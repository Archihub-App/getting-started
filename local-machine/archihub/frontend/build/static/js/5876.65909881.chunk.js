"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[5876],{14533:function(e,t,n){var i=n(89379),a=n(5544),r=n(65043),l=n(83003),s=n(73216),o=n(85211),c=n(72378),u=n(91181),d=n(76445),p=n(29464),f=n(81551),v=n(99246),m=n(70579),h=(0,f.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"}}}));t.A=function(e){h();var t=(0,r.useState)(null),n=(0,a.A)(t,2),f=(n[0],n[1]),g=(0,r.useState)(null),y=(0,a.A)(g,2),b=y[0],x=(y[1],(0,r.useState)([])),A=(0,a.A)(x,2),w=(A[0],A[1],(0,r.useState)(0)),j=(0,a.A)(w,2),k=j[0],S=j[1],C=(0,r.useState)([]),B=(0,a.A)(C,2),M=B[0],T=B[1],_=(0,r.useState)(!1),F=(0,a.A)(_,2),D=F[0],R=F[1],E=(0,r.useState)(""),N=(0,a.A)(E,2),L=N[0],z=(N[1],(0,r.useState)("")),G=(0,a.A)(z,2),q=(G[0],G[1],(0,s.Zp)()),H=(0,l.wA)(),I=(0,l.d4)((function(e){return e.app.filters}));(0,v.A)();return(0,r.useEffect)((function(){var t;null!==(t=e.selectedType)&&void 0!==t&&t.parentsTypes?e.selectedType.parentsTypes.length>0?f("multiple"):e.selectedType.hierarchical?f("tree"):f("single"):f(null)}),[e.selectedType]),(0,r.useEffect)((function(){e.setSelected&&b?e.setSelected(b.id):e.setSelected&&e.setSelected(null)}),[b]),(0,r.useEffect)((function(){var t=(0,i.A)({},I);H((0,o.vm)((0,o.e)(t,e.view,"keyword",L)))}),[L]),(0,r.useEffect)((function(){var t=(0,i.A)({},I);t=(0,o.e)(t,e.view,"status",e.viewDrafts?"draft":"published"),H((0,o.vm)(t))}),[e.viewDrafts]),(0,m.jsxs)("div",{style:(0,i.A)({display:"flex",height:"100%",width:"100%",flexDirection:"column"},e.style),children:[(0,m.jsx)(c.EL,{style:{width:"calc(100% - 40px)",height:"55px",overflowX:"hidden",marginLeft:0,marginBottom:0},children:(0,m.jsx)(u.A,{total:k,showFilters:D,setShowFilters:R,activeFilters:M,setActiveFilters:e.forms?T:null,view:e.view})}),(0,m.jsxs)(c.EL,{id:"dropzone_scroll",onScroll:function(e){},style:{width:"calc(100% - 40px)",height:"calc(100% - 40px)",overflowX:"hidden",marginLeft:0,placeContent:"flex-start"},children:[!D&&(0,m.jsx)(d.A,{selectedTypes:e.detail?e.type:e.types,selectedType:e.selectedType,filters:I,type:e.type,editBtns:!0,parentTotal:S,handleClick:function(t){"checkbox"===e.type?e.setSelectedResources(t.id):q("/detail/".concat(t.id))},selectedResources:e.selectedResources,view:e.view,form:e.forms,setColumns:function(){}}),D&&(0,m.jsx)(p.n,{forms:e.forms,activeFilters:M,setActiveFilters:T,view:e.view})]})]})}},42588:function(e,t,n){n.d(t,{AD:function(){return M},M2:function(){return B},oF:function(){return T}});var i=n(60436),a=n(65043),r=n(96446),l=n(85865),s=n(17392),o=n(43845),c=n(81551),u=n(94495),d=n(39244),p=n(26240),f=n(11238),v=n(83003),m=n(85211),h=n(98344),g=n(5983),y=n(58140),b=n(18751),x=n(92429),A=n(78717),w=n(99246),j=n(70579),k=(0,c.A)((function(e){return{container:{display:"flex",flexDirection:"column",width:"calc(100% - 20px)",overflowY:"auto",marginLeft:"10px",marginTop:"10px"},item:{overflow:"hidden",color:"#777",fontSize:14,position:"relative",marginBottom:10,paddingBottom:10},itemName:{fontSize:15},chip:{margin:2,padding:2,"& .MuiChip-avatar":{backgroundColor:"transparent !important"}}}})),S=function(e){var t=k(),n=(0,p.A)(),i=(0,y.M)().showAlert,a=(0,v.d4)((function(e){return e.app.isDarkMode}));return(0,j.jsxs)(r.A,{className:t.item,style:e.style?e.style:{borderBottom:"1px solid ".concat(a?n.palette.grey[800]:n.palette.grey[200])},children:[(0,j.jsxs)(r.A,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,j.jsx)(l.A,{className:t.itemName,style:{color:a?n.palette.primary.light:n.palette.primary.main},children:e.title}),e.help&&(0,j.jsx)(s.A,{onClick:function(){i("video-info",e.help)},children:(0,j.jsx)(g.A,{style:{color:a?n.palette.grey[400]:n.palette.grey[700]}})})]}),e.item?e.item:e.children]})},C=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=t<0?0:t,i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(n))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]},B=function(e){var t,n,i=k(),l=(0,v.d4)((function(e){return e.app.isDarkMode})),s=(0,p.A)();return(0,a.useEffect)((function(){0===e.record.parent.length?e.setMetadata(null):e.metadata&&e.setMetadata(e.record.parent[0])}),[e.record]),(0,j.jsxs)(r.A,{className:i.container,children:[(0,j.jsx)(S,{title:"Nombre del archivo",item:null!==e&&void 0!==e&&null!==(t=e.record)&&void 0!==t&&t.displayName?null===e||void 0===e||null===(n=e.record)||void 0===n?void 0:n.displayName:e.record.name}),(0,j.jsx)(S,{title:"HASH",item:e.record.hash}),(0,j.jsx)(S,{title:"Tama\xf1o",item:C(e.record.size)}),e.record.parent.length>0&&(0,j.jsx)(S,{title:"Contenido relacionado",children:e.record.parent.map((function(t,n){return(0,j.jsx)(o.A,{avatar:u.dR.filter((function(e){return e.value===t.icon}))?u.dR.filter((function(e){return e.value===t.icon}))[0].iconlight:(0,j.jsx)(d.A,{}),label:t.name,className:i.chip,onClick:function(){e.setMetadata(t)},sx:{background:l?s.palette.grey[800]:s.palette.grey[200],color:l?s.palette.grey[300]:s.palette.grey[600],"& svg":{width:15},"& path":{fill:l?s.palette.grey[300]:s.palette.grey[600]}}},n)}))})]})},M=function(e){var t=k(),n=((0,v.wA)(),(0,v.d4)((function(e){return e.app.filters}))),i=(0,v.d4)((function(e){return e.app.isDarkMode})),a=(0,p.A)(),s=(0,y.M)().showAlert;return(0,j.jsx)(j.Fragment,{children:(0,j.jsxs)(r.A,{className:t.container,children:[(0,j.jsx)(f.nA,{startIcon:(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(b.A,{}),(0,j.jsx)(x.A,{})]}),label:"Descargar inventario",style:{borderRadius:5,backgroundColor:i?a.palette.grey[800]:a.palette.grey[200],color:a.palette.grey[500]},onClick:function(){s("confirm","\xbfDesea descargar el inventario de los tipos de contenido?").then((function(t){if(t){s("loading","Generando archivo...");var i=n[e.view]&&n[e.view].post_type?n[e.view].post_type.slug:"*";A._Q({post_type:i,view:e.view},(function(e){s("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){s("success","Archivo descargado correctamente")})).catch((function(e){e.msg?s("error","Error al descargar el archivo: "+e.msg):s("error","Error al descargar el archivo")}))}}))}}),(0,j.jsx)(S,{title:"Descripci\xf3n",item:(0,j.jsx)(l.A,{children:e.type.description})}),e.files.total>0&&(0,j.jsx)(S,{title:"Balance general de los documentos",item:(0,j.jsx)(h.RJ,{data:e.files.data,legend:!0,style:{height:250,width:250,margin:"0 auto"}})}),(0,j.jsx)(T,{view:e.view,parents:e.parents,root:e.root})]})})},T=function(e){var t,n=(0,v.wA)(),a=(0,v.d4)((function(e){return e.app.filters})),r=k(),l=(0,v.d4)((function(e){return e.app.isDarkMode})),s=(0,p.A)(),c=(0,w.A)();return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(S,{title:c.formatMessage({id:"cataloging.folderStructure"}),item:(0,j.jsx)(j.Fragment,{children:(0,j.jsx)(f.$k,{label:c.formatMessage({id:"menuList.postTypes"}),style:{color:l?"white":"black",backgroundColor:l?"#333":"#f5f5f5",borderColor:l?"#333":"#f5f5f5"},showLabel:!1,value:a[e.view]?!e.single&&a[e.view].post_type?a[e.view].post_type.slug:e.single&&!Array.isArray(a[e.view].post_type_single)&&a[e.view].post_type_single?a[e.view].post_type_single.slug:"*":"*",onChange:function(t){if(e.onChange)e.onChange(t);else{var i=e.single?"post_type_single":"post_type";if("*"===t.target.value){var r=(0,m.e)(a,e.view,i,null);n((0,m.vm)(r))}else{var l=(0,m.e)(a,e.view,i,{slug:t.target.value});n((0,m.vm)(l))}}},options:function(){var t=(0,i.A)(e.parents.map((function(e){return{value:e.slug,label:e.name}})));return"cataloging"!==e.view&&(t=[{value:"*",label:c.formatMessage({id:"cataloging.allPostTypes"})}].concat((0,i.A)(t))),t}()})}),help:"folder-structure"}),a[e.view]&&(null===(t=a[e.view].parents)||void 0===t?void 0:t.name)&&(0,j.jsx)("div",{style:{marginBottom:10},children:(0,j.jsx)(o.A,{avatar:u.dR.filter((function(t){return t.value===a[e.view].parents.icon}))?u.dR.filter((function(t){return t.value===a[e.view].parents.icon}))[0].iconlight:(0,j.jsx)(d.A,{}),label:a[e.view].parents.name,className:r.chip,onDelete:function(){var t=(0,m.e)(a,e.view,"parents",{id:e.root});n((0,m.vm)(t))},size:"small",color:"primary",sx:{backgroundColor:s.palette.primary.light,color:s.palette.primary.main,"& path":{fill:s.palette.primary.main}}})})]})}},53326:function(e,t){t.A={50:"#ede7f6",100:"#d1c4e9",200:"#b39ddb",300:"#9575cd",400:"#7e57c2",500:"#673ab7",600:"#5e35b1",700:"#512da8",800:"#4527a0",900:"#311b92",A100:"#b388ff",A200:"#7c4dff",A400:"#651fff",A700:"#6200ea"}},55263:function(e,t,n){n.d(t,{A:function(){return g}});var i=n(64467),a=n(98587),r=n(58168),l=n(65043),s=n(69292),o=n(98610),c=n(98206),u=n(34535),d=n(92532),p=n(72372);function f(e){return(0,p.Ay)("MuiToolbar",e)}(0,d.A)("MuiToolbar",["root","gutters","regular","dense"]);var v=n(70579),m=["className","component","disableGutters","variant"],h=(0,u.Ay)("div",{name:"MuiToolbar",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,!n.disableGutters&&t.gutters,t[n.variant]]}})((function(e){var t=e.theme,n=e.ownerState;return(0,r.A)({position:"relative",display:"flex",alignItems:"center"},!n.disableGutters&&(0,i.A)({paddingLeft:t.spacing(2),paddingRight:t.spacing(2)},t.breakpoints.up("sm"),{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}),"dense"===n.variant&&{minHeight:48})}),(function(e){var t=e.theme;return"regular"===e.ownerState.variant&&t.mixins.toolbar})),g=l.forwardRef((function(e,t){var n=(0,c.b)({props:e,name:"MuiToolbar"}),i=n.className,l=n.component,u=void 0===l?"div":l,d=n.disableGutters,p=void 0!==d&&d,g=n.variant,y=void 0===g?"regular":g,b=(0,a.A)(n,m),x=(0,r.A)({},n,{component:u,disableGutters:p,variant:y}),A=function(e){var t=e.classes,n={root:["root",!e.disableGutters&&"gutters",e.variant]};return(0,o.A)(n,f,t)}(x);return(0,v.jsx)(h,(0,r.A)({as:u,className:(0,s.A)(A.root,i),ref:t,ownerState:x},b))}))},61151:function(e,t,n){n.r(t);var i=n(60436),a=n(89379),r=n(5544),l=n(65043),s=n(73216),o=n(72378),c=n(83003),u=n(85211),d=n(19853),p=n(55263),f=n(85865),v=n(4598),m=n(11906),h=n(96446),g=n(31445),y=n(14533),b=n(30064),x=n.n(b),A=n(42588),w=n(69389),j=n(43288),k=n(26240),S=n(99246),C=n(24394),B=n(63516),M=n(11238),T=n(58140),_=n(70579);t.default=function(e){var t,n,b,F=(0,l.useState)([]),D=(0,r.A)(F,2),R=D[0],E=D[1],N=(0,l.useState)(null),L=(0,r.A)(N,2),z=L[0],G=L[1],q=(0,l.useState)(null),H=(0,r.A)(q,2),I=H[0],V=H[1],O=(0,l.useState)(null),P=(0,r.A)(O,2),J=P[0],Z=P[1],Q=(0,l.useState)(null),X=(0,r.A)(Q,2),Y=X[0],K=X[1],U=(0,l.useState)(null),$=(0,r.A)(U,2),W=$[0],ee=$[1],te=(0,l.useState)([]),ne=(0,r.A)(te,2),ie=ne[0],ae=ne[1],re=(0,l.useState)([]),le=(0,r.A)(re,2),se=le[0],oe=le[1],ce=(0,l.useState)(!1),ue=(0,r.A)(ce,2),de=ue[0],pe=ue[1],fe=(0,l.useState)(!1),ve=(0,r.A)(fe,2),me=(ve[0],ve[1],(0,s.g)().slug),he=((0,s.Zp)(),(0,c.d4)((function(e){return e.app.filters}))),ge=(0,c.wA)(),ye=(0,k.A)(),be=(0,T.M)().showAlert,xe=(0,S.A)(),Ae=(0,c.d4)((function(e){return e.app.isDarkMode})),we={page:0,sortBy:"createdAt",sortOrder:"desc",post_type:null,status:"published",activeColumns:[{destiny:"",label:""},{destiny:"createdAt",label:"Fecha de creaci\xf3n",sortBy:"createdAt"},{destiny:"ident",label:"Identificador"},{destiny:"metadata.firstLevel.title",label:"T\xedtulo",sortBy:"metadata.firstLevel.title"},{destiny:"files",label:"Archivos"},{destiny:"accessRights",label:"Derechos de acceso"}]};(0,l.useEffect)((function(){je()}),[e.match]),(0,l.useEffect)((function(){var e,t;if(he.bulk)he.bulk.post_type?G(he.bulk.post_type):G(null),he.bulk.parents?oe(null===(t=he.bulk)||void 0===t?void 0:t.parents):oe([]);else if(null===(e=he.bulk)||void 0===e||!e.status){var n=(0,u.e)(he,"bulk","status","published");ge((0,u.vm)(n))}}),[he]);var je=function(){};(0,l.useEffect)((function(){if(g.DI().then((function(e){console.log("response",e),E(e)})),he.bulk&&!he.bulk.status){var e=(0,u.e)(he,"bulk","status","published");ge((0,u.vm)(e))}je()}),[]),(0,l.useEffect)((function(){if(null===z&&R&&R.length>0){K({fields:[[{destiny:"metadata.firstLevel.title",label:xe.formatMessage({id:"general.title"}),sortBy:"metadata.firstLevel.title"}]]});var e=(0,a.A)({},he);e.bulk=we,ge((0,u.vm)(e))}else z&&g.Pw(z.slug).then((function(e){K({fields:[e.metadata.fields],forms:[{name:e.metadata.name,slug:e.metadata.slug}]});var t=(0,a.A)({},he);t.bulk.activeColumns&&0!==t.bulk.activeColumns.length||(t.bulk.activeColumns=we.activeColumns),ge((0,u.vm)(t))}))}),[z]);return(0,l.useEffect)((function(){me&&d.DJ(me,"bulk").then((function(e){V(e);var t={};e.map((function(e){"instructions"!==e.type&&"file"!==e.type&&((t=(0,a.A)({},t))[e.id]=e.default)})),t.files=[],Z(t)}))}),[]),(0,_.jsxs)(o.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:[ie&&R&&(null===(t=he.bulk)||void 0===t?void 0:t.status)&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsx)(o.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"40%",display:"block",overflow:"auto",placeContent:"flex-start"},children:(0,_.jsxs)("div",{style:{padding:10},children:[(null===(n=he.bulk)||void 0===n?void 0:n.status)&&(0,_.jsxs)(_.Fragment,{children:[(0,_.jsxs)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:20},children:[(0,_.jsx)(f.A,{style:{color:Ae?ye.palette.primary.light:ye.palette.primary.main,fontSize:15},children:xe.formatMessage({id:"cataloging.viewDrafts"})}),(0,_.jsx)(v.A,{checked:"draft"===(null===(b=he.bulk)||void 0===b?void 0:b.status),onChange:function(){var e,t=(0,a.A)({},he);ge((0,u.vm)((0,u.e)(t,"bulk","status","draft"===(null===(e=he.bulk)||void 0===e?void 0:e.status)?"published":"draft")))}})]}),(0,_.jsx)(A.oF,{parents:R,view:"bulk"}),(0,_.jsx)(w.A,{root:null,activeTypes:z?[{slug:z.slug}]:R.map((function(e){return{slug:e.slug}})),postType:z?z.slug:null,view:"list",mainView:"bulk",checkboxTypes:R.map((function(e){return e.slug})),multiple:!1,selected:[se],childrenSelect:!1,setSelected:function(e){if(0===e.length){var t=(0,u.e)(he,"bulk","parents",null);ge((0,u.vm)(t))}else{var n=(0,u.e)(he,"bulk","parents",e[0]);ge((0,u.vm)(n))}}},z?[z.slug]:R)]}),I&&J&&(0,_.jsx)("div",{style:{marginTop:20},children:(0,_.jsx)(B.l1,{initialValues:J,onSubmit:function(e,t){var n,i,a=t.setSubmitting;null!==(n=he.bulk)&&void 0!==n&&n.post_type?e.post_type=null===(i=he.bulk)||void 0===i?void 0:i.post_type.slug:e.post_type=R.map((function(e){return e.slug})),e.parent=se.id,e.resources=ie,a(!0),pe(!0),d.eP(me,JSON.stringify(e)).then((function(e){a(!1),pe(!1),be("success",e.msg).then((function(){}))})).catch((function(e){a(!1),pe(!1),e.json().then((function(e){be("error",e.msg)}))}))},children:function(e){var t=e.values,n=e.errors,i=(e.touched,e.handleChange),a=e.handleBlur,r=e.handleSubmit,l=e.isSubmitting,s=e.setFieldValue;return(0,_.jsxs)("form",{onSubmit:r,children:[I.map((function(e,r){return(0,_.jsxs)(_.Fragment,{children:["file"===e.type&&(0,_.jsx)(C.U0,{name:e.label,id:e.name,values:t,required:e.required,change:s,limit:e.limit,acceptedFiles:e.acceptedFiles},r),"instructions"===e.type&&(0,_.jsx)(f.A,{variant:"body1",sx:{padding:"10px",backgroundColor:"#f5f5f5",marginBottom:"10px",borderRadius:"5px",background:ye.palette.primary.light,color:ye.palette.primary.main},children:e.text},r),"checkbox"===e.type&&(0,_.jsx)(C.FO,{id:e.id,name:e.label,instructions:e.instructions,value:t[e.id],handleChange:function(t){s(e.id,t)},handleBlur:a,error:n[e.id],required:e.required},r),"select"===e.type&&(0,_.jsx)(C.Q5,{id:e.id,name:e.label,value:t[e.id],handleChange:i,handleBlur:a,error:n[e.id],options:e.options,required:e.required},r),"text"===e.type&&(0,_.jsx)(C.BR,{id:e.id,name:e.label,value:t[e.id],handleChange:i,handleBlur:a,error:n[e.id],required:e.required},r),"button"===e.type&&(0,_.jsx)(m.A,{variant:"contained",onClick:function(){!function(e,t){d.Gj(e,JSON.stringify({parent:W,post_type:z.slug}),t).then((function(e){x().fire({title:"\xc9xito",text:"Se ha ejecutado la acci\xf3n correctamente",icon:"success",confirmButtonText:"Ok"})}))}(me,e.callback)},sx:{margin:"10px"},children:e.label}),"condition"===e.type&&(0,_.jsx)(C.e7,{id:e.id,label:e.label,value:t[e.id],condition:e.condition,options:e.options,conditionValue:t[e.id_condition],change:s},"".concat(r,"-").concat(t[e.id_condition]))]})})),(0,_.jsx)(h.A,{style:{display:"flex",justifyContent:"center",marginTop:25},children:(0,_.jsx)(M.nA,{variant:"outlined",type:"submit",disabled:l,style:{margin:5,width:"auto"},label:"Procesar"})})]})}})})]})}),R.length>0&&(0,_.jsx)(y.A,{types:R,style:{width:"60%"},forms:Y,view:"bulk",type:"checkbox",selectedType:z,setSelected:ee,setSelectedResources:function(e){ie.includes(e)?ae(ie.filter((function(t){return t!==e}))):ae([].concat((0,i.A)(ie),[e]))},selectedResources:ie})]}),de&&(0,_.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",position:"fixed",top:0,left:0,background:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(5px) saturate(0%)",zIndex:9999},children:(0,_.jsx)(j.A,{})})]})}},92429:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),r=n(70579);t.A=(0,a.default)((0,r.jsx)("path",{d:"M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2m-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1m2 14H7v-2h7zm3-4H7v-2h10zm0-4H7V7h10z"}),"Assignment")}}]);
//# sourceMappingURL=5876.65909881.chunk.js.map