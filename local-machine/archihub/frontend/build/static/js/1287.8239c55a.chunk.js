"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[1287],{61413:function(e,t,n){var r=n(60436),o=n(5544),i=n(65043),a=n(83003),l=n(26240),c=n(96446),s=n(55263),u=n(17392),d=n(72221),h=n(10673),g=n(77739),f=n(12110),p=n(43360),b=n(99246),x=n(97223),m=n(61958),w=n(75678),k=n(27385),y=n(43288),v=n(81551),A=n(25012),j=n(58140),C=n(70579);t.A=function(e){var t=(0,i.useState)(null),n=(0,o.A)(t,2),S=n[0],B=n[1],R=(0,i.useState)([]),M=(0,o.A)(R,2),E=M[0],V=M[1],T=(0,i.useState)([]),I=(0,o.A)(T,2),z=I[0],_=I[1],P=(0,i.useState)(null),H=(0,o.A)(P,2),F=H[0],D=H[1],O=(0,i.useState)(null),L=(0,o.A)(O,2),N=L[0],J=L[1],G=(0,i.useState)([]),q=(0,o.A)(G,2),W=q[0],Z=q[1],Q=(0,i.useState)(null),$=(0,o.A)(Q,2),U=$[0],K=$[1],X=(0,i.useState)(!1),Y=(0,o.A)(X,2),ee=Y[0],te=Y[1],ne=(0,i.useState)(!1),re=(0,o.A)(ne,2),oe=re[0],ie=re[1],ae=(0,i.useState)(!1),le=(0,o.A)(ae,2),ce=le[0],se=le[1],ue=(0,i.useState)([]),de=(0,o.A)(ue,2),he=de[0],ge=de[1],fe=(0,b.A)(),pe=(0,a.d4)((function(e){return e.app.isDarkMode})),be=(0,l.A)(),xe=(0,i.useRef)(null),me=(0,i.useRef)(null),we=(0,j.M)().showAlert,ke=(0,v.A)((function(e){return{bloque:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:be.palette.primary.main,border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:be.palette.primary.main},"&::-webkit-scrollbar-thumb:active":{background:be.palette.primary.main},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}}}}));(0,i.useEffect)((function(){x.UK().then((function(e){V(e.map((function(e){return{name:e.name,id:e._id.$oid}}))),B({name:e[0].name,id:e[0]._id.$oid})})).catch((function(e){console.log(e)}))}),[]),(0,i.useEffect)((function(){S&&x.SM(S.id).then((function(e){_(e.map((function(e){return{name:e.name,id:e.id}}))),D({name:e[0].name,id:e[0].id})})).catch((function(e){console.log(e)}))}),[S]),(0,i.useEffect)((function(){me.current&&me.current.scrollIntoView({behavior:"smooth",block:"start"}),ee&&x.Jb({message:W[W.length-1].message,provider:S,model:F,type:e.type,id:e.id,conversation_id:N,slug:e.slug,opts:e.opts}).then((function(e){var t=e.response;J(e.conversation_id),Z([].concat((0,r.A)(W),[{message:t,sender:"assistant"}])),te(!1)})).catch((function(e){te(!1),e.json().then((function(e){we("error",e.msg)}))}))}),[W]),(0,i.useEffect)((function(){ce&&(ie(!0),x.kP({id:e.id,type:"record"}).then((function(e){console.log(e),ge(e),ie(!1)})).catch((function(e){ie(!1),console.log(e)})))}),[ce]);var ye=function(){U&&!ee&&F&&S&&(Z([].concat((0,r.A)(W),[{message:U,sender:"user"}])),K(""),te(!0))};return(0,C.jsxs)(c.A,{sx:{backgroundColor:pe?be.palette.grey[800]:"#fff",borderRadius:"5px"},children:[(0,C.jsxs)(s.A,{children:[0===W.length&&S&&!ce&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(u.A,{onClick:function(){se(!ce)},style:{marginRight:10,color:pe?"#fff":be.palette.primary.main,backgroundColor:pe?be.palette.grey[700]:"#fff"},children:(0,C.jsx)(m.A,{})}),(0,C.jsx)(d.A,{value:S?S.id:"",sx:{width:200,backgroundColor:pe?be.palette.grey[700]:"#fff",color:pe?"#fff":be.palette.primary.main},children:E.map((function(e,t){return(0,C.jsx)(h.A,{value:e.id,onClick:function(){B(e)},children:e.name},t)}))}),(0,C.jsx)(d.A,{value:F?F.id:"",sx:{width:200,backgroundColor:pe?be.palette.grey[700]:"#fff",color:pe?"#fff":be.palette.primary.main},children:z.map((function(e,t){return(0,C.jsx)(h.A,{value:e.id,onClick:function(){D(e)},children:e.name},t)}))})]}),(W.length>0||ce)&&(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(g.A,{title:fe.formatMessage({id:"general.history"}),children:(0,C.jsx)(u.A,{onClick:function(){se(!ce)},style:{marginRight:10,color:pe?"#fff":be.palette.primary.main,backgroundColor:pe?be.palette.grey[700]:"#fff"},children:(0,C.jsx)(m.A,{})})}),(0,C.jsx)(g.A,{title:fe.formatMessage({id:"general.newConversation"}),children:(0,C.jsx)(u.A,{onClick:function(){Z([]),J(null),se(!1),K(""),te(!1),ie(!1),ge([])},style:{marginRight:10,color:pe?"#fff":be.palette.primary.main,backgroundColor:pe?be.palette.grey[700]:"#fff"},children:(0,C.jsx)(k.A,{})})}),(0,C.jsx)(d.A,{value:S?S.id:"",sx:{width:200,backgroundColor:pe?be.palette.grey[700]:"#fff",color:pe?"#fff":be.palette.primary.main},children:E.map((function(e,t){return(0,C.jsx)(h.A,{value:e.id,onClick:function(){B(e)},children:e.name},t)}))}),(0,C.jsx)(d.A,{value:F?F.id:"",sx:{width:200,backgroundColor:pe?be.palette.grey[700]:"#fff",color:pe?"#fff":be.palette.primary.main},children:z.map((function(e,t){return(0,C.jsx)(h.A,{value:e.id,onClick:function(){D(e)},children:e.name},t)}))})]})]}),(0,C.jsxs)(c.A,{ref:xe,className:ke().bloque,sx:{height:200,width:500,backgroundColor:pe?be.palette.grey[700]:"#fff",overflowY:"auto",padding:2,display:"flex",flexDirection:"column",gap:1},children:[ce&&he.length>0&&!oe&&(0,C.jsx)(C.Fragment,{children:he.map((function(e,t){return(0,C.jsx)(f.A,{onClick:function(){var t;t=e._id.$oid,ie(!0),x.QL(t).then((function(e){Z(e.messages.map((function(e){return{message:e.content,sender:e.role}}))),J(e._id.$oid),se(!1),K(""),ie(!1)})).catch((function(e){ie(!1),te(!1),e.json().then((function(e){console.log(e.msg)}))}))},sx:{padding:2,backgroundColor:pe?be.palette.grey[600]:"#fff",color:pe?"#fff":"#000",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.1)",wordWrap:"break-word",cursor:"pointer","&:hover":{backgroundColor:pe?be.palette.grey[500]:"#f0f0f0"}},children:e.messages[0].content},t)}))}),W.length>0&&!ce&&W.map((function(e,t){return(0,C.jsx)(c.A,{ref:t===W.length-1?me:null,sx:{alignSelf:"user"===e.sender?"flex-end":"flex-start",maxWidth:"90%",padding:1.5,borderRadius:2,backgroundColor:"user"===e.sender?be.palette.primary.main:pe?be.palette.grey[600]:be.palette.grey[100],color:"user"===e.sender||pe?"#fff":"#000",boxShadow:"0px 2px 4px rgba(0, 0, 0, 0.1)",wordWrap:"break-word"},children:(0,C.jsx)(A.$,{children:e.message})},t)})),ee&&(0,C.jsx)(c.A,{sx:{alignSelf:"flex-start",maxWidth:"90%",padding:1.5,borderRadius:2,color:pe?"#fff":"#000",wordWrap:"break-word"},children:(0,C.jsx)(y.A,{width:60,height:60})}),oe&&(0,C.jsx)(y.A,{width:60,height:60})]}),!ce&&(0,C.jsx)(s.A,{children:(0,C.jsxs)("form",{onSubmit:function(e){e.preventDefault(),ye()},style:{display:"flex",flexDirection:"row",alignItems:"center",width:"100%"},children:[(0,C.jsx)(p.A,{placeholder:fe.formatMessage({id:"general.typeMessage"}),value:U||"",style:{flex:1,backgroundColor:pe?be.palette.grey[700]:"#fff",color:pe?"#fff":be.palette.primary.main,padding:10},onChange:function(e){K(e.target.value)}}),(0,C.jsx)(u.A,{onClick:function(){ye()},style:{marginLeft:10,color:pe?"#fff":be.palette.primary.main},children:(0,C.jsx)(w.A,{})})]})})]})}},63573:function(e,t,n){n.d(t,{A:function(){return Y}});var r=n(89379),o=n(5544),i=n(65043),a=n(83003),l=n(85211),c=n(9920),s=n(19853),u=n(48210),d=n(4598),h=n(43845),g=n(96446),f=n(17392),p=n(99070),b=n(55263),x=n(90151),m=n(68641),w=n(42497),k=n(83903),y=n(34535),v=n(6512),A=n(4319),j=n(76370),C=n(81551),S=n(11906),B=n(41905),R=n(24394),M=n(30064),E=n.n(M),V=n(26240),T=n(15089),I=n(70579),z=((0,B.A)((function(e){return{segment:{fontSize:"20px",opacity:.25,transition:"all .5s",textAlign:"center",cursor:"pointer","&:hover":{opacity:.55},"&.selected":{opacity:1}},paragraph:{fontSize:"15px",maxWidth:"750px",margin:"0 auto",marginBottom:"20px"}}})),function(e){var t=(0,i.useState)(0),n=(0,o.A)(t,2),l=n[0],c=(n[1],(0,i.useState)(null)),u=(0,o.A)(c,2),d=u[0],h=u[1],f=(0,i.useState)(null),p=(0,o.A)(f,2),b=p[0],x=p[1],m=(0,V.A)();(0,a.d4)((function(e){return e.app.isDarkMode}));(0,i.useEffect)((function(){e.view&&(e.setTabView("document"),s.DJ(e.view.slug,"detail").then((function(e){e.forEach((function(e){"multicheckbox"===e.type&&w(e.id,e.default)})),h(e)})).catch((function(e){})))}),[]);var w=function(e,t){var n=(0,r.A)({},b);n[e]=t,x(n)};return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(g.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",margin:0,marginBottom:"5px"},children:(0,I.jsx)(T.A,{value:l,style:{background:m.palette.grey[700]},list:[{value:"document",label:"Documento"},{value:"blocks",label:"Bloques"},{value:"words",label:"Palabras"}],onChange:function(t){e.setTabView(t.value)}})}),d&&(0,I.jsx)(g.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:"20px",marginTop:"20px",backgroundColor:"#fff",borderRadius:"25px",boxShadow:"0px 3px 1px -2px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 1px 5px 0px rgba(0,0,0,0.12)"},children:d.map((function(t,n){return(0,I.jsxs)(I.Fragment,{children:["multicheckbox"===t.type&&(0,I.jsx)(R.lH,{options:t.options.map((function(e){return{id:e.value,term:e.label}})),value:b[t.id],handleChange:function(e){w(t.id,e)}}),"button"===t.type&&(0,I.jsx)(S.A,{variant:"contained",onClick:function(){var n;e.view.slug,n=t.callback,s.Gj(e.view.slug,JSON.stringify((0,r.A)((0,r.A)({},b),{},{id:e.id})),n).then((function(e){E().fire({title:"\xc9xito",text:"Se ha ejecutado la acci\xf3n correctamente",icon:"success",confirmButtonText:"Ok"})}))},sx:{margin:"10px"},children:t.label})]})}))})]})}),_=n(74054),P=n(6456),H=n(48084),F=n(70141),D=n(64904),O=n(90675),L=n(10467),N=n(2936),J=n.n(N),G=n(49658),q=n(43288),W=function(e){var t=(0,i.useRef)(),n=(0,i.useRef)(),a=(0,i.useRef)(),l=(0,i.useRef)(!1),s=(0,i.useState)(0),u=(0,o.A)(s,2),d=u[0],h=u[1],g=(0,i.useMemo)((function(){return G.UMr(G.t55)}),[]),f=(0,i.useState)({width:100,height:100}),p=(0,o.A)(f,2),b=p[0],x=p[1],m=(0,i.useState)(!0),w=(0,o.A)(m,2),k=w[0],y=w[1],v=(0,i.useCallback)(function(){var t=(0,L.A)((0,O.A)().mark((function t(n){var r,o,i,a,l;return(0,O.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=document.getElementById("page-".concat(n))){t.next=4;break}return n+1===e.page&&y(!1),t.abrupt("return");case 4:if(o=r.querySelector("svg")){t.next=8;break}return n+1===e.page&&y(!1),t.abrupt("return");case 8:return n+1===e.page&&y(!0),t.prev=9,t.next=12,c.f2(e.id,[n],"big");case 12:if((i=t.sent)&&i[0]&&i[0].data){t.next=17;break}return console.error("Image data not found for page",n),n+1===e.page&&y(!1),t.abrupt("return");case 17:a=new Image,l="data:image/jpg;base64,"+i[0].data,r.style.backgroundImage="url(".concat(l,")"),a.onload=function(){var t=a.width,i=a.height,l=r.getBoundingClientRect();if(0===l.width||0===l.height)return console.warn("Page div for index ".concat(n," has zero/incorrect dimensions when image loaded. Width: ").concat(l.width,", Height: ").concat(l.height,". SVG setup might be incorrect. Retrying might be needed or check CSS.")),void(n+1===e.page&&y(!1));var c,s,u=l.width,d=l.height,h=t/i;h>u/d?(c=u,s=u/h):t/u>i/d?(c=u,s=i*(u/t)):(s=d,c=t*(d/i));var g=(u-(c=Math.max(1,c)))/2,f=(d-(s=Math.max(1,s)))/2;o.setAttribute("viewBox","0 0 ".concat(c," ").concat(s)),o.setAttribute("preserveAspectRatio","none"),o.style.position="absolute",o.style.left="".concat(g,"px"),o.style.top="".concat(f,"px"),o.style.width="".concat(c,"px"),o.style.height="".concat(s,"px"),n+1===e.page&&(x({width:c,height:s}),y(!1))},a.onerror=function(){console.error("Failed to load image for page",n),n+1===e.page&&y(!1)},a.src=l,t.next=29;break;case 25:t.prev=25,t.t0=t.catch(9),console.error("Error fetching image for page",n,t.t0),n+1===e.page&&y(!1);case 29:case"end":return t.stop()}}),t,null,[[9,25]])})));return function(e){return t.apply(this,arguments)}}(),[e.id,e.page,y,x]);(0,i.useEffect)((function(){var t=e.page-1,r=setTimeout((function(){var e=document.getElementById("page-".concat(t));e&&e.scrollIntoView({duration:0})}),200),o=null;n.current=new IntersectionObserver((function(t){return t.forEach((function(t){if(t.isIntersecting){var n=parseInt(t.target.dataset.index);o&&clearTimeout(o),o=setTimeout((function(){e.setPage(n+1)}),150)}}))}),{threshold:.25});var i=n.current;e.pages>0&&document.querySelectorAll(".page").forEach((function(e){return i.observe(e)}));var a=setTimeout((function(){e.pages>0&&t>=0&&t<e.pages?v(t):(e.pages,y(!1))}),250);return function(){i&&i.disconnect(),clearTimeout(r),o&&clearTimeout(o),clearTimeout(a)}}),[e.id,e.page,e.pages,e.setPage,v]),(0,i.useEffect)((function(){var t=n.current;t&&e.pages>0&&(t.disconnect(),document.querySelectorAll(".page").forEach((function(e){return t.observe(e)})))}),[e.pages]),(0,i.useEffect)((function(){if(!l.current){if(d!==e.page&&e.page>0&&e.page<=e.pages){var t=Math.abs(e.page-d),n=document.getElementById("page-".concat(e.page-1));n&&n.scrollIntoView({behavior:"smooth",duration:Math.max(100,50*t)})}h(e.page)}}),[e.page,e.pages,d]);var A=null,j=(0,i.useCallback)((function(){l.current=!0,A&&clearTimeout(A),A=setTimeout((function(){l.current=!1}),150)}),[]);(0,i.useEffect)((function(){var e=t.current;return e&&e.addEventListener("wheel",j,{passive:!0}),function(){e&&e.removeEventListener("wheel",j),A&&clearTimeout(A)}}),[j]);var C=function(e){return Array.isArray(e.label)?e.label.length>0?"O"===e.label[0]?"transparent":g(e.label[0]):void 0:e.type?(console.log("Block type:",e.type,"Color:",g(e.type)),g(e.type)):"transparent"};(0,i.useEffect)((function(){return t.current&&t.current.addEventListener("wheel",j),function(){t.current&&t.current.removeEventListener("wheel",j)}}),[t]),(0,i.useEffect)((function(){a.current&&J()(a.current).resizable({edges:{left:!1,right:!0,bottom:!0,top:!1},listeners:{move:function(t){var n=t.target.ownerSVGElement;if(n){var o=n.getBoundingClientRect();if(0!==b.width&&0!==b.height){var i=parseFloat(t.target.getAttribute("x")),a=parseFloat(t.target.getAttribute("y")),l=t.client.x-o.left,c=t.client.y-o.top,s=l/o.width*b.width-i,u=c/o.height*b.height-a;s=Math.max(1,s),u=Math.max(1,u),t.target.setAttribute("width","".concat(s)),t.target.setAttribute("height","".concat(u));var d=s/b.width,h=u/b.height;d=Math.max(0,Math.min(d,1-e.selectedBlock.bbox.x)),h=Math.max(0,Math.min(h,1-e.selectedBlock.bbox.y));var g={x:e.selectedBlock.bbox.x,y:e.selectedBlock.bbox.y,width:d,height:h},f=(0,r.A)({},e.selectedBlock);f.bbox=g,e.setSelectedBlock(f)}}}}}).draggable({listeners:{move:function(t){var n=t.target.ownerSVGElement;if(n){var o=n.getBoundingClientRect();if(0!==b.width&&0!==b.height){var i=parseFloat(t.target.getAttribute("x")),a=parseFloat(t.target.getAttribute("y")),l=t.delta.x/o.width*b.width,c=a+t.delta.y/o.height*b.height,s=(i+l)/b.width,u=c/b.height;s=Math.max(0,Math.min(s,1-e.selectedBlock.bbox.width)),u=Math.max(0,Math.min(u,1-e.selectedBlock.bbox.height));var d=s*b.width,h=u*b.height;t.target.setAttribute("x","".concat(d)),t.target.setAttribute("y","".concat(h));var g={x:s,y:u,width:e.selectedBlock.bbox.width,height:e.selectedBlock.bbox.height},f=(0,r.A)((0,r.A)({},e.selectedBlock),{},{bbox:g});e.setSelectedBlock(f)}}}}})}),[a,e.selectedBlock,b]);return console.log(e.selectedBlock,"selected block in DocumentViewerScroll"),(0,I.jsx)("div",{ref:t,style:{height:"100%",width:"100%",overflowY:"auto",position:"absolute",top:0,left:0},children:Array.from({length:e.pages},(function(t,n){return(0,I.jsxs)("div",{id:"page-".concat(n),className:"page","data-index":n,style:{marginBottom:30,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",width:"100%",aspectRatio:"1/1"},children:[k&&(0,I.jsx)("div",{style:{display:"flex",justifyContent:"center",width:"100%"},children:(0,I.jsx)(q.A,{})}),(0,I.jsxs)("svg",{children:[e.selectedBlock&&e.selectedBlock.new&&e.page-1===n&&!k&&(0,I.jsx)("rect",{x:e.selectedBlock.bbox.x*b.width,y:e.selectedBlock.bbox.y*b.height,width:e.selectedBlock.bbox.width*b.width,height:e.selectedBlock.bbox.height*b.height,fill:C(e.selectedBlock,a.current),fillOpacity:.3,ref:a}),e.selectedBlock&&e.blocks&&e.page-1===n&&!k&&(0,I.jsx)("rect",{x:e.selectedBlock.bbox.x*b.width,y:e.selectedBlock.bbox.y*b.height,width:e.selectedBlock.bbox.width*b.width,height:e.selectedBlock.bbox.height*b.height,fill:C(e.selectedBlock),fillOpacity:.3,ref:a}),!e.selectedBlock&&e.blocks&&!k&&e.blocks.map((function(t,o){return e.page!==n+1?null:(console.log("Rendering block",t,"on page",n+1),(0,I.jsx)("rect",{x:t.bbox.x*b.width,y:t.bbox.y*b.height,width:t.bbox.width*b.width,height:t.bbox.height*b.height,fill:C(t,t.type),fillOpacity:.3,onClick:function(){var n=(0,r.A)((0,r.A)({},t),{},{index:o});e.setSelectedBlock(n)},style:{cursor:"pointer",stroke:e.selectedBlock&&e.selectedBlock.id===t.id?"black":"none",strokeWidth:e.selectedBlock&&e.selectedBlock.id===t.id?2:0}},o))}))]})]},n)}))})},Z=n(61413),Q=n(79175),$=n(58140),U=(0,C.A)((function(e){return{scrollbar:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"},"& path":{fill:"white"}}}})),K=(0,y.Ay)(d.A)((function(e){var t=e.theme;return{width:62,height:26,padding:8,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(30px)","& .MuiSwitch-thumb:before":{backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24"><path fill="white" d="M2 7h4v10H2V7zm5 12h10V5H7v14zM18 7h4v10h-4V7z"></path></svg>\')'},"& + .MuiSwitch-track":{opacity:1,backgroundColor:(t.palette.mode,t.palette.grey[800])}}},"& .MuiSwitch-thumb":{backgroundColor:(t.palette.mode,t.palette.primary.main),width:23,height:23,"&::before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24"><path fill="white" d="M2 21h19v-3H2v3zM20 8H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zM2 3v3h19V3H2z"></path></svg>\')',backgroundSize:"60%"}},"& .MuiSwitch-track":{opacity:1,backgroundColor:(t.palette.mode,t.palette.grey[800]),borderRadius:10,border:"1px solid "+t.palette.grey[800],height:10}}})),X=function(e){var t=U(),n=(0,i.useState)({}),a=(0,o.A)(n,2),l=a[0],d=a[1],g=(0,i.useState)({}),f=(0,o.A)(g,2),p=f[0],b=f[1],x=(0,V.A)(),m=(0,$.M)().showAlert;(0,i.useEffect)((function(){l[e.subView]||e.slug&&e.subView&&s.DJ(e.slug,e.subView).then((function(t){var n=(0,r.A)({},l);n[e.subView]?n[e.subView]=n[e.subView].concat(t):n[e.subView]=t;var o=(0,r.A)({},p);t.forEach((function(t){o[t.id]=e.block[t.id]})),b(o),d(n)})).catch((function(e){}))}),[e.subView]);var w=function(t,n){var o=(0,r.A)({},p);o[n.id]=t.target.value,b(o);var i=(0,r.A)({},e.block);i[n.id]=t.target.value,e.setSelectedBlock(i)};return(0,I.jsxs)("div",{style:{background:x.palette.grey[700],borderRadius:5,marginTop:5},children:[(0,I.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[(0,I.jsxs)("div",{children:[(0,I.jsx)(h.A,{label:"Guardar",size:"small",onClick:function(){!function(){var t={data:p,id_doc:e.recordId,type_block:e.subView,index:e.block.index,page:e.page,slug:e.slug,bbox:e.block.bbox};if(e.slug&&e.subView)e.block.new?c.Rm(t).then((function(t){e.setSelectedBlock(null)})).catch((function(e){console.error(e),m("error","Error al guardar el bloque")})):c.ao(t).then((function(t){e.setSelectedBlock(null)})).catch((function(e){console.error(e),m("error","Error al actualizar el bloque")}));else if(e.block.new){var n={x:e.block.bbox.x,y:e.block.bbox.y,width:e.block.bbox.width,height:e.block.bbox.height};u.vt({type:"document",record_id:e.recordId,data:{bbox:n,page:e.page}}).then((function(t){e.setSelectedBlock(null),m("success","Recorte creado correctamente")}))}}()},icon:(0,I.jsx)(_.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close}),!e.block.new&&(0,I.jsx)(h.A,{label:"Eliminar",size:"small",onClick:function(){!function(){var t={id_doc:e.recordId,type_block:e.subView,index:e.block.index,page:e.page,slug:e.slug};c.S7(t).then((function(t){e.setSelectedBlock(null)}))}()},icon:(0,I.jsx)(P.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close})]}),(0,I.jsx)(h.A,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:(0,I.jsx)(k.A,{}),style:{margin:3,width:24,height:24,border:"none"},className:t.close})]}),l[e.subView]&&l[e.subView].map((function(t,n){return(0,I.jsxs)("div",{children:["text"===t.type&&(0,I.jsx)(R.BR,{name:t.id,value:p[t.id],handleChange:function(e){return w(e,t)},style:{width:"100%",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"}}),"text-area"===t.type&&(0,I.jsx)(R.QA,{name:t.id,value:p[t.id],handleChange:function(e){return w(e,t)},style:{width:"350px",height:"400px",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"},rootStyle:{width:"100%",margin:"0px",padding:"5px"}}),"select"===t.type&&(0,I.jsx)(R.Q5,{name:t.label,id:t.id,value:p[t.id],options:e.labels.map((function(e){return{value:e,label:e}})),handleChange:function(e){return w(e,t)},style:{width:"100%",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"},rootStyle:{width:"100%",margin:"0px",padding:"5px"}})]},n)}))]})},Y=function(e){var t,n,s,u=(0,i.useState)(0),d=(0,o.A)(u,2),k=d[0],y=d[1],C=(0,i.useState)(0),S=(0,o.A)(C,2),B=S[0],M=S[1],E=(0,i.useState)(1),T=(0,o.A)(E,2),_=T[0],P=T[1],O=(0,i.useState)([]),L=(0,o.A)(O,2),N=L[0],J=L[1],G=(0,i.useState)([]),q=(0,o.A)(G,2),$=q[0],U=q[1],Y=(0,i.useState)(null),ee=(0,o.A)(Y,2),te=ee[0],ne=ee[1],re=(0,i.useRef)(null),oe=(0,i.useRef)(null),ie=(0,i.useState)(!1),ae=(0,o.A)(ie,2),le=ae[0],ce=ae[1],se=(0,D.M)("docViewType","carrousel"),ue=(0,o.A)(se,2),de=ue[0],he=ue[1],ge=(0,i.useState)("document"),fe=(0,o.A)(ge,2),pe=fe[0],be=fe[1],xe=(0,V.A)(),me=(0,i.useState)("documentView"),we=(0,o.A)(me,2),ke=we[0],ye=we[1],ve=(0,a.d4)((function(e){return e.app.adjustements})),Ae=(0,a.wA)(),je=function(e){return(0,I.jsxs)(g.A,{style:{display:"flex",width:"calc(100% - 0px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",backgroundColor:"dark"===e.variant?xe.palette.grey[900]:"white",borderRadius:"50px"},children:[(0,I.jsx)(f.A,{color:"primary",onClick:function(){Be(_-1)},children:(0,I.jsx)(m.A,{})}),(0,I.jsx)(R.Z6,{name:null,value:_,handleChange:function(e){Be(parseInt(e.target.value))},min:1,max:k,style:{width:"100px",padding:"0px",backgroundColor:"dark"===e.variant?xe.palette.grey[700]:"white",marginRight:"10px",borderBottom:"none"}}),(0,I.jsx)(p.Ay,{ref:oe,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:_,step:1,marks:!0,min:1,max:k,style:{width:"80%"},onChangeCommitted:function(e,t){Be(t)}}),(0,I.jsx)(f.A,{color:"primary",onClick:function(){Be(_+1)},children:(0,I.jsx)(w.A,{})})]})},Ce=function(t){"carrousel"===de?(0,x.vs)():"scroll"===de&&(y(k),M(B),(0,x.Ts)(k,re.current,B,e.id,_),(0,x.Zv)(P),te&&((0,x.D8)(te),(0,x.P4)(N,_,B,ne)),(0,x.i0)()),he(t)};(0,i.useEffect)((function(){return c.wp(e.id).then((function(t){y(t.pages),M(1),"carrousel"===de&&((0,x.Ts)(t.pages,re.current,1,e.id),(0,x.Zv)(P),(0,x.i0)())})),Ae((0,l.n_)({contrast:1,brightness:1,saturation:1,invert:0,rotation:0})),function(){"carrousel"===de&&(0,x.vs)()}}),[]);var Se=function(t){"blocks"===pe?c.FZ(e.id,t,e.view.slug,pe).then((function(e){J(e.blocks),U(e.labels),ce(!0)})):"words"===pe?c.FZ(e.id,t,e.view.slug,pe).then((function(e){J(e.words),U(e.labels),ce(!0)})):(J([]),le&&"carrousel"===de&&(0,x.a7)(t))};(0,i.useEffect)((function(){ve&&(0,x.RI)(ve)}),[ve]),(0,i.useEffect)((function(){null===te?("carrousel"===de&&(0,x.D8)(null),le&&"carrousel"===de&&(0,x.a7)(_),Se(_)):(le&&"carrousel"===de&&(0,x.a7)(_),"carrousel"===de&&(0,x.D8)(te),"carrousel"===de&&(0,x.P4)(N,_,B,ne))}),[te]),(0,i.useEffect)((function(){Se(_),ne(null)}),[pe,_]),(0,i.useEffect)((function(){(0,x.kx)(e.view.slug)}),[e.view]),(0,i.useEffect)((function(){N&&N.length>0&&"carrousel"===de&&(0,x.P4)(N,_,B,Re)}),[N]);var Be=function(t){t>k&&(t=k),t<1&&(t=1),"carrousel"===de&&(0,x.qV)(t,B,e.id),P(t)},Re=function(e,t){var n=(0,r.A)({},e);n.index=t,ne(n),"carrousel"===de&&((0,x.a7)(_),(0,x.D8)(n),(0,x.P4)(N,_,B,ne))};return(0,i.useEffect)((function(){var t=(0,r.A)({},ve);t.rotation=0,Ae((0,l.n_)(t)),e.setOpts({page:_})}),[_]),(0,I.jsxs)(A.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(e,t){ye(e.id)},children:[(0,I.jsx)(g.A,{ref:re,style:{position:"absolute",width:"100%",height:"100%",cursor:"move"}}),"scroll"===de&&(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(W,{pages:k,aspectRatio:B,page:_,id:e.id,setPage:P,selectedBlock:te,setSelectedBlock:ne,setBlocks:J,blocks:N})}),(0,I.jsx)(v.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none",zIndex:"metadata"===ke?1:0},children:(0,I.jsx)(j.A,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})}),(0,I.jsxs)(v.V,{id:"processing",initialPosition:{x:0,y:0},style:{borderRadius:5,boxShadow:"none",zIndex:"processing"===ke?1:0},children:["viz"===e.view&&(0,I.jsxs)("div",{style:{padding:"5px",background:xe.palette.grey[700],borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,I.jsx)(je,{variant:"dark"}),(0,I.jsxs)(H.A,{children:[(0,I.jsx)(h.A,{label:"Agregar un recorte",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:$[0]?$[0]:"default",new:!0}),ce(!0)},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,I.jsx)(g.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,I.jsx)(Q.A,{})}),variant:"outlined"}),(0,I.jsx)(b.A,{disableGutters:!0,variant:"dense",style:{minHeight:"auto"},children:(0,I.jsx)(K,{size:"small",checked:"carrousel"===de,onChange:function(e){return Ce(e.target.checked?"carrousel":"scroll")},color:"primary"})})]})]}),"lt_extraction"===(null===(t=e.view)||void 0===t?void 0:t.view)&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(z,{setTabView:be,view:e.view,setSelectedBlock:ne}),(0,I.jsxs)("div",{style:{padding:"5px",background:xe.palette.grey[700],borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,I.jsx)(je,{variant:"dark"}),(0,I.jsxs)(H.A,{children:[!e.subView.split(",").includes("blocks")&&!e.subView.split(",").includes("words")&&null===te&&(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(h.A,{label:"Agregar un recorte",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:$[0]?$[0]:"default",new:!0})},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,I.jsx)(g.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,I.jsx)(Q.A,{})}),variant:"outlined"})}),e.subView.split(",").includes("blocks")&&null===te&&(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(h.A,{label:"Agregar un nuevo bloque",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:$[0],new:!0})},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,I.jsx)(g.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,I.jsx)(F.A,{})}),variant:"outlined"})}),"words"===e.subView&&null===te&&(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(h.A,{label:"Agregar una palabra",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:$[0],new:!0})},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,I.jsx)(g.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,I.jsx)(F.A,{})}),variant:"outlined"})}),(0,I.jsx)(b.A,{disableGutters:!0,variant:"dense",style:{minHeight:"auto"},children:(0,I.jsx)(K,{size:"small",checked:"carrousel"===de,onChange:function(e){return Ce(e.target.checked?"carrousel":"scroll")},color:"primary"})})]})]})]}),"ner_extraction"===(null===(n=e.view)||void 0===n?void 0:n.view)&&(0,I.jsx)(z,{setTabView:be,view:e.view,setSelectedBlock:ne,id:e.match.params.id}),"docseg_extraction"===(null===(s=e.view)||void 0===s?void 0:s.view)&&(0,I.jsx)(z,{setTabView:be,view:e.view,setSelectedBlock:ne,id:e.match.params.id}),te&&(0,I.jsx)(X,{block:te,labels:$,subView:e.subView,setSelectedBlock:ne,slug:e.view.slug,recordId:e.id,page:_})]}),(0,I.jsx)(v.V,{id:"aiasistent_msgs",initialPosition:{x:0,y:0},style:{display:e.subView.split(",").includes("aiasistent_msgs")?"block":"none",zIndex:"aiasistent_msgs"===ke?1:0},children:e.subView.split(",").includes("aiasistent_msgs")&&(0,I.jsx)(Z.A,{id:e.id,slug:e.slug,type:"document",opts:e.opts})})]})}},82094:function(e,t,n){var r=n(89379),o=n(5544),i=n(65043),a=n(83003),l=n(86279),c=n(11238),s=n(99562),u=n(26240),d=n(58140),h=n(43288),g=n(72378),f=n(99246),p=n(70579);t.A=function(e){var t=(0,i.useState)(null),n=(0,o.A)(t,2),b=n[0],x=n[1],m=(0,i.useState)(!0),w=(0,o.A)(m,2),k=w[0],y=w[1],v=(0,u.A)(),A=(0,d.M)().showAlert,j=(0,a.d4)((function(e){return e.user})),C=(0,a.d4)((function(e){return e.app.isDarkMode})),S=(0,f.A)();return(0,i.useEffect)((function(){e.record?l.Tk(e.id).then((function(e){y(!1),x(e)})).catch((function(e){y(!1),x(null)})):l.Qs(e.id).then((function(e){y(!1),x(e)})).catch((function(e){y(!1),x(null)}))}),[]),(0,i.useEffect)((function(){}),[j,b]),(0,p.jsxs)(p.Fragment,{children:[k&&(0,p.jsx)(h.A,{}),!b&&!k&&j.roles.includes("team_lead")&&(0,p.jsx)(c.nA,{style:{borderRadius:5},customColor:{background:C?v.palette.grey[800]:v.palette.grey[200],color:C?v.palette.primary.light:v.palette.primary.main},startIcon:(0,p.jsx)(s.A,{}),onClick:function(){A("taskForm","create").then((function(t){if(t){y(!0),x(null);var n=(0,r.A)({},t);e.record?n.recordId=e.id:n.resourceId=e.id,l.UT(JSON.stringify(n)).then((function(e){y(!1),x(e)})).catch((function(e){console.log(e)}))}}))},label:S.formatMessage({id:"usertask.create"})}),b&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(c.nA,{style:{borderRadius:5},customColor:{background:v.palette.grey[200],color:v.palette.primary.main},startIcon:(0,p.jsx)(s.A,{}),label:"".concat(S.formatMessage({id:"usertask.asignedTo"})," ").concat(b.user)}),(0,p.jsx)(g.WB,{children:(0,p.jsx)("div",{dangerouslySetInnerHTML:{__html:b.comment.replace(/\n/g,"<br />")}})}),("pending"===b.status||"rejected"===b.status)&&b.user===j.name&&(0,p.jsx)(c.nA,{style:{marginTop:10,borderRadius:5},customColor:{background:v.palette.grey[200],color:v.palette.grey[600]},onClick:function(){A("taskForm","update").then((function(e){e?(y(!0),x(null),l.lC(b._id,JSON.stringify((0,r.A)((0,r.A)({},e),{},{status:"review"}))).then((function(e){y(!1),x(e)})).catch((function(e){console.log(e)}))):y(!1)}))},label:S.formatMessage({id:"usertask.sendToReview"})}),"review"===b.status&&j.roles.includes("team_lead")&&(0,p.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:10,width:"100%"},children:[(0,p.jsx)(c.nA,{style:{borderRadius:5,margin:2},customColor:{background:v.palette.grey[200],color:v.palette.grey[600]},onClick:function(){A("taskForm","update").then((function(e){e&&(y(!0),x(null),l.lC(b._id,JSON.stringify((0,r.A)((0,r.A)({},e),{},{status:"rejected"}))).then((function(e){y(!1),x(e)})).catch((function(e){console.log(e)})))}))},label:S.formatMessage({id:"usertask.reject"})}),(0,p.jsx)(c.nA,{style:{borderRadius:5,margin:2},customColor:{background:v.palette.grey[200],color:v.palette.grey[600]},onClick:function(){A("taskForm","update").then((function(e){e&&(y(!0),x(null),l.lC(b._id,JSON.stringify((0,r.A)((0,r.A)({},e),{},{status:"approved"}))).then((function(e){y(!1),x(null)})).catch((function(e){y(!1),x(null)})))}))},label:S.formatMessage({id:"usertask.approve"})})]})]})]})}},92392:function(e,t,n){var r=n(5544),o=n(65043),i=n(9920),a=n(96446),l=n(90151),c=n(4319),s=n(6512),u=n(76370),d=(n(24394),n(70579));t.A=function(e){var t=(0,o.useState)(0),n=(0,r.A)(t,2),h=(n[0],n[1]),g=(0,o.useState)(0),f=(0,r.A)(g,2),p=(f[0],f[1]),b=(0,o.useState)(1),x=(0,r.A)(b,2),m=(x[0],x[1]),w=(0,o.useRef)(null);(0,o.useRef)(null);(0,o.useEffect)((function(){return i.wp(e.id).then((function(t){h(t.pages),p(t.aspect_ratio),(0,l.Ts)(t.pages,w.current,t.aspect_ratio,e.id),(0,l.Zv)(m),(0,l.i0)()})),function(){(0,l.vs)()}}),[]);return(0,d.jsxs)(c.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")},children:[(0,d.jsx)(a.A,{ref:w,style:{position:"absolute",width:"100%",height:"100%"}}),(0,d.jsx)(s.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"},children:(0,d.jsx)(u.A,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})})]})}},97223:function(e,t,n){n.d(t,{De:function(){return c},Jb:function(){return u},QL:function(){return h},SM:function(){return s},UK:function(){return i},Z3:function(){return a},kP:function(){return d},v5:function(){return l}});var r=n(88120),o=n(91280);function i(){var e={method:"GET",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch((0,r.H6)()+"/llms",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function a(){var e={method:"GET",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch((0,r.H6)()+"/llms/providers",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function l(e){var t={method:"POST",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,r.H6)()+"/llms",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function c(e){var t="/llms/"+e,n={method:"DELETE",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch((0,r.H6)()+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function s(e){var t="/llms/models/"+e,n={method:"GET",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch((0,r.H6)()+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function u(e){var t={method:"POST",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,r.H6)()+"/llms/conversation",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function d(e){var t={method:"POST",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,r.H6)()+"/llms/conversation/history",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function h(e){var t="/llms/conversation/"+e,n={method:"GET",headers:new Headers({Authorization:(0,o.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch((0,r.H6)()+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}}}]);
//# sourceMappingURL=1287.8239c55a.chunk.js.map