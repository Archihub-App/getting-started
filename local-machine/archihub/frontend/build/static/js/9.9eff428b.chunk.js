/*! For license information please see 9.9eff428b.chunk.js.LICENSE.txt */
(this.webpackJsonpsim=this.webpackJsonpsim||[]).push([[9,1,12,21],{1014:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(202),a=n(18),i=n(35),o=n(2),s=n.n(o),l=n(965),c=n(947),u=n(956),d=n(999),h=n(843),f=n(926),p=Object(h.a)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"}}})),m=function(e){p();var t=Object(o.useState)(null),n=Object(i.a)(t,2),h=(n[0],n[1]),m=Object(o.useState)(null),v=Object(i.a)(m,2),g=v[0],y=v[1],b=Object(o.useState)([]),_=Object(i.a)(b,2),x=_[0],E=_[1],S=Object(o.useState)({}),M=Object(i.a)(S,2),T=M[0],w=M[1],O=Object(o.useState)(0),A=Object(i.a)(O,2),R=A[0],C=A[1],k=Object(o.useState)([]),P=Object(i.a)(k,2),L=(P[0],P[1],Object(o.useState)("")),I=Object(i.a)(L,2),N=I[0],D=I[1];Object(o.useEffect)((function(){e.selectedResource&&U("parents",{id:e.selectedResource._id})}),[]),Object(o.useEffect)((function(){e.type.parentsTypes?e.type.parentsTypes.length>0?h("multiple"):e.type.hierarchical?h("tree"):h("single"):h(null)}),[e.selectedType]),Object(o.useEffect)((function(){e.setSelected&&g?e.setSelected(g.id):e.setSelected&&e.setSelected(null)}),[g]),Object(o.useEffect)((function(){U("keyword",N)}),[N]),Object(o.useEffect)((function(){y(null)}),[e.selectedType]);var U=function(e,t){if(t){var n=Object(a.a)({},T);n[e]=t,w(n)}else{var r=Object(a.a)({},T);delete r[e],w(r)}};return s.a.createElement(l.BloqueContenido,{style:{width:"calc(100% - 400px)",height:"calc(100% - 50px)",overflowX:"hidden"},topBar:s.a.createElement(c.a,{total:R,onSearchSubmit:function(e){D(e)}}),title:"Recursos"},s.a.createElement(f.a,{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",width:"100%",height:"100%"}},s.a.createElement(f.a,{style:{width:270}},s.a.createElement(d.TreeViewColumnContainer,{slug:e.type.slug,selectedResource:e.selectedResource?e.selectedResource:null,setFondo:function(e,t){g&&t?g.id===e.id?(y(null),E([]),U("parents",null)):(y(e),E([].concat(Object(r.a)(t),[e])),U("parents",e)):t?(y(e),E([].concat(Object(r.a)(t),[e])),U("parents",e)):g&&g.id===e.id?(y(null),E([]),U("parents",null)):(y(e),E([e]),U("parents",e))},selected:g?[g]:[],path:x})),s.a.createElement(f.a,{style:{width:"calc(100% - 120px)",height:"100%"}},s.a.createElement(u.a,{selectedType:e.type,records:null,filters:T,handleClick:function(t){e.history.push("/detail/".concat(t.id))},parent:e.selectedResource,parentTotal:C,viewDrafts:!1,offsetOrigin:{x:-250,y:-157}}))))}},1017:function(e,t,n){"use strict";n.d(t,"g",(function(){return go})),n.d(t,"h",(function(){return yo})),n.d(t,"i",(function(){return bo})),n.d(t,"f",(function(){return Eo})),n.d(t,"d",(function(){return So})),n.d(t,"c",(function(){return Mo})),n.d(t,"b",(function(){return Oo})),n.d(t,"e",(function(){return Ao})),n.d(t,"a",(function(){return ko})),n.d(t,"j",(function(){return Po}));var r=n(18),a=n(1085),i=(n(202),n(239)),o=n(968),s=n(35),l=n(141);function c(e,t,n){return(c="undefined"!==typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=Object(l.a)(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(n):a.value}})(e,t,n||e)}var u=n(211),d=n(208),h=n(210),f=n(16),p=n(139),m=n(140);function v(e,t,n){return t=Object(l.a)(t),Object(u.a)(e,Object(d.a)()?Reflect.construct(t,n||[],Object(l.a)(e).constructor):t.apply(e,n))}function g(){g=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof v?t:v,o=Object.create(i.prototype),s=new C(r||[]);return a(o,"_invoke",{value:w(e,n,s)}),o}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}t.wrap=u;var h="suspendedStart",f="executing",p="completed",m={};function v(){}function y(){}function b(){}var _={};c(_,o,(function(){return this}));var x=Object.getPrototypeOf,E=x&&x(x(k([])));E&&E!==n&&r.call(E,o)&&(_=E);var S=b.prototype=v.prototype=Object.create(_);function M(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(a,i,o,s){var l=d(e[a],e,i);if("throw"!==l.type){var c=l.arg,u=c.value;return u&&"object"==typeof u&&r.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(l.arg)}var i;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return i=i?i.then(a,a):a()}})}function w(t,n,r){var a=h;return function(i,o){if(a===f)throw Error("Generator is already running");if(a===p){if("throw"===i)throw o;return{value:e,done:!0}}for(r.method=i,r.arg=o;;){var s=r.delegate;if(s){var l=O(s,r);if(l){if(l===m)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===h)throw a=p,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=f;var c=d(t,n,r);if("normal"===c.type){if(a=r.done?p:"suspendedYield",c.arg===m)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(a=p,r.method="throw",r.arg=c.arg)}}}function O(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,O(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var i=d(a,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,m;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function A(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function R(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(A,this),this.reset(!0)}function k(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,i=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=b,a(S,"constructor",{value:b,configurable:!0}),a(b,"constructor",{value:y,configurable:!0}),y.displayName=c(b,l,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,b):(e.__proto__=b,c(e,l,"GeneratorFunction")),e.prototype=Object.create(S),e},t.awrap=function(e){return{__await:e}},M(T.prototype),c(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,r,a,i){void 0===i&&(i=Promise);var o=new T(u(e,n,r,a),i);return t.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},M(S),c(S,l,"Generator"),c(S,o,(function(){return this})),c(S,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=k,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(R),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return s.type="throw",s.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return a("end");if(o.tryLoc<=this.prev){var l=r.call(o,"catchLoc"),c=r.call(o,"finallyLoc");if(l&&c){if(this.prev<o.catchLoc)return a(o.catchLoc,!0);if(this.prev<o.finallyLoc)return a(o.finallyLoc)}else if(l){if(this.prev<o.catchLoc)return a(o.catchLoc,!0)}else{if(!c)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return a(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var i=a;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),R(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;R(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:k(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}var y=0,b=1,_=2,x=0,E=1,S=2,M=3,T=function(){return Object(m.a)((function e(){Object(p.a)(this,e)}),[{key:"addEventListener",value:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)}},{key:"hasEventListener",value:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)}},{key:"removeEventListener",value:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}}},{key:"dispatchEvent",value:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),r=0,a=n.length;r<a;r++)n[r].call(this,e);e.target=null}}}}])}(),w=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],O=Math.PI/180,A=180/Math.PI;function R(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(w[255&e]+w[e>>8&255]+w[e>>16&255]+w[e>>24&255]+"-"+w[255&t]+w[t>>8&255]+"-"+w[t>>16&15|64]+w[t>>24&255]+"-"+w[63&n|128]+w[n>>8&255]+"-"+w[n>>16&255]+w[n>>24&255]+w[255&r]+w[r>>8&255]+w[r>>16&255]+w[r>>24&255]).toLowerCase()}function C(e,t,n){return Math.max(t,Math.min(n,e))}function k(e,t){return(e%t+t)%t}function P(e,t,n){return(1-n)*e+n*t}function L(e){return 0===(e&e-1)&&0!==e}function I(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))}function N(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function D(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw new Error("Invalid component type.")}}var U=O,j=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(p.a)(this,e),e.prototype.isVector2=!0,this.x=t,this.y=n}),[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(C(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=this.x-e.x,i=this.y-e.y;return this.x=a*n-i*r+e.x,this.y=a*r+i*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}},{key:Symbol.iterator,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:case"end":return e.stop()}}),e,this)}))}])}(),F=function(){return Object(m.a)((function e(t,n,r,a,i,o,s,l,c){Object(p.a)(this,e),e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==t&&this.set(t,n,r,a,i,o,s,l,c)}),[{key:"set",value:function(e,t,n,r,a,i,o,s,l){var c=this.elements;return c[0]=e,c[1]=r,c[2]=o,c[3]=t,c[4]=a,c[5]=s,c[6]=n,c[7]=i,c[8]=l,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,a=this.elements,i=n[0],o=n[3],s=n[6],l=n[1],c=n[4],u=n[7],d=n[2],h=n[5],f=n[8],p=r[0],m=r[3],v=r[6],g=r[1],y=r[4],b=r[7],_=r[2],x=r[5],E=r[8];return a[0]=i*p+o*g+s*_,a[3]=i*m+o*y+s*x,a[6]=i*v+o*b+s*E,a[1]=l*p+c*g+u*_,a[4]=l*m+c*y+u*x,a[7]=l*v+c*b+u*E,a[2]=d*p+h*g+f*_,a[5]=d*m+h*y+f*x,a[8]=d*v+h*b+f*E,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[3]*=e,t[6]*=e,t[1]*=e,t[4]*=e,t[7]*=e,t[2]*=e,t[5]*=e,t[8]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],c=e[8];return t*i*c-t*o*l-n*a*c+n*o*s+r*a*l-r*i*s}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=c*i-o*l,d=o*s-c*a,h=l*a-i*s,f=t*u+n*d+r*h;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);var p=1/f;return e[0]=u*p,e[1]=(r*l-c*n)*p,e[2]=(o*n-r*i)*p,e[3]=d*p,e[4]=(c*t-r*s)*p,e[5]=(r*a-o*t)*p,e[6]=h*p,e[7]=(n*s-l*t)*p,e[8]=(i*t-n*a)*p,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,a,i,o){var s=Math.cos(a),l=Math.sin(a);return this.set(n*s,n*l,-n*(s*i+l*o)+i+e,-r*l,r*s,-r*(-l*i+s*o)+o+t,0,0,1),this}},{key:"scale",value:function(e,t){return this.premultiply(z.makeScale(e,t)),this}},{key:"rotate",value:function(e){return this.premultiply(z.makeRotation(-e)),this}},{key:"translate",value:function(e,t){return this.premultiply(z.makeTranslation(e,t)),this}},{key:"makeTranslation",value:function(e,t){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,t,0,0,1),this}},{key:"makeRotation",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,n,t,0,0,0,1),this}},{key:"makeScale",value:function(e,t){return this.set(e,0,0,0,t,0,0,0,1),this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}])}(),z=new F;function B(e){for(var t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;function H(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}var V={};function G(e){e in V||(V[e]=!0,console.warn(e))}function W(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function X(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var q=(new F).fromArray([.8224621,.0331941,.0170827,.177538,.9668058,.0723974,-1e-7,1e-7,.9105199]),Y=(new F).fromArray([1.2249401,-.0420569,-.0196376,-.2249404,1.0420571,-.0786361,1e-7,0,1.0982735]);var K,Z=Object(f.a)(Object(f.a)(Object(f.a)({},"srgb-linear",(function(e){return e})),"srgb",(function(e){return e.convertSRGBToLinear()})),"display-p3",(function(e){return e.convertSRGBToLinear().applyMatrix3(Y)})),J=Object(f.a)(Object(f.a)(Object(f.a)({},"srgb-linear",(function(e){return e})),"srgb",(function(e){return e.convertLinearToSRGB()})),"display-p3",(function(e){return e.applyMatrix3(q).convertLinearToSRGB()})),Q={enabled:!0,get legacyMode(){return console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),!this.enabled},set legacyMode(e){console.warn("THREE.ColorManagement: .legacyMode=false renamed to .enabled=true in r150."),this.enabled=!e},get workingColorSpace(){return"srgb-linear"},set workingColorSpace(e){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(e,t,n){if(!1===this.enabled||t===n||!t||!n)return e;var r=Z[t],a=J[n];if(void 0===r||void 0===a)throw new Error('Unsupported color space conversion, "'.concat(t,'" to "').concat(n,'".'));return a(r(e))},fromWorkingColorSpace:function(e,t){return this.convert(e,this.workingColorSpace,t)},toWorkingColorSpace:function(e,t){return this.convert(e,t,this.workingColorSpace)}},$=function(){return Object(m.a)((function e(){Object(p.a)(this,e)}),null,[{key:"getDataURL",value:function(e){if(/^data:/i.test(e.src))return e.src;if("undefined"===typeof HTMLCanvasElement)return e.src;var t;if(e instanceof HTMLCanvasElement)t=e;else{void 0===K&&(K=H("canvas")),K.width=e.width,K.height=e.height;var n=K.getContext("2d");e instanceof ImageData?n.putImageData(e,0,0):n.drawImage(e,0,0,e.width,e.height),t=K}return t.width>2048||t.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),t.toDataURL("image/jpeg",.6)):t.toDataURL("image/png")}},{key:"sRGBToLinear",value:function(e){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var t=H("canvas");t.width=e.width,t.height=e.height;var n=t.getContext("2d");n.drawImage(e,0,0,e.width,e.height);for(var r=n.getImageData(0,0,e.width,e.height),a=r.data,i=0;i<a.length;i++)a[i]=255*W(a[i]/255);return n.putImageData(r,0,0),t}if(e.data){for(var o=e.data.slice(0),s=0;s<o.length;s++)o instanceof Uint8Array||o instanceof Uint8ClampedArray?o[s]=Math.floor(255*W(o[s]/255)):o[s]=W(o[s]);return{data:o,width:e.width,height:e.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e}}])}(),ee=0,te=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Object(p.a)(this,e),this.isSource=!0,Object.defineProperty(this,"id",{value:ee++}),this.uuid=R(),this.data=t,this.version=0}),[{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.images[this.uuid])return e.images[this.uuid];var n={uuid:this.uuid,url:""},r=this.data;if(null!==r){var a;if(Array.isArray(r)){a=[];for(var i=0,o=r.length;i<o;i++)r[i].isDataTexture?a.push(ne(r[i].image)):a.push(ne(r[i]))}else a=ne(r);n.url=a}return t||(e.images[this.uuid]=n),n}}])}();function ne(e){return"undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap?$.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var re=0,ae=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:t.DEFAULT_IMAGE,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t.DEFAULT_MAPPING,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1001,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1001,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1006,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1008,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1023,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:1009,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:t.DEFAULT_ANISOTROPY,d=arguments.length>9&&void 0!==arguments[9]?arguments[9]:"";return Object(p.a)(this,t),(e=v(this,t)).isTexture=!0,Object.defineProperty(e,"id",{value:re++}),e.uuid=R(),e.name="",e.source=new te(n),e.mipmaps=[],e.mapping=r,e.channel=0,e.wrapS=a,e.wrapT=i,e.magFilter=o,e.minFilter=s,e.anisotropy=u,e.format=l,e.internalFormat=null,e.type=c,e.offset=new j(0,0),e.repeat=new j(1,1),e.center=new j(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new F,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,"string"===typeof d?e.colorSpace=d:(G("THREE.Texture: Property .encoding has been replaced by .colorSpace."),e.colorSpace=3001===d?"srgb":""),e.userData={},e.version=0,e.onUpdate=null,e.isRenderTargetTexture=!1,e.needsPMREMUpdate=!1,e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"image",get:function(){return this.source.data},set:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;this.source.data=e}},{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;if(!t&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];var n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),t||(e.textures[this.uuid]=n),n}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}},{key:"encoding",get:function(){return G("THREE.Texture: Property .encoding has been replaced by .colorSpace."),"srgb"===this.colorSpace?3001:3e3},set:function(e){G("THREE.Texture: Property .encoding has been replaced by .colorSpace."),this.colorSpace=3001===e?"srgb":""}}])}(T);ae.DEFAULT_IMAGE=null,ae.DEFAULT_MAPPING=300,ae.DEFAULT_ANISOTROPY=1;var ie=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(p.a)(this,e),e.prototype.isVector4=!0,this.x=t,this.y=n,this.z=r,this.w=a}),[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this.w=e.w+t.w,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this.w+=e.w*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this.w=e.w-t.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,a=this.w,i=e.elements;return this.x=i[0]*t+i[4]*n+i[8]*r+i[12]*a,this.y=i[1]*t+i[5]*n+i[9]*r+i[13]*a,this.z=i[2]*t+i[6]*n+i[10]*r+i[14]*a,this.w=i[3]*t+i[7]*n+i[11]*r+i[15]*a,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(e){this.w=2*Math.acos(e.w);var t=Math.sqrt(1-e.w*e.w);return t<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/t,this.y=e.y/t,this.z=e.z/t),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,a,i=e.elements,o=i[0],s=i[4],l=i[8],c=i[1],u=i[5],d=i[9],h=i[2],f=i[6],p=i[10];if(Math.abs(s-c)<.01&&Math.abs(l-h)<.01&&Math.abs(d-f)<.01){if(Math.abs(s+c)<.1&&Math.abs(l+h)<.1&&Math.abs(d+f)<.1&&Math.abs(o+u+p-3)<.1)return this.set(1,0,0,0),this;t=Math.PI;var m=(o+1)/2,v=(u+1)/2,g=(p+1)/2,y=(s+c)/4,b=(l+h)/4,_=(d+f)/4;return m>v&&m>g?m<.01?(n=0,r=.707106781,a=.707106781):(r=y/(n=Math.sqrt(m)),a=b/n):v>g?v<.01?(n=.707106781,r=0,a=.707106781):(n=y/(r=Math.sqrt(v)),a=_/r):g<.01?(n=.707106781,r=.707106781,a=0):(n=b/(a=Math.sqrt(g)),r=_/a),this.set(n,r,a,t),this}var x=Math.sqrt((f-d)*(f-d)+(l-h)*(l-h)+(c-s)*(c-s));return Math.abs(x)<.001&&(x=1),this.x=(f-d)/x,this.y=(l-h)/x,this.z=(c-s)/x,this.w=Math.acos((o+u+p-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}},{key:Symbol.iterator,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:return e.next=8,this.w;case 8:case"end":return e.stop()}}),e,this)}))}])}(),oe=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return Object(p.a)(this,t),(e=v(this,t,[n,r,a])).isWebGLRenderTarget=!0,e}return Object(h.a)(t,e),Object(m.a)(t)}(function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};Object(p.a)(this,t),(e=v(this,t)).isRenderTarget=!0,e.width=n,e.height=r,e.depth=1,e.scissor=new ie(0,0,n,r),e.scissorTest=!1,e.viewport=new ie(0,0,n,r);var i={width:n,height:r,depth:1};return void 0!==a.encoding&&(G("THREE.WebGLRenderTarget: option.encoding has been replaced by option.colorSpace."),a.colorSpace=3001===a.encoding?"srgb":""),e.texture=new ae(i,a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.colorSpace),e.texture.isRenderTargetTexture=!0,e.texture.flipY=!1,e.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,e.texture.internalFormat=void 0!==a.internalFormat?a.internalFormat:null,e.texture.minFilter=void 0!==a.minFilter?a.minFilter:1006,e.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,e.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,e.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,e.samples=void 0!==a.samples?a.samples:0,e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.width=e.width,this.height=e.height,this.depth=e.depth,this.scissor.copy(e.scissor),this.scissorTest=e.scissorTest,this.viewport.copy(e.viewport),this.texture=e.texture.clone(),this.texture.isRenderTargetTexture=!0;var t=Object.assign({},e.texture.image);return this.texture.source=new te(t),this.depthBuffer=e.depthBuffer,this.stencilBuffer=e.stencilBuffer,null!==e.depthTexture&&(this.depthTexture=e.depthTexture.clone()),this.samples=e.samples,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}])}(T)),se=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(p.a)(this,t),(e=v(this,t,[null])).isDataArrayTexture=!0,e.image={data:n,width:r,height:a,depth:i},e.magFilter=1003,e.minFilter=1003,e.wrapR=1001,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return Object(h.a)(t,e),Object(m.a)(t)}(ae),le=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(p.a)(this,t),(e=v(this,t,[null])).isData3DTexture=!0,e.image={data:n,width:r,height:a,depth:i},e.magFilter=1003,e.minFilter=1003,e.wrapR=1001,e.generateMipmaps=!1,e.flipY=!1,e.unpackAlignment=1,e}return Object(h.a)(t,e),Object(m.a)(t)}(ae),ce=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(p.a)(this,e),this.isQuaternion=!0,this._x=t,this._y=n,this._z=r,this._w=a}),[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){var n=e._x,r=e._y,a=e._z,i=e._order,o=Math.cos,s=Math.sin,l=o(n/2),c=o(r/2),u=o(a/2),d=s(n/2),h=s(r/2),f=s(a/2);switch(i){case"XYZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"YXZ":this._x=d*c*u+l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"ZXY":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u-d*h*f;break;case"ZYX":this._x=d*c*u-l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u+d*h*f;break;case"YZX":this._x=d*c*u+l*h*f,this._y=l*h*u+d*c*f,this._z=l*c*f-d*h*u,this._w=l*c*u-d*h*f;break;case"XZY":this._x=d*c*u-l*h*f,this._y=l*h*u-d*c*f,this._z=l*c*f+d*h*u,this._w=l*c*u+d*h*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+i)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,r=Math.sin(n);return this._x=e.x*r,this._y=e.y*r,this._z=e.z*r,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],a=t[8],i=t[1],o=t[5],s=t[9],l=t[2],c=t[6],u=t[10],d=n+o+u;if(d>0){var h=.5/Math.sqrt(d+1);this._w=.25/h,this._x=(c-s)*h,this._y=(a-l)*h,this._z=(i-r)*h}else if(n>o&&n>u){var f=2*Math.sqrt(1+n-o-u);this._w=(c-s)/f,this._x=.25*f,this._y=(r+i)/f,this._z=(a+l)/f}else if(o>u){var p=2*Math.sqrt(1+o-n-u);this._w=(a-l)/p,this._x=(r+i)/p,this._y=.25*p,this._z=(s+c)/p}else{var m=2*Math.sqrt(1+u-n-o);this._w=(i-r)/m,this._x=(a+l)/m,this._y=(s+c)/m,this._z=.25*m}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(e){return 2*Math.acos(Math.abs(C(this.dot(e),-1,1)))}},{key:"rotateTowards",value:function(e,t){var n=this.angleTo(e);if(0===n)return this;var r=Math.min(1,t/n);return this.slerp(e,r),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(e){return this.multiplyQuaternions(this,e)}},{key:"premultiply",value:function(e){return this.multiplyQuaternions(e,this)}},{key:"multiplyQuaternions",value:function(e,t){var n=e._x,r=e._y,a=e._z,i=e._w,o=t._x,s=t._y,l=t._z,c=t._w;return this._x=n*c+i*o+r*l-a*s,this._y=r*c+i*s+a*o-n*l,this._z=a*c+i*l+n*s-r*o,this._w=i*c-n*o-r*s-a*l,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,a=this._z,i=this._w,o=i*e._w+n*e._x+r*e._y+a*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=i,this._x=n,this._y=r,this._z=a,this;var s=1-o*o;if(s<=Number.EPSILON){var l=1-t;return this._w=l*i+t*this._w,this._x=l*n+t*this._x,this._y=l*r+t*this._y,this._z=l*a+t*this._z,this.normalize(),this._onChangeCallback(),this}var c=Math.sqrt(s),u=Math.atan2(c,o),d=Math.sin((1-t)*u)/c,h=Math.sin(t*u)/c;return this._w=i*d+this._w*h,this._x=n*d+this._x*h,this._y=r*d+this._y*h,this._z=a*d+this._z*h,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){return this.copy(e).slerp(t,n)}},{key:"random",value:function(){var e=Math.random(),t=Math.sqrt(1-e),n=Math.sqrt(e),r=2*Math.PI*Math.random(),a=2*Math.PI*Math.random();return this.set(t*Math.cos(r),n*Math.sin(a),n*Math.cos(a),t*Math.sin(r))}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"toJSON",value:function(){return this.toArray()}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._w;case 8:case"end":return e.stop()}}),e,this)}))}],[{key:"slerpFlat",value:function(e,t,n,r,a,i,o){var s=n[r+0],l=n[r+1],c=n[r+2],u=n[r+3],d=a[i+0],h=a[i+1],f=a[i+2],p=a[i+3];if(0===o)return e[t+0]=s,e[t+1]=l,e[t+2]=c,void(e[t+3]=u);if(1===o)return e[t+0]=d,e[t+1]=h,e[t+2]=f,void(e[t+3]=p);if(u!==p||s!==d||l!==h||c!==f){var m=1-o,v=s*d+l*h+c*f+u*p,g=v>=0?1:-1,y=1-v*v;if(y>Number.EPSILON){var b=Math.sqrt(y),_=Math.atan2(b,v*g);m=Math.sin(m*_)/b,o=Math.sin(o*_)/b}var x=o*g;if(s=s*m+d*x,l=l*m+h*x,c=c*m+f*x,u=u*m+p*x,m===1-o){var E=1/Math.sqrt(s*s+l*l+c*c+u*u);s*=E,l*=E,c*=E,u*=E}}e[t]=s,e[t+1]=l,e[t+2]=c,e[t+3]=u}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,a,i){var o=n[r],s=n[r+1],l=n[r+2],c=n[r+3],u=a[i],d=a[i+1],h=a[i+2],f=a[i+3];return e[t]=o*f+c*u+s*h-l*d,e[t+1]=s*f+c*d+l*u-o*h,e[t+2]=l*f+c*h+o*d-s*u,e[t+3]=c*f-o*u-s*d-l*h,e}}])}(),ue=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(p.a)(this,e),e.prototype.isVector3=!0,this.x=t,this.y=n,this.z=r}),[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}},{key:"addScalar",value:function(e){return this.x+=e,this.y+=e,this.z+=e,this}},{key:"addVectors",value:function(e,t){return this.x=e.x+t.x,this.y=e.y+t.y,this.z=e.z+t.z,this}},{key:"addScaledVector",value:function(e,t){return this.x+=e.x*t,this.y+=e.y*t,this.z+=e.z*t,this}},{key:"sub",value:function(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}},{key:"subScalar",value:function(e){return this.x-=e,this.y-=e,this.z-=e,this}},{key:"subVectors",value:function(e,t){return this.x=e.x-t.x,this.y=e.y-t.y,this.z=e.z-t.z,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(e,t){return this.x=e.x*t.x,this.y=e.y*t.y,this.z=e.z*t.z,this}},{key:"applyEuler",value:function(e){return this.applyQuaternion(he.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(he.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[3]*n+a[6]*r,this.y=a[1]*t+a[4]*n+a[7]*r,this.z=a[2]*t+a[5]*n+a[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements,i=1/(a[3]*t+a[7]*n+a[11]*r+a[15]);return this.x=(a[0]*t+a[4]*n+a[8]*r+a[12])*i,this.y=(a[1]*t+a[5]*n+a[9]*r+a[13])*i,this.z=(a[2]*t+a[6]*n+a[10]*r+a[14])*i,this}},{key:"applyQuaternion",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.x,i=e.y,o=e.z,s=e.w,l=s*t+i*r-o*n,c=s*n+o*t-a*r,u=s*r+a*n-i*t,d=-a*t-i*n-o*r;return this.x=l*s+d*-a+c*-o-u*-i,this.y=c*s+d*-i+u*-a-l*-o,this.z=u*s+d*-o+l*-i-c*-a,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,a=e.elements;return this.x=a[0]*t+a[4]*n+a[8]*r,this.y=a[1]*t+a[5]*n+a[9]*r,this.z=a[2]*t+a[6]*n+a[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e){return this.crossVectors(this,e)}},{key:"crossVectors",value:function(e,t){var n=e.x,r=e.y,a=e.z,i=t.x,o=t.y,s=t.z;return this.x=r*s-a*o,this.y=a*i-n*s,this.z=n*o-r*i,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return de.copy(this).projectOnVector(e),this.sub(de)}},{key:"reflect",value:function(e){return this.sub(de.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(C(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"setFromEuler",value:function(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}},{key:"setFromColor",value:function(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t){return this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}},{key:"randomDirection",value:function(){var e=2*(Math.random()-.5),t=Math.random()*Math.PI*2,n=Math.sqrt(1-Math.pow(e,2));return this.x=n*Math.cos(t),this.y=n*Math.sin(t),this.z=e,this}},{key:Symbol.iterator,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.x;case 2:return e.next=4,this.y;case 4:return e.next=6,this.z;case 6:case"end":return e.stop()}}),e,this)}))}])}(),de=new ue,he=new ce,fe=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ue(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ue(-1/0,-1/0,-1/0);Object(p.a)(this,e),this.isBox3=!0,this.min=t,this.max=n}),[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t+=3)this.expandByPoint(me.fromArray(e,t));return this}},{key:"setFromBufferAttribute",value:function(e){this.makeEmpty();for(var t=0,n=e.count;t<n;t++)this.expandByPoint(me.fromBufferAttribute(e,t));return this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=me.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.makeEmpty(),this.expandByObject(e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(e.updateWorldMatrix(!1,!1),void 0!==e.boundingBox)null===e.boundingBox&&e.computeBoundingBox(),ve.copy(e.boundingBox),ve.applyMatrix4(e.matrixWorld),this.union(ve);else{var n=e.geometry;if(void 0!==n)if(t&&void 0!==n.attributes&&void 0!==n.attributes.position)for(var r=n.attributes.position,a=0,i=r.count;a<i;a++)me.fromBufferAttribute(r,a).applyMatrix4(e.matrixWorld),this.expandByPoint(me);else null===n.boundingBox&&n.computeBoundingBox(),ve.copy(n.boundingBox),ve.applyMatrix4(e.matrixWorld),this.union(ve)}for(var o=e.children,s=0,l=o.length;s<l;s++)this.expandByObject(o[s],t);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,me),me.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(Se),Me.subVectors(this.max,Se),ge.subVectors(e.a,Se),ye.subVectors(e.b,Se),be.subVectors(e.c,Se),_e.subVectors(ye,ge),xe.subVectors(be,ye),Ee.subVectors(ge,be);var t=[0,-_e.z,_e.y,0,-xe.z,xe.y,0,-Ee.z,Ee.y,_e.z,0,-_e.x,xe.z,0,-xe.x,Ee.z,0,-Ee.x,-_e.y,_e.x,0,-xe.y,xe.x,0,-Ee.y,Ee.x,0];return!!Oe(t,ge,ye,be,Me)&&(!!Oe(t=[1,0,0,0,1,0,0,0,1],ge,ye,be,Me)&&(Te.crossVectors(_e,xe),Oe(t=[Te.x,Te.y,Te.z],ge,ye,be,Me)))}},{key:"clampPoint",value:function(e,t){return t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return this.clampPoint(e,me).distanceTo(e)}},{key:"getBoundingSphere",value:function(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(me).length()),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(pe[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),pe[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),pe[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),pe[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),pe[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),pe[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),pe[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),pe[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(pe)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}])}(),pe=[new ue,new ue,new ue,new ue,new ue,new ue,new ue,new ue],me=new ue,ve=new fe,ge=new ue,ye=new ue,be=new ue,_e=new ue,xe=new ue,Ee=new ue,Se=new ue,Me=new ue,Te=new ue,we=new ue;function Oe(e,t,n,r,a){for(var i=0,o=e.length-3;i<=o;i+=3){we.fromArray(e,i);var s=a.x*Math.abs(we.x)+a.y*Math.abs(we.y)+a.z*Math.abs(we.z),l=t.dot(we),c=n.dot(we),u=r.dot(we);if(Math.max(-Math.max(l,c,u),Math.min(l,c,u))>s)return!1}return!0}var Ae=new fe,Re=new ue,Ce=new ue,ke=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ue,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Object(p.a)(this,e),this.center=t,this.radius=n}),[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):Ae.setFromPoints(e).getCenter(n);for(var r=0,a=0,i=e.length;a<i;a++)r=Math.max(r,n.distanceToSquared(e[a]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;Re.subVectors(e,this.center);var t=Re.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.addScaledVector(Re,r/n),this.radius+=r}return this}},{key:"union",value:function(e){return e.isEmpty()?this:this.isEmpty()?(this.copy(e),this):(!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(Ce.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(Re.copy(e.center).add(Ce)),this.expandByPoint(Re.copy(e.center).sub(Ce))),this)}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])}(),Pe=new ue,Le=new ue,Ie=new ue,Ne=new ue,De=new ue,Ue=new ue,je=new ue,Fe=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ue,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ue(0,0,-1);Object(p.a)(this,e),this.origin=t,this.direction=n}),[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return t.copy(this.origin).addScaledVector(this.direction,e)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,Pe)),this}},{key:"closestPointToPoint",value:function(e,t){t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.origin).addScaledVector(this.direction,n)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=Pe.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(Pe.copy(this.origin).addScaledVector(this.direction,t),Pe.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){Le.copy(e).add(t).multiplyScalar(.5),Ie.copy(t).sub(e).normalize(),Ne.copy(this.origin).sub(Le);var a,i,o,s,l=.5*e.distanceTo(t),c=-this.direction.dot(Ie),u=Ne.dot(this.direction),d=-Ne.dot(Ie),h=Ne.lengthSq(),f=Math.abs(1-c*c);if(f>0)if(i=c*u-d,s=l*f,(a=c*d-u)>=0)if(i>=-s)if(i<=s){var p=1/f;o=(a*=p)*(a+c*(i*=p)+2*u)+i*(c*a+i+2*d)+h}else i=l,o=-(a=Math.max(0,-(c*i+u)))*a+i*(i+2*d)+h;else i=-l,o=-(a=Math.max(0,-(c*i+u)))*a+i*(i+2*d)+h;else i<=-s?o=-(a=Math.max(0,-(-c*l+u)))*a+(i=a>0?-l:Math.min(Math.max(-l,-d),l))*(i+2*d)+h:i<=s?(a=0,o=(i=Math.min(Math.max(-l,-d),l))*(i+2*d)+h):o=-(a=Math.max(0,-(c*l+u)))*a+(i=a>0?l:Math.min(Math.max(-l,-d),l))*(i+2*d)+h;else i=c>0?-l:l,o=-(a=Math.max(0,-(c*i+u)))*a+i*(i+2*d)+h;return n&&n.copy(this.origin).addScaledVector(this.direction,a),r&&r.copy(Le).addScaledVector(Ie,i),o}},{key:"intersectSphere",value:function(e,t){Pe.subVectors(e.center,this.origin);var n=Pe.dot(this.direction),r=Pe.dot(Pe)-n*n,a=e.radius*e.radius;if(r>a)return null;var i=Math.sqrt(a-r),o=n-i,s=n+i;return s<0?null:o<0?this.at(s,t):this.at(o,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,a,i,o,s,l=1/this.direction.x,c=1/this.direction.y,u=1/this.direction.z,d=this.origin;return l>=0?(n=(e.min.x-d.x)*l,r=(e.max.x-d.x)*l):(n=(e.max.x-d.x)*l,r=(e.min.x-d.x)*l),c>=0?(a=(e.min.y-d.y)*c,i=(e.max.y-d.y)*c):(a=(e.max.y-d.y)*c,i=(e.min.y-d.y)*c),n>i||a>r?null:((a>n||isNaN(n))&&(n=a),(i<r||isNaN(r))&&(r=i),u>=0?(o=(e.min.z-d.z)*u,s=(e.max.z-d.z)*u):(o=(e.max.z-d.z)*u,s=(e.min.z-d.z)*u),n>s||o>r?null:((o>n||n!==n)&&(n=o),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,Pe)}},{key:"intersectTriangle",value:function(e,t,n,r,a){De.subVectors(t,e),Ue.subVectors(n,e),je.crossVectors(De,Ue);var i,o=this.direction.dot(je);if(o>0){if(r)return null;i=1}else{if(!(o<0))return null;i=-1,o=-o}Ne.subVectors(this.origin,e);var s=i*this.direction.dot(Ue.crossVectors(Ne,Ue));if(s<0)return null;var l=i*this.direction.dot(De.cross(Ne));if(l<0)return null;if(s+l>o)return null;var c=-i*Ne.dot(je);return c<0?null:this.at(c/o,a)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])}(),ze=function(){function e(t,n,r,a,i,o,s,l,c,u,d,h,f,m,v,g){Object(p.a)(this,e),e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==t&&this.set(t,n,r,a,i,o,s,l,c,u,d,h,f,m,v,g)}return Object(m.a)(e,[{key:"set",value:function(e,t,n,r,a,i,o,s,l,c,u,d,h,f,p,m){var v=this.elements;return v[0]=e,v[4]=t,v[8]=n,v[12]=r,v[1]=a,v[5]=i,v[9]=o,v[13]=s,v[2]=l,v[6]=c,v[10]=u,v[14]=d,v[3]=h,v[7]=f,v[11]=p,v[15]=m,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/Be.setFromMatrixColumn(e,0).length(),a=1/Be.setFromMatrixColumn(e,1).length(),i=1/Be.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*a,t[5]=n[5]*a,t[6]=n[6]*a,t[7]=0,t[8]=n[8]*i,t[9]=n[9]*i,t[10]=n[10]*i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){var t=this.elements,n=e.x,r=e.y,a=e.z,i=Math.cos(n),o=Math.sin(n),s=Math.cos(r),l=Math.sin(r),c=Math.cos(a),u=Math.sin(a);if("XYZ"===e.order){var d=i*c,h=i*u,f=o*c,p=o*u;t[0]=s*c,t[4]=-s*u,t[8]=l,t[1]=h+f*l,t[5]=d-p*l,t[9]=-o*s,t[2]=p-d*l,t[6]=f+h*l,t[10]=i*s}else if("YXZ"===e.order){var m=s*c,v=s*u,g=l*c,y=l*u;t[0]=m+y*o,t[4]=g*o-v,t[8]=i*l,t[1]=i*u,t[5]=i*c,t[9]=-o,t[2]=v*o-g,t[6]=y+m*o,t[10]=i*s}else if("ZXY"===e.order){var b=s*c,_=s*u,x=l*c,E=l*u;t[0]=b-E*o,t[4]=-i*u,t[8]=x+_*o,t[1]=_+x*o,t[5]=i*c,t[9]=E-b*o,t[2]=-i*l,t[6]=o,t[10]=i*s}else if("ZYX"===e.order){var S=i*c,M=i*u,T=o*c,w=o*u;t[0]=s*c,t[4]=T*l-M,t[8]=S*l+w,t[1]=s*u,t[5]=w*l+S,t[9]=M*l-T,t[2]=-l,t[6]=o*s,t[10]=i*s}else if("YZX"===e.order){var O=i*s,A=i*l,R=o*s,C=o*l;t[0]=s*c,t[4]=C-O*u,t[8]=R*u+A,t[1]=u,t[5]=i*c,t[9]=-o*c,t[2]=-l*c,t[6]=A*u+R,t[10]=O-C*u}else if("XZY"===e.order){var k=i*s,P=i*l,L=o*s,I=o*l;t[0]=s*c,t[4]=-u,t[8]=l*c,t[1]=k*u+I,t[5]=i*c,t[9]=P*u-L,t[2]=L*u-P,t[6]=o*c,t[10]=I*u+k}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(e){return this.compose(Ve,e,Ge)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return qe.subVectors(e,t),0===qe.lengthSq()&&(qe.z=1),qe.normalize(),We.crossVectors(n,qe),0===We.lengthSq()&&(1===Math.abs(n.z)?qe.x+=1e-4:qe.z+=1e-4,qe.normalize(),We.crossVectors(n,qe)),We.normalize(),Xe.crossVectors(qe,We),r[0]=We.x,r[4]=Xe.x,r[8]=qe.x,r[1]=We.y,r[5]=Xe.y,r[9]=qe.y,r[2]=We.z,r[6]=Xe.z,r[10]=qe.z,this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(e,t){var n=e.elements,r=t.elements,a=this.elements,i=n[0],o=n[4],s=n[8],l=n[12],c=n[1],u=n[5],d=n[9],h=n[13],f=n[2],p=n[6],m=n[10],v=n[14],g=n[3],y=n[7],b=n[11],_=n[15],x=r[0],E=r[4],S=r[8],M=r[12],T=r[1],w=r[5],O=r[9],A=r[13],R=r[2],C=r[6],k=r[10],P=r[14],L=r[3],I=r[7],N=r[11],D=r[15];return a[0]=i*x+o*T+s*R+l*L,a[4]=i*E+o*w+s*C+l*I,a[8]=i*S+o*O+s*k+l*N,a[12]=i*M+o*A+s*P+l*D,a[1]=c*x+u*T+d*R+h*L,a[5]=c*E+u*w+d*C+h*I,a[9]=c*S+u*O+d*k+h*N,a[13]=c*M+u*A+d*P+h*D,a[2]=f*x+p*T+m*R+v*L,a[6]=f*E+p*w+m*C+v*I,a[10]=f*S+p*O+m*k+v*N,a[14]=f*M+p*A+m*P+v*D,a[3]=g*x+y*T+b*R+_*L,a[7]=g*E+y*w+b*C+_*I,a[11]=g*S+y*O+b*k+_*N,a[15]=g*M+y*A+b*P+_*D,this}},{key:"multiplyScalar",value:function(e){var t=this.elements;return t[0]*=e,t[4]*=e,t[8]*=e,t[12]*=e,t[1]*=e,t[5]*=e,t[9]*=e,t[13]*=e,t[2]*=e,t[6]*=e,t[10]*=e,t[14]*=e,t[3]*=e,t[7]*=e,t[11]*=e,t[15]*=e,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],a=e[12],i=e[1],o=e[5],s=e[9],l=e[13],c=e[2],u=e[6],d=e[10],h=e[14];return e[3]*(+a*s*u-r*l*u-a*o*d+n*l*d+r*o*h-n*s*h)+e[7]*(+t*s*h-t*l*d+a*i*d-r*i*h+r*l*c-a*s*c)+e[11]*(+t*l*u-t*o*h-a*i*u+n*i*h+a*o*c-n*l*c)+e[15]*(-r*o*c-t*s*u+t*o*d+r*i*u-n*i*d+n*s*c)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],a=e[3],i=e[4],o=e[5],s=e[6],l=e[7],c=e[8],u=e[9],d=e[10],h=e[11],f=e[12],p=e[13],m=e[14],v=e[15],g=u*m*l-p*d*l+p*s*h-o*m*h-u*s*v+o*d*v,y=f*d*l-c*m*l-f*s*h+i*m*h+c*s*v-i*d*v,b=c*p*l-f*u*l+f*o*h-i*p*h-c*o*v+i*u*v,_=f*u*s-c*p*s-f*o*d+i*p*d+c*o*m-i*u*m,x=t*g+n*y+r*b+a*_;if(0===x)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var E=1/x;return e[0]=g*E,e[1]=(p*d*a-u*m*a-p*r*h+n*m*h+u*r*v-n*d*v)*E,e[2]=(o*m*a-p*s*a+p*r*l-n*m*l-o*r*v+n*s*v)*E,e[3]=(u*s*a-o*d*a-u*r*l+n*d*l+o*r*h-n*s*h)*E,e[4]=y*E,e[5]=(c*m*a-f*d*a+f*r*h-t*m*h-c*r*v+t*d*v)*E,e[6]=(f*s*a-i*m*a-f*r*l+t*m*l+i*r*v-t*s*v)*E,e[7]=(i*d*a-c*s*a+c*r*l-t*d*l-i*r*h+t*s*h)*E,e[8]=b*E,e[9]=(f*u*a-c*p*a-f*n*h+t*p*h+c*n*v-t*u*v)*E,e[10]=(i*p*a-f*o*a+f*n*l-t*p*l-i*n*v+t*o*v)*E,e[11]=(c*o*a-i*u*a-c*n*l+t*u*l+i*n*h-t*o*h)*E,e[12]=_*E,e[13]=(c*p*r-f*u*r+f*n*d-t*p*d-c*n*m+t*u*m)*E,e[14]=(f*o*r-i*p*r-f*n*s+t*p*s+i*n*m-t*o*m)*E,e[15]=(i*u*r-c*o*r+c*n*s-t*u*s-i*n*d+t*o*d)*E,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,a=e.z;return t[0]*=n,t[4]*=r,t[8]*=a,t[1]*=n,t[5]*=r,t[9]*=a,t[2]*=n,t[6]*=r,t[10]*=a,t[3]*=n,t[7]*=r,t[11]*=a,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(1,0,0,0,0,t,-n,0,0,n,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,0,n,0,0,1,0,0,-n,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),n=Math.sin(e);return this.set(t,-n,0,0,n,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),r=Math.sin(t),a=1-n,i=e.x,o=e.y,s=e.z,l=a*i,c=a*o;return this.set(l*i+n,l*o-r*s,l*s+r*o,0,l*o+r*s,c*o+n,c*s-r*i,0,l*s-r*o,c*s+r*i,a*s*s+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n,r,a,i){return this.set(1,n,a,0,e,1,i,0,t,r,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,a=t._x,i=t._y,o=t._z,s=t._w,l=a+a,c=i+i,u=o+o,d=a*l,h=a*c,f=a*u,p=i*c,m=i*u,v=o*u,g=s*l,y=s*c,b=s*u,_=n.x,x=n.y,E=n.z;return r[0]=(1-(p+v))*_,r[1]=(h+b)*_,r[2]=(f-y)*_,r[3]=0,r[4]=(h-b)*x,r[5]=(1-(d+v))*x,r[6]=(m+g)*x,r[7]=0,r[8]=(f+y)*E,r[9]=(m-g)*E,r[10]=(1-(d+p))*E,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,a=Be.set(r[0],r[1],r[2]).length(),i=Be.set(r[4],r[5],r[6]).length(),o=Be.set(r[8],r[9],r[10]).length();this.determinant()<0&&(a=-a),e.x=r[12],e.y=r[13],e.z=r[14],He.copy(this);var s=1/a,l=1/i,c=1/o;return He.elements[0]*=s,He.elements[1]*=s,He.elements[2]*=s,He.elements[4]*=l,He.elements[5]*=l,He.elements[6]*=l,He.elements[8]*=c,He.elements[9]*=c,He.elements[10]*=c,t.setFromRotationMatrix(He),n.x=a,n.y=i,n.z=o,this}},{key:"makePerspective",value:function(e,t,n,r,a,i){var o,s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2e3,c=this.elements,u=2*a/(t-e),d=2*a/(n-r),h=(t+e)/(t-e),f=(n+r)/(n-r);if(2e3===l)o=-(i+a)/(i-a),s=-2*i*a/(i-a);else{if(2001!==l)throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+l);o=-i/(i-a),s=-i*a/(i-a)}return c[0]=u,c[4]=0,c[8]=h,c[12]=0,c[1]=0,c[5]=d,c[9]=f,c[13]=0,c[2]=0,c[6]=0,c[10]=o,c[14]=s,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,a,i){var o,s,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:2e3,c=this.elements,u=1/(t-e),d=1/(n-r),h=1/(i-a),f=(t+e)*u,p=(n+r)*d;if(2e3===l)o=(i+a)*h,s=-2*h;else{if(2001!==l)throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+l);o=a*h,s=-1*h}return c[0]=2*u,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-p,c[2]=0,c[6]=0,c[10]=s,c[14]=-o,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}])}(),Be=new ue,He=new ze,Ve=new ue(0,0,0),Ge=new ue(1,1,1),We=new ue,Xe=new ue,qe=new ue,Ye=new ze,Ke=new ce,Ze=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DEFAULT_ORDER;Object(p.a)(this,e),this.isEuler=!0,this._x=t,this._y=n,this._z=r,this._order=a}),[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this._order;return this._x=e,this._y=t,this._z=n,this._order=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=e.elements,a=r[0],i=r[4],o=r[8],s=r[1],l=r[5],c=r[9],u=r[2],d=r[6],h=r[10];switch(t){case"XYZ":this._y=Math.asin(C(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(-c,h),this._z=Math.atan2(-i,a)):(this._x=Math.atan2(d,l),this._z=0);break;case"YXZ":this._x=Math.asin(-C(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(o,h),this._z=Math.atan2(s,l)):(this._y=Math.atan2(-u,a),this._z=0);break;case"ZXY":this._x=Math.asin(C(d,-1,1)),Math.abs(d)<.9999999?(this._y=Math.atan2(-u,h),this._z=Math.atan2(-i,l)):(this._y=0,this._z=Math.atan2(s,a));break;case"ZYX":this._y=Math.asin(-C(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(d,h),this._z=Math.atan2(s,a)):(this._x=0,this._z=Math.atan2(-i,l));break;case"YZX":this._z=Math.asin(C(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-c,l),this._y=Math.atan2(-u,a)):(this._x=0,this._y=Math.atan2(o,h));break;case"XZY":this._z=Math.asin(-C(i,-1,1)),Math.abs(i)<.9999999?(this._x=Math.atan2(d,l),this._y=Math.atan2(o,a)):(this._x=Math.atan2(-c,h),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!0===n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(e,t,n){return Ye.makeRotationFromQuaternion(e),this.setFromRotationMatrix(Ye,t,n)}},{key:"setFromVector3",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._order;return this.set(e.x,e.y,e.z,t)}},{key:"reorder",value:function(e){return Ke.setFromEuler(this),this.setFromQuaternion(Ke,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}},{key:Symbol.iterator,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._x;case 2:return e.next=4,this._y;case 4:return e.next=6,this._z;case 6:return e.next=8,this._order;case 8:case"end":return e.stop()}}),e,this)}))}])}();Ze.DEFAULT_ORDER="XYZ";var Je=function(){return Object(m.a)((function e(){Object(p.a)(this,e),this.mask=1}),[{key:"set",value:function(e){this.mask=(1<<e|0)>>>0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!==(this.mask&e.mask)}},{key:"isEnabled",value:function(e){return 0!==(this.mask&(1<<e|0))}}])}(),Qe=0,$e=new ue,et=new ce,tt=new ze,nt=new ue,rt=new ue,at=new ue,it=new ce,ot=new ue(1,0,0),st=new ue(0,1,0),lt=new ue(0,0,1),ct={type:"added"},ut={type:"removed"},dt=function(e){function t(){var e;Object(p.a)(this,t),(e=v(this,t)).isObject3D=!0,Object.defineProperty(e,"id",{value:Qe++}),e.uuid=R(),e.name="",e.type="Object3D",e.parent=null,e.children=[],e.up=t.DEFAULT_UP.clone();var n=new ue,r=new Ze,a=new ce,i=new ue(1,1,1);return r._onChange((function(){a.setFromEuler(r,!1)})),a._onChange((function(){r.setFromQuaternion(a,void 0,!1)})),Object.defineProperties(e,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new ze},normalMatrix:{value:new F}}),e.matrix=new ze,e.matrixWorld=new ze,e.matrixAutoUpdate=t.DEFAULT_MATRIX_AUTO_UPDATE,e.matrixWorldNeedsUpdate=!1,e.matrixWorldAutoUpdate=t.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,e.layers=new Je,e.visible=!0,e.castShadow=!1,e.receiveShadow=!1,e.frustumCulled=!0,e.renderOrder=0,e.animations=[],e.userData={},e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"onBeforeRender",value:function(){}},{key:"onAfterRender",value:function(){}},{key:"applyMatrix4",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}},{key:"applyQuaternion",value:function(e){return this.quaternion.premultiply(e),this}},{key:"setRotationFromAxisAngle",value:function(e,t){this.quaternion.setFromAxisAngle(e,t)}},{key:"setRotationFromEuler",value:function(e){this.quaternion.setFromEuler(e,!0)}},{key:"setRotationFromMatrix",value:function(e){this.quaternion.setFromRotationMatrix(e)}},{key:"setRotationFromQuaternion",value:function(e){this.quaternion.copy(e)}},{key:"rotateOnAxis",value:function(e,t){return et.setFromAxisAngle(e,t),this.quaternion.multiply(et),this}},{key:"rotateOnWorldAxis",value:function(e,t){return et.setFromAxisAngle(e,t),this.quaternion.premultiply(et),this}},{key:"rotateX",value:function(e){return this.rotateOnAxis(ot,e)}},{key:"rotateY",value:function(e){return this.rotateOnAxis(st,e)}},{key:"rotateZ",value:function(e){return this.rotateOnAxis(lt,e)}},{key:"translateOnAxis",value:function(e,t){return $e.copy(e).applyQuaternion(this.quaternion),this.position.add($e.multiplyScalar(t)),this}},{key:"translateX",value:function(e){return this.translateOnAxis(ot,e)}},{key:"translateY",value:function(e){return this.translateOnAxis(st,e)}},{key:"translateZ",value:function(e){return this.translateOnAxis(lt,e)}},{key:"localToWorld",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}},{key:"worldToLocal",value:function(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(tt.copy(this.matrixWorld).invert())}},{key:"lookAt",value:function(e,t,n){e.isVector3?nt.copy(e):nt.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),rt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?tt.lookAt(rt,nt,this.up):tt.lookAt(nt,rt,this.up),this.quaternion.setFromRotationMatrix(tt),r&&(tt.extractRotation(r.matrixWorld),et.setFromRotationMatrix(tt),this.quaternion.premultiply(et.invert()))}},{key:"add",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.add(arguments[t]);return this}return e===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",e),this):(e&&e.isObject3D?(null!==e.parent&&e.parent.remove(e),e.parent=this,this.children.push(e),e.dispatchEvent(ct)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this)}},{key:"remove",value:function(e){if(arguments.length>1){for(var t=0;t<arguments.length;t++)this.remove(arguments[t]);return this}var n=this.children.indexOf(e);return-1!==n&&(e.parent=null,this.children.splice(n,1),e.dispatchEvent(ut)),this}},{key:"removeFromParent",value:function(){var e=this.parent;return null!==e&&e.remove(this),this}},{key:"clear",value:function(){for(var e=0;e<this.children.length;e++){var t=this.children[e];t.parent=null,t.dispatchEvent(ut)}return this.children.length=0,this}},{key:"attach",value:function(e){return this.updateWorldMatrix(!0,!1),tt.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),tt.multiply(e.parent.matrixWorld)),e.applyMatrix4(tt),this.add(e),e.updateWorldMatrix(!1,!0),this}},{key:"getObjectById",value:function(e){return this.getObjectByProperty("id",e)}},{key:"getObjectByName",value:function(e){return this.getObjectByProperty("name",e)}},{key:"getObjectByProperty",value:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var a=this.children[n].getObjectByProperty(e,t);if(void 0!==a)return a}}},{key:"getObjectsByProperty",value:function(e,t){var n=[];this[e]===t&&n.push(this);for(var r=0,a=this.children.length;r<a;r++){var i=this.children[r].getObjectsByProperty(e,t);i.length>0&&(n=n.concat(i))}return n}},{key:"getWorldPosition",value:function(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}},{key:"getWorldQuaternion",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rt,e,at),e}},{key:"getWorldScale",value:function(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(rt,it,e),e}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()}},{key:"raycast",value:function(){}},{key:"traverse",value:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)}},{key:"traverseVisible",value:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}}},{key:"traverseAncestors",value:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))}},{key:"updateMatrix",value:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}},{key:"updateMatrixWorld",value:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++){var a=t[n];!0!==a.matrixWorldAutoUpdate&&!0!==e||a.updateMatrixWorld(e)}}},{key:"updateWorldMatrix",value:function(e,t){var n=this.parent;if(!0===e&&null!==n&&!0===n.matrixWorldAutoUpdate&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,a=0,i=r.length;a<i;a++){var o=r[a];!0===o.matrixWorldAutoUpdate&&o.updateWorldMatrix(!1,!0)}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e,n={};t&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});var r={};function a(t,n){return void 0===t[n.uuid]&&(t[n.uuid]=n.toJSON(e)),n.uuid}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),!0===this.castShadow&&(r.castShadow=!0),!0===this.receiveShadow&&(r.receiveShadow=!0),!1===this.visible&&(r.visible=!1),!1===this.frustumCulled&&(r.frustumCulled=!1),0!==this.renderOrder&&(r.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(r.userData=this.userData),r.layers=this.layers.mask,r.matrix=this.matrix.toArray(),r.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(r.matrixAutoUpdate=!1),this.isInstancedMesh&&(r.type="InstancedMesh",r.count=this.count,r.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(r.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?r.background=this.background.toJSON():this.background.isTexture&&(r.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(r.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){r.geometry=a(e.geometries,this.geometry);var i=this.geometry.parameters;if(void 0!==i&&void 0!==i.shapes){var o=i.shapes;if(Array.isArray(o))for(var s=0,l=o.length;s<l;s++){var c=o[s];a(e.shapes,c)}else a(e.shapes,o)}}if(this.isSkinnedMesh&&(r.bindMode=this.bindMode,r.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(a(e.skeletons,this.skeleton),r.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var u=[],d=0,h=this.material.length;d<h;d++)u.push(a(e.materials,this.material[d]));r.material=u}else r.material=a(e.materials,this.material);if(this.children.length>0){r.children=[];for(var f=0;f<this.children.length;f++)r.children.push(this.children[f].toJSON(e).object)}if(this.animations.length>0){r.animations=[];for(var p=0;p<this.animations.length;p++){var m=this.animations[p];r.animations.push(a(e.animations,m))}}if(t){var v=M(e.geometries),g=M(e.materials),y=M(e.textures),b=M(e.images),_=M(e.shapes),x=M(e.skeletons),E=M(e.animations),S=M(e.nodes);v.length>0&&(n.geometries=v),g.length>0&&(n.materials=g),y.length>0&&(n.textures=y),b.length>0&&(n.images=b),_.length>0&&(n.shapes=_),x.length>0&&(n.skeletons=x),E.length>0&&(n.animations=E),S.length>0&&(n.nodes=S)}return n.object=r,n;function M(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}}},{key:"clone",value:function(e){return(new this.constructor).copy(this,e)}},{key:"copy",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===t)for(var n=0;n<e.children.length;n++){var r=e.children[n];this.add(r.clone())}return this}}])}(T);dt.DEFAULT_UP=new ue(0,1,0),dt.DEFAULT_MATRIX_AUTO_UPDATE=!0,dt.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var ht=new ue,ft=new ue,pt=new ue,mt=new ue,vt=new ue,gt=new ue,yt=new ue,bt=new ue,_t=new ue,xt=new ue,Et=!1,St=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ue,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new ue,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new ue;Object(p.a)(this,e),this.a=t,this.b=n,this.c=r}return Object(m.a)(e,[{key:"set",value:function(e,t,n){return this.a.copy(e),this.b.copy(t),this.c.copy(n),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"setFromAttributeAndIndices",value:function(e,t,n,r){return this.a.fromBufferAttribute(e,t),this.b.fromBufferAttribute(e,n),this.c.fromBufferAttribute(e,r),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return ht.subVectors(this.c,this.b),ft.subVectors(this.a,this.b),.5*ht.cross(ft).length()}},{key:"getMidpoint",value:function(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,a,i){return!1===Et&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Et=!0),e.getInterpolation(t,this.a,this.b,this.c,n,r,a,i)}},{key:"getInterpolation",value:function(t,n,r,a,i){return e.getInterpolation(t,this.a,this.b,this.c,n,r,a,i)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(e,t){var n,r,a=this.a,i=this.b,o=this.c;vt.subVectors(i,a),gt.subVectors(o,a),bt.subVectors(e,a);var s=vt.dot(bt),l=gt.dot(bt);if(s<=0&&l<=0)return t.copy(a);_t.subVectors(e,i);var c=vt.dot(_t),u=gt.dot(_t);if(c>=0&&u<=c)return t.copy(i);var d=s*u-c*l;if(d<=0&&s>=0&&c<=0)return n=s/(s-c),t.copy(a).addScaledVector(vt,n);xt.subVectors(e,o);var h=vt.dot(xt),f=gt.dot(xt);if(f>=0&&h<=f)return t.copy(o);var p=h*l-s*f;if(p<=0&&l>=0&&f<=0)return r=l/(l-f),t.copy(a).addScaledVector(gt,r);var m=c*f-h*u;if(m<=0&&u-c>=0&&h-f>=0)return yt.subVectors(o,i),r=(u-c)/(u-c+(h-f)),t.copy(i).addScaledVector(yt,r);var v=1/(m+p+d);return n=p*v,r=d*v,t.copy(a).addScaledVector(vt,n).addScaledVector(gt,r)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(e,t,n,r){r.subVectors(n,t),ht.subVectors(e,t),r.cross(ht);var a=r.lengthSq();return a>0?r.multiplyScalar(1/Math.sqrt(a)):r.set(0,0,0)}},{key:"getBarycoord",value:function(e,t,n,r,a){ht.subVectors(r,t),ft.subVectors(n,t),pt.subVectors(e,t);var i=ht.dot(ht),o=ht.dot(ft),s=ht.dot(pt),l=ft.dot(ft),c=ft.dot(pt),u=i*l-o*o;if(0===u)return a.set(-2,-1,-1);var d=1/u,h=(l*s-o*c)*d,f=(i*c-o*s)*d;return a.set(1-h-f,f,h)}},{key:"containsPoint",value:function(e,t,n,r){return this.getBarycoord(e,t,n,r,mt),mt.x>=0&&mt.y>=0&&mt.x+mt.y<=1}},{key:"getUV",value:function(e,t,n,r,a,i,o,s){return!1===Et&&(console.warn("THREE.Triangle.getUV() has been renamed to THREE.Triangle.getInterpolation()."),Et=!0),this.getInterpolation(e,t,n,r,a,i,o,s)}},{key:"getInterpolation",value:function(e,t,n,r,a,i,o,s){return this.getBarycoord(e,t,n,r,mt),s.setScalar(0),s.addScaledVector(a,mt.x),s.addScaledVector(i,mt.y),s.addScaledVector(o,mt.z),s}},{key:"isFrontFacing",value:function(e,t,n,r){return ht.subVectors(n,t),ft.subVectors(e,t),ht.cross(ft).dot(r)<0}}])}(),Mt=0,Tt=function(e){function t(){var e;return Object(p.a)(this,t),(e=v(this,t)).isMaterial=!0,Object.defineProperty(e,"id",{value:Mt++}),e.uuid=R(),e.name="",e.type="Material",e.blending=1,e.side=0,e.vertexColors=!1,e.opacity=1,e.transparent=!1,e.alphaHash=!1,e.blendSrc=204,e.blendDst=205,e.blendEquation=100,e.blendSrcAlpha=null,e.blendDstAlpha=null,e.blendEquationAlpha=null,e.depthFunc=3,e.depthTest=!0,e.depthWrite=!0,e.stencilWriteMask=255,e.stencilFunc=519,e.stencilRef=0,e.stencilFuncMask=255,e.stencilFail=7680,e.stencilZFail=7680,e.stencilZPass=7680,e.stencilWrite=!1,e.clippingPlanes=null,e.clipIntersection=!1,e.clipShadows=!1,e.shadowSide=null,e.colorWrite=!0,e.precision=null,e.polygonOffset=!1,e.polygonOffsetFactor=0,e.polygonOffsetUnits=0,e.dithering=!1,e.alphaToCoverage=!1,e.premultipliedAlpha=!1,e.forceSinglePass=!1,e.visible=!0,e.toneMapped=!0,e.userData={},e.version=0,e._alphaTest=0,e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"alphaTest",get:function(){return this._alphaTest},set:function(e){this._alphaTest>0!==e>0&&this.version++,this._alphaTest=e}},{key:"onBuild",value:function(){}},{key:"onBeforeRender",value:function(){}},{key:"onBeforeCompile",value:function(){}},{key:"customProgramCacheKey",value:function(){return this.onBeforeCompile.toString()}},{key:"setValues",value:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE.Material: '".concat(t,"' is not a property of THREE.").concat(this.type,"."))}else console.warn("THREE.Material: parameter '".concat(t,"' has value of undefined."))}}},{key:"toJSON",value:function(e){var t=void 0===e||"string"===typeof e;t&&(e={textures:{},images:{}});var n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function r(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),void 0!==this.roughness&&(n.roughness=this.roughness),void 0!==this.metalness&&(n.metalness=this.metalness),void 0!==this.sheen&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(n.shininess=this.shininess),void 0!==this.clearcoat&&(n.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.iridescence&&(n.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(n.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(n.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(e).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(e).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(e).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(e).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(e).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(n.combine=this.combine)),void 0!==this.envMapIntensity&&(n.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(n.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(n.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(n.size=this.size),null!==this.shadowSide&&(n.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(n.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(n.blending=this.blending),0!==this.side&&(n.side=this.side),this.vertexColors&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),!0===this.transparent&&(n.transparent=this.transparent),n.depthFunc=this.depthFunc,n.depthTest=this.depthTest,n.depthWrite=this.depthWrite,n.colorWrite=this.colorWrite,n.stencilWrite=this.stencilWrite,n.stencilWriteMask=this.stencilWriteMask,n.stencilFunc=this.stencilFunc,n.stencilRef=this.stencilRef,n.stencilFuncMask=this.stencilFuncMask,n.stencilFail=this.stencilFail,n.stencilZFail=this.stencilZFail,n.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(n.rotation=this.rotation),!0===this.polygonOffset&&(n.polygonOffset=!0),0!==this.polygonOffsetFactor&&(n.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(n.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(n.linewidth=this.linewidth),void 0!==this.dashSize&&(n.dashSize=this.dashSize),void 0!==this.gapSize&&(n.gapSize=this.gapSize),void 0!==this.scale&&(n.scale=this.scale),!0===this.dithering&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),!0===this.alphaHash&&(n.alphaHash=this.alphaHash),!0===this.alphaToCoverage&&(n.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(n.premultipliedAlpha=this.premultipliedAlpha),!0===this.forceSinglePass&&(n.forceSinglePass=this.forceSinglePass),!0===this.wireframe&&(n.wireframe=this.wireframe),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(n.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(n.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(n.flatShading=this.flatShading),!1===this.visible&&(n.visible=!1),!1===this.toneMapped&&(n.toneMapped=!1),!1===this.fog&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData),t){var a=r(e.textures),i=r(e.images);a.length>0&&(n.textures=a),i.length>0&&(n.images=i)}return n}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;var t=e.clippingPlanes,n=null;if(null!==t){var r=t.length;n=new Array(r);for(var a=0;a!==r;++a)n[a]=t[a].clone()}return this.clippingPlanes=n,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}])}(T),wt={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},Ot={h:0,s:0,l:0},At={h:0,s:0,l:0};function Rt(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+6*(t-e)*(2/3-n):e}var Ct=function(){return Object(m.a)((function e(t,n,r){return Object(p.a)(this,e),this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,n,r)}),[{key:"set",value:function(e,t,n){if(void 0===t&&void 0===n){var r=e;r&&r.isColor?this.copy(r):"number"===typeof r?this.setHex(r):"string"===typeof r&&this.setStyle(r)}else this.setRGB(e,t,n);return this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"srgb";return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,Q.toWorkingColorSpace(this,t),this}},{key:"setRGB",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Q.workingColorSpace;return this.r=e,this.g=t,this.b=n,Q.toWorkingColorSpace(this,r),this}},{key:"setHSL",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Q.workingColorSpace;if(e=k(e,1),t=C(t,0,1),n=C(n,0,1),0===t)this.r=this.g=this.b=n;else{var a=n<=.5?n*(1+t):n+t-n*t,i=2*n-a;this.r=Rt(i,a,e+1/3),this.g=Rt(i,a,e),this.b=Rt(i,a,e-1/3)}return Q.toWorkingColorSpace(this,r),this}},{key:"setStyle",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"srgb";function r(t){void 0!==t&&parseFloat(t)<1&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(t=/^(\w+)\(([^\)]*)\)/.exec(e)){var a,i=t[1],o=t[2];switch(i){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,n);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,n);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return r(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,n);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(e)){var s=t[1],l=s.length;if(3===l)return this.setRGB(parseInt(s.charAt(0),16)/15,parseInt(s.charAt(1),16)/15,parseInt(s.charAt(2),16)/15,n);if(6===l)return this.setHex(parseInt(s,16),n);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,n);return this}},{key:"setColorName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"srgb",n=wt[e.toLowerCase()];return void 0!==n?this.setHex(n,t):console.warn("THREE.Color: Unknown color "+e),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copySRGBToLinear",value:function(e){return this.r=W(e.r),this.g=W(e.g),this.b=W(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=X(e.r),this.g=X(e.g),this.b=X(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"srgb";return Q.fromWorkingColorSpace(kt.copy(this),e),65536*Math.round(C(255*kt.r,0,255))+256*Math.round(C(255*kt.g,0,255))+Math.round(C(255*kt.b,0,255))}},{key:"getHexString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"srgb";return("000000"+this.getHex(e).toString(16)).slice(-6)}},{key:"getHSL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.workingColorSpace;Q.fromWorkingColorSpace(kt.copy(this),t);var n,r,a=kt.r,i=kt.g,o=kt.b,s=Math.max(a,i,o),l=Math.min(a,i,o),c=(l+s)/2;if(l===s)n=0,r=0;else{var u=s-l;switch(r=c<=.5?u/(s+l):u/(2-s-l),s){case a:n=(i-o)/u+(i<o?6:0);break;case i:n=(o-a)/u+2;break;case o:n=(a-i)/u+4}n/=6}return e.h=n,e.s=r,e.l=c,e}},{key:"getRGB",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q.workingColorSpace;return Q.fromWorkingColorSpace(kt.copy(this),t),e.r=kt.r,e.g=kt.g,e.b=kt.b,e}},{key:"getStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"srgb";Q.fromWorkingColorSpace(kt.copy(this),e);var t=kt.r,n=kt.g,r=kt.b;return"srgb"!==e?"color(".concat(e," ").concat(t.toFixed(3)," ").concat(n.toFixed(3)," ").concat(r.toFixed(3),")"):"rgb(".concat(Math.round(255*t),",").concat(Math.round(255*n),",").concat(Math.round(255*r),")")}},{key:"offsetHSL",value:function(e,t,n){return this.getHSL(Ot),Ot.h+=e,Ot.s+=t,Ot.l+=n,this.setHSL(Ot.h,Ot.s,Ot.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(e){return this.r+=e,this.g+=e,this.b+=e,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(e){return this.r*=e,this.g*=e,this.b*=e,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(Ot),e.getHSL(At);var n=P(Ot.h,At.h,t),r=P(Ot.s,At.s,t),a=P(Ot.l,At.l,t);return this.setHSL(n,r,a),this}},{key:"setFromVector3",value:function(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}},{key:"applyMatrix3",value:function(e){var t=this.r,n=this.g,r=this.b,a=e.elements;return this.r=a[0]*t+a[3]*n+a[6]*r,this.g=a[1]*t+a[4]*n+a[7]*r,this.b=a[2]*t+a[5]*n+a[8]*r,this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),this}},{key:"toJSON",value:function(){return this.getHex()}},{key:Symbol.iterator,value:g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.r;case 2:return e.next=4,this.g;case 4:return e.next=6,this.b;case 6:case"end":return e.stop()}}),e,this)}))}])}(),kt=new Ct;Ct.NAMES=wt;var Pt=function(e){function t(e){var n;return Object(p.a)(this,t),(n=v(this,t)).isMeshBasicMaterial=!0,n.type="MeshBasicMaterial",n.color=new Ct(16777215),n.map=null,n.lightMap=null,n.lightMapIntensity=1,n.aoMap=null,n.aoMapIntensity=1,n.specularMap=null,n.alphaMap=null,n.envMap=null,n.combine=0,n.reflectivity=1,n.refractionRatio=.98,n.wireframe=!1,n.wireframeLinewidth=1,n.wireframeLinecap="round",n.wireframeLinejoin="round",n.fog=!0,n.setValues(e),n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e){return c(Object(l.a)(t.prototype),"copy",this).call(this,e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}}])}(Tt);var Lt=new ue,It=new j,Nt=function(){return Object(m.a)((function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(Object(p.a)(this,e),Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=n,this.count=void 0!==t?t.length/n:0,this.normalized=r,this.usage=35044,this.updateRange={offset:0,count:-1},this.gpuType=1015,this.version=0}),[{key:"onUploadCallback",value:function(){}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}},{key:"setUsage",value:function(e){return this.usage=e,this}},{key:"copy",value:function(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}},{key:"copyAt",value:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,a=this.itemSize;r<a;r++)this.array[e+r]=t.array[n+r];return this}},{key:"copyArray",value:function(e){return this.array.set(e),this}},{key:"applyMatrix3",value:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)It.fromBufferAttribute(this,t),It.applyMatrix3(e),this.setXY(t,It.x,It.y);else if(3===this.itemSize)for(var r=0,a=this.count;r<a;r++)Lt.fromBufferAttribute(this,r),Lt.applyMatrix3(e),this.setXYZ(r,Lt.x,Lt.y,Lt.z);return this}},{key:"applyMatrix4",value:function(e){for(var t=0,n=this.count;t<n;t++)Lt.fromBufferAttribute(this,t),Lt.applyMatrix4(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this}},{key:"applyNormalMatrix",value:function(e){for(var t=0,n=this.count;t<n;t++)Lt.fromBufferAttribute(this,t),Lt.applyNormalMatrix(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this}},{key:"transformDirection",value:function(e){for(var t=0,n=this.count;t<n;t++)Lt.fromBufferAttribute(this,t),Lt.transformDirection(e),this.setXYZ(t,Lt.x,Lt.y,Lt.z);return this}},{key:"set",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this}},{key:"getComponent",value:function(e,t){var n=this.array[e*this.itemSize+t];return this.normalized&&(n=N(n,this.array)),n}},{key:"setComponent",value:function(e,t,n){return this.normalized&&(n=D(n,this.array)),this.array[e*this.itemSize+t]=n,this}},{key:"getX",value:function(e){var t=this.array[e*this.itemSize];return this.normalized&&(t=N(t,this.array)),t}},{key:"setX",value:function(e,t){return this.normalized&&(t=D(t,this.array)),this.array[e*this.itemSize]=t,this}},{key:"getY",value:function(e){var t=this.array[e*this.itemSize+1];return this.normalized&&(t=N(t,this.array)),t}},{key:"setY",value:function(e,t){return this.normalized&&(t=D(t,this.array)),this.array[e*this.itemSize+1]=t,this}},{key:"getZ",value:function(e){var t=this.array[e*this.itemSize+2];return this.normalized&&(t=N(t,this.array)),t}},{key:"setZ",value:function(e,t){return this.normalized&&(t=D(t,this.array)),this.array[e*this.itemSize+2]=t,this}},{key:"getW",value:function(e){var t=this.array[e*this.itemSize+3];return this.normalized&&(t=N(t,this.array)),t}},{key:"setW",value:function(e,t){return this.normalized&&(t=D(t,this.array)),this.array[e*this.itemSize+3]=t,this}},{key:"setXY",value:function(e,t,n){return e*=this.itemSize,this.normalized&&(t=D(t,this.array),n=D(n,this.array)),this.array[e+0]=t,this.array[e+1]=n,this}},{key:"setXYZ",value:function(e,t,n,r){return e*=this.itemSize,this.normalized&&(t=D(t,this.array),n=D(n,this.array),r=D(r,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this}},{key:"setXYZW",value:function(e,t,n,r,a){return e*=this.itemSize,this.normalized&&(t=D(t,this.array),n=D(n,this.array),r=D(r,this.array),a=D(a,this.array)),this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=a,this}},{key:"onUpload",value:function(e){return this.onUploadCallback=e,this}},{key:"clone",value:function(){return new this.constructor(this.array,this.itemSize).copy(this)}},{key:"toJSON",value:function(){var e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(e.updateRange=this.updateRange),e}}])}(),Dt=function(e){function t(e,n,r){return Object(p.a)(this,t),v(this,t,[new Uint16Array(e),n,r])}return Object(h.a)(t,e),Object(m.a)(t)}(Nt),Ut=function(e){function t(e,n,r){return Object(p.a)(this,t),v(this,t,[new Uint32Array(e),n,r])}return Object(h.a)(t,e),Object(m.a)(t)}(Nt),jt=function(e){function t(e,n,r){return Object(p.a)(this,t),v(this,t,[new Float32Array(e),n,r])}return Object(h.a)(t,e),Object(m.a)(t)}(Nt),Ft=0,zt=new ze,Bt=new dt,Ht=new ue,Vt=new fe,Gt=new fe,Wt=new ue,Xt=function(e){function t(){var e;return Object(p.a)(this,t),(e=v(this,t)).isBufferGeometry=!0,Object.defineProperty(e,"id",{value:Ft++}),e.uuid=R(),e.name="",e.type="BufferGeometry",e.index=null,e.attributes={},e.morphAttributes={},e.morphTargetsRelative=!1,e.groups=[],e.boundingBox=null,e.boundingSphere=null,e.drawRange={start:0,count:1/0},e.userData={},e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return Array.isArray(e)?this.index=new(B(e)?Ut:Dt)(e,1):this.index=e,this}},{key:"getAttribute",value:function(e){return this.attributes[e]}},{key:"setAttribute",value:function(e,t){return this.attributes[e]=t,this}},{key:"deleteAttribute",value:function(e){return delete this.attributes[e],this}},{key:"hasAttribute",value:function(e){return void 0!==this.attributes[e]}},{key:"addGroup",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})}},{key:"clearGroups",value:function(){this.groups=[]}},{key:"setDrawRange",value:function(e,t){this.drawRange.start=e,this.drawRange.count=t}},{key:"applyMatrix4",value:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new F).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var a=this.attributes.tangent;return void 0!==a&&(a.transformDirection(e),a.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}},{key:"applyQuaternion",value:function(e){return zt.makeRotationFromQuaternion(e),this.applyMatrix4(zt),this}},{key:"rotateX",value:function(e){return zt.makeRotationX(e),this.applyMatrix4(zt),this}},{key:"rotateY",value:function(e){return zt.makeRotationY(e),this.applyMatrix4(zt),this}},{key:"rotateZ",value:function(e){return zt.makeRotationZ(e),this.applyMatrix4(zt),this}},{key:"translate",value:function(e,t,n){return zt.makeTranslation(e,t,n),this.applyMatrix4(zt),this}},{key:"scale",value:function(e,t,n){return zt.makeScale(e,t,n),this.applyMatrix4(zt),this}},{key:"lookAt",value:function(e){return Bt.lookAt(e),Bt.updateMatrix(),this.applyMatrix4(Bt.matrix),this}},{key:"center",value:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ht).negate(),this.translate(Ht.x,Ht.y,Ht.z),this}},{key:"setFromPoints",value:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var a=e[n];t.push(a.x,a.y,a.z||0)}return this.setAttribute("position",new jt(t,3)),this}},{key:"computeBoundingBox",value:function(){null===this.boundingBox&&(this.boundingBox=new fe);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new ue(-1/0,-1/0,-1/0),new ue(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var a=t[n];Vt.setFromBufferAttribute(a),this.morphTargetsRelative?(Wt.addVectors(this.boundingBox.min,Vt.min),this.boundingBox.expandByPoint(Wt),Wt.addVectors(this.boundingBox.max,Vt.max),this.boundingBox.expandByPoint(Wt)):(this.boundingBox.expandByPoint(Vt.min),this.boundingBox.expandByPoint(Vt.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}},{key:"computeBoundingSphere",value:function(){null===this.boundingSphere&&(this.boundingSphere=new ke);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new ue,1/0);if(e){var n=this.boundingSphere.center;if(Vt.setFromBufferAttribute(e),t)for(var r=0,a=t.length;r<a;r++){var i=t[r];Gt.setFromBufferAttribute(i),this.morphTargetsRelative?(Wt.addVectors(Vt.min,Gt.min),Vt.expandByPoint(Wt),Wt.addVectors(Vt.max,Gt.max),Vt.expandByPoint(Wt)):(Vt.expandByPoint(Gt.min),Vt.expandByPoint(Gt.max))}Vt.getCenter(n);for(var o=0,s=0,l=e.count;s<l;s++)Wt.fromBufferAttribute(e,s),o=Math.max(o,n.distanceToSquared(Wt));if(t)for(var c=0,u=t.length;c<u;c++)for(var d=t[c],h=this.morphTargetsRelative,f=0,p=d.count;f<p;f++)Wt.fromBufferAttribute(d,f),h&&(Ht.fromBufferAttribute(e,f),Wt.add(Ht)),o=Math.max(o,n.distanceToSquared(Wt));this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}},{key:"computeTangents",value:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,a=t.normal.array,i=t.uv.array,o=r.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new Nt(new Float32Array(4*o),4));for(var s=this.getAttribute("tangent").array,l=[],c=[],u=0;u<o;u++)l[u]=new ue,c[u]=new ue;var d=new ue,h=new ue,f=new ue,p=new j,m=new j,v=new j,g=new ue,y=new ue,b=this.groups;0===b.length&&(b=[{start:0,count:n.length}]);for(var _=0,x=b.length;_<x;++_)for(var E=b[_],S=E.start,M=S,T=S+E.count;M<T;M+=3)D(n[M+0],n[M+1],n[M+2]);for(var w=new ue,O=new ue,A=new ue,R=new ue,C=0,k=b.length;C<k;++C)for(var P=b[C],L=P.start,I=L,N=L+P.count;I<N;I+=3)U(n[I+0]),U(n[I+1]),U(n[I+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function D(e,t,n){d.fromArray(r,3*e),h.fromArray(r,3*t),f.fromArray(r,3*n),p.fromArray(i,2*e),m.fromArray(i,2*t),v.fromArray(i,2*n),h.sub(d),f.sub(d),m.sub(p),v.sub(p);var a=1/(m.x*v.y-v.x*m.y);isFinite(a)&&(g.copy(h).multiplyScalar(v.y).addScaledVector(f,-m.y).multiplyScalar(a),y.copy(f).multiplyScalar(m.x).addScaledVector(h,-v.x).multiplyScalar(a),l[e].add(g),l[t].add(g),l[n].add(g),c[e].add(y),c[t].add(y),c[n].add(y))}function U(e){A.fromArray(a,3*e),R.copy(A);var t=l[e];w.copy(t),w.sub(A.multiplyScalar(A.dot(t))).normalize(),O.crossVectors(R,t);var n=O.dot(c[e])<0?-1:1;s[4*e]=w.x,s[4*e+1]=w.y,s[4*e+2]=w.z,s[4*e+3]=n}}},{key:"computeVertexNormals",value:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new Nt(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,a=n.count;r<a;r++)n.setXYZ(r,0,0,0);var i=new ue,o=new ue,s=new ue,l=new ue,c=new ue,u=new ue,d=new ue,h=new ue;if(e)for(var f=0,p=e.count;f<p;f+=3){var m=e.getX(f+0),v=e.getX(f+1),g=e.getX(f+2);i.fromBufferAttribute(t,m),o.fromBufferAttribute(t,v),s.fromBufferAttribute(t,g),d.subVectors(s,o),h.subVectors(i,o),d.cross(h),l.fromBufferAttribute(n,m),c.fromBufferAttribute(n,v),u.fromBufferAttribute(n,g),l.add(d),c.add(d),u.add(d),n.setXYZ(m,l.x,l.y,l.z),n.setXYZ(v,c.x,c.y,c.z),n.setXYZ(g,u.x,u.y,u.z)}else for(var y=0,b=t.count;y<b;y+=3)i.fromBufferAttribute(t,y+0),o.fromBufferAttribute(t,y+1),s.fromBufferAttribute(t,y+2),d.subVectors(s,o),h.subVectors(i,o),d.cross(h),n.setXYZ(y+0,d.x,d.y,d.z),n.setXYZ(y+1,d.x,d.y,d.z),n.setXYZ(y+2,d.x,d.y,d.z);this.normalizeNormals(),n.needsUpdate=!0}}},{key:"normalizeNormals",value:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)Wt.fromBufferAttribute(e,t),Wt.normalize(),e.setXYZ(t,Wt.x,Wt.y,Wt.z)}},{key:"toNonIndexed",value:function(){function e(e,t){for(var n=e.array,r=e.itemSize,a=e.normalized,i=new n.constructor(t.length*r),o=0,s=0,l=0,c=t.length;l<c;l++){o=e.isInterleavedBufferAttribute?t[l]*e.data.stride+e.offset:t[l]*r;for(var u=0;u<r;u++)i[s++]=n[o++]}return new Nt(i,r,a)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var n=new t,r=this.index.array,a=this.attributes;for(var i in a){var o=e(a[i],r);n.setAttribute(i,o)}var s=this.morphAttributes;for(var l in s){for(var c=[],u=s[l],d=0,h=u.length;d<h;d++){var f=e(u[d],r);c.push(f)}n.morphAttributes[l]=c}n.morphTargetsRelative=this.morphTargetsRelative;for(var p=this.groups,m=0,v=p.length;m<v;m++){var g=p[m];n.addGroup(g.start,g.count,g.materialIndex)}return n}},{key:"toJSON",value:function(){var e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){var t=this.parameters;for(var n in t)void 0!==t[n]&&(e[n]=t[n]);return e}e.data={attributes:{}};var r=this.index;null!==r&&(e.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});var a=this.attributes;for(var i in a){var o=a[i];e.data.attributes[i]=o.toJSON(e.data)}var s={},l=!1;for(var c in this.morphAttributes){for(var u=this.morphAttributes[c],d=[],h=0,f=u.length;h<f;h++){var p=u[h];d.push(p.toJSON(e.data))}d.length>0&&(s[c]=d,l=!0)}l&&(e.data.morphAttributes=s,e.data.morphTargetsRelative=this.morphTargetsRelative);var m=this.groups;m.length>0&&(e.data.groups=JSON.parse(JSON.stringify(m)));var v=this.boundingSphere;return null!==v&&(e.data.boundingSphere={center:v.center.toArray(),radius:v.radius}),e}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var t={};this.name=e.name;var n=e.index;null!==n&&this.setIndex(n.clone(t));var r=e.attributes;for(var a in r){var i=r[a];this.setAttribute(a,i.clone(t))}var o=e.morphAttributes;for(var s in o){for(var l=[],c=o[s],u=0,d=c.length;u<d;u++)l.push(c[u].clone(t));this.morphAttributes[s]=l}this.morphTargetsRelative=e.morphTargetsRelative;for(var h=e.groups,f=0,p=h.length;f<p;f++){var m=h[f];this.addGroup(m.start,m.count,m.materialIndex)}var v=e.boundingBox;null!==v&&(this.boundingBox=v.clone());var g=e.boundingSphere;return null!==g&&(this.boundingSphere=g.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}])}(T),qt=new ze,Yt=new Fe,Kt=new ke,Zt=new ue,Jt=new ue,Qt=new ue,$t=new ue,en=new ue,tn=new ue,nn=new j,rn=new j,an=new j,on=new ue,sn=new ue,ln=new ue,cn=new ue,un=new ue,dn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Xt,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Pt;return Object(p.a)(this,t),(e=v(this,t)).isMesh=!0,e.type="Mesh",e.geometry=n,e.material=r,e.updateMorphTargets(),e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e,n){return c(Object(l.a)(t.prototype),"copy",this).call(this,e,n),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=e.material,this.geometry=e.geometry,this}},{key:"updateMorphTargets",value:function(){var e=this.geometry.morphAttributes,t=Object.keys(e);if(t.length>0){var n=e[t[0]];if(void 0!==n){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var r=0,a=n.length;r<a;r++){var i=n[r].name||String(r);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=r}}}}},{key:"getVertexPosition",value:function(e,t){var n=this.geometry,r=n.attributes.position,a=n.morphAttributes.position,i=n.morphTargetsRelative;t.fromBufferAttribute(r,e);var o=this.morphTargetInfluences;if(a&&o){tn.set(0,0,0);for(var s=0,l=a.length;s<l;s++){var c=o[s],u=a[s];0!==c&&(en.fromBufferAttribute(u,e),i?tn.addScaledVector(en,c):tn.addScaledVector(en.sub(t),c))}t.add(tn)}return t}},{key:"raycast",value:function(e,t){var n=this.geometry,r=this.material,a=this.matrixWorld;if(void 0!==r){if(null===n.boundingSphere&&n.computeBoundingSphere(),Kt.copy(n.boundingSphere),Kt.applyMatrix4(a),Yt.copy(e.ray).recast(e.near),!1===Kt.containsPoint(Yt.origin)){if(null===Yt.intersectSphere(Kt,Zt))return;if(Yt.origin.distanceToSquared(Zt)>Math.pow(e.far-e.near,2))return}qt.copy(a).invert(),Yt.copy(e.ray).applyMatrix4(qt),null!==n.boundingBox&&!1===Yt.intersectsBox(n.boundingBox)||this._computeIntersections(e,t,Yt)}}},{key:"_computeIntersections",value:function(e,t,n){var r,a=this.geometry,i=this.material,o=a.index,s=a.attributes.position,l=a.attributes.uv,c=a.attributes.uv1,u=a.attributes.normal,d=a.groups,h=a.drawRange;if(null!==o)if(Array.isArray(i))for(var f=0,p=d.length;f<p;f++)for(var m=d[f],v=i[m.materialIndex],g=Math.max(m.start,h.start),y=Math.min(o.count,Math.min(m.start+m.count,h.start+h.count));g<y;g+=3){(r=hn(this,v,e,n,l,c,u,o.getX(g),o.getX(g+1),o.getX(g+2)))&&(r.faceIndex=Math.floor(g/3),r.face.materialIndex=m.materialIndex,t.push(r))}else for(var b=Math.max(0,h.start),_=Math.min(o.count,h.start+h.count);b<_;b+=3){(r=hn(this,i,e,n,l,c,u,o.getX(b),o.getX(b+1),o.getX(b+2)))&&(r.faceIndex=Math.floor(b/3),t.push(r))}else if(void 0!==s)if(Array.isArray(i))for(var x=0,E=d.length;x<E;x++)for(var S=d[x],M=i[S.materialIndex],T=Math.max(S.start,h.start),w=Math.min(s.count,Math.min(S.start+S.count,h.start+h.count));T<w;T+=3){(r=hn(this,M,e,n,l,c,u,T,T+1,T+2))&&(r.faceIndex=Math.floor(T/3),r.face.materialIndex=S.materialIndex,t.push(r))}else for(var O=Math.max(0,h.start),A=Math.min(s.count,h.start+h.count);O<A;O+=3){(r=hn(this,i,e,n,l,c,u,O,O+1,O+2))&&(r.faceIndex=Math.floor(O/3),t.push(r))}}}])}(dt);function hn(e,t,n,r,a,i,o,s,l,c){e.getVertexPosition(s,Jt),e.getVertexPosition(l,Qt),e.getVertexPosition(c,$t);var u=function(e,t,n,r,a,i,o,s){if(null===(1===t.side?r.intersectTriangle(o,i,a,!0,s):r.intersectTriangle(a,i,o,0===t.side,s)))return null;un.copy(s),un.applyMatrix4(e.matrixWorld);var l=n.ray.origin.distanceTo(un);return l<n.near||l>n.far?null:{distance:l,point:un.clone(),object:e}}(e,t,n,r,Jt,Qt,$t,cn);if(u){a&&(nn.fromBufferAttribute(a,s),rn.fromBufferAttribute(a,l),an.fromBufferAttribute(a,c),u.uv=St.getInterpolation(cn,Jt,Qt,$t,nn,rn,an,new j)),i&&(nn.fromBufferAttribute(i,s),rn.fromBufferAttribute(i,l),an.fromBufferAttribute(i,c),u.uv1=St.getInterpolation(cn,Jt,Qt,$t,nn,rn,an,new j),u.uv2=u.uv1),o&&(on.fromBufferAttribute(o,s),sn.fromBufferAttribute(o,l),ln.fromBufferAttribute(o,c),u.normal=St.getInterpolation(cn,Jt,Qt,$t,on,sn,ln,new ue),u.normal.dot(r.direction)>0&&u.normal.multiplyScalar(-1));var d={a:s,b:l,c:c,normal:new ue,materialIndex:0};St.getNormal(Jt,Qt,$t,d.normal),u.face=d}return u}var fn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(p.a)(this,t),(e=v(this,t)).type="BoxGeometry",e.parameters={width:n,height:r,depth:a,widthSegments:i,heightSegments:o,depthSegments:s};var l=e;i=Math.floor(i),o=Math.floor(o),s=Math.floor(s);var c=[],u=[],d=[],h=[],f=0,m=0;function g(e,t,n,r,a,i,o,s,p,v,g){for(var y=i/p,b=o/v,_=i/2,x=o/2,E=s/2,S=p+1,M=v+1,T=0,w=0,O=new ue,A=0;A<M;A++)for(var R=A*b-x,C=0;C<S;C++){var k=C*y-_;O[e]=k*r,O[t]=R*a,O[n]=E,u.push(O.x,O.y,O.z),O[e]=0,O[t]=0,O[n]=s>0?1:-1,d.push(O.x,O.y,O.z),h.push(C/p),h.push(1-A/v),T+=1}for(var P=0;P<v;P++)for(var L=0;L<p;L++){var I=f+L+S*P,N=f+L+S*(P+1),D=f+(L+1)+S*(P+1),U=f+(L+1)+S*P;c.push(I,N,U),c.push(N,D,U),w+=6}l.addGroup(m,w,g),m+=w,f+=T}return g("z","y","x",-1,-1,a,r,n,s,o,0),g("z","y","x",1,-1,a,r,-n,s,o,1),g("x","z","y",1,1,n,a,r,i,s,2),g("x","z","y",1,-1,n,a,-r,i,s,3),g("x","y","z",1,-1,n,r,a,i,o,4),g("x","y","z",-1,-1,n,r,-a,i,o,5),e.setIndex(c),e.setAttribute("position",new jt(u,3)),e.setAttribute("normal",new jt(d,3)),e.setAttribute("uv",new jt(h,2)),e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e){return c(Object(l.a)(t.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.width,e.height,e.depth,e.widthSegments,e.heightSegments,e.depthSegments)}}])}(Xt);function pn(e){var t={};for(var n in e)for(var r in t[n]={},e[n]){var a=e[n][r];a&&(a.isColor||a.isMatrix3||a.isMatrix4||a.isVector2||a.isVector3||a.isVector4||a.isTexture||a.isQuaternion)?a.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[n][r]=null):t[n][r]=a.clone():Array.isArray(a)?t[n][r]=a.slice():t[n][r]=a}return t}function mn(e){for(var t={},n=0;n<e.length;n++){var r=pn(e[n]);for(var a in r)t[a]=r[a]}return t}function vn(e){return null===e.getRenderTarget()?e.outputColorSpace:"srgb-linear"}var gn={clone:pn,merge:mn},yn=function(e){function t(e){var n;return Object(p.a)(this,t),(n=v(this,t)).isShaderMaterial=!0,n.type="ShaderMaterial",n.defines={},n.uniforms={},n.uniformsGroups=[],n.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",n.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",n.linewidth=1,n.wireframe=!1,n.wireframeLinewidth=1,n.fog=!1,n.lights=!1,n.clipping=!1,n.forceSinglePass=!0,n.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},n.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},n.index0AttributeName=void 0,n.uniformsNeedUpdate=!1,n.glslVersion=null,void 0!==e&&n.setValues(e),n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e){return c(Object(l.a)(t.prototype),"copy",this).call(this,e),this.fragmentShader=e.fragmentShader,this.vertexShader=e.vertexShader,this.uniforms=pn(e.uniforms),this.uniformsGroups=function(e){for(var t=[],n=0;n<e.length;n++)t.push(e[n].clone());return t}(e.uniformsGroups),this.defines=Object.assign({},e.defines),this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.fog=e.fog,this.lights=e.lights,this.clipping=e.clipping,this.extensions=Object.assign({},e.extensions),this.glslVersion=e.glslVersion,this}},{key:"toJSON",value:function(e){var n=c(Object(l.a)(t.prototype),"toJSON",this).call(this,e);for(var r in n.glslVersion=this.glslVersion,n.uniforms={},this.uniforms){var a=this.uniforms[r].value;a&&a.isTexture?n.uniforms[r]={type:"t",value:a.toJSON(e).uuid}:a&&a.isColor?n.uniforms[r]={type:"c",value:a.getHex()}:a&&a.isVector2?n.uniforms[r]={type:"v2",value:a.toArray()}:a&&a.isVector3?n.uniforms[r]={type:"v3",value:a.toArray()}:a&&a.isVector4?n.uniforms[r]={type:"v4",value:a.toArray()}:a&&a.isMatrix3?n.uniforms[r]={type:"m3",value:a.toArray()}:a&&a.isMatrix4?n.uniforms[r]={type:"m4",value:a.toArray()}:n.uniforms[r]={value:a}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader,n.lights=this.lights,n.clipping=this.clipping;var i={};for(var o in this.extensions)!0===this.extensions[o]&&(i[o]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}])}(Tt),bn=function(e){function t(){var e;return Object(p.a)(this,t),(e=v(this,t)).isCamera=!0,e.type="Camera",e.matrixWorldInverse=new ze,e.projectionMatrix=new ze,e.projectionMatrixInverse=new ze,e.coordinateSystem=2e3,e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e,n){return c(Object(l.a)(t.prototype),"copy",this).call(this,e,n),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}},{key:"getWorldDirection",value:function(e){this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()}},{key:"updateMatrixWorld",value:function(e){c(Object(l.a)(t.prototype),"updateMatrixWorld",this).call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"updateWorldMatrix",value:function(e,n){c(Object(l.a)(t.prototype),"updateWorldMatrix",this).call(this,e,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])}(dt),_n=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;return Object(p.a)(this,t),(e=v(this,t)).isPerspectiveCamera=!0,e.type="PerspectiveCamera",e.fov=n,e.zoom=1,e.near=a,e.far=i,e.focus=10,e.aspect=r,e.view=null,e.filmGauge=35,e.filmOffset=0,e.updateProjectionMatrix(),e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e,n){return c(Object(l.a)(t.prototype),"copy",this).call(this,e,n),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}},{key:"setFocalLength",value:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*A*Math.atan(t),this.updateProjectionMatrix()}},{key:"getFocalLength",value:function(){var e=Math.tan(.5*O*this.fov);return.5*this.getFilmHeight()/e}},{key:"getEffectiveFOV",value:function(){return 2*A*Math.atan(Math.tan(.5*O*this.fov)/this.zoom)}},{key:"getFilmWidth",value:function(){return this.filmGauge*Math.min(this.aspect,1)}},{key:"getFilmHeight",value:function(){return this.filmGauge/Math.max(this.aspect,1)}},{key:"setViewOffset",value:function(e,t,n,r,a,i){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=this.near,t=e*Math.tan(.5*O*this.fov)/this.zoom,n=2*t,r=this.aspect*n,a=-.5*r,i=this.view;if(null!==this.view&&this.view.enabled){var o=i.fullWidth,s=i.fullHeight;a+=i.offsetX*r/o,t-=i.offsetY*n/s,r*=i.width/o,n*=i.height/s}var l=this.filmOffset;0!==l&&(a+=e*l/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+r,t,t-n,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var n=c(Object(l.a)(t.prototype),"toJSON",this).call(this,e);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,null!==this.view&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}])}(bn),xn=function(e){function t(e,n,r){var a;Object(p.a)(this,t),(a=v(this,t)).type="CubeCamera",a.renderTarget=r,a.coordinateSystem=null;var i=new _n(-90,1,e,n);i.layers=a.layers,a.add(i);var o=new _n(-90,1,e,n);o.layers=a.layers,a.add(o);var s=new _n(-90,1,e,n);s.layers=a.layers,a.add(s);var l=new _n(-90,1,e,n);l.layers=a.layers,a.add(l);var c=new _n(-90,1,e,n);c.layers=a.layers,a.add(c);var u=new _n(-90,1,e,n);return u.layers=a.layers,a.add(u),a}return Object(h.a)(t,e),Object(m.a)(t,[{key:"updateCoordinateSystem",value:function(){var e,t=this.coordinateSystem,n=this.children.concat(),r=Object(s.a)(n,6),a=r[0],i=r[1],l=r[2],c=r[3],u=r[4],d=r[5],h=Object(o.a)(n);try{for(h.s();!(e=h.n()).done;){var f=e.value;this.remove(f)}}catch(g){h.e(g)}finally{h.f()}if(2e3===t)a.up.set(0,1,0),a.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),l.up.set(0,0,-1),l.lookAt(0,1,0),c.up.set(0,0,1),c.lookAt(0,-1,0),u.up.set(0,1,0),u.lookAt(0,0,1),d.up.set(0,1,0),d.lookAt(0,0,-1);else{if(2001!==t)throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);a.up.set(0,-1,0),a.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),l.up.set(0,0,1),l.lookAt(0,1,0),c.up.set(0,0,-1),c.lookAt(0,-1,0),u.up.set(0,-1,0),u.lookAt(0,0,1),d.up.set(0,-1,0),d.lookAt(0,0,-1)}var p,m=Object(o.a)(n);try{for(m.s();!(p=m.n()).done;){var v=p.value;this.add(v),v.updateMatrixWorld()}}catch(g){m.e(g)}finally{m.f()}}},{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget;this.coordinateSystem!==e.coordinateSystem&&(this.coordinateSystem=e.coordinateSystem,this.updateCoordinateSystem());var r=Object(s.a)(this.children,6),a=r[0],i=r[1],o=r[2],l=r[3],c=r[4],u=r[5],d=e.getRenderTarget(),h=e.xr.enabled;e.xr.enabled=!1;var f=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,a),e.setRenderTarget(n,1),e.render(t,i),e.setRenderTarget(n,2),e.render(t,o),e.setRenderTarget(n,3),e.render(t,l),e.setRenderTarget(n,4),e.render(t,c),n.texture.generateMipmaps=f,e.setRenderTarget(n,5),e.render(t,u),e.setRenderTarget(d),e.xr.enabled=h,n.texture.needsPMREMUpdate=!0}}])}(dt),En=function(e){function t(e,n,r,a,i,o,s,l,c,u){var d;return Object(p.a)(this,t),(d=v(this,t,[e=void 0!==e?e:[],n=void 0!==n?n:301,r,a,i,o,s,l,c,u])).isCubeTexture=!0,d.flipY=!1,d}return Object(h.a)(t,e),Object(m.a)(t,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}])}(ae),Sn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Object(p.a)(this,t),(e=v(this,t,[n,n,r])).isWebGLCubeRenderTarget=!0;var a={width:n,height:n,depth:1},i=[a,a,a,a,a,a];return void 0!==r.encoding&&(G("THREE.WebGLCubeRenderTarget: option.encoding has been replaced by option.colorSpace."),r.colorSpace=3001===r.encoding?"srgb":""),e.texture=new En(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),e.texture.isRenderTargetTexture=!0,e.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,e.texture.minFilter=void 0!==r.minFilter?r.minFilter:1006,e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.colorSpace=t.colorSpace,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",a="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",i=new fn(5,5,5),o=new yn({name:"CubemapFromEquirect",uniforms:pn(n),vertexShader:r,fragmentShader:a,side:1,blending:0});o.uniforms.tEquirect.value=t;var s=new dn(i,o),l=t.minFilter;return 1008===t.minFilter&&(t.minFilter=1006),new xn(1,10,this).update(e,s),t.minFilter=l,s.geometry.dispose(),s.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var a=e.getRenderTarget(),i=0;i<6;i++)e.setRenderTarget(this,i),e.clear(t,n,r);e.setRenderTarget(a)}}])}(oe),Mn=new ue,Tn=new ue,wn=new F,On=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new ue(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(p.a)(this,e),this.isPlane=!0,this.normal=t,this.constant=n}),[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(e,t,n){var r=Mn.subVectors(n,t).cross(Tn.subVectors(e,t)).normalize();return this.setFromNormalAndCoplanarPoint(r,e),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return t.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}},{key:"intersectLine",value:function(e,t){var n=e.delta(Mn),r=this.normal.dot(n);if(0===r)return 0===this.distanceToPoint(e.start)?t.copy(e.start):null;var a=-(e.start.dot(this.normal)+this.constant)/r;return a<0||a>1?null:t.copy(e.start).addScaledVector(n,a)}},{key:"intersectsLine",value:function(e){var t=this.distanceToPoint(e.start),n=this.distanceToPoint(e.end);return t<0&&n>0||n<0&&t>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||wn.getNormalMatrix(e),r=this.coplanarPoint(Mn).applyMatrix4(e),a=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(a),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])}(),An=new ke,Rn=new ue,Cn=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new On,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new On,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new On,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new On,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new On,o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new On;Object(p.a)(this,e),this.planes=[t,n,r,a,i,o]}),[{key:"set",value:function(e,t,n,r,a,i){var o=this.planes;return o[0].copy(e),o[1].copy(t),o[2].copy(n),o[3].copy(r),o[4].copy(a),o[5].copy(i),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2e3,n=this.planes,r=e.elements,a=r[0],i=r[1],o=r[2],s=r[3],l=r[4],c=r[5],u=r[6],d=r[7],h=r[8],f=r[9],p=r[10],m=r[11],v=r[12],g=r[13],y=r[14],b=r[15];if(n[0].setComponents(s-a,d-l,m-h,b-v).normalize(),n[1].setComponents(s+a,d+l,m+h,b+v).normalize(),n[2].setComponents(s+i,d+c,m+f,b+g).normalize(),n[3].setComponents(s-i,d-c,m-f,b-g).normalize(),n[4].setComponents(s-o,d-u,m-p,b-y).normalize(),2e3===t)n[5].setComponents(s+o,d+u,m+p,b+y).normalize();else{if(2001!==t)throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+t);n[5].setComponents(o,u,p,y).normalize()}return this}},{key:"intersectsObject",value:function(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),An.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{var t=e.geometry;null===t.boundingSphere&&t.computeBoundingSphere(),An.copy(t.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(An)}},{key:"intersectsSprite",value:function(e){return An.center.set(0,0,0),An.radius=.7071067811865476,An.applyMatrix4(e.matrixWorld),this.intersectsSphere(An)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,a=0;a<6;a++){if(t[a].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(Rn.x=r.normal.x>0?e.max.x:e.min.x,Rn.y=r.normal.y>0?e.max.y:e.min.y,Rn.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(Rn)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])}();function kn(){var e=null,t=!1,n=null,r=null;function a(t,i){n(t,i),r=e.requestAnimationFrame(a)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(a),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function Pn(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var n=r.get(t);n&&(e.deleteBuffer(n.buffer),r.delete(t))},update:function(t,a){if(t.isGLBufferAttribute){var i=r.get(t);(!i||i.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var o=r.get(t);void 0===o?r.set(t,function(t,r){var a,i=t.array,o=t.usage,s=e.createBuffer();if(e.bindBuffer(r,s),e.bufferData(r,i,o),t.onUploadCallback(),i instanceof Float32Array)a=e.FLOAT;else if(i instanceof Uint16Array)if(t.isFloat16BufferAttribute){if(!n)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");a=e.HALF_FLOAT}else a=e.UNSIGNED_SHORT;else if(i instanceof Int16Array)a=e.SHORT;else if(i instanceof Uint32Array)a=e.UNSIGNED_INT;else if(i instanceof Int32Array)a=e.INT;else if(i instanceof Int8Array)a=e.BYTE;else if(i instanceof Uint8Array)a=e.UNSIGNED_BYTE;else{if(!(i instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+i);a=e.UNSIGNED_BYTE}return{buffer:s,type:a,bytesPerElement:i.BYTES_PER_ELEMENT,version:t.version}}(t,a)):o.version<t.version&&(!function(t,r,a){var i=r.array,o=r.updateRange;e.bindBuffer(a,t),-1===o.count?e.bufferSubData(a,0,i):(n?e.bufferSubData(a,o.offset*i.BYTES_PER_ELEMENT,i,o.offset,o.count):e.bufferSubData(a,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1),r.onUploadCallback()}(o.buffer,t,a),o.version=t.version)}}}}var Ln=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(p.a)(this,t),(e=v(this,t)).type="PlaneGeometry",e.parameters={width:n,height:r,widthSegments:a,heightSegments:i};for(var o=n/2,s=r/2,l=Math.floor(a),c=Math.floor(i),u=l+1,d=c+1,h=n/l,f=r/c,m=[],g=[],y=[],b=[],_=0;_<d;_++)for(var x=_*f-s,E=0;E<u;E++){var S=E*h-o;g.push(S,-x,0),y.push(0,0,1),b.push(E/l),b.push(1-_/c)}for(var M=0;M<c;M++)for(var T=0;T<l;T++){var w=T+u*M,O=T+u*(M+1),A=T+1+u*(M+1),R=T+1+u*M;m.push(w,O,R),m.push(O,A,R)}return e.setIndex(m),e.setAttribute("position",new jt(g,3)),e.setAttribute("normal",new jt(y,3)),e.setAttribute("uv",new jt(b,2)),e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e){return c(Object(l.a)(t.prototype),"copy",this).call(this,e),this.parameters=Object.assign({},e.parameters),this}}],[{key:"fromJSON",value:function(e){return new t(e.width,e.height,e.widthSegments,e.heightSegments)}}])}(Xt),In={alphahash_fragment:"#ifdef USE_ALPHAHASH\n\tif ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;\n#endif",alphahash_pars_fragment:"#ifdef USE_ALPHAHASH\n\tconst float ALPHA_HASH_SCALE = 0.05;\n\tfloat hash2D( vec2 value ) {\n\t\treturn fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );\n\t}\n\tfloat hash3D( vec3 value ) {\n\t\treturn hash2D( vec2( hash2D( value.xy ), value.z ) );\n\t}\n\tfloat getAlphaHashThreshold( vec3 position ) {\n\t\tfloat maxDeriv = max(\n\t\t\tlength( dFdx( position.xyz ) ),\n\t\t\tlength( dFdy( position.xyz ) )\n\t\t);\n\t\tfloat pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );\n\t\tvec2 pixScales = vec2(\n\t\t\texp2( floor( log2( pixScale ) ) ),\n\t\t\texp2( ceil( log2( pixScale ) ) )\n\t\t);\n\t\tvec2 alpha = vec2(\n\t\t\thash3D( floor( pixScales.x * position.xyz ) ),\n\t\t\thash3D( floor( pixScales.y * position.xyz ) )\n\t\t);\n\t\tfloat lerpFactor = fract( log2( pixScale ) );\n\t\tfloat x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;\n\t\tfloat a = min( lerpFactor, 1.0 - lerpFactor );\n\t\tvec3 cases = vec3(\n\t\t\tx * x / ( 2.0 * a * ( 1.0 - a ) ),\n\t\t\t( x - 0.5 * a ) / ( 1.0 - a ),\n\t\t\t1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )\n\t\t);\n\t\tfloat threshold = ( x < ( 1.0 - a ) )\n\t\t\t? ( ( x < a ) ? cases.x : cases.y )\n\t\t\t: cases.z;\n\t\treturn clamp( threshold , 1.0e-6, 1.0 );\n\t}\n#endif",alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );\n#ifdef USE_ALPHAHASH\n\tvPosition = vec3( position );\n#endif",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"float G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n} // validated",iridescence_fragment:"#ifdef USE_IRIDESCENCE\n\tconst mat3 XYZ_TO_REC709 = mat3(\n\t\t 3.2404542, -0.9692660,  0.0556434,\n\t\t-1.5371385,  1.8760108, -0.2040259,\n\t\t-0.4985314,  0.0415560,  1.0572252\n\t);\n\tvec3 Fresnel0ToIor( vec3 fresnel0 ) {\n\t\tvec3 sqrtF0 = sqrt( fresnel0 );\n\t\treturn ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );\n\t}\n\tvec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );\n\t}\n\tfloat IorToFresnel0( float transmittedIor, float incidentIor ) {\n\t\treturn pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));\n\t}\n\tvec3 evalSensitivity( float OPD, vec3 shift ) {\n\t\tfloat phase = 2.0 * PI * OPD * 1.0e-9;\n\t\tvec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );\n\t\tvec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );\n\t\tvec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );\n\t\tvec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );\n\t\txyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );\n\t\txyz /= 1.0685e-7;\n\t\tvec3 rgb = XYZ_TO_REC709 * xyz;\n\t\treturn rgb;\n\t}\n\tvec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {\n\t\tvec3 I;\n\t\tfloat iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );\n\t\tfloat sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );\n\t\tfloat cosTheta2Sq = 1.0 - sinTheta2Sq;\n\t\tif ( cosTheta2Sq < 0.0 ) {\n\t\t\treturn vec3( 1.0 );\n\t\t}\n\t\tfloat cosTheta2 = sqrt( cosTheta2Sq );\n\t\tfloat R0 = IorToFresnel0( iridescenceIOR, outsideIOR );\n\t\tfloat R12 = F_Schlick( R0, 1.0, cosTheta1 );\n\t\tfloat T121 = 1.0 - R12;\n\t\tfloat phi12 = 0.0;\n\t\tif ( iridescenceIOR < outsideIOR ) phi12 = PI;\n\t\tfloat phi21 = PI - phi12;\n\t\tvec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );\t\tvec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );\n\t\tvec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );\n\t\tvec3 phi23 = vec3( 0.0 );\n\t\tif ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;\n\t\tif ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;\n\t\tif ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;\n\t\tfloat OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;\n\t\tvec3 phi = vec3( phi21 ) + phi23;\n\t\tvec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );\n\t\tvec3 r123 = sqrt( R123 );\n\t\tvec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );\n\t\tvec3 C0 = R12 + Rs;\n\t\tI = C0;\n\t\tvec3 Cm = Rs - T121;\n\t\tfor ( int m = 1; m <= 2; ++ m ) {\n\t\t\tCm *= r123;\n\t\t\tvec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );\n\t\t\tI += Cm * Sm;\n\t\t}\n\t\treturn max( I, vec3( 0.0 ) );\n\t}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vBumpMapUv );\n\t\tvec2 dSTdy = dFdy( vBumpMapUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = dFdx( surf_pos.xyz );\n\t\tvec3 vSigmaY = dFdy( surf_pos.xyz );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nvec3 pow2( const in vec3 x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\n#ifdef USE_ALPHAHASH\n\tvarying vec3 vPosition;\n#endif\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat luminance( const in vec3 rgb ) {\n\tconst vec3 weights = vec3( 0.2126729, 0.7151522, 0.0721750 );\n\treturn dot( weights, rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}\nvec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat F_Schlick( const in float f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n} // validated",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\thighp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define cubeUV_r0 1.0\n\t#define cubeUV_v0 0.339\n\t#define cubeUV_m0 - 2.0\n\t#define cubeUV_r1 0.8\n\t#define cubeUV_v1 0.276\n\t#define cubeUV_m1 - 1.0\n\t#define cubeUV_r4 0.4\n\t#define cubeUV_v4 0.046\n\t#define cubeUV_m4 2.0\n\t#define cubeUV_r5 0.305\n\t#define cubeUV_v5 0.016\n\t#define cubeUV_m5 3.0\n\t#define cubeUV_r6 0.21\n\t#define cubeUV_v6 0.0038\n\t#define cubeUV_m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= cubeUV_r1 ) {\n\t\t\tmip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;\n\t\t} else if ( roughness >= cubeUV_r4 ) {\n\t\t\tmip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;\n\t\t} else if ( roughness >= cubeUV_r5 ) {\n\t\t\tmip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;\n\t\t} else if ( roughness >= cubeUV_r6 ) {\n\t\t\tmip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",colorspace_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",colorspace_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#ifdef USE_ENVMAP\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\t#ifdef USE_ANISOTROPY\n\t\tvec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {\n\t\t\t#ifdef ENVMAP_TYPE_CUBE_UV\n\t\t\t\tvec3 bentNormal = cross( bitangent, viewDir );\n\t\t\t\tbentNormal = normalize( cross( bentNormal, bitangent ) );\n\t\t\t\tbentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );\n\t\t\t\treturn getIBLRadiance( viewDir, bentNormal, roughness );\n\t\t\t#else\n\t\t\t\treturn vec3( 0.0 );\n\t\t\t#endif\n\t\t}\n\t#endif\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\tvec2 fw = fwidth( coord ) * 0.5;\n\t\treturn mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_fragment:"LambertMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularStrength = specularStrength;",lights_lambert_pars_fragment:"varying vec3 vViewPosition;\nstruct LambertMaterial {\n\tvec3 diffuseColor;\n\tfloat specularStrength;\n};\nvoid RE_Direct_Lambert( const in IncidentLight directLight, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in GeometricContext geometry, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Lambert\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Lambert",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( LEGACY_LIGHTS )\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#else\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\tmaterial.ior = ior;\n\t#ifdef USE_SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULAR_COLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;\n\t\t#endif\n\t\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_IRIDESCENCE\n\tmaterial.iridescence = iridescence;\n\tmaterial.iridescenceIOR = iridescenceIOR;\n\t#ifdef USE_IRIDESCENCEMAP\n\t\tmaterial.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;\n\t#endif\n\t#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\t\tmaterial.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;\n\t#else\n\t\tmaterial.iridescenceThickness = iridescenceThicknessMaximum;\n\t#endif\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\t#ifdef USE_ANISOTROPYMAP\n\t\tmat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );\n\t\tvec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;\n\t\tvec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;\n\t#else\n\t\tvec2 anisotropyV = anisotropyVector;\n\t#endif\n\tmaterial.anisotropy = length( anisotropyV );\n\tanisotropyV /= material.anisotropy;\n\tmaterial.anisotropy = saturate( material.anisotropy );\n\tmaterial.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );\n\tmaterial.anisotropyT = tbn[ 0 ] * anisotropyV.x - tbn[ 1 ] * anisotropyV.y;\n\tmaterial.anisotropyB = tbn[ 1 ] * anisotropyV.x + tbn[ 0 ] * anisotropyV.y;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_IRIDESCENCE\n\t\tfloat iridescence;\n\t\tfloat iridescenceIOR;\n\t\tfloat iridescenceThickness;\n\t\tvec3 iridescenceFresnel;\n\t\tvec3 iridescenceF0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n\t#ifdef IOR\n\t\tfloat ior;\n\t#endif\n\t#ifdef USE_TRANSMISSION\n\t\tfloat transmission;\n\t\tfloat transmissionAlpha;\n\t\tfloat thickness;\n\t\tfloat attenuationDistance;\n\t\tvec3 attenuationColor;\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat anisotropy;\n\t\tfloat alphaT;\n\t\tvec3 anisotropyT;\n\t\tvec3 anisotropyB;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nvec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {\n    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );\n    float x2 = x * x;\n    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );\n    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\n#ifdef USE_ANISOTROPY\n\tfloat V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {\n\t\tfloat gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );\n\t\tfloat gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );\n\t\tfloat v = 0.5 / ( gv + gl );\n\t\treturn saturate(v);\n\t}\n\tfloat D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {\n\t\tfloat a2 = alphaT * alphaB;\n\t\thighp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );\n\t\thighp float v2 = dot( v, v );\n\t\tfloat w2 = a2 / v2;\n\t\treturn RECIPROCAL_PI * a2 * pow2 ( w2 );\n\t}\n#endif\n#ifdef USE_CLEARCOAT\n\tvec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {\n\t\tvec3 f0 = material.clearcoatF0;\n\t\tfloat f90 = material.clearcoatF90;\n\t\tfloat roughness = material.clearcoatRoughness;\n\t\tfloat alpha = pow2( roughness );\n\t\tvec3 halfDir = normalize( lightDir + viewDir );\n\t\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\t\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\t\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\t\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\t\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t\treturn F * ( V * D );\n\t}\n#endif\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {\n\tvec3 f0 = material.specularColor;\n\tfloat f90 = material.specularF90;\n\tfloat roughness = material.roughness;\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\t#ifdef USE_IRIDESCENCE\n\t\tF = mix( F, material.iridescenceFresnel, material.iridescence );\n\t#endif\n\t#ifdef USE_ANISOTROPY\n\t\tfloat dotTL = dot( material.anisotropyT, lightDir );\n\t\tfloat dotTV = dot( material.anisotropyT, viewDir );\n\t\tfloat dotTH = dot( material.anisotropyT, halfDir );\n\t\tfloat dotBL = dot( material.anisotropyB, lightDir );\n\t\tfloat dotBV = dot( material.anisotropyB, viewDir );\n\t\tfloat dotBH = dot( material.anisotropyB, halfDir );\n\t\tfloat V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );\n\t\tfloat D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );\n\t#else\n\t\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\t\tfloat D = D_GGX( alpha, dotNH );\n\t#endif\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\n#ifdef USE_IRIDESCENCE\nvoid computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#else\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n#endif\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\t#ifdef USE_IRIDESCENCE\n\t\tvec3 Fr = mix( specularColor, iridescenceF0, iridescence );\n\t#else\n\t\tvec3 Fr = specularColor;\n\t#endif\n\tvec3 FssEss = Fr * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\t#ifdef USE_IRIDESCENCE\n\t\tcomputeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );\n\t#else\n\t\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\t#endif\n\tvec3 totalScattering = singleScattering + multiScattering;\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\n#ifdef USE_IRIDESCENCE\n\tfloat dotNVi = saturate( dot( normal, geometry.viewDir ) );\n\tif ( material.iridescenceThickness == 0.0 ) {\n\t\tmaterial.iridescence = 0.0;\n\t} else {\n\t\tmaterial.iridescence = saturate( material.iridescence );\n\t}\n\tif ( material.iridescence > 0.0 ) {\n\t\tmaterial.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );\n\t\tmaterial.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );\n\t}\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\tvec4 spotColor;\n\tvec3 spotLightCoord;\n\tbool inSpotLightMap;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX\n\t\t#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS\n\t\t#else\n\t\t#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )\n\t\t#endif\n\t\t#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )\n\t\t\tspotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;\n\t\t\tinSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );\n\t\t\tspotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );\n\t\t\tdirectLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;\n\t\t#endif\n\t\t#undef SPOT_LIGHT_MAP_INDEX\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\t#ifdef USE_ANISOTROPY\n\t\tradiance += getIBLAnisotropyRadiance( geometry.viewDir, geometry.normal, material.roughness, material.anisotropyB, material.anisotropy );\n\t#else\n\t\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, vMapUv );\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t#if defined( USE_POINTS_UV )\n\t\tvec2 uv = vUv;\n\t#else\n\t\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_POINTS_UV )\n\tvarying vec2 vUv;\n#else\n\t#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\t\tuniform mat3 uvTransform;\n\t#endif\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = dFdx( vViewPosition );\n\tvec3 fdy = dFdy( vViewPosition );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal *= faceDirection;\n\t#endif\n#endif\n#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn = getTangentFrame( - vViewPosition, normal,\n\t\t#if defined( USE_NORMALMAP )\n\t\t\tvNormalMapUv\n\t\t#elif defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tvClearcoatNormalMapUv\n\t\t#else\n\t\t\tvUv\n\t\t#endif\n\t\t);\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn[0] *= faceDirection;\n\t\ttbn[1] *= faceDirection;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\t#ifdef USE_TANGENT\n\t\tmat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );\n\t#else\n\t\tmat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );\n\t#endif\n\t#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )\n\t\ttbn2[0] *= faceDirection;\n\t\ttbn2[1] *= faceDirection;\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef USE_NORMALMAP_OBJECTSPACE\n\tnormal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( USE_NORMALMAP_TANGENTSPACE )\n\tvec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\tnormal = normalize( tbn * mapN );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef USE_NORMALMAP_OBJECTSPACE\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )\n\tmat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {\n\t\tvec3 q0 = dFdx( eye_pos.xyz );\n\t\tvec3 q1 = dFdy( eye_pos.xyz );\n\t\tvec2 st0 = dFdx( uv.st );\n\t\tvec2 st1 = dFdy( uv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );\n\t\treturn mat3( T * scale, B * scale, N );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\tclearcoatNormal = normalize( tbn2 * clearcoatMapN );\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif",iridescence_pars_fragment:"#ifdef USE_IRIDESCENCEMAP\n\tuniform sampler2D iridescenceMap;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform sampler2D iridescenceThicknessMap;\n#endif",opaque_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= material.transmissionAlpha;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec2 packDepthToRG( in highp float v ) {\n\treturn packDepthToRGBA( v ).yx;\n}\nfloat unpackRGToDepth( const in highp vec2 v ) {\n\treturn unpackRGBAToDepth( vec4( v.xy, 0.0, 0.0 ) );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn depth * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * depth - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#if NUM_SPOT_LIGHT_MAPS > 0\n\tuniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;\n\t\tbool frustumTest = inFrustum && shadowCoord.z <= 1.0;\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#if NUM_SPOT_LIGHT_COORDS > 0\n\tuniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];\n\tvarying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];\n#endif\n#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )\n\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\tvec4 shadowWorldPosition;\n#endif\n#if defined( USE_SHADOWMAP )\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if NUM_SPOT_LIGHT_COORDS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition;\n\t\t#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\t\tshadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;\n\t\t#endif\n\t\tvSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\tuniform highp sampler2D boneTexture;\n\tuniform int boneTextureSize;\n\tmat4 getBoneMatrix( const in float i ) {\n\t\tfloat j = i * 4.0;\n\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\ty = dy * ( y + 0.5 );\n\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\treturn bone;\n\t}\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn saturate( toneMappingExposure * color );\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tmaterial.transmission = transmission;\n\tmaterial.transmissionAlpha = 1.0;\n\tmaterial.thickness = thickness;\n\tmaterial.attenuationDistance = attenuationDistance;\n\tmaterial.attenuationColor = attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tmaterial.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tmaterial.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmitted = getIBLVolumeRefraction(\n\t\tn, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, material.ior, material.thickness,\n\t\tmaterial.attenuationColor, material.attenuationDistance );\n\tmaterial.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );\n\ttotalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tfloat w0( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );\n\t}\n\tfloat w1( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );\n\t}\n\tfloat w2( float a ){\n\t\treturn ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );\n\t}\n\tfloat w3( float a ) {\n\t\treturn ( 1.0 / 6.0 ) * ( a * a * a );\n\t}\n\tfloat g0( float a ) {\n\t\treturn w0( a ) + w1( a );\n\t}\n\tfloat g1( float a ) {\n\t\treturn w2( a ) + w3( a );\n\t}\n\tfloat h0( float a ) {\n\t\treturn - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );\n\t}\n\tfloat h1( float a ) {\n\t\treturn 1.0 + w3( a ) / ( w2( a ) + w3( a ) );\n\t}\n\tvec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {\n\t\tuv = uv * texelSize.zw + 0.5;\n\t\tvec2 iuv = floor( uv );\n\t\tvec2 fuv = fract( uv );\n\t\tfloat g0x = g0( fuv.x );\n\t\tfloat g1x = g1( fuv.x );\n\t\tfloat h0x = h0( fuv.x );\n\t\tfloat h1x = h1( fuv.x );\n\t\tfloat h0y = h0( fuv.y );\n\t\tfloat h1y = h1( fuv.y );\n\t\tvec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\tvec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;\n\t\treturn g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +\n\t\t\tg1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );\n\t}\n\tvec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {\n\t\tvec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );\n\t\tvec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );\n\t\tvec2 fLodSizeInv = 1.0 / fLodSize;\n\t\tvec2 cLodSizeInv = 1.0 / cLodSize;\n\t\tvec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );\n\t\tvec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );\n\t\treturn mix( fSample, cSample, fract( lod ) );\n\t}\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\treturn textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );\n\t}\n\tvec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( isinf( attenuationDistance ) ) {\n\t\t\treturn vec3( 1.0 );\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 attenuatedColor = transmittance * transmittedLight.rgb;\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\tfloat transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );\n\t}\n#endif",uv_pars_fragment:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_pars_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvarying vec2 vUv;\n#endif\n#ifdef USE_MAP\n\tuniform mat3 mapTransform;\n\tvarying vec2 vMapUv;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform mat3 alphaMapTransform;\n\tvarying vec2 vAlphaMapUv;\n#endif\n#ifdef USE_LIGHTMAP\n\tuniform mat3 lightMapTransform;\n\tvarying vec2 vLightMapUv;\n#endif\n#ifdef USE_AOMAP\n\tuniform mat3 aoMapTransform;\n\tvarying vec2 vAoMapUv;\n#endif\n#ifdef USE_BUMPMAP\n\tuniform mat3 bumpMapTransform;\n\tvarying vec2 vBumpMapUv;\n#endif\n#ifdef USE_NORMALMAP\n\tuniform mat3 normalMapTransform;\n\tvarying vec2 vNormalMapUv;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tuniform mat3 displacementMapTransform;\n\tvarying vec2 vDisplacementMapUv;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tuniform mat3 emissiveMapTransform;\n\tvarying vec2 vEmissiveMapUv;\n#endif\n#ifdef USE_METALNESSMAP\n\tuniform mat3 metalnessMapTransform;\n\tvarying vec2 vMetalnessMapUv;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tuniform mat3 roughnessMapTransform;\n\tvarying vec2 vRoughnessMapUv;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tuniform mat3 anisotropyMapTransform;\n\tvarying vec2 vAnisotropyMapUv;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tuniform mat3 clearcoatMapTransform;\n\tvarying vec2 vClearcoatMapUv;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform mat3 clearcoatNormalMapTransform;\n\tvarying vec2 vClearcoatNormalMapUv;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform mat3 clearcoatRoughnessMapTransform;\n\tvarying vec2 vClearcoatRoughnessMapUv;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tuniform mat3 sheenColorMapTransform;\n\tvarying vec2 vSheenColorMapUv;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tuniform mat3 sheenRoughnessMapTransform;\n\tvarying vec2 vSheenRoughnessMapUv;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tuniform mat3 iridescenceMapTransform;\n\tvarying vec2 vIridescenceMapUv;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tuniform mat3 iridescenceThicknessMapTransform;\n\tvarying vec2 vIridescenceThicknessMapUv;\n#endif\n#ifdef USE_SPECULARMAP\n\tuniform mat3 specularMapTransform;\n\tvarying vec2 vSpecularMapUv;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tuniform mat3 specularColorMapTransform;\n\tvarying vec2 vSpecularColorMapUv;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tuniform mat3 specularIntensityMapTransform;\n\tvarying vec2 vSpecularIntensityMapUv;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tuniform mat3 transmissionMapTransform;\n\tvarying vec2 vTransmissionMapUv;\n#endif\n#ifdef USE_THICKNESSMAP\n\tuniform mat3 thicknessMapTransform;\n\tvarying vec2 vThicknessMapUv;\n#endif",uv_vertex:"#if defined( USE_UV ) || defined( USE_ANISOTROPY )\n\tvUv = vec3( uv, 1 ).xy;\n#endif\n#ifdef USE_MAP\n\tvMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ALPHAMAP\n\tvAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_LIGHTMAP\n\tvLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_AOMAP\n\tvAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_BUMPMAP\n\tvBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_NORMALMAP\n\tvNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_DISPLACEMENTMAP\n\tvDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_EMISSIVEMAP\n\tvEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_METALNESSMAP\n\tvMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ROUGHNESSMAP\n\tvRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_ANISOTROPYMAP\n\tvAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOATMAP\n\tvClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tvClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tvClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCEMAP\n\tvIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_IRIDESCENCE_THICKNESSMAP\n\tvIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_COLORMAP\n\tvSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SHEEN_ROUGHNESSMAP\n\tvSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULARMAP\n\tvSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_COLORMAP\n\tvSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_SPECULAR_INTENSITYMAP\n\tvSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_TRANSMISSIONMAP\n\tvTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;\n#endif\n#ifdef USE_THICKNESSMAP\n\tvThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nuniform float backgroundIntensity;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",backgroundCube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",backgroundCube_frag:"#ifdef ENVMAP_TYPE_CUBE\n\tuniform samplerCube envMap;\n#elif defined( ENVMAP_TYPE_CUBE_UV )\n\tuniform sampler2D envMap;\n#endif\nuniform float flipEnvMap;\nuniform float backgroundBlurriness;\nuniform float backgroundIntensity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 texColor = textureCube( envMap, vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 texColor = textureCubeUV( envMap, vWorldDirection, backgroundBlurriness );\n\t#else\n\t\tvec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t#endif\n\ttexColor.rgb *= backgroundIntensity;\n\tgl_FragColor = texColor;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldDirection;\nvoid main() {\n\tvec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );\n\tgl_FragColor = texColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vLightMapUv );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"#define LAMBERT\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_lambert_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_lambert_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define USE_SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef USE_SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULAR_COLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n\t#ifdef USE_SPECULAR_INTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_IRIDESCENCE\n\tuniform float iridescence;\n\tuniform float iridescenceIOR;\n\tuniform float iridescenceThicknessMinimum;\n\tuniform float iridescenceThicknessMaximum;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEEN_COLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEEN_ROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\n#ifdef USE_ANISOTROPY\n\tuniform vec2 anisotropyVector;\n\t#ifdef USE_ANISOTROPYMAP\n\t\tuniform sampler2D anisotropyMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <iridescence_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <iridescence_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#ifdef USE_POINTS_UV\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\nvoid main() {\n\t#ifdef USE_POINTS_UV\n\t\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\t#endif\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <logdepthbuf_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <alphahash_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <alphahash_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <opaque_fragment>\n\t#include <tonemapping_fragment>\n\t#include <colorspace_fragment>\n\t#include <fog_fragment>\n}"},Nn={common:{diffuse:{value:new Ct(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new F},alphaMap:{value:null},alphaMapTransform:{value:new F},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new F}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new F}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new F}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new F},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new F},normalScale:{value:new j(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new F},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new F}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new F}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new F}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Ct(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Ct(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new F},alphaTest:{value:0},uvTransform:{value:new F}},sprite:{diffuse:{value:new Ct(16777215)},opacity:{value:1},center:{value:new j(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new F},alphaMap:{value:null},alphaMapTransform:{value:new F},alphaTest:{value:0}}},Dn={basic:{uniforms:mn([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.fog]),vertexShader:In.meshbasic_vert,fragmentShader:In.meshbasic_frag},lambert:{uniforms:mn([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,Nn.lights,{emissive:{value:new Ct(0)}}]),vertexShader:In.meshlambert_vert,fragmentShader:In.meshlambert_frag},phong:{uniforms:mn([Nn.common,Nn.specularmap,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,Nn.lights,{emissive:{value:new Ct(0)},specular:{value:new Ct(1118481)},shininess:{value:30}}]),vertexShader:In.meshphong_vert,fragmentShader:In.meshphong_frag},standard:{uniforms:mn([Nn.common,Nn.envmap,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.roughnessmap,Nn.metalnessmap,Nn.fog,Nn.lights,{emissive:{value:new Ct(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:In.meshphysical_vert,fragmentShader:In.meshphysical_frag},toon:{uniforms:mn([Nn.common,Nn.aomap,Nn.lightmap,Nn.emissivemap,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.gradientmap,Nn.fog,Nn.lights,{emissive:{value:new Ct(0)}}]),vertexShader:In.meshtoon_vert,fragmentShader:In.meshtoon_frag},matcap:{uniforms:mn([Nn.common,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,Nn.fog,{matcap:{value:null}}]),vertexShader:In.meshmatcap_vert,fragmentShader:In.meshmatcap_frag},points:{uniforms:mn([Nn.points,Nn.fog]),vertexShader:In.points_vert,fragmentShader:In.points_frag},dashed:{uniforms:mn([Nn.common,Nn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:In.linedashed_vert,fragmentShader:In.linedashed_frag},depth:{uniforms:mn([Nn.common,Nn.displacementmap]),vertexShader:In.depth_vert,fragmentShader:In.depth_frag},normal:{uniforms:mn([Nn.common,Nn.bumpmap,Nn.normalmap,Nn.displacementmap,{opacity:{value:1}}]),vertexShader:In.meshnormal_vert,fragmentShader:In.meshnormal_frag},sprite:{uniforms:mn([Nn.sprite,Nn.fog]),vertexShader:In.sprite_vert,fragmentShader:In.sprite_frag},background:{uniforms:{uvTransform:{value:new F},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:In.background_vert,fragmentShader:In.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1}},vertexShader:In.backgroundCube_vert,fragmentShader:In.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:In.cube_vert,fragmentShader:In.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:In.equirect_vert,fragmentShader:In.equirect_frag},distanceRGBA:{uniforms:mn([Nn.common,Nn.displacementmap,{referencePosition:{value:new ue},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:In.distanceRGBA_vert,fragmentShader:In.distanceRGBA_frag},shadow:{uniforms:mn([Nn.lights,Nn.fog,{color:{value:new Ct(0)},opacity:{value:1}}]),vertexShader:In.shadow_vert,fragmentShader:In.shadow_frag}};Dn.physical={uniforms:mn([Dn.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new F},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new F},clearcoatNormalScale:{value:new j(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new F},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new F},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new F},sheen:{value:0},sheenColor:{value:new Ct(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new F},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new F},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new F},transmissionSamplerSize:{value:new j},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new F},attenuationDistance:{value:0},attenuationColor:{value:new Ct(0)},specularColor:{value:new Ct(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new F},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new F},anisotropyVector:{value:new j},anisotropyMap:{value:null},anisotropyMapTransform:{value:new F}}]),vertexShader:In.meshphysical_vert,fragmentShader:In.meshphysical_frag};var Un={r:0,b:0,g:0};function jn(e,t,n,r,a,i,o){var s,l,c=new Ct(0),u=!0===i?0:1,d=null,h=0,f=null;function p(t,n){t.getRGB(Un,vn(e)),r.buffers.color.setClear(Un.r,Un.g,Un.b,n,o)}return{getClearColor:function(){return c},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;c.set(e),p(c,u=t)},getClearAlpha:function(){return u},setClearAlpha:function(e){p(c,u=e)},render:function(i,m){var v=!1,g=!0===m.isScene?m.background:null;switch(g&&g.isTexture&&(g=(m.backgroundBlurriness>0?n:t).get(g)),null===g?p(c,u):g&&g.isColor&&(p(g,1),v=!0),e.xr.getEnvironmentBlendMode()){case"opaque":v=!0;break;case"additive":r.buffers.color.setClear(0,0,0,1,o),v=!0;break;case"alpha-blend":r.buffers.color.setClear(0,0,0,0,o),v=!0}(e.autoClear||v)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),g&&(g.isCubeTexture||306===g.mapping)?(void 0===l&&((l=new dn(new fn(1,1,1),new yn({name:"BackgroundCubeMaterial",uniforms:pn(Dn.backgroundCube.uniforms),vertexShader:Dn.backgroundCube.vertexShader,fragmentShader:Dn.backgroundCube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),l.geometry.deleteAttribute("uv"),l.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(l.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(l)),l.material.uniforms.envMap.value=g,l.material.uniforms.flipEnvMap.value=g.isCubeTexture&&!1===g.isRenderTargetTexture?-1:1,l.material.uniforms.backgroundBlurriness.value=m.backgroundBlurriness,l.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,l.material.toneMapped="srgb"!==g.colorSpace,d===g&&h===g.version&&f===e.toneMapping||(l.material.needsUpdate=!0,d=g,h=g.version,f=e.toneMapping),l.layers.enableAll(),i.unshift(l,l.geometry,l.material,0,0,null)):g&&g.isTexture&&(void 0===s&&((s=new dn(new Ln(2,2),new yn({name:"BackgroundMaterial",uniforms:pn(Dn.background.uniforms),vertexShader:Dn.background.vertexShader,fragmentShader:Dn.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(s.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(s)),s.material.uniforms.t2D.value=g,s.material.uniforms.backgroundIntensity.value=m.backgroundIntensity,s.material.toneMapped="srgb"!==g.colorSpace,!0===g.matrixAutoUpdate&&g.updateMatrix(),s.material.uniforms.uvTransform.value.copy(g.matrix),d===g&&h===g.version&&f===e.toneMapping||(s.material.needsUpdate=!0,d=g,h=g.version,f=e.toneMapping),s.layers.enableAll(),i.unshift(s,s.geometry,s.material,0,0,null))}}}function Fn(e,t,n,r){var a=e.getParameter(e.MAX_VERTEX_ATTRIBS),i=r.isWebGL2?null:t.get("OES_vertex_array_object"),o=r.isWebGL2||null!==i,s={},l=f(null),c=l,u=!1;function d(t){return r.isWebGL2?e.bindVertexArray(t):i.bindVertexArrayOES(t)}function h(t){return r.isWebGL2?e.deleteVertexArray(t):i.deleteVertexArrayOES(t)}function f(e){for(var t=[],n=[],r=[],i=0;i<a;i++)t[i]=0,n[i]=0,r[i]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function p(){for(var e=c.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function m(e){v(e,0)}function v(n,a){var i=c.newAttributes,o=c.enabledAttributes,s=c.attributeDivisors;(i[n]=1,0===o[n]&&(e.enableVertexAttribArray(n),o[n]=1),s[n]!==a)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,a),s[n]=a)}function g(){for(var t=c.newAttributes,n=c.enabledAttributes,r=0,a=n.length;r<a;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function y(t,n,r,a,i,o,s){!0===s?e.vertexAttribIPointer(t,n,r,i,o):e.vertexAttribPointer(t,n,r,a,i,o)}function b(){_(),u=!0,c!==l&&d((c=l).object)}function _(){l.geometry=null,l.program=null,l.wireframe=!1}return{setup:function(a,l,h,b,_){var x=!1;if(o){var E=function(t,n,a){var o=!0===a.wireframe,l=s[t.id];void 0===l&&(l={},s[t.id]=l);var c=l[n.id];void 0===c&&(c={},l[n.id]=c);var u=c[o];void 0===u&&(u=f(r.isWebGL2?e.createVertexArray():i.createVertexArrayOES()),c[o]=u);return u}(b,h,l);c!==E&&d((c=E).object),(x=function(e,t,n,r){var a=c.attributes,i=t.attributes,o=0,s=n.getAttributes();for(var l in s){if(s[l].location>=0){var u=a[l],d=i[l];if(void 0===d&&("instanceMatrix"===l&&e.instanceMatrix&&(d=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(d=e.instanceColor)),void 0===u)return!0;if(u.attribute!==d)return!0;if(d&&u.data!==d.data)return!0;o++}}return c.attributesNum!==o||c.index!==r}(a,b,h,_))&&function(e,t,n,r){var a={},i=t.attributes,o=0,s=n.getAttributes();for(var l in s){if(s[l].location>=0){var u=i[l];void 0===u&&("instanceMatrix"===l&&e.instanceMatrix&&(u=e.instanceMatrix),"instanceColor"===l&&e.instanceColor&&(u=e.instanceColor));var d={};d.attribute=u,u&&u.data&&(d.data=u.data),a[l]=d,o++}}c.attributes=a,c.attributesNum=o,c.index=r}(a,b,h,_)}else{var S=!0===l.wireframe;c.geometry===b.id&&c.program===h.id&&c.wireframe===S||(c.geometry=b.id,c.program=h.id,c.wireframe=S,x=!0)}null!==_&&n.update(_,e.ELEMENT_ARRAY_BUFFER),(x||u)&&(u=!1,function(a,i,o,s){if(!1===r.isWebGL2&&(a.isInstancedMesh||s.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;p();var l=s.attributes,c=o.getAttributes(),u=i.defaultAttributeValues;for(var d in c){var h=c[d];if(h.location>=0){var f=l[d];if(void 0===f&&("instanceMatrix"===d&&a.instanceMatrix&&(f=a.instanceMatrix),"instanceColor"===d&&a.instanceColor&&(f=a.instanceColor)),void 0!==f){var b=f.normalized,_=f.itemSize,x=n.get(f);if(void 0===x)continue;var E=x.buffer,S=x.type,M=x.bytesPerElement,T=!0===r.isWebGL2&&(S===e.INT||S===e.UNSIGNED_INT||1013===f.gpuType);if(f.isInterleavedBufferAttribute){var w=f.data,O=w.stride,A=f.offset;if(w.isInstancedInterleavedBuffer){for(var R=0;R<h.locationSize;R++)v(h.location+R,w.meshPerAttribute);!0!==a.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=w.meshPerAttribute*w.count)}else for(var C=0;C<h.locationSize;C++)m(h.location+C);e.bindBuffer(e.ARRAY_BUFFER,E);for(var k=0;k<h.locationSize;k++)y(h.location+k,_/h.locationSize,S,b,O*M,(A+_/h.locationSize*k)*M,T)}else{if(f.isInstancedBufferAttribute){for(var P=0;P<h.locationSize;P++)v(h.location+P,f.meshPerAttribute);!0!==a.isInstancedMesh&&void 0===s._maxInstanceCount&&(s._maxInstanceCount=f.meshPerAttribute*f.count)}else for(var L=0;L<h.locationSize;L++)m(h.location+L);e.bindBuffer(e.ARRAY_BUFFER,E);for(var I=0;I<h.locationSize;I++)y(h.location+I,_/h.locationSize,S,b,_*M,_/h.locationSize*I*M,T)}}else if(void 0!==u){var N=u[d];if(void 0!==N)switch(N.length){case 2:e.vertexAttrib2fv(h.location,N);break;case 3:e.vertexAttrib3fv(h.location,N);break;case 4:e.vertexAttrib4fv(h.location,N);break;default:e.vertexAttrib1fv(h.location,N)}}}}g()}(a,l,h,b),null!==_&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.get(_).buffer))},reset:b,resetDefaultState:_,dispose:function(){for(var e in b(),s){var t=s[e];for(var n in t){var r=t[n];for(var a in r)h(r[a].object),delete r[a];delete t[n]}delete s[e]}},releaseStatesOfGeometry:function(e){if(void 0!==s[e.id]){var t=s[e.id];for(var n in t){var r=t[n];for(var a in r)h(r[a].object),delete r[a];delete t[n]}delete s[e.id]}},releaseStatesOfProgram:function(e){for(var t in s){var n=s[t];if(void 0!==n[e.id]){var r=n[e.id];for(var a in r)h(r[a].object),delete r[a];delete n[e.id]}}},initAttributes:p,enableAttribute:m,disableUnusedAttributes:g}}function zn(e,t,n,r){var a,i=r.isWebGL2;this.setMode=function(e){a=e},this.render=function(t,r){e.drawArrays(a,t,r),n.update(r,a,1)},this.renderInstances=function(r,o,s){if(0!==s){var l,c;if(i)l=e,c="drawArraysInstanced";else if(c="drawArraysInstancedANGLE",null===(l=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");l[c](a,r,o,s),n.update(o,a,s)}}}function Bn(e,t,n){var r;function a(t){if("highp"===t){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var i="undefined"!==typeof WebGL2RenderingContext&&"WebGL2RenderingContext"===e.constructor.name,o=void 0!==n.precision?n.precision:"highp",s=a(o);s!==o&&(console.warn("THREE.WebGLRenderer:",o,"not supported, using",s,"instead."),o=s);var l=i||t.has("WEBGL_draw_buffers"),c=!0===n.logarithmicDepthBuffer,u=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),d=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=e.getParameter(e.MAX_TEXTURE_SIZE),f=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),p=e.getParameter(e.MAX_VERTEX_ATTRIBS),m=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),v=e.getParameter(e.MAX_VARYING_VECTORS),g=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),y=d>0,b=i||t.has("OES_texture_float");return{isWebGL2:i,drawBuffers:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:a,precision:o,logarithmicDepthBuffer:c,maxTextures:u,maxVertexTextures:d,maxTextureSize:h,maxCubemapSize:f,maxAttributes:p,maxVertexUniforms:m,maxVaryings:v,maxFragmentUniforms:g,vertexTextures:y,floatFragmentTextures:b,floatVertexTextures:y&&b,maxSamples:i?e.getParameter(e.MAX_SAMPLES):0}}function Hn(e){var t=this,n=null,r=0,a=!1,i=!1,o=new On,s=new F,l={value:null,needsUpdate:!1};function c(e,n,r,a){var i=null!==e?e.length:0,c=null;if(0!==i){if(c=l.value,!0!==a||null===c){var u=r+4*i,d=n.matrixWorldInverse;s.getNormalMatrix(d),(null===c||c.length<u)&&(c=new Float32Array(u));for(var h=0,f=r;h!==i;++h,f+=4)o.copy(e[h]).applyMatrix4(d,s),o.normal.toArray(c,f),c[f+3]=o.constant}l.value=c,l.needsUpdate=!0}return t.numPlanes=i,t.numIntersection=0,c}this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t){var n=0!==e.length||t||0!==r||a;return a=t,r=e.length,n},this.beginShadows=function(){i=!0,c(null)},this.endShadows=function(){i=!1},this.setGlobalState=function(e,t){n=c(e,t,0)},this.setState=function(o,s,u){var d=o.clippingPlanes,h=o.clipIntersection,f=o.clipShadows,p=e.get(o);if(!a||null===d||0===d.length||i&&!f)i?c(null):function(){l.value!==n&&(l.value=n,l.needsUpdate=r>0);t.numPlanes=r,t.numIntersection=0}();else{var m=i?0:r,v=4*m,g=p.clippingState||null;l.value=g,g=c(d,s,v,u);for(var y=0;y!==v;++y)g[y]=n[y];p.clippingState=g,this.numIntersection=h?this.numPlanes:0,this.numPlanes+=m}}}function Vn(e){var t=new WeakMap;function n(e,t){return 303===t?e.mapping=301:304===t&&(e.mapping=302),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var a=t.get(n);void 0!==a&&(t.delete(n),a.dispose())}return{get:function(a){if(a&&a.isTexture&&!1===a.isRenderTargetTexture){var i=a.mapping;if(303===i||304===i){if(t.has(a))return n(t.get(a).texture,a.mapping);var o=a.image;if(o&&o.height>0){var s=new Sn(o.height/2);return s.fromEquirectangularTexture(e,a),t.set(a,s),a.addEventListener("dispose",r),n(s.texture,a.mapping)}return null}}return a},dispose:function(){t=new WeakMap}}}var Gn=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return Object(p.a)(this,t),(e=v(this,t)).isOrthographicCamera=!0,e.type="OrthographicCamera",e.zoom=1,e.view=null,e.left=n,e.right=r,e.top=a,e.bottom=i,e.near=o,e.far=s,e.updateProjectionMatrix(),e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e,n){return c(Object(l.a)(t.prototype),"copy",this).call(this,e,n),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}},{key:"setViewOffset",value:function(e,t,n,r,a,i){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=a,this.view.height=i,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,a=n-e,i=n+e,o=r+t,s=r-t;if(null!==this.view&&this.view.enabled){var l=(this.right-this.left)/this.view.fullWidth/this.zoom,c=(this.top-this.bottom)/this.view.fullHeight/this.zoom;i=(a+=l*this.view.offsetX)+l*this.view.width,s=(o-=c*this.view.offsetY)-c*this.view.height}this.projectionMatrix.makeOrthographic(a,i,o,s,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(e){var n=c(Object(l.a)(t.prototype),"toJSON",this).call(this,e);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,null!==this.view&&(n.object.view=Object.assign({},this.view)),n}}])}(bn),Wn=[.125,.215,.35,.446,.526,.582],Xn=new Gn,qn=new Ct,Yn=null,Kn=(1+Math.sqrt(5))/2,Zn=1/Kn,Jn=[new ue(1,1,1),new ue(-1,1,1),new ue(1,1,-1),new ue(-1,1,-1),new ue(0,Kn,Zn),new ue(0,Kn,-Zn),new ue(Zn,0,Kn),new ue(-Zn,0,Kn),new ue(Kn,Zn,0),new ue(-Kn,Zn,0)],Qn=function(){return Object(m.a)((function e(t){Object(p.a)(this,e),this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}),[{key:"fromScene",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:100;Yn=this._renderer.getRenderTarget(),this._setSize(256);var a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(e,n,r,a),t>0&&this._blur(a,0,0,t),this._applyPMREM(a),this._cleanup(a),a}},{key:"fromEquirectangular",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"fromCubemap",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this._fromTexture(e,t)}},{key:"compileCubemapShader",value:function(){null===this._cubemapMaterial&&(this._cubemapMaterial=nr(),this._compileMaterial(this._cubemapMaterial))}},{key:"compileEquirectangularShader",value:function(){null===this._equirectMaterial&&(this._equirectMaterial=tr(),this._compileMaterial(this._equirectMaterial))}},{key:"dispose",value:function(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}},{key:"_setSize",value:function(e){this._lodMax=Math.floor(Math.log2(e)),this._cubeSize=Math.pow(2,this._lodMax)}},{key:"_dispose",value:function(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(var e=0;e<this._lodPlanes.length;e++)this._lodPlanes[e].dispose()}},{key:"_cleanup",value:function(e){this._renderer.setRenderTarget(Yn),e.scissorTest=!1,er(e,0,0,e.width,e.height)}},{key:"_fromTexture",value:function(e,t){301===e.mapping||302===e.mapping?this._setSize(0===e.image.length?16:e.image[0].width||e.image[0].image.width):this._setSize(e.image.width/4),Yn=this._renderer.getRenderTarget();var n=t||this._allocateTargets();return this._textureToCubeUV(e,n),this._applyPMREM(n),this._cleanup(n),n}},{key:"_allocateTargets",value:function(){var e=3*Math.max(this._cubeSize,112),t=4*this._cubeSize,n={magFilter:1006,minFilter:1006,generateMipmaps:!1,type:1016,format:1023,colorSpace:"srgb-linear",depthBuffer:!1},r=$n(e,t,n);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==e||this._pingPongRenderTarget.height!==t){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=$n(e,t,n);var a=this._lodMax,i=function(e){for(var t=[],n=[],r=[],a=e,i=e-4+1+Wn.length,o=0;o<i;o++){var s=Math.pow(2,a);n.push(s);var l=1/s;o>e-4?l=Wn[o-e+4-1]:0===o&&(l=0),r.push(l);for(var c=1/(s-2),u=-c,d=1+c,h=[u,u,d,u,d,d,u,u,d,d,u,d],f=new Float32Array(108),p=new Float32Array(72),m=new Float32Array(36),v=0;v<6;v++){var g=v%3*2/3-1,y=v>2?0:-1,b=[g,y,0,g+2/3,y,0,g+2/3,y+1,0,g,y,0,g+2/3,y+1,0,g,y+1,0];f.set(b,18*v),p.set(h,12*v);var _=[v,v,v,v,v,v];m.set(_,6*v)}var x=new Xt;x.setAttribute("position",new Nt(f,3)),x.setAttribute("uv",new Nt(p,2)),x.setAttribute("faceIndex",new Nt(m,1)),t.push(x),a>4&&a--}return{lodPlanes:t,sizeLods:n,sigmas:r}}(a);this._sizeLods=i.sizeLods,this._lodPlanes=i.lodPlanes,this._sigmas=i.sigmas,this._blurMaterial=function(e,t,n){var r=new Float32Array(20),a=new ue(0,1,0);return new yn({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:"".concat(e,".0")},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:a}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}(a,e,t)}return r}},{key:"_compileMaterial",value:function(e){var t=new dn(this._lodPlanes[0],e);this._renderer.compile(t,Xn)}},{key:"_sceneToCubeUV",value:function(e,t,n,r){var a=new _n(90,1,t,n),i=[1,-1,1,1,1,1],o=[1,1,1,-1,-1,-1],s=this._renderer,l=s.autoClear,c=s.toneMapping;s.getClearColor(qn),s.toneMapping=0,s.autoClear=!1;var u=new Pt({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),d=new dn(new fn,u),h=!1,f=e.background;f?f.isColor&&(u.color.copy(f),e.background=null,h=!0):(u.color.copy(qn),h=!0);for(var p=0;p<6;p++){var m=p%3;0===m?(a.up.set(0,i[p],0),a.lookAt(o[p],0,0)):1===m?(a.up.set(0,0,i[p]),a.lookAt(0,o[p],0)):(a.up.set(0,i[p],0),a.lookAt(0,0,o[p]));var v=this._cubeSize;er(r,m*v,p>2?v:0,v,v),s.setRenderTarget(r),h&&s.render(d,a),s.render(e,a)}d.geometry.dispose(),d.material.dispose(),s.toneMapping=c,s.autoClear=l,e.background=f}},{key:"_textureToCubeUV",value:function(e,t){var n=this._renderer,r=301===e.mapping||302===e.mapping;r?(null===this._cubemapMaterial&&(this._cubemapMaterial=nr()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===e.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=tr());var a=r?this._cubemapMaterial:this._equirectMaterial,i=new dn(this._lodPlanes[0],a);a.uniforms.envMap.value=e;var o=this._cubeSize;er(t,0,0,3*o,2*o),n.setRenderTarget(t),n.render(i,Xn)}},{key:"_applyPMREM",value:function(e){var t=this._renderer,n=t.autoClear;t.autoClear=!1;for(var r=1;r<this._lodPlanes.length;r++){var a=Math.sqrt(this._sigmas[r]*this._sigmas[r]-this._sigmas[r-1]*this._sigmas[r-1]),i=Jn[(r-1)%Jn.length];this._blur(e,r-1,r,a,i)}t.autoClear=n}},{key:"_blur",value:function(e,t,n,r,a){var i=this._pingPongRenderTarget;this._halfBlur(e,i,t,n,r,"latitudinal",a),this._halfBlur(i,e,n,n,r,"longitudinal",a)}},{key:"_halfBlur",value:function(e,t,n,r,a,i,o){var s=this._renderer,l=this._blurMaterial;"latitudinal"!==i&&"longitudinal"!==i&&console.error("blur direction must be either latitudinal or longitudinal!");var c=new dn(this._lodPlanes[r],l),u=l.uniforms,d=this._sizeLods[n]-1,h=isFinite(a)?Math.PI/(2*d):2*Math.PI/39,f=a/h,p=isFinite(a)?1+Math.floor(3*f):20;p>20&&console.warn("sigmaRadians, ".concat(a,", is too large and will clip, as it requested ").concat(p," samples when the maximum is set to ").concat(20));for(var m=[],v=0,g=0;g<20;++g){var y=g/f,b=Math.exp(-y*y/2);m.push(b),0===g?v+=b:g<p&&(v+=2*b)}for(var _=0;_<m.length;_++)m[_]=m[_]/v;u.envMap.value=e.texture,u.samples.value=p,u.weights.value=m,u.latitudinal.value="latitudinal"===i,o&&(u.poleAxis.value=o);var x=this._lodMax;u.dTheta.value=h,u.mipInt.value=x-n;var E=this._sizeLods[r];er(t,3*E*(r>x-4?r-x+4:0),4*(this._cubeSize-E),3*E,2*E),s.setRenderTarget(t),s.render(c,Xn)}}])}();function $n(e,t,n){var r=new oe(e,t,n);return r.texture.mapping=306,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function er(e,t,n,r,a){e.viewport.set(t,n,r,a),e.scissor.set(t,n,r,a)}function tr(){return new yn({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function nr(){return new yn({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:0,depthTest:!1,depthWrite:!1})}function rr(e){var t=new WeakMap,n=null;function r(e){var n=e.target;n.removeEventListener("dispose",r);var a=t.get(n);void 0!==a&&(t.delete(n),a.dispose())}return{get:function(a){if(a&&a.isTexture){var i=a.mapping,o=303===i||304===i,s=301===i||302===i;if(o||s){if(a.isRenderTargetTexture&&!0===a.needsPMREMUpdate){a.needsPMREMUpdate=!1;var l=t.get(a);return null===n&&(n=new Qn(e)),l=o?n.fromEquirectangular(a,l):n.fromCubemap(a,l),t.set(a,l),l.texture}if(t.has(a))return t.get(a).texture;var c=a.image;if(o&&c&&c.height>0||s&&c&&function(e){for(var t=0,n=0;n<6;n++)void 0!==e[n]&&t++;return 6===t}(c)){null===n&&(n=new Qn(e));var u=o?n.fromEquirectangular(a):n.fromCubemap(a);return t.set(a,u),a.addEventListener("dispose",r),u.texture}return null}}return a},dispose:function(){t=new WeakMap,null!==n&&(n.dispose(),n=null)}}}function ar(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function ir(e,t,n,r){var a={},i=new WeakMap;function o(e){var s=e.target;for(var l in null!==s.index&&t.remove(s.index),s.attributes)t.remove(s.attributes[l]);for(var c in s.morphAttributes)for(var u=s.morphAttributes[c],d=0,h=u.length;d<h;d++)t.remove(u[d]);s.removeEventListener("dispose",o),delete a[s.id];var f=i.get(s);f&&(t.remove(f),i.delete(s)),r.releaseStatesOfGeometry(s),!0===s.isInstancedBufferGeometry&&delete s._maxInstanceCount,n.memory.geometries--}function s(e){var n=[],r=e.index,a=e.attributes.position,o=0;if(null!==r){var s=r.array;o=r.version;for(var l=0,c=s.length;l<c;l+=3){var u=s[l+0],d=s[l+1],h=s[l+2];n.push(u,d,d,h,h,u)}}else{if(void 0===a)return;var f=a.array;o=a.version;for(var p=0,m=f.length/3-1;p<m;p+=3){var v=p+0,g=p+1,y=p+2;n.push(v,g,g,y,y,v)}}var b=new(B(n)?Ut:Dt)(n,1);b.version=o;var _=i.get(e);_&&t.remove(_),i.set(e,b)}return{get:function(e,t){return!0===a[t.id]||(t.addEventListener("dispose",o),a[t.id]=!0,n.memory.geometries++),t},update:function(n){var r=n.attributes;for(var a in r)t.update(r[a],e.ARRAY_BUFFER);var i=n.morphAttributes;for(var o in i)for(var s=i[o],l=0,c=s.length;l<c;l++)t.update(s[l],e.ARRAY_BUFFER)},getWireframeAttribute:function(e){var t=i.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&s(e)}else s(e);return i.get(e)}}}function or(e,t,n,r){var a,i,o,s=r.isWebGL2;this.setMode=function(e){a=e},this.setIndex=function(e){i=e.type,o=e.bytesPerElement},this.render=function(t,r){e.drawElements(a,r,i,t*o),n.update(r,a,1)},this.renderInstances=function(r,l,c){if(0!==c){var u,d;if(s)u=e,d="drawElementsInstanced";else if(d="drawElementsInstancedANGLE",null===(u=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");u[d](a,l,i,r*o,c),n.update(l,a,c)}}}function sr(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(n,r,a){switch(t.calls++,r){case e.TRIANGLES:t.triangles+=a*(n/3);break;case e.LINES:t.lines+=a*(n/2);break;case e.LINE_STRIP:t.lines+=a*(n-1);break;case e.LINE_LOOP:t.lines+=a*n;break;case e.POINTS:t.points+=a*n;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",r)}}}}function lr(e,t){return e[0]-t[0]}function cr(e,t){return Math.abs(t[1])-Math.abs(e[1])}function ur(e,t,n){for(var r={},a=new Float32Array(8),i=new WeakMap,o=new ie,s=[],l=0;l<8;l++)s[l]=[l,0];return{update:function(l,c,u){var d=l.morphTargetInfluences;if(!0===t.isWebGL2){var h=c.morphAttributes.position||c.morphAttributes.normal||c.morphAttributes.color,f=void 0!==h?h.length:0,p=i.get(c);if(void 0===p||p.count!==f){void 0!==p&&p.texture.dispose();var m=void 0!==c.morphAttributes.position,v=void 0!==c.morphAttributes.normal,g=void 0!==c.morphAttributes.color,y=c.morphAttributes.position||[],b=c.morphAttributes.normal||[],_=c.morphAttributes.color||[],x=0;!0===m&&(x=1),!0===v&&(x=2),!0===g&&(x=3);var E=c.attributes.position.count*x,S=1;E>t.maxTextureSize&&(S=Math.ceil(E/t.maxTextureSize),E=t.maxTextureSize);var M=new Float32Array(E*S*4*f),T=new se(M,E,S,f);T.type=1015,T.needsUpdate=!0;for(var w=4*x,O=0;O<f;O++)for(var A=y[O],R=b[O],C=_[O],k=E*S*4*O,P=0;P<A.count;P++){var L=P*w;!0===m&&(o.fromBufferAttribute(A,P),M[k+L+0]=o.x,M[k+L+1]=o.y,M[k+L+2]=o.z,M[k+L+3]=0),!0===v&&(o.fromBufferAttribute(R,P),M[k+L+4]=o.x,M[k+L+5]=o.y,M[k+L+6]=o.z,M[k+L+7]=0),!0===g&&(o.fromBufferAttribute(C,P),M[k+L+8]=o.x,M[k+L+9]=o.y,M[k+L+10]=o.z,M[k+L+11]=4===C.itemSize?o.w:1)}p={count:f,texture:T,size:new j(E,S)},i.set(c,p),c.addEventListener("dispose",(function e(){T.dispose(),i.delete(c),c.removeEventListener("dispose",e)}))}for(var I=0,N=0;N<d.length;N++)I+=d[N];var D=c.morphTargetsRelative?1:1-I;u.getUniforms().setValue(e,"morphTargetBaseInfluence",D),u.getUniforms().setValue(e,"morphTargetInfluences",d),u.getUniforms().setValue(e,"morphTargetsTexture",p.texture,n),u.getUniforms().setValue(e,"morphTargetsTextureSize",p.size)}else{var U=void 0===d?0:d.length,F=r[c.id];if(void 0===F||F.length!==U){F=[];for(var z=0;z<U;z++)F[z]=[z,0];r[c.id]=F}for(var B=0;B<U;B++){var H=F[B];H[0]=B,H[1]=d[B]}F.sort(cr);for(var V=0;V<8;V++)V<U&&F[V][1]?(s[V][0]=F[V][0],s[V][1]=F[V][1]):(s[V][0]=Number.MAX_SAFE_INTEGER,s[V][1]=0);s.sort(lr);for(var G=c.morphAttributes.position,W=c.morphAttributes.normal,X=0,q=0;q<8;q++){var Y=s[q],K=Y[0],Z=Y[1];K!==Number.MAX_SAFE_INTEGER&&Z?(G&&c.getAttribute("morphTarget"+q)!==G[K]&&c.setAttribute("morphTarget"+q,G[K]),W&&c.getAttribute("morphNormal"+q)!==W[K]&&c.setAttribute("morphNormal"+q,W[K]),a[q]=Z,X+=Z):(G&&!0===c.hasAttribute("morphTarget"+q)&&c.deleteAttribute("morphTarget"+q),W&&!0===c.hasAttribute("morphNormal"+q)&&c.deleteAttribute("morphNormal"+q),a[q]=0)}var J=c.morphTargetsRelative?1:1-X;u.getUniforms().setValue(e,"morphTargetBaseInfluence",J),u.getUniforms().setValue(e,"morphTargetInfluences",a)}}}}function dr(e,t,n,r){var a=new WeakMap;function i(e){var t=e.target;t.removeEventListener("dispose",i),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(o){var s=r.render.frame,l=o.geometry,c=t.get(o,l);if(a.get(c)!==s&&(t.update(c),a.set(c,s)),o.isInstancedMesh&&(!1===o.hasEventListener("dispose",i)&&o.addEventListener("dispose",i),a.get(o)!==s&&(n.update(o.instanceMatrix,e.ARRAY_BUFFER),null!==o.instanceColor&&n.update(o.instanceColor,e.ARRAY_BUFFER),a.set(o,s))),o.isSkinnedMesh){var u=o.skeleton;a.get(u)!==s&&(u.update(),a.set(u,s))}return c},dispose:function(){a=new WeakMap}}}var hr=new ae,fr=new se,pr=new le,mr=new En,vr=[],gr=[],yr=new Float32Array(16),br=new Float32Array(9),_r=new Float32Array(4);function xr(e,t,n){var r=e[0];if(r<=0||r>0)return e;var a=t*n,i=vr[a];if(void 0===i&&(i=new Float32Array(a),vr[a]=i),0!==t){r.toArray(i,0);for(var o=1,s=0;o!==t;++o)s+=n,e[o].toArray(i,s)}return i}function Er(e,t){if(e.length!==t.length)return!1;for(var n=0,r=e.length;n<r;n++)if(e[n]!==t[n])return!1;return!0}function Sr(e,t){for(var n=0,r=t.length;n<r;n++)e[n]=t[n]}function Mr(e,t){var n=gr[t];void 0===n&&(n=new Int32Array(t),gr[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Tr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function wr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Er(n,t))return;e.uniform2fv(this.addr,t),Sr(n,t)}}function Or(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(Er(n,t))return;e.uniform3fv(this.addr,t),Sr(n,t)}}function Ar(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Er(n,t))return;e.uniform4fv(this.addr,t),Sr(n,t)}}function Rr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Er(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Sr(n,t)}else{if(Er(n,r))return;_r.set(r),e.uniformMatrix2fv(this.addr,!1,_r),Sr(n,r)}}function Cr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Er(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Sr(n,t)}else{if(Er(n,r))return;br.set(r),e.uniformMatrix3fv(this.addr,!1,br),Sr(n,r)}}function kr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(Er(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Sr(n,t)}else{if(Er(n,r))return;yr.set(r),e.uniformMatrix4fv(this.addr,!1,yr),Sr(n,r)}}function Pr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function Lr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2i(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Er(n,t))return;e.uniform2iv(this.addr,t),Sr(n,t)}}function Ir(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3i(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Er(n,t))return;e.uniform3iv(this.addr,t),Sr(n,t)}}function Nr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Er(n,t))return;e.uniform4iv(this.addr,t),Sr(n,t)}}function Dr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function Ur(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2ui(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(Er(n,t))return;e.uniform2uiv(this.addr,t),Sr(n,t)}}function jr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3ui(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else{if(Er(n,t))return;e.uniform3uiv(this.addr,t),Sr(n,t)}}function Fr(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(Er(n,t))return;e.uniform4uiv(this.addr,t),Sr(n,t)}}function zr(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture2D(t||hr,a)}function Br(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture3D(t||pr,a)}function Hr(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTextureCube(t||mr,a)}function Vr(e,t,n){var r=this.cache,a=n.allocateTextureUnit();r[0]!==a&&(e.uniform1i(this.addr,a),r[0]=a),n.setTexture2DArray(t||fr,a)}function Gr(e,t){e.uniform1fv(this.addr,t)}function Wr(e,t){var n=xr(t,this.size,2);e.uniform2fv(this.addr,n)}function Xr(e,t){var n=xr(t,this.size,3);e.uniform3fv(this.addr,n)}function qr(e,t){var n=xr(t,this.size,4);e.uniform4fv(this.addr,n)}function Yr(e,t){var n=xr(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,n)}function Kr(e,t){var n=xr(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,n)}function Zr(e,t){var n=xr(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,n)}function Jr(e,t){e.uniform1iv(this.addr,t)}function Qr(e,t){e.uniform2iv(this.addr,t)}function $r(e,t){e.uniform3iv(this.addr,t)}function ea(e,t){e.uniform4iv(this.addr,t)}function ta(e,t){e.uniform1uiv(this.addr,t)}function na(e,t){e.uniform2uiv(this.addr,t)}function ra(e,t){e.uniform3uiv(this.addr,t)}function aa(e,t){e.uniform4uiv(this.addr,t)}function ia(e,t,n){var r=this.cache,a=t.length,i=Mr(n,a);Er(r,i)||(e.uniform1iv(this.addr,i),Sr(r,i));for(var o=0;o!==a;++o)n.setTexture2D(t[o]||hr,i[o])}function oa(e,t,n){var r=this.cache,a=t.length,i=Mr(n,a);Er(r,i)||(e.uniform1iv(this.addr,i),Sr(r,i));for(var o=0;o!==a;++o)n.setTexture3D(t[o]||pr,i[o])}function sa(e,t,n){var r=this.cache,a=t.length,i=Mr(n,a);Er(r,i)||(e.uniform1iv(this.addr,i),Sr(r,i));for(var o=0;o!==a;++o)n.setTextureCube(t[o]||mr,i[o])}function la(e,t,n){var r=this.cache,a=t.length,i=Mr(n,a);Er(r,i)||(e.uniform1iv(this.addr,i),Sr(r,i));for(var o=0;o!==a;++o)n.setTexture2DArray(t[o]||fr,i[o])}var ca=Object(m.a)((function e(t,n,r){Object(p.a)(this,e),this.id=t,this.addr=r,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Tr;case 35664:return wr;case 35665:return Or;case 35666:return Ar;case 35674:return Rr;case 35675:return Cr;case 35676:return kr;case 5124:case 35670:return Pr;case 35667:case 35671:return Lr;case 35668:case 35672:return Ir;case 35669:case 35673:return Nr;case 5125:return Dr;case 36294:return Ur;case 36295:return jr;case 36296:return Fr;case 35678:case 36198:case 36298:case 36306:case 35682:return zr;case 35679:case 36299:case 36307:return Br;case 35680:case 36300:case 36308:case 36293:return Hr;case 36289:case 36303:case 36311:case 36292:return Vr}}(n.type)})),ua=Object(m.a)((function e(t,n,r){Object(p.a)(this,e),this.id=t,this.addr=r,this.cache=[],this.size=n.size,this.setValue=function(e){switch(e){case 5126:return Gr;case 35664:return Wr;case 35665:return Xr;case 35666:return qr;case 35674:return Yr;case 35675:return Kr;case 35676:return Zr;case 5124:case 35670:return Jr;case 35667:case 35671:return Qr;case 35668:case 35672:return $r;case 35669:case 35673:return ea;case 5125:return ta;case 36294:return na;case 36295:return ra;case 36296:return aa;case 35678:case 36198:case 36298:case 36306:case 35682:return ia;case 35679:case 36299:case 36307:return oa;case 35680:case 36300:case 36308:case 36293:return sa;case 36289:case 36303:case 36311:case 36292:return la}}(n.type)})),da=function(){return Object(m.a)((function e(t){Object(p.a)(this,e),this.id=t,this.seq=[],this.map={}}),[{key:"setValue",value:function(e,t,n){for(var r=this.seq,a=0,i=r.length;a!==i;++a){var o=r[a];o.setValue(e,t[o.id],n)}}}])}(),ha=/(\w+)(\])?(\[|\.)?/g;function fa(e,t){e.seq.push(t),e.map[t.id]=t}function pa(e,t,n){var r=e.name,a=r.length;for(ha.lastIndex=0;;){var i=ha.exec(r),o=ha.lastIndex,s=i[1],l="]"===i[2],c=i[3];if(l&&(s|=0),void 0===c||"["===c&&o+2===a){fa(n,void 0===c?new ca(s,e,t):new ua(s,e,t));break}var u=n.map[s];void 0===u&&fa(n,u=new da(s)),n=u}}var ma=function(){return Object(m.a)((function e(t,n){Object(p.a)(this,e),this.seq=[],this.map={};for(var r=t.getProgramParameter(n,t.ACTIVE_UNIFORMS),a=0;a<r;++a){var i=t.getActiveUniform(n,a);pa(i,t.getUniformLocation(n,i.name),this)}}),[{key:"setValue",value:function(e,t,n,r){var a=this.map[t];void 0!==a&&a.setValue(e,n,r)}},{key:"setOptional",value:function(e,t,n){var r=t[n];void 0!==r&&this.setValue(e,n,r)}}],[{key:"upload",value:function(e,t,n,r){for(var a=0,i=t.length;a!==i;++a){var o=t[a],s=n[o.id];!1!==s.needsUpdate&&o.setValue(e,s.value,r)}}},{key:"seqWithValue",value:function(e,t){for(var n=[],r=0,a=e.length;r!==a;++r){var i=e[r];i.id in t&&n.push(i)}return n}}])}();function va(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}var ga=0;function ya(e,t,n){var r=e.getShaderParameter(t,e.COMPILE_STATUS),a=e.getShaderInfoLog(t).trim();if(r&&""===a)return"";var i=/ERROR: 0:(\d+)/.exec(a);if(i){var o=parseInt(i[1]);return n.toUpperCase()+"\n\n"+a+"\n\n"+function(e,t){for(var n=e.split("\n"),r=[],a=Math.max(t-6,0),i=Math.min(t+6,n.length),o=a;o<i;o++){var s=o+1;r.push("".concat(s===t?">":" "," ").concat(s,": ").concat(n[o]))}return r.join("\n")}(e.getShaderSource(t),o)}return a}function ba(e,t){var n=function(e){switch(e){case"srgb-linear":return["Linear","( value )"];case"srgb":return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported color space:",e),["Linear","( value )"]}}(t);return"vec4 "+e+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function _a(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function xa(e){return""!==e}function Ea(e,t){var n=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,n).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Sa(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Ma=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ta(e){return e.replace(Ma,Oa)}var wa=new Map([["encodings_fragment","colorspace_fragment"],["encodings_pars_fragment","colorspace_pars_fragment"],["output_fragment","opaque_fragment"]]);function Oa(e,t){var n=In[t];if(void 0===n){var r=wa.get(t);if(void 0===r)throw new Error("Can not resolve #include <"+t+">");n=In[r],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,r)}return Ta(n)}var Aa=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Ra(e){return e.replace(Aa,Ca)}function Ca(e,t,n,r){for(var a="",i=parseInt(t);i<parseInt(n);i++)a+=r.replace(/\[\s*i\s*\]/g,"[ "+i+" ]").replace(/UNROLLED_LOOP_INDEX/g,i);return a}function ka(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function Pa(e,t,n,r){var a,i,o=e.getContext(),s=n.defines,l=n.vertexShader,c=n.fragmentShader,u=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),d=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case 301:case 302:t="ENVMAP_TYPE_CUBE";break;case 306:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),h=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case 302:t="ENVMAP_MODE_REFRACTION"}return t}(n),f=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),p=function(e){var t=e.envMapCubeUVHeight;if(null===t)return null;var n=Math.log2(t)-2,r=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),112)),texelHeight:r,maxMip:n}}(n),m=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUVHeight||e.bumpMap||e.normalMapTangentSpace||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap||e.transmission)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(xa).join("\n")}(n),v=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(s),g=o.createProgram(),y=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((a=["#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(xa).join("\n")).length>0&&(a+="\n"),(i=[m,"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v].filter(xa).join("\n")).length>0&&(i+="\n")):(a=[ka(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+h:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.displacementMap?"#define USE_DISPLACEMENTMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.mapUv?"#define MAP_UV "+n.mapUv:"",n.alphaMapUv?"#define ALPHAMAP_UV "+n.alphaMapUv:"",n.lightMapUv?"#define LIGHTMAP_UV "+n.lightMapUv:"",n.aoMapUv?"#define AOMAP_UV "+n.aoMapUv:"",n.emissiveMapUv?"#define EMISSIVEMAP_UV "+n.emissiveMapUv:"",n.bumpMapUv?"#define BUMPMAP_UV "+n.bumpMapUv:"",n.normalMapUv?"#define NORMALMAP_UV "+n.normalMapUv:"",n.displacementMapUv?"#define DISPLACEMENTMAP_UV "+n.displacementMapUv:"",n.metalnessMapUv?"#define METALNESSMAP_UV "+n.metalnessMapUv:"",n.roughnessMapUv?"#define ROUGHNESSMAP_UV "+n.roughnessMapUv:"",n.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+n.anisotropyMapUv:"",n.clearcoatMapUv?"#define CLEARCOATMAP_UV "+n.clearcoatMapUv:"",n.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+n.clearcoatNormalMapUv:"",n.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+n.clearcoatRoughnessMapUv:"",n.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+n.iridescenceMapUv:"",n.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+n.iridescenceThicknessMapUv:"",n.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+n.sheenColorMapUv:"",n.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+n.sheenRoughnessMapUv:"",n.specularMapUv?"#define SPECULARMAP_UV "+n.specularMapUv:"",n.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+n.specularColorMapUv:"",n.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+n.specularIntensityMapUv:"",n.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+n.transmissionMapUv:"",n.thicknessMapUv?"#define THICKNESSMAP_UV "+n.thicknessMapUv:"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","\tattribute vec2 uv1;","#endif","#ifdef USE_UV2","\tattribute vec2 uv2;","#endif","#ifdef USE_UV3","\tattribute vec2 uv3;","#endif","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(xa).join("\n"),i=[m,ka(n),"#define SHADER_TYPE "+n.shaderType,"#define SHADER_NAME "+n.shaderName,v,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+d:"",n.envMap?"#define "+h:"",n.envMap?"#define "+f:"",p?"#define CUBEUV_TEXEL_WIDTH "+p.texelWidth:"",p?"#define CUBEUV_TEXEL_HEIGHT "+p.texelHeight:"",p?"#define CUBEUV_MAX_MIP "+p.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",n.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.anisotropy?"#define USE_ANISOTROPY":"",n.anisotropyMap?"#define USE_ANISOTROPYMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",n.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.alphaHash?"#define USE_ALPHAHASH":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.vertexTangents&&!1===n.flatShading?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUv1s?"#define USE_UV1":"",n.vertexUv2s?"#define USE_UV2":"",n.vertexUv3s?"#define USE_UV3":"",n.pointsUvs?"#define USE_POINTS_UV":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+u:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.useLegacyLights?"#define LEGACY_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?In.tonemapping_pars_fragment:"",0!==n.toneMapping?_a("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",In.colorspace_pars_fragment,ba("linearToOutputTexel",n.outputColorSpace),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(xa).join("\n")),l=Sa(l=Ea(l=Ta(l),n),n),c=Sa(c=Ea(c=Ta(c),n),n),l=Ra(l),c=Ra(c),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(y="#version 300 es\n",a=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+a,i=["#define varying in","300 es"===n.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===n.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+i);var b,_,x=y+a+l,E=y+i+c,S=va(o,o.VERTEX_SHADER,x),M=va(o,o.FRAGMENT_SHADER,E);if(o.attachShader(g,S),o.attachShader(g,M),void 0!==n.index0AttributeName?o.bindAttribLocation(g,0,n.index0AttributeName):!0===n.morphTargets&&o.bindAttribLocation(g,0,"position"),o.linkProgram(g),e.debug.checkShaderErrors){var T=o.getProgramInfoLog(g).trim(),w=o.getShaderInfoLog(S).trim(),O=o.getShaderInfoLog(M).trim(),A=!0,R=!0;if(!1===o.getProgramParameter(g,o.LINK_STATUS))if(A=!1,"function"===typeof e.debug.onShaderError)e.debug.onShaderError(o,g,S,M);else{var C=ya(o,S,"vertex"),k=ya(o,M,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(g,o.VALIDATE_STATUS)+"\n\nProgram Info Log: "+T+"\n"+C+"\n"+k)}else""!==T?console.warn("THREE.WebGLProgram: Program Info Log:",T):""!==w&&""!==O||(R=!1);R&&(this.diagnostics={runnable:A,programLog:T,vertexShader:{log:w,prefix:a},fragmentShader:{log:O,prefix:i}})}return o.deleteShader(S),o.deleteShader(M),this.getUniforms=function(){return void 0===b&&(b=new ma(o,g)),b},this.getAttributes=function(){return void 0===_&&(_=function(e,t){for(var n={},r=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES),a=0;a<r;a++){var i=e.getActiveAttrib(t,a),o=i.name,s=1;i.type===e.FLOAT_MAT2&&(s=2),i.type===e.FLOAT_MAT3&&(s=3),i.type===e.FLOAT_MAT4&&(s=4),n[o]={type:i.type,location:e.getAttribLocation(t,o),locationSize:s}}return n}(o,g)),_},this.destroy=function(){r.releaseStatesOfProgram(this),o.deleteProgram(g),this.program=void 0},this.type=n.shaderType,this.name=n.shaderName,this.id=ga++,this.cacheKey=t,this.usedTimes=1,this.program=g,this.vertexShader=S,this.fragmentShader=M,this}var La=0,Ia=function(){return Object(m.a)((function e(){Object(p.a)(this,e),this.shaderCache=new Map,this.materialCache=new Map}),[{key:"update",value:function(e){var t=e.vertexShader,n=e.fragmentShader,r=this._getShaderStage(t),a=this._getShaderStage(n),i=this._getShaderCacheForMaterial(e);return!1===i.has(r)&&(i.add(r),r.usedTimes++),!1===i.has(a)&&(i.add(a),a.usedTimes++),this}},{key:"remove",value:function(e){var t,n=this.materialCache.get(e),r=Object(o.a)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;a.usedTimes--,0===a.usedTimes&&this.shaderCache.delete(a.code)}}catch(i){r.e(i)}finally{r.f()}return this.materialCache.delete(e),this}},{key:"getVertexShaderID",value:function(e){return this._getShaderStage(e.vertexShader).id}},{key:"getFragmentShaderID",value:function(e){return this._getShaderStage(e.fragmentShader).id}},{key:"dispose",value:function(){this.shaderCache.clear(),this.materialCache.clear()}},{key:"_getShaderCacheForMaterial",value:function(e){var t=this.materialCache,n=t.get(e);return void 0===n&&(n=new Set,t.set(e,n)),n}},{key:"_getShaderStage",value:function(e){var t=this.shaderCache,n=t.get(e);return void 0===n&&(n=new Na(e),t.set(e,n)),n}}])}(),Na=Object(m.a)((function e(t){Object(p.a)(this,e),this.id=La++,this.code=t,this.usedTimes=0}));function Da(e,t,n,r,a,i,o){var s=new Je,l=new Ia,c=[],u=a.isWebGL2,d=a.logarithmicDepthBuffer,h=a.vertexTextures,f=a.precision,p={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function m(e){return 0===e?"uv":"uv".concat(e)}return{getParameters:function(i,s,c,v,g){var y=v.fog,b=g.geometry,_=i.isMeshStandardMaterial?v.environment:null,x=(i.isMeshStandardMaterial?n:t).get(i.envMap||_),E=x&&306===x.mapping?x.image.height:null,S=p[i.type];null!==i.precision&&(f=a.getMaxPrecision(i.precision))!==i.precision&&console.warn("THREE.WebGLProgram.getParameters:",i.precision,"not supported, using",f,"instead.");var M,T,w,O,A=b.morphAttributes.position||b.morphAttributes.normal||b.morphAttributes.color,R=void 0!==A?A.length:0,C=0;if(void 0!==b.morphAttributes.position&&(C=1),void 0!==b.morphAttributes.normal&&(C=2),void 0!==b.morphAttributes.color&&(C=3),S){var k=Dn[S];M=k.vertexShader,T=k.fragmentShader}else M=i.vertexShader,T=i.fragmentShader,l.update(i),w=l.getVertexShaderID(i),O=l.getFragmentShaderID(i);var P=e.getRenderTarget(),L=!0===g.isInstancedMesh,I=!!i.map,N=!!i.matcap,D=!!x,U=!!i.aoMap,j=!!i.lightMap,F=!!i.bumpMap,z=!!i.normalMap,B=!!i.displacementMap,H=!!i.emissiveMap,V=!!i.metalnessMap,G=!!i.roughnessMap,W=i.anisotropy>0,X=i.clearcoat>0,q=i.iridescence>0,Y=i.sheen>0,K=i.transmission>0,Z=W&&!!i.anisotropyMap,J=X&&!!i.clearcoatMap,Q=X&&!!i.clearcoatNormalMap,$=X&&!!i.clearcoatRoughnessMap,ee=q&&!!i.iridescenceMap,te=q&&!!i.iridescenceThicknessMap,ne=Y&&!!i.sheenColorMap,re=Y&&!!i.sheenRoughnessMap,ae=!!i.specularMap,ie=!!i.specularColorMap,oe=!!i.specularIntensityMap,se=K&&!!i.transmissionMap,le=K&&!!i.thicknessMap,ce=!!i.gradientMap,ue=!!i.alphaMap,de=i.alphaTest>0,he=!!i.alphaHash,fe=!!i.extensions,pe=!!b.attributes.uv1,me=!!b.attributes.uv2,ve=!!b.attributes.uv3,ge=0;return i.toneMapped&&(null!==P&&!0!==P.isXRRenderTarget||(ge=e.toneMapping)),{isWebGL2:u,shaderID:S,shaderType:i.type,shaderName:i.name,vertexShader:M,fragmentShader:T,defines:i.defines,customVertexShaderID:w,customFragmentShaderID:O,isRawShaderMaterial:!0===i.isRawShaderMaterial,glslVersion:i.glslVersion,precision:f,instancing:L,instancingColor:L&&null!==g.instanceColor,supportsVertexTextures:h,outputColorSpace:null===P?e.outputColorSpace:!0===P.isXRRenderTarget?P.texture.colorSpace:"srgb-linear",map:I,matcap:N,envMap:D,envMapMode:D&&x.mapping,envMapCubeUVHeight:E,aoMap:U,lightMap:j,bumpMap:F,normalMap:z,displacementMap:h&&B,emissiveMap:H,normalMapObjectSpace:z&&1===i.normalMapType,normalMapTangentSpace:z&&0===i.normalMapType,metalnessMap:V,roughnessMap:G,anisotropy:W,anisotropyMap:Z,clearcoat:X,clearcoatMap:J,clearcoatNormalMap:Q,clearcoatRoughnessMap:$,iridescence:q,iridescenceMap:ee,iridescenceThicknessMap:te,sheen:Y,sheenColorMap:ne,sheenRoughnessMap:re,specularMap:ae,specularColorMap:ie,specularIntensityMap:oe,transmission:K,transmissionMap:se,thicknessMap:le,gradientMap:ce,opaque:!1===i.transparent&&1===i.blending,alphaMap:ue,alphaTest:de,alphaHash:he,combine:i.combine,mapUv:I&&m(i.map.channel),aoMapUv:U&&m(i.aoMap.channel),lightMapUv:j&&m(i.lightMap.channel),bumpMapUv:F&&m(i.bumpMap.channel),normalMapUv:z&&m(i.normalMap.channel),displacementMapUv:B&&m(i.displacementMap.channel),emissiveMapUv:H&&m(i.emissiveMap.channel),metalnessMapUv:V&&m(i.metalnessMap.channel),roughnessMapUv:G&&m(i.roughnessMap.channel),anisotropyMapUv:Z&&m(i.anisotropyMap.channel),clearcoatMapUv:J&&m(i.clearcoatMap.channel),clearcoatNormalMapUv:Q&&m(i.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:$&&m(i.clearcoatRoughnessMap.channel),iridescenceMapUv:ee&&m(i.iridescenceMap.channel),iridescenceThicknessMapUv:te&&m(i.iridescenceThicknessMap.channel),sheenColorMapUv:ne&&m(i.sheenColorMap.channel),sheenRoughnessMapUv:re&&m(i.sheenRoughnessMap.channel),specularMapUv:ae&&m(i.specularMap.channel),specularColorMapUv:ie&&m(i.specularColorMap.channel),specularIntensityMapUv:oe&&m(i.specularIntensityMap.channel),transmissionMapUv:se&&m(i.transmissionMap.channel),thicknessMapUv:le&&m(i.thicknessMap.channel),alphaMapUv:ue&&m(i.alphaMap.channel),vertexTangents:!!b.attributes.tangent&&(z||W),vertexColors:i.vertexColors,vertexAlphas:!0===i.vertexColors&&!!b.attributes.color&&4===b.attributes.color.itemSize,vertexUv1s:pe,vertexUv2s:me,vertexUv3s:ve,pointsUvs:!0===g.isPoints&&!!b.attributes.uv&&(I||ue),fog:!!y,useFog:!0===i.fog,fogExp2:y&&y.isFogExp2,flatShading:!0===i.flatShading,sizeAttenuation:!0===i.sizeAttenuation,logarithmicDepthBuffer:d,skinning:!0===g.isSkinnedMesh,morphTargets:void 0!==b.morphAttributes.position,morphNormals:void 0!==b.morphAttributes.normal,morphColors:void 0!==b.morphAttributes.color,morphTargetsCount:R,morphTextureStride:C,numDirLights:s.directional.length,numPointLights:s.point.length,numSpotLights:s.spot.length,numSpotLightMaps:s.spotLightMap.length,numRectAreaLights:s.rectArea.length,numHemiLights:s.hemi.length,numDirLightShadows:s.directionalShadowMap.length,numPointLightShadows:s.pointShadowMap.length,numSpotLightShadows:s.spotShadowMap.length,numSpotLightShadowsWithMaps:s.numSpotLightShadowsWithMaps,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:i.dithering,shadowMapEnabled:e.shadowMap.enabled&&c.length>0,shadowMapType:e.shadowMap.type,toneMapping:ge,useLegacyLights:e._useLegacyLights,premultipliedAlpha:i.premultipliedAlpha,doubleSided:2===i.side,flipSided:1===i.side,useDepthPacking:i.depthPacking>=0,depthPacking:i.depthPacking||0,index0AttributeName:i.index0AttributeName,extensionDerivatives:fe&&!0===i.extensions.derivatives,extensionFragDepth:fe&&!0===i.extensions.fragDepth,extensionDrawBuffers:fe&&!0===i.extensions.drawBuffers,extensionShaderTextureLOD:fe&&!0===i.extensions.shaderTextureLOD,rendererExtensionFragDepth:u||r.has("EXT_frag_depth"),rendererExtensionDrawBuffers:u||r.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:u||r.has("EXT_shader_texture_lod"),customProgramCacheKey:i.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.customVertexShaderID),n.push(t.customFragmentShaderID)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);return!1===t.isRawShaderMaterial&&(!function(e,t){e.push(t.precision),e.push(t.outputColorSpace),e.push(t.envMapMode),e.push(t.envMapCubeUVHeight),e.push(t.mapUv),e.push(t.alphaMapUv),e.push(t.lightMapUv),e.push(t.aoMapUv),e.push(t.bumpMapUv),e.push(t.normalMapUv),e.push(t.displacementMapUv),e.push(t.emissiveMapUv),e.push(t.metalnessMapUv),e.push(t.roughnessMapUv),e.push(t.anisotropyMapUv),e.push(t.clearcoatMapUv),e.push(t.clearcoatNormalMapUv),e.push(t.clearcoatRoughnessMapUv),e.push(t.iridescenceMapUv),e.push(t.iridescenceThicknessMapUv),e.push(t.sheenColorMapUv),e.push(t.sheenRoughnessMapUv),e.push(t.specularMapUv),e.push(t.specularColorMapUv),e.push(t.specularIntensityMapUv),e.push(t.transmissionMapUv),e.push(t.thicknessMapUv),e.push(t.combine),e.push(t.fogExp2),e.push(t.sizeAttenuation),e.push(t.morphTargetsCount),e.push(t.morphAttributeCount),e.push(t.numDirLights),e.push(t.numPointLights),e.push(t.numSpotLights),e.push(t.numSpotLightMaps),e.push(t.numHemiLights),e.push(t.numRectAreaLights),e.push(t.numDirLightShadows),e.push(t.numPointLightShadows),e.push(t.numSpotLightShadows),e.push(t.numSpotLightShadowsWithMaps),e.push(t.shadowMapType),e.push(t.toneMapping),e.push(t.numClippingPlanes),e.push(t.numClipIntersection),e.push(t.depthPacking)}(n,t),function(e,t){s.disableAll(),t.isWebGL2&&s.enable(0);t.supportsVertexTextures&&s.enable(1);t.instancing&&s.enable(2);t.instancingColor&&s.enable(3);t.matcap&&s.enable(4);t.envMap&&s.enable(5);t.normalMapObjectSpace&&s.enable(6);t.normalMapTangentSpace&&s.enable(7);t.clearcoat&&s.enable(8);t.iridescence&&s.enable(9);t.alphaTest&&s.enable(10);t.vertexColors&&s.enable(11);t.vertexAlphas&&s.enable(12);t.vertexUv1s&&s.enable(13);t.vertexUv2s&&s.enable(14);t.vertexUv3s&&s.enable(15);t.vertexTangents&&s.enable(16);t.anisotropy&&s.enable(17);e.push(s.mask),s.disableAll(),t.fog&&s.enable(0);t.useFog&&s.enable(1);t.flatShading&&s.enable(2);t.logarithmicDepthBuffer&&s.enable(3);t.skinning&&s.enable(4);t.morphTargets&&s.enable(5);t.morphNormals&&s.enable(6);t.morphColors&&s.enable(7);t.premultipliedAlpha&&s.enable(8);t.shadowMapEnabled&&s.enable(9);t.useLegacyLights&&s.enable(10);t.doubleSided&&s.enable(11);t.flipSided&&s.enable(12);t.useDepthPacking&&s.enable(13);t.dithering&&s.enable(14);t.transmission&&s.enable(15);t.sheen&&s.enable(16);t.opaque&&s.enable(17);t.pointsUvs&&s.enable(18);e.push(s.mask)}(n,t),n.push(e.outputColorSpace)),n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=p[e.type];if(n){var r=Dn[n];t=gn.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,a=0,o=c.length;a<o;a++){var s=c[a];if(s.cacheKey===n){++(r=s).usedTimes;break}}return void 0===r&&(r=new Pa(e,n,t,i),c.push(r)),r},releaseProgram:function(e){if(0===--e.usedTimes){var t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},releaseShaderCache:function(e){l.remove(e)},programs:c,dispose:function(){l.dispose()}}}function Ua(){var e=new WeakMap;return{get:function(t){var n=e.get(t);return void 0===n&&(n={},e.set(t,n)),n},remove:function(t){e.delete(t)},update:function(t,n,r){e.get(t)[n]=r},dispose:function(){e=new WeakMap}}}function ja(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function Fa(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function za(){var e=[],t=0,n=[],r=[],a=[];function i(n,r,a,i,o,s){var l=e[t];return void 0===l?(l={id:n.id,object:n,geometry:r,material:a,groupOrder:i,renderOrder:n.renderOrder,z:o,group:s},e[t]=l):(l.id=n.id,l.object=n,l.geometry=r,l.material=a,l.groupOrder=i,l.renderOrder=n.renderOrder,l.z=o,l.group=s),t++,l}return{opaque:n,transmissive:r,transparent:a,init:function(){t=0,n.length=0,r.length=0,a.length=0},push:function(e,t,o,s,l,c){var u=i(e,t,o,s,l,c);o.transmission>0?r.push(u):!0===o.transparent?a.push(u):n.push(u)},unshift:function(e,t,o,s,l,c){var u=i(e,t,o,s,l,c);o.transmission>0?r.unshift(u):!0===o.transparent?a.unshift(u):n.unshift(u)},finish:function(){for(var n=t,r=e.length;n<r;n++){var a=e[n];if(null===a.id)break;a.id=null,a.object=null,a.geometry=null,a.material=null,a.group=null}},sort:function(e,t){n.length>1&&n.sort(e||ja),r.length>1&&r.sort(t||Fa),a.length>1&&a.sort(t||Fa)}}}function Ba(){var e=new WeakMap;return{get:function(t,n){var r,a=e.get(t);return void 0===a?(r=new za,e.set(t,[r])):n>=a.length?(r=new za,a.push(r)):r=a[n],r},dispose:function(){e=new WeakMap}}}function Ha(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new ue,color:new Ct};break;case"SpotLight":n={position:new ue,direction:new ue,color:new Ct,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new ue,color:new Ct,distance:0,decay:0};break;case"HemisphereLight":n={direction:new ue,skyColor:new Ct,groundColor:new Ct};break;case"RectAreaLight":n={color:new Ct,position:new ue,halfWidth:new ue,halfHeight:new ue}}return e[t.id]=n,n}}}var Va=0;function Ga(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Wa(e,t){for(var n=new Ha,r=function(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new j};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new j,shadowCameraNear:1,shadowCameraFar:1e3}}return e[t.id]=n,n}}}(),a={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0},i=0;i<9;i++)a.probe.push(new ue);var o=new ue,s=new ze,l=new ze;return{setup:function(i,o){for(var s=0,l=0,c=0,u=0;u<9;u++)a.probe[u].set(0,0,0);var d=0,h=0,f=0,p=0,m=0,v=0,g=0,y=0,b=0,_=0;i.sort(Ga);for(var x=!0===o?Math.PI:1,E=0,S=i.length;E<S;E++){var M=i[E],T=M.color,w=M.intensity,O=M.distance,A=M.shadow&&M.shadow.map?M.shadow.map.texture:null;if(M.isAmbientLight)s+=T.r*w*x,l+=T.g*w*x,c+=T.b*w*x;else if(M.isLightProbe)for(var R=0;R<9;R++)a.probe[R].addScaledVector(M.sh.coefficients[R],w);else if(M.isDirectionalLight){var C=n.get(M);if(C.color.copy(M.color).multiplyScalar(M.intensity*x),M.castShadow){var k=M.shadow,P=r.get(M);P.shadowBias=k.bias,P.shadowNormalBias=k.normalBias,P.shadowRadius=k.radius,P.shadowMapSize=k.mapSize,a.directionalShadow[d]=P,a.directionalShadowMap[d]=A,a.directionalShadowMatrix[d]=M.shadow.matrix,v++}a.directional[d]=C,d++}else if(M.isSpotLight){var L=n.get(M);L.position.setFromMatrixPosition(M.matrixWorld),L.color.copy(T).multiplyScalar(w*x),L.distance=O,L.coneCos=Math.cos(M.angle),L.penumbraCos=Math.cos(M.angle*(1-M.penumbra)),L.decay=M.decay,a.spot[f]=L;var I=M.shadow;if(M.map&&(a.spotLightMap[b]=M.map,b++,I.updateMatrices(M),M.castShadow&&_++),a.spotLightMatrix[f]=I.matrix,M.castShadow){var N=r.get(M);N.shadowBias=I.bias,N.shadowNormalBias=I.normalBias,N.shadowRadius=I.radius,N.shadowMapSize=I.mapSize,a.spotShadow[f]=N,a.spotShadowMap[f]=A,y++}f++}else if(M.isRectAreaLight){var D=n.get(M);D.color.copy(T).multiplyScalar(w),D.halfWidth.set(.5*M.width,0,0),D.halfHeight.set(0,.5*M.height,0),a.rectArea[p]=D,p++}else if(M.isPointLight){var U=n.get(M);if(U.color.copy(M.color).multiplyScalar(M.intensity*x),U.distance=M.distance,U.decay=M.decay,M.castShadow){var j=M.shadow,F=r.get(M);F.shadowBias=j.bias,F.shadowNormalBias=j.normalBias,F.shadowRadius=j.radius,F.shadowMapSize=j.mapSize,F.shadowCameraNear=j.camera.near,F.shadowCameraFar=j.camera.far,a.pointShadow[h]=F,a.pointShadowMap[h]=A,a.pointShadowMatrix[h]=M.shadow.matrix,g++}a.point[h]=U,h++}else if(M.isHemisphereLight){var z=n.get(M);z.skyColor.copy(M.color).multiplyScalar(w*x),z.groundColor.copy(M.groundColor).multiplyScalar(w*x),a.hemi[m]=z,m++}}p>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(a.rectAreaLTC1=Nn.LTC_FLOAT_1,a.rectAreaLTC2=Nn.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(a.rectAreaLTC1=Nn.LTC_HALF_1,a.rectAreaLTC2=Nn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),a.ambient[0]=s,a.ambient[1]=l,a.ambient[2]=c;var B=a.hash;B.directionalLength===d&&B.pointLength===h&&B.spotLength===f&&B.rectAreaLength===p&&B.hemiLength===m&&B.numDirectionalShadows===v&&B.numPointShadows===g&&B.numSpotShadows===y&&B.numSpotMaps===b||(a.directional.length=d,a.spot.length=f,a.rectArea.length=p,a.point.length=h,a.hemi.length=m,a.directionalShadow.length=v,a.directionalShadowMap.length=v,a.pointShadow.length=g,a.pointShadowMap.length=g,a.spotShadow.length=y,a.spotShadowMap.length=y,a.directionalShadowMatrix.length=v,a.pointShadowMatrix.length=g,a.spotLightMatrix.length=y+b-_,a.spotLightMap.length=b,a.numSpotLightShadowsWithMaps=_,B.directionalLength=d,B.pointLength=h,B.spotLength=f,B.rectAreaLength=p,B.hemiLength=m,B.numDirectionalShadows=v,B.numPointShadows=g,B.numSpotShadows=y,B.numSpotMaps=b,a.version=Va++)},setupView:function(e,t){for(var n=0,r=0,i=0,c=0,u=0,d=t.matrixWorldInverse,h=0,f=e.length;h<f;h++){var p=e[h];if(p.isDirectionalLight){var m=a.directional[n];m.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),m.direction.sub(o),m.direction.transformDirection(d),n++}else if(p.isSpotLight){var v=a.spot[i];v.position.setFromMatrixPosition(p.matrixWorld),v.position.applyMatrix4(d),v.direction.setFromMatrixPosition(p.matrixWorld),o.setFromMatrixPosition(p.target.matrixWorld),v.direction.sub(o),v.direction.transformDirection(d),i++}else if(p.isRectAreaLight){var g=a.rectArea[c];g.position.setFromMatrixPosition(p.matrixWorld),g.position.applyMatrix4(d),l.identity(),s.copy(p.matrixWorld),s.premultiply(d),l.extractRotation(s),g.halfWidth.set(.5*p.width,0,0),g.halfHeight.set(0,.5*p.height,0),g.halfWidth.applyMatrix4(l),g.halfHeight.applyMatrix4(l),c++}else if(p.isPointLight){var y=a.point[r];y.position.setFromMatrixPosition(p.matrixWorld),y.position.applyMatrix4(d),r++}else if(p.isHemisphereLight){var b=a.hemi[u];b.direction.setFromMatrixPosition(p.matrixWorld),b.direction.transformDirection(d),u++}}},state:a}}function Xa(e,t){var n=new Wa(e,t),r=[],a=[];return{init:function(){r.length=0,a.length=0},state:{lightsArray:r,shadowsArray:a,lights:n},setupLights:function(e){n.setup(r,e)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){a.push(e)}}}function qa(e,t){var n=new WeakMap;return{get:function(r){var a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=n.get(r);return void 0===o?(a=new Xa(e,t),n.set(r,[a])):i>=o.length?(a=new Xa(e,t),o.push(a)):a=o[i],a},dispose:function(){n=new WeakMap}}}var Ya=function(e){function t(e){var n;return Object(p.a)(this,t),(n=v(this,t)).isMeshDepthMaterial=!0,n.type="MeshDepthMaterial",n.depthPacking=3200,n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.wireframe=!1,n.wireframeLinewidth=1,n.setValues(e),n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e){return c(Object(l.a)(t.prototype),"copy",this).call(this,e),this.depthPacking=e.depthPacking,this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this}}])}(Tt),Ka=function(e){function t(e){var n;return Object(p.a)(this,t),(n=v(this,t)).isMeshDistanceMaterial=!0,n.type="MeshDistanceMaterial",n.map=null,n.alphaMap=null,n.displacementMap=null,n.displacementScale=1,n.displacementBias=0,n.setValues(e),n}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e){return c(Object(l.a)(t.prototype),"copy",this).call(this,e),this.map=e.map,this.alphaMap=e.alphaMap,this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this}}])}(Tt);function Za(e,t,n){var r=new Cn,a=new j,i=new j,o=new ie,s=new Ya({depthPacking:3201}),l=new Ka,c={},u=n.maxTextureSize,d=Object(f.a)(Object(f.a)(Object(f.a)({},0,1),1,0),2,2),h=new yn({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new j},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),p=h.clone();p.defines.HORIZONTAL_PASS=1;var m=new Xt;m.setAttribute("position",new Nt(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var v=new dn(m,h),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1;var y=this.type;function b(n,r){var i=t.update(v);h.defines.VSM_SAMPLES!==n.blurSamples&&(h.defines.VSM_SAMPLES=n.blurSamples,p.defines.VSM_SAMPLES=n.blurSamples,h.needsUpdate=!0,p.needsUpdate=!0),null===n.mapPass&&(n.mapPass=new oe(a.x,a.y)),h.uniforms.shadow_pass.value=n.map.texture,h.uniforms.resolution.value=n.mapSize,h.uniforms.radius.value=n.radius,e.setRenderTarget(n.mapPass),e.clear(),e.renderBufferDirect(r,null,i,h,v,null),p.uniforms.shadow_pass.value=n.mapPass.texture,p.uniforms.resolution.value=n.mapSize,p.uniforms.radius.value=n.radius,e.setRenderTarget(n.map),e.clear(),e.renderBufferDirect(r,null,i,p,v,null)}function _(t,n,r,a){var i=null,o=!0===r.isPointLight?t.customDistanceMaterial:t.customDepthMaterial;if(void 0!==o)i=o;else if(i=!0===r.isPointLight?l:s,e.localClippingEnabled&&!0===n.clipShadows&&Array.isArray(n.clippingPlanes)&&0!==n.clippingPlanes.length||n.displacementMap&&0!==n.displacementScale||n.alphaMap&&n.alphaTest>0||n.map&&n.alphaTest>0){var u=i.uuid,h=n.uuid,f=c[u];void 0===f&&(f={},c[u]=f);var p=f[h];void 0===p&&(p=i.clone(),f[h]=p),i=p}(i.visible=n.visible,i.wireframe=n.wireframe,i.side=3===a?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:d[n.side],i.alphaMap=n.alphaMap,i.alphaTest=n.alphaTest,i.map=n.map,i.clipShadows=n.clipShadows,i.clippingPlanes=n.clippingPlanes,i.clipIntersection=n.clipIntersection,i.displacementMap=n.displacementMap,i.displacementScale=n.displacementScale,i.displacementBias=n.displacementBias,i.wireframeLinewidth=n.wireframeLinewidth,i.linewidth=n.linewidth,!0===r.isPointLight&&!0===i.isMeshDistanceMaterial)&&(e.properties.get(i).light=r);return i}function x(n,a,i,o,s){if(!1!==n.visible){if(n.layers.test(a.layers)&&(n.isMesh||n.isLine||n.isPoints)&&(n.castShadow||n.receiveShadow&&3===s)&&(!n.frustumCulled||r.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(i.matrixWorldInverse,n.matrixWorld);var l=t.update(n),c=n.material;if(Array.isArray(c))for(var u=l.groups,d=0,h=u.length;d<h;d++){var f=u[d],p=c[f.materialIndex];if(p&&p.visible){var m=_(n,p,o,s);e.renderBufferDirect(i,null,l,m,n,f)}}else if(c.visible){var v=_(n,c,o,s);e.renderBufferDirect(i,null,l,v,n,null)}}for(var g=n.children,y=0,b=g.length;y<b;y++)x(g[y],a,i,o,s)}}this.render=function(t,n,s){if(!1!==g.enabled&&(!1!==g.autoUpdate||!1!==g.needsUpdate)&&0!==t.length){var l=e.getRenderTarget(),c=e.getActiveCubeFace(),d=e.getActiveMipmapLevel(),h=e.state;h.setBlending(0),h.buffers.color.setClear(1,1,1,1),h.buffers.depth.setTest(!0),h.setScissorTest(!1);for(var f=3!==y&&3===this.type,p=3===y&&3!==this.type,m=0,v=t.length;m<v;m++){var _=t[m],E=_.shadow;if(void 0!==E){if(!1!==E.autoUpdate||!1!==E.needsUpdate){a.copy(E.mapSize);var S=E.getFrameExtents();if(a.multiply(S),i.copy(E.mapSize),(a.x>u||a.y>u)&&(a.x>u&&(i.x=Math.floor(u/S.x),a.x=i.x*S.x,E.mapSize.x=i.x),a.y>u&&(i.y=Math.floor(u/S.y),a.y=i.y*S.y,E.mapSize.y=i.y)),null===E.map||!0===f||!0===p){var M=3!==this.type?{minFilter:1003,magFilter:1003}:{};null!==E.map&&E.map.dispose(),E.map=new oe(a.x,a.y,M),E.map.texture.name=_.name+".shadowMap",E.camera.updateProjectionMatrix()}e.setRenderTarget(E.map),e.clear();for(var T=E.getViewportCount(),w=0;w<T;w++){var O=E.getViewport(w);o.set(i.x*O.x,i.y*O.y,i.x*O.z,i.y*O.w),h.viewport(o),E.updateMatrices(_,w),r=E.getFrustum(),x(n,s,E.camera,_,this.type)}!0!==E.isPointLightShadow&&3===this.type&&b(E,s),E.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",_,"has no shadow.")}y=this.type,g.needsUpdate=!1,e.setRenderTarget(l,c,d)}}}function Ja(e,t,n){var r,a=n.isWebGL2;var i=new function(){var t=!1,n=new ie,r=null,a=new ie(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,r,i,o,s){!0===s&&(t*=o,r*=o,i*=o),n.set(t,r,i,o),!1===a.equals(n)&&(e.clearColor(t,r,i,o),a.copy(n))},reset:function(){t=!1,r=null,a.set(-1,0,0,0)}}},o=new function(){var t=!1,n=null,r=null,a=null;return{setTest:function(t){t?H(e.DEPTH_TEST):V(e.DEPTH_TEST)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){switch(t){case 0:e.depthFunc(e.NEVER);break;case 1:e.depthFunc(e.ALWAYS);break;case 2:e.depthFunc(e.LESS);break;case 3:e.depthFunc(e.LEQUAL);break;case 4:e.depthFunc(e.EQUAL);break;case 5:e.depthFunc(e.GEQUAL);break;case 6:e.depthFunc(e.GREATER);break;case 7:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}r=t}},setLocked:function(e){t=e},setClear:function(t){a!==t&&(e.clearDepth(t),a=t)},reset:function(){t=!1,n=null,r=null,a=null}}},s=new function(){var t=!1,n=null,r=null,a=null,i=null,o=null,s=null,l=null,c=null;return{setTest:function(n){t||(n?H(e.STENCIL_TEST):V(e.STENCIL_TEST))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,o){r===t&&a===n&&i===o||(e.stencilFunc(t,n,o),r=t,a=n,i=o)},setOp:function(t,n,r){o===t&&s===n&&l===r||(e.stencilOp(t,n,r),o=t,s=n,l=r)},setLocked:function(e){t=e},setClear:function(t){c!==t&&(e.clearStencil(t),c=t)},reset:function(){t=!1,n=null,r=null,a=null,i=null,o=null,s=null,l=null,c=null}}},l=new WeakMap,c=new WeakMap,u={},d={},h=new WeakMap,p=[],m=null,v=!1,g=null,y=null,b=null,_=null,x=null,E=null,S=null,M=!1,T=null,w=null,O=null,A=null,R=null,C=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS),k=!1,P=0,L=e.getParameter(e.VERSION);-1!==L.indexOf("WebGL")?(P=parseFloat(/^WebGL (\d)/.exec(L)[1]),k=P>=1):-1!==L.indexOf("OpenGL ES")&&(P=parseFloat(/^OpenGL ES (\d)/.exec(L)[1]),k=P>=2);var I=null,N={},D=e.getParameter(e.SCISSOR_BOX),U=e.getParameter(e.VIEWPORT),j=(new ie).fromArray(D),F=(new ie).fromArray(U);function z(t,n,r,i){var o=new Uint8Array(4),s=e.createTexture();e.bindTexture(t,s),e.texParameteri(t,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(t,e.TEXTURE_MAG_FILTER,e.NEAREST);for(var l=0;l<r;l++)!a||t!==e.TEXTURE_3D&&t!==e.TEXTURE_2D_ARRAY?e.texImage2D(n+l,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,o):e.texImage3D(n,0,e.RGBA,1,1,i,0,e.RGBA,e.UNSIGNED_BYTE,o);return s}var B={};function H(t){!0!==u[t]&&(e.enable(t),u[t]=!0)}function V(t){!1!==u[t]&&(e.disable(t),u[t]=!1)}B[e.TEXTURE_2D]=z(e.TEXTURE_2D,e.TEXTURE_2D,1),B[e.TEXTURE_CUBE_MAP]=z(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),a&&(B[e.TEXTURE_2D_ARRAY]=z(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),B[e.TEXTURE_3D]=z(e.TEXTURE_3D,e.TEXTURE_3D,1,1)),i.setClear(0,0,0,1),o.setClear(1),s.setClear(0),H(e.DEPTH_TEST),o.setFunc(3),Y(!1),K(1),H(e.CULL_FACE),q(0);var G=Object(f.a)(Object(f.a)(Object(f.a)({},100,e.FUNC_ADD),101,e.FUNC_SUBTRACT),102,e.FUNC_REVERSE_SUBTRACT);if(a)G[103]=e.MIN,G[104]=e.MAX;else{var W=t.get("EXT_blend_minmax");null!==W&&(G[103]=W.MIN_EXT,G[104]=W.MAX_EXT)}var X=(r={},Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(r,200,e.ZERO),201,e.ONE),202,e.SRC_COLOR),204,e.SRC_ALPHA),210,e.SRC_ALPHA_SATURATE),208,e.DST_COLOR),206,e.DST_ALPHA),203,e.ONE_MINUS_SRC_COLOR),205,e.ONE_MINUS_SRC_ALPHA),209,e.ONE_MINUS_DST_COLOR),Object(f.a)(r,207,e.ONE_MINUS_DST_ALPHA));function q(t,n,r,a,i,o,s,l){if(0!==t){if(!1===v&&(H(e.BLEND),v=!0),5===t)i=i||n,o=o||r,s=s||a,n===y&&i===x||(e.blendEquationSeparate(G[n],G[i]),y=n,x=i),r===b&&a===_&&o===E&&s===S||(e.blendFuncSeparate(X[r],X[a],X[o],X[s]),b=r,_=a,E=o,S=s),g=t,M=!1;else if(t!==g||l!==M){if(100===y&&100===x||(e.blendEquation(e.FUNC_ADD),y=100,x=100),l)switch(t){case 1:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.ONE,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case 2:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case 3:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case 4:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}b=null,_=null,E=null,S=null,g=t,M=l}}else!0===v&&(V(e.BLEND),v=!1)}function Y(t){T!==t&&(t?e.frontFace(e.CW):e.frontFace(e.CCW),T=t)}function K(t){0!==t?(H(e.CULL_FACE),t!==w&&(1===t?e.cullFace(e.BACK):2===t?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):V(e.CULL_FACE),w=t}function Z(t,n,r){t?(H(e.POLYGON_OFFSET_FILL),A===n&&R===r||(e.polygonOffset(n,r),A=n,R=r)):V(e.POLYGON_OFFSET_FILL)}return{buffers:{color:i,depth:o,stencil:s},enable:H,disable:V,bindFramebuffer:function(t,n){return d[t]!==n&&(e.bindFramebuffer(t,n),d[t]=n,a&&(t===e.DRAW_FRAMEBUFFER&&(d[e.FRAMEBUFFER]=n),t===e.FRAMEBUFFER&&(d[e.DRAW_FRAMEBUFFER]=n)),!0)},drawBuffers:function(r,a){var i=p,o=!1;if(r)if(void 0===(i=h.get(a))&&(i=[],h.set(a,i)),r.isWebGLMultipleRenderTargets){var s=r.texture;if(i.length!==s.length||i[0]!==e.COLOR_ATTACHMENT0){for(var l=0,c=s.length;l<c;l++)i[l]=e.COLOR_ATTACHMENT0+l;i.length=s.length,o=!0}}else i[0]!==e.COLOR_ATTACHMENT0&&(i[0]=e.COLOR_ATTACHMENT0,o=!0);else i[0]!==e.BACK&&(i[0]=e.BACK,o=!0);o&&(n.isWebGL2?e.drawBuffers(i):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(i))},useProgram:function(t){return m!==t&&(e.useProgram(t),m=t,!0)},setBlending:q,setMaterial:function(t,n){2===t.side?V(e.CULL_FACE):H(e.CULL_FACE);var r=1===t.side;n&&(r=!r),Y(r),1===t.blending&&!1===t.transparent?q(0):q(t.blending,t.blendEquation,t.blendSrc,t.blendDst,t.blendEquationAlpha,t.blendSrcAlpha,t.blendDstAlpha,t.premultipliedAlpha),o.setFunc(t.depthFunc),o.setTest(t.depthTest),o.setMask(t.depthWrite),i.setMask(t.colorWrite);var a=t.stencilWrite;s.setTest(a),a&&(s.setMask(t.stencilWriteMask),s.setFunc(t.stencilFunc,t.stencilRef,t.stencilFuncMask),s.setOp(t.stencilFail,t.stencilZFail,t.stencilZPass)),Z(t.polygonOffset,t.polygonOffsetFactor,t.polygonOffsetUnits),!0===t.alphaToCoverage?H(e.SAMPLE_ALPHA_TO_COVERAGE):V(e.SAMPLE_ALPHA_TO_COVERAGE)},setFlipSided:Y,setCullFace:K,setLineWidth:function(t){t!==O&&(k&&e.lineWidth(t),O=t)},setPolygonOffset:Z,setScissorTest:function(t){t?H(e.SCISSOR_TEST):V(e.SCISSOR_TEST)},activeTexture:function(t){void 0===t&&(t=e.TEXTURE0+C-1),I!==t&&(e.activeTexture(t),I=t)},bindTexture:function(t,n,r){void 0===r&&(r=null===I?e.TEXTURE0+C-1:I);var a=N[r];void 0===a&&(a={type:void 0,texture:void 0},N[r]=a),a.type===t&&a.texture===n||(I!==r&&(e.activeTexture(r),I=r),e.bindTexture(t,n||B[t]),a.type=t,a.texture=n)},unbindTexture:function(){var t=N[I];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexImage3D:function(){try{e.compressedTexImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},updateUBOMapping:function(t,n){var r=c.get(n);void 0===r&&(r=new WeakMap,c.set(n,r));var a=r.get(t);void 0===a&&(a=e.getUniformBlockIndex(n,t.name),r.set(t,a))},uniformBlockBinding:function(t,n){var r=c.get(n).get(t);l.get(n)!==r&&(e.uniformBlockBinding(n,r,t.__bindingPointIndex),l.set(n,r))},texStorage2D:function(){try{e.texStorage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texStorage3D:function(){try{e.texStorage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage2D:function(){try{e.texSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},texSubImage3D:function(){try{e.texSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage2D:function(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},compressedTexSubImage3D:function(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(t){console.error("THREE.WebGLState:",t)}},scissor:function(t){!1===j.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),j.copy(t))},viewport:function(t){!1===F.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),F.copy(t))},reset:function(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),!0===a&&(e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),u={},I=null,N={},d={},h=new WeakMap,p=[],m=null,v=!1,g=null,y=null,b=null,_=null,x=null,E=null,S=null,M=!1,T=null,w=null,O=null,A=null,R=null,j.set(0,0,e.canvas.width,e.canvas.height),F.set(0,0,e.canvas.width,e.canvas.height),i.reset(),o.reset(),s.reset()}}}function Qa(e,t,n,r,a,i,o){var s,l=a.isWebGL2,c=a.maxTextures,u=a.maxCubemapSize,d=a.maxTextureSize,h=a.maxSamples,p=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,m="undefined"!==typeof navigator&&/OculusBrowser/g.test(navigator.userAgent),v=new WeakMap,g=new WeakMap,y=!1;try{y="undefined"!==typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(q){}function b(e,t){return y?new OffscreenCanvas(e,t):H("canvas")}function _(e,t,n,r){var a=1;if((e.width>r||e.height>r)&&(a=r/Math.max(e.width,e.height)),a<1||!0===t){if("undefined"!==typeof HTMLImageElement&&e instanceof HTMLImageElement||"undefined"!==typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"undefined"!==typeof ImageBitmap&&e instanceof ImageBitmap){var i=t?I:Math.floor,o=i(a*e.width),l=i(a*e.height);void 0===s&&(s=b(o,l));var c=n?b(o,l):s;return c.width=o,c.height=l,c.getContext("2d").drawImage(e,0,0,o,l),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+e.width+"x"+e.height+") to ("+o+"x"+l+")."),c}return"data"in e&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+e.width+"x"+e.height+")."),e}return e}function x(e){return L(e.width)&&L(e.height)}function E(e,t){return e.generateMipmaps&&t&&1003!==e.minFilter&&1006!==e.minFilter}function S(t){e.generateMipmap(t)}function M(n,r,a,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(!1===l)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var s=r;return r===e.RED&&(a===e.FLOAT&&(s=e.R32F),a===e.HALF_FLOAT&&(s=e.R16F),a===e.UNSIGNED_BYTE&&(s=e.R8)),r===e.RED_INTEGER&&(a===e.UNSIGNED_BYTE&&(s=e.R8UI),a===e.UNSIGNED_SHORT&&(s=e.R16UI),a===e.UNSIGNED_INT&&(s=e.R32UI),a===e.BYTE&&(s=e.R8I),a===e.SHORT&&(s=e.R16I),a===e.INT&&(s=e.R32I)),r===e.RG&&(a===e.FLOAT&&(s=e.RG32F),a===e.HALF_FLOAT&&(s=e.RG16F),a===e.UNSIGNED_BYTE&&(s=e.RG8)),r===e.RGBA&&(a===e.FLOAT&&(s=e.RGBA32F),a===e.HALF_FLOAT&&(s=e.RGBA16F),a===e.UNSIGNED_BYTE&&(s="srgb"===i&&!1===o?e.SRGB8_ALPHA8:e.RGBA8),a===e.UNSIGNED_SHORT_4_4_4_4&&(s=e.RGBA4),a===e.UNSIGNED_SHORT_5_5_5_1&&(s=e.RGB5_A1)),s!==e.R16F&&s!==e.R32F&&s!==e.RG16F&&s!==e.RG32F&&s!==e.RGBA16F&&s!==e.RGBA32F||t.get("EXT_color_buffer_float"),s}function T(e,t,n){return!0===E(e,n)||e.isFramebufferTexture&&1003!==e.minFilter&&1006!==e.minFilter?Math.log2(Math.max(t.width,t.height))+1:void 0!==e.mipmaps&&e.mipmaps.length>0?e.mipmaps.length:e.isCompressedTexture&&Array.isArray(e.image)?t.mipmaps.length:1}function w(t){return 1003===t||1004===t||1005===t?e.NEAREST:e.LINEAR}function O(e){var t=e.target;t.removeEventListener("dispose",O),function(e){var t=r.get(e);if(void 0===t.__webglInit)return;var n=e.source,a=g.get(n);if(a){var i=a[t.__cacheKey];i.usedTimes--,0===i.usedTimes&&R(e),0===Object.keys(a).length&&g.delete(n)}r.remove(e)}(t),t.isVideoTexture&&v.delete(t)}function A(t){var n=t.target;n.removeEventListener("dispose",A),function(t){var n=t.texture,a=r.get(t),i=r.get(n);void 0!==i.__webglTexture&&(e.deleteTexture(i.__webglTexture),o.memory.textures--);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var s=0;s<6;s++){if(Array.isArray(a.__webglFramebuffer[s]))for(var l=0;l<a.__webglFramebuffer[s].length;l++)e.deleteFramebuffer(a.__webglFramebuffer[s][l]);else e.deleteFramebuffer(a.__webglFramebuffer[s]);a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer[s])}else{if(Array.isArray(a.__webglFramebuffer))for(var c=0;c<a.__webglFramebuffer.length;c++)e.deleteFramebuffer(a.__webglFramebuffer[c]);else e.deleteFramebuffer(a.__webglFramebuffer);if(a.__webglDepthbuffer&&e.deleteRenderbuffer(a.__webglDepthbuffer),a.__webglMultisampledFramebuffer&&e.deleteFramebuffer(a.__webglMultisampledFramebuffer),a.__webglColorRenderbuffer)for(var u=0;u<a.__webglColorRenderbuffer.length;u++)a.__webglColorRenderbuffer[u]&&e.deleteRenderbuffer(a.__webglColorRenderbuffer[u]);a.__webglDepthRenderbuffer&&e.deleteRenderbuffer(a.__webglDepthRenderbuffer)}if(t.isWebGLMultipleRenderTargets)for(var d=0,h=n.length;d<h;d++){var f=r.get(n[d]);f.__webglTexture&&(e.deleteTexture(f.__webglTexture),o.memory.textures--),r.remove(n[d])}r.remove(n),r.remove(t)}(n)}function R(t){var n=r.get(t);e.deleteTexture(n.__webglTexture);var a=t.source;delete g.get(a)[n.__cacheKey],o.memory.textures--}var C=0;function k(t,a){var i=r.get(t);if(t.isVideoTexture&&function(e){var t=o.render.frame;v.get(e)!==t&&(v.set(e,t),e.update())}(t),!1===t.isRenderTargetTexture&&t.version>0&&i.__version!==t.version){var s=t.image;if(null===s)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==s.complete)return void F(i,t,a);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.bindTexture(e.TEXTURE_2D,i.__webglTexture,e.TEXTURE0+a)}var P=Object(f.a)(Object(f.a)(Object(f.a)({},1e3,e.REPEAT),1001,e.CLAMP_TO_EDGE),1002,e.MIRRORED_REPEAT),N=Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)({},1003,e.NEAREST),1004,e.NEAREST_MIPMAP_NEAREST),1005,e.NEAREST_MIPMAP_LINEAR),1006,e.LINEAR),1007,e.LINEAR_MIPMAP_NEAREST),1008,e.LINEAR_MIPMAP_LINEAR),D=Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)(Object(f.a)({},512,e.NEVER),519,e.ALWAYS),513,e.LESS),515,e.LEQUAL),514,e.EQUAL),518,e.GEQUAL),516,e.GREATER),517,e.NOTEQUAL);function U(n,i,o){if(o?(e.texParameteri(n,e.TEXTURE_WRAP_S,P[i.wrapS]),e.texParameteri(n,e.TEXTURE_WRAP_T,P[i.wrapT]),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,P[i.wrapR]),e.texParameteri(n,e.TEXTURE_MAG_FILTER,N[i.magFilter]),e.texParameteri(n,e.TEXTURE_MIN_FILTER,N[i.minFilter])):(e.texParameteri(n,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(n,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),n!==e.TEXTURE_3D&&n!==e.TEXTURE_2D_ARRAY||e.texParameteri(n,e.TEXTURE_WRAP_R,e.CLAMP_TO_EDGE),1001===i.wrapS&&1001===i.wrapT||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,e.TEXTURE_MAG_FILTER,w(i.magFilter)),e.texParameteri(n,e.TEXTURE_MIN_FILTER,w(i.minFilter)),1003!==i.minFilter&&1006!==i.minFilter&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),i.compareFunction&&(e.texParameteri(n,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(n,e.TEXTURE_COMPARE_FUNC,D[i.compareFunction])),!0===t.has("EXT_texture_filter_anisotropic")){var s=t.get("EXT_texture_filter_anisotropic");if(1003===i.magFilter)return;if(1005!==i.minFilter&&1008!==i.minFilter)return;if(1015===i.type&&!1===t.has("OES_texture_float_linear"))return;if(!1===l&&1016===i.type&&!1===t.has("OES_texture_half_float_linear"))return;(i.anisotropy>1||r.get(i).__currentAnisotropy)&&(e.texParameterf(n,s.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(i.anisotropy,a.getMaxAnisotropy())),r.get(i).__currentAnisotropy=i.anisotropy)}}function j(t,n){var r=!1;void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",O));var a=n.source,i=g.get(a);void 0===i&&(i={},g.set(a,i));var s=function(e){var t=[];return t.push(e.wrapS),t.push(e.wrapT),t.push(e.wrapR||0),t.push(e.magFilter),t.push(e.minFilter),t.push(e.anisotropy),t.push(e.internalFormat),t.push(e.format),t.push(e.type),t.push(e.generateMipmaps),t.push(e.premultiplyAlpha),t.push(e.flipY),t.push(e.unpackAlignment),t.push(e.colorSpace),t.join()}(n);if(s!==t.__cacheKey){void 0===i[s]&&(i[s]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,r=!0),i[s].usedTimes++;var l=i[t.__cacheKey];void 0!==l&&(i[t.__cacheKey].usedTimes--,0===l.usedTimes&&R(n)),t.__cacheKey=s,t.__webglTexture=i[s].texture}return r}function F(t,a,o){var s=e.TEXTURE_2D;(a.isDataArrayTexture||a.isCompressedArrayTexture)&&(s=e.TEXTURE_2D_ARRAY),a.isData3DTexture&&(s=e.TEXTURE_3D);var c=j(t,a),u=a.source;n.bindTexture(s,t.__webglTexture,e.TEXTURE0+o);var h=r.get(u);if(u.version!==h.__version||!0===c){n.activeTexture(e.TEXTURE0+o),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);var f,p=function(e){return!l&&(1001!==e.wrapS||1001!==e.wrapT||1003!==e.minFilter&&1006!==e.minFilter)}(a)&&!1===x(a.image),m=_(a.image,p,!1,d),v=x(m=X(a,m))||l,g=i.convert(a.format,a.colorSpace),y=i.convert(a.type),b=M(a.internalFormat,g,y,a.colorSpace);U(s,a,v);var w=a.mipmaps,O=l&&!0!==a.isVideoTexture,A=void 0===h.__version||!0===c,R=T(a,m,v);if(a.isDepthTexture)b=e.DEPTH_COMPONENT,l?b=1015===a.type?e.DEPTH_COMPONENT32F:1014===a.type?e.DEPTH_COMPONENT24:1020===a.type?e.DEPTH24_STENCIL8:e.DEPTH_COMPONENT16:1015===a.type&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),1026===a.format&&b===e.DEPTH_COMPONENT&&1012!==a.type&&1014!==a.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),a.type=1014,y=i.convert(a.type)),1027===a.format&&b===e.DEPTH_COMPONENT&&(b=e.DEPTH_STENCIL,1020!==a.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),a.type=1020,y=i.convert(a.type))),A&&(O?n.texStorage2D(e.TEXTURE_2D,1,b,m.width,m.height):n.texImage2D(e.TEXTURE_2D,0,b,m.width,m.height,0,g,y,null));else if(a.isDataTexture)if(w.length>0&&v){O&&A&&n.texStorage2D(e.TEXTURE_2D,R,b,w[0].width,w[0].height);for(var C=0,k=w.length;C<k;C++)f=w[C],O?n.texSubImage2D(e.TEXTURE_2D,C,0,0,f.width,f.height,g,y,f.data):n.texImage2D(e.TEXTURE_2D,C,b,f.width,f.height,0,g,y,f.data);a.generateMipmaps=!1}else O?(A&&n.texStorage2D(e.TEXTURE_2D,R,b,m.width,m.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,m.width,m.height,g,y,m.data)):n.texImage2D(e.TEXTURE_2D,0,b,m.width,m.height,0,g,y,m.data);else if(a.isCompressedTexture)if(a.isCompressedArrayTexture){O&&A&&n.texStorage3D(e.TEXTURE_2D_ARRAY,R,b,w[0].width,w[0].height,m.depth);for(var P=0,L=w.length;P<L;P++)f=w[P],1023!==a.format?null!==g?O?n.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,P,0,0,0,f.width,f.height,m.depth,g,f.data,0,0):n.compressedTexImage3D(e.TEXTURE_2D_ARRAY,P,b,f.width,f.height,m.depth,0,f.data,0,0):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):O?n.texSubImage3D(e.TEXTURE_2D_ARRAY,P,0,0,0,f.width,f.height,m.depth,g,y,f.data):n.texImage3D(e.TEXTURE_2D_ARRAY,P,b,f.width,f.height,m.depth,0,g,y,f.data)}else{O&&A&&n.texStorage2D(e.TEXTURE_2D,R,b,w[0].width,w[0].height);for(var I=0,N=w.length;I<N;I++)f=w[I],1023!==a.format?null!==g?O?n.compressedTexSubImage2D(e.TEXTURE_2D,I,0,0,f.width,f.height,g,f.data):n.compressedTexImage2D(e.TEXTURE_2D,I,b,f.width,f.height,0,f.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):O?n.texSubImage2D(e.TEXTURE_2D,I,0,0,f.width,f.height,g,y,f.data):n.texImage2D(e.TEXTURE_2D,I,b,f.width,f.height,0,g,y,f.data)}else if(a.isDataArrayTexture)O?(A&&n.texStorage3D(e.TEXTURE_2D_ARRAY,R,b,m.width,m.height,m.depth),n.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,m.width,m.height,m.depth,g,y,m.data)):n.texImage3D(e.TEXTURE_2D_ARRAY,0,b,m.width,m.height,m.depth,0,g,y,m.data);else if(a.isData3DTexture)O?(A&&n.texStorage3D(e.TEXTURE_3D,R,b,m.width,m.height,m.depth),n.texSubImage3D(e.TEXTURE_3D,0,0,0,0,m.width,m.height,m.depth,g,y,m.data)):n.texImage3D(e.TEXTURE_3D,0,b,m.width,m.height,m.depth,0,g,y,m.data);else if(a.isFramebufferTexture){if(A)if(O)n.texStorage2D(e.TEXTURE_2D,R,b,m.width,m.height);else for(var D=m.width,F=m.height,z=0;z<R;z++)n.texImage2D(e.TEXTURE_2D,z,b,D,F,0,g,y,null),D>>=1,F>>=1}else if(w.length>0&&v){O&&A&&n.texStorage2D(e.TEXTURE_2D,R,b,w[0].width,w[0].height);for(var B=0,H=w.length;B<H;B++)f=w[B],O?n.texSubImage2D(e.TEXTURE_2D,B,0,0,g,y,f):n.texImage2D(e.TEXTURE_2D,B,b,g,y,f);a.generateMipmaps=!1}else O?(A&&n.texStorage2D(e.TEXTURE_2D,R,b,m.width,m.height),n.texSubImage2D(e.TEXTURE_2D,0,0,0,g,y,m)):n.texImage2D(e.TEXTURE_2D,0,b,g,y,m);E(a,v)&&S(s),h.__version=u.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}function z(t,a,o,s,l,c){var u=i.convert(o.format,o.colorSpace),d=i.convert(o.type),h=M(o.internalFormat,u,d,o.colorSpace);if(!r.get(a).__hasExternalTextures){var f=Math.max(1,a.width>>c),m=Math.max(1,a.height>>c);l===e.TEXTURE_3D||l===e.TEXTURE_2D_ARRAY?n.texImage3D(l,c,h,f,m,a.depth,0,u,d,null):n.texImage2D(l,c,h,f,m,0,u,d,null)}n.bindFramebuffer(e.FRAMEBUFFER,t),W(a)?p.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,s,l,r.get(o).__webglTexture,0,G(a)):(l===e.TEXTURE_2D||l>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&l<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,s,l,r.get(o).__webglTexture,c),n.bindFramebuffer(e.FRAMEBUFFER,null)}function B(t,n,r){if(e.bindRenderbuffer(e.RENDERBUFFER,t),n.depthBuffer&&!n.stencilBuffer){var a=e.DEPTH_COMPONENT16;if(r||W(n)){var o=n.depthTexture;o&&o.isDepthTexture&&(1015===o.type?a=e.DEPTH_COMPONENT32F:1014===o.type&&(a=e.DEPTH_COMPONENT24));var s=G(n);W(n)?p.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,s,a,n.width,n.height):e.renderbufferStorageMultisample(e.RENDERBUFFER,s,a,n.width,n.height)}else e.renderbufferStorage(e.RENDERBUFFER,a,n.width,n.height);e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,t)}else if(n.depthBuffer&&n.stencilBuffer){var l=G(n);r&&!1===W(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,l,e.DEPTH24_STENCIL8,n.width,n.height):W(n)?p.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,l,e.DEPTH24_STENCIL8,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_STENCIL,n.width,n.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.RENDERBUFFER,t)}else for(var c=!0===n.isWebGLMultipleRenderTargets?n.texture:[n.texture],u=0;u<c.length;u++){var d=c[u],h=i.convert(d.format,d.colorSpace),f=i.convert(d.type),m=M(d.internalFormat,h,f,d.colorSpace),v=G(n);r&&!1===W(n)?e.renderbufferStorageMultisample(e.RENDERBUFFER,v,m,n.width,n.height):W(n)?p.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,v,m,n.width,n.height):e.renderbufferStorage(e.RENDERBUFFER,m,n.width,n.height)}e.bindRenderbuffer(e.RENDERBUFFER,null)}function V(t){var a=r.get(t),i=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture&&!a.__autoAllocateDepthBuffer){if(i)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,a){if(a&&a.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(e.FRAMEBUFFER,t),!a.depthTexture||!a.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(a.depthTexture).__webglTexture&&a.depthTexture.image.width===a.width&&a.depthTexture.image.height===a.height||(a.depthTexture.image.width=a.width,a.depthTexture.image.height=a.height,a.depthTexture.needsUpdate=!0),k(a.depthTexture,0);var i=r.get(a.depthTexture).__webglTexture,o=G(a);if(1026===a.depthTexture.format)W(a)?p.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,i,0);else{if(1027!==a.depthTexture.format)throw new Error("Unknown depthTexture format");W(a)?p.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0,o):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,i,0)}}(a.__webglFramebuffer,t)}else if(i){a.__webglDepthbuffer=[];for(var o=0;o<6;o++)n.bindFramebuffer(e.FRAMEBUFFER,a.__webglFramebuffer[o]),a.__webglDepthbuffer[o]=e.createRenderbuffer(),B(a.__webglDepthbuffer[o],t,!1)}else n.bindFramebuffer(e.FRAMEBUFFER,a.__webglFramebuffer),a.__webglDepthbuffer=e.createRenderbuffer(),B(a.__webglDepthbuffer,t,!1);n.bindFramebuffer(e.FRAMEBUFFER,null)}function G(e){return Math.min(h,e.samples)}function W(e){var n=r.get(e);return l&&e.samples>0&&!0===t.has("WEBGL_multisampled_render_to_texture")&&!1!==n.__useRenderToTexture}function X(e,n){var r=e.colorSpace,a=e.format,i=e.type;return!0===e.isCompressedTexture||1035===e.format||"srgb-linear"!==r&&""!==r&&("srgb"===r?!1===l?!0===t.has("EXT_sRGB")&&1023===a?(e.format=1035,e.minFilter=1006,e.generateMipmaps=!1):n=$.sRGBToLinear(n):1023===a&&1009===i||console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",r)),n}this.allocateTextureUnit=function(){var e=C;return e>=c&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+c),C+=1,e},this.resetTextureUnits=function(){C=0},this.setTexture2D=k,this.setTexture2DArray=function(t,a){var i=r.get(t);t.version>0&&i.__version!==t.version?F(i,t,a):n.bindTexture(e.TEXTURE_2D_ARRAY,i.__webglTexture,e.TEXTURE0+a)},this.setTexture3D=function(t,a){var i=r.get(t);t.version>0&&i.__version!==t.version?F(i,t,a):n.bindTexture(e.TEXTURE_3D,i.__webglTexture,e.TEXTURE0+a)},this.setTextureCube=function(t,a){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,a,o){if(6!==a.image.length)return;var s=j(t,a),c=a.source;n.bindTexture(e.TEXTURE_CUBE_MAP,t.__webglTexture,e.TEXTURE0+o);var d=r.get(c);if(c.version!==d.__version||!0===s){n.activeTexture(e.TEXTURE0+o),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,a.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,a.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,a.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.NONE);for(var h=a.isCompressedTexture||a.image[0].isCompressedTexture,f=a.image[0]&&a.image[0].isDataTexture,p=[],m=0;m<6;m++)p[m]=h||f?f?a.image[m].image:a.image[m]:_(a.image[m],!1,!0,u),p[m]=X(a,p[m]);var v,g=p[0],y=x(g)||l,b=i.convert(a.format,a.colorSpace),w=i.convert(a.type),O=M(a.internalFormat,b,w,a.colorSpace),A=l&&!0!==a.isVideoTexture,R=void 0===d.__version||!0===s,C=T(a,g,y);if(U(e.TEXTURE_CUBE_MAP,a,y),h){A&&R&&n.texStorage2D(e.TEXTURE_CUBE_MAP,C,O,g.width,g.height);for(var k=0;k<6;k++){v=p[k].mipmaps;for(var P=0;P<v.length;P++){var L=v[P];1023!==a.format?null!==b?A?n.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+k,P,0,0,L.width,L.height,b,L.data):n.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+k,P,O,L.width,L.height,0,L.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):A?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+k,P,0,0,L.width,L.height,b,w,L.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+k,P,O,L.width,L.height,0,b,w,L.data)}}}else{v=a.mipmaps,A&&R&&(v.length>0&&C++,n.texStorage2D(e.TEXTURE_CUBE_MAP,C,O,p[0].width,p[0].height));for(var I=0;I<6;I++)if(f){A?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,0,0,0,p[I].width,p[I].height,b,w,p[I].data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,0,O,p[I].width,p[I].height,0,b,w,p[I].data);for(var N=0;N<v.length;N++){var D=v[N].image[I].image;A?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,N+1,0,0,D.width,D.height,b,w,D.data):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,N+1,O,D.width,D.height,0,b,w,D.data)}}else{A?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,0,0,0,b,w,p[I]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,0,O,b,w,p[I]);for(var F=0;F<v.length;F++){var z=v[F];A?n.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,F+1,0,0,b,w,z.image[I]):n.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+I,F+1,O,b,w,z.image[I])}}}E(a,y)&&S(e.TEXTURE_CUBE_MAP),d.__version=c.version,a.onUpdate&&a.onUpdate(a)}t.__version=a.version}(o,t,a):n.bindTexture(e.TEXTURE_CUBE_MAP,o.__webglTexture,e.TEXTURE0+a)},this.rebindTextures=function(t,n,a){var i=r.get(t);void 0!==n&&z(i.__webglFramebuffer,t,t.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),void 0!==a&&V(t)},this.setupRenderTarget=function(t){var s=t.texture,c=r.get(t),u=r.get(s);t.addEventListener("dispose",A),!0!==t.isWebGLMultipleRenderTargets&&(void 0===u.__webglTexture&&(u.__webglTexture=e.createTexture()),u.__version=s.version,o.memory.textures++);var d=!0===t.isWebGLCubeRenderTarget,h=!0===t.isWebGLMultipleRenderTargets,f=x(t)||l;if(d){c.__webglFramebuffer=[];for(var p=0;p<6;p++)if(l&&s.mipmaps&&s.mipmaps.length>0){c.__webglFramebuffer[p]=[];for(var m=0;m<s.mipmaps.length;m++)c.__webglFramebuffer[p][m]=e.createFramebuffer()}else c.__webglFramebuffer[p]=e.createFramebuffer()}else{if(l&&s.mipmaps&&s.mipmaps.length>0){c.__webglFramebuffer=[];for(var v=0;v<s.mipmaps.length;v++)c.__webglFramebuffer[v]=e.createFramebuffer()}else c.__webglFramebuffer=e.createFramebuffer();if(h)if(a.drawBuffers)for(var g=t.texture,y=0,b=g.length;y<b;y++){var _=r.get(g[y]);void 0===_.__webglTexture&&(_.__webglTexture=e.createTexture(),o.memory.textures++)}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(l&&t.samples>0&&!1===W(t)){var T=h?s:[s];c.__webglMultisampledFramebuffer=e.createFramebuffer(),c.__webglColorRenderbuffer=[],n.bindFramebuffer(e.FRAMEBUFFER,c.__webglMultisampledFramebuffer);for(var w=0;w<T.length;w++){var O=T[w];c.__webglColorRenderbuffer[w]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,c.__webglColorRenderbuffer[w]);var R=i.convert(O.format,O.colorSpace),C=i.convert(O.type),k=M(O.internalFormat,R,C,O.colorSpace,!0===t.isXRRenderTarget),P=G(t);e.renderbufferStorageMultisample(e.RENDERBUFFER,P,k,t.width,t.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+w,e.RENDERBUFFER,c.__webglColorRenderbuffer[w])}e.bindRenderbuffer(e.RENDERBUFFER,null),t.depthBuffer&&(c.__webglDepthRenderbuffer=e.createRenderbuffer(),B(c.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(e.FRAMEBUFFER,null)}}if(d){n.bindTexture(e.TEXTURE_CUBE_MAP,u.__webglTexture),U(e.TEXTURE_CUBE_MAP,s,f);for(var L=0;L<6;L++)if(l&&s.mipmaps&&s.mipmaps.length>0)for(var I=0;I<s.mipmaps.length;I++)z(c.__webglFramebuffer[L][I],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+L,I);else z(c.__webglFramebuffer[L],t,s,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+L,0);E(s,f)&&S(e.TEXTURE_CUBE_MAP),n.unbindTexture()}else if(h){for(var N=t.texture,D=0,j=N.length;D<j;D++){var F=N[D],H=r.get(F);n.bindTexture(e.TEXTURE_2D,H.__webglTexture),U(e.TEXTURE_2D,F,f),z(c.__webglFramebuffer,t,F,e.COLOR_ATTACHMENT0+D,e.TEXTURE_2D,0),E(F,f)&&S(e.TEXTURE_2D)}n.unbindTexture()}else{var X=e.TEXTURE_2D;if((t.isWebGL3DRenderTarget||t.isWebGLArrayRenderTarget)&&(l?X=t.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(X,u.__webglTexture),U(X,s,f),l&&s.mipmaps&&s.mipmaps.length>0)for(var q=0;q<s.mipmaps.length;q++)z(c.__webglFramebuffer[q],t,s,e.COLOR_ATTACHMENT0,X,q);else z(c.__webglFramebuffer,t,s,e.COLOR_ATTACHMENT0,X,0);E(s,f)&&S(X),n.unbindTexture()}t.depthBuffer&&V(t)},this.updateRenderTargetMipmap=function(t){for(var a=x(t)||l,i=!0===t.isWebGLMultipleRenderTargets?t.texture:[t.texture],o=0,s=i.length;o<s;o++){var c=i[o];if(E(c,a)){var u=t.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:e.TEXTURE_2D,d=r.get(c).__webglTexture;n.bindTexture(u,d),S(u),n.unbindTexture()}}},this.updateMultisampleRenderTarget=function(t){if(l&&t.samples>0&&!1===W(t)){var a=t.isWebGLMultipleRenderTargets?t.texture:[t.texture],i=t.width,o=t.height,s=e.COLOR_BUFFER_BIT,c=[],u=t.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,d=r.get(t),h=!0===t.isWebGLMultipleRenderTargets;if(h)for(var f=0;f<a.length;f++)n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+f,e.RENDERBUFFER,null),n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+f,e.TEXTURE_2D,null,0);n.bindFramebuffer(e.READ_FRAMEBUFFER,d.__webglMultisampledFramebuffer),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglFramebuffer);for(var p=0;p<a.length;p++){c.push(e.COLOR_ATTACHMENT0+p),t.depthBuffer&&c.push(u);var v=void 0!==d.__ignoreDepthValues&&d.__ignoreDepthValues;if(!1===v&&(t.depthBuffer&&(s|=e.DEPTH_BUFFER_BIT),t.stencilBuffer&&(s|=e.STENCIL_BUFFER_BIT)),h&&e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,d.__webglColorRenderbuffer[p]),!0===v&&(e.invalidateFramebuffer(e.READ_FRAMEBUFFER,[u]),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[u])),h){var g=r.get(a[p]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,g,0)}e.blitFramebuffer(0,0,i,o,0,0,i,o,s,e.NEAREST),m&&e.invalidateFramebuffer(e.READ_FRAMEBUFFER,c)}if(n.bindFramebuffer(e.READ_FRAMEBUFFER,null),n.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),h)for(var y=0;y<a.length;y++){n.bindFramebuffer(e.FRAMEBUFFER,d.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.RENDERBUFFER,d.__webglColorRenderbuffer[y]);var b=r.get(a[y]).__webglTexture;n.bindFramebuffer(e.FRAMEBUFFER,d.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+y,e.TEXTURE_2D,b,0)}n.bindFramebuffer(e.DRAW_FRAMEBUFFER,d.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=V,this.setupFrameBufferTexture=z,this.useMultisampledRTT=W}function $a(e,t,n){var r=n.isWebGL2;return{convert:function(n){var a,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(1009===n)return e.UNSIGNED_BYTE;if(1017===n)return e.UNSIGNED_SHORT_4_4_4_4;if(1018===n)return e.UNSIGNED_SHORT_5_5_5_1;if(1010===n)return e.BYTE;if(1011===n)return e.SHORT;if(1012===n)return e.UNSIGNED_SHORT;if(1013===n)return e.INT;if(1014===n)return e.UNSIGNED_INT;if(1015===n)return e.FLOAT;if(1016===n)return r?e.HALF_FLOAT:null!==(a=t.get("OES_texture_half_float"))?a.HALF_FLOAT_OES:null;if(1021===n)return e.ALPHA;if(1023===n)return e.RGBA;if(1024===n)return e.LUMINANCE;if(1025===n)return e.LUMINANCE_ALPHA;if(1026===n)return e.DEPTH_COMPONENT;if(1027===n)return e.DEPTH_STENCIL;if(1035===n)return null!==(a=t.get("EXT_sRGB"))?a.SRGB_ALPHA_EXT:null;if(1028===n)return e.RED;if(1029===n)return e.RED_INTEGER;if(1030===n)return e.RG;if(1031===n)return e.RG_INTEGER;if(1033===n)return e.RGBA_INTEGER;if(33776===n||33777===n||33778===n||33779===n)if("srgb"===i){if(null===(a=t.get("WEBGL_compressed_texture_s3tc_srgb")))return null;if(33776===n)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===n)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===n)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===n)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(null===(a=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===n)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===n)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===n)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===n)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===n||35841===n||35842===n||35843===n){if(null===(a=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===n)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===n)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===n)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===n)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===n)return null!==(a=t.get("WEBGL_compressed_texture_etc1"))?a.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===n||37496===n){if(null===(a=t.get("WEBGL_compressed_texture_etc")))return null;if(37492===n)return"srgb"===i?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(37496===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}if(37808===n||37809===n||37810===n||37811===n||37812===n||37813===n||37814===n||37815===n||37816===n||37817===n||37818===n||37819===n||37820===n||37821===n){if(null===(a=t.get("WEBGL_compressed_texture_astc")))return null;if(37808===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===n)return"srgb"===i?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===n){if(null===(a=t.get("EXT_texture_compression_bptc")))return null;if(36492===n)return"srgb"===i?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT}if(36283===n||36284===n||36285===n||36286===n){if(null===(a=t.get("EXT_texture_compression_rgtc")))return null;if(36492===n)return a.COMPRESSED_RED_RGTC1_EXT;if(36284===n)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(36285===n)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(36286===n)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}return 1020===n?r?e.UNSIGNED_INT_24_8:null!==(a=t.get("WEBGL_depth_texture"))?a.UNSIGNED_INT_24_8_WEBGL:null:void 0!==e[n]?e[n]:null}}}var ei=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(p.a)(this,t),(e=v(this,t)).isArrayCamera=!0,e.cameras=n,e}return Object(h.a)(t,e),Object(m.a)(t)}(_n),ti=function(e){function t(){var e;return Object(p.a)(this,t),(e=v(this,t)).isGroup=!0,e.type="Group",e}return Object(h.a)(t,e),Object(m.a)(t)}(dt),ni={type:"move"},ri=function(){return Object(m.a)((function e(){Object(p.a)(this,e),this._targetRay=null,this._grip=null,this._hand=null}),[{key:"getHandSpace",value:function(){return null===this._hand&&(this._hand=new ti,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}},{key:"getTargetRaySpace",value:function(){return null===this._targetRay&&(this._targetRay=new ti,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new ue,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new ue),this._targetRay}},{key:"getGripSpace",value:function(){return null===this._grip&&(this._grip=new ti,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new ue,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new ue),this._grip}},{key:"dispatchEvent",value:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this}},{key:"connect",value:function(e){if(e&&e.hand){var t=this._hand;if(t){var n,r=Object(o.a)(e.hand.values());try{for(r.s();!(n=r.n()).done;){var a=n.value;this._getHandJoint(t,a)}}catch(i){r.e(i)}finally{r.f()}}}return this.dispatchEvent({type:"connected",data:e}),this}},{key:"disconnect",value:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}},{key:"update",value:function(e,t,n){var r=null,a=null,i=null,s=this._targetRay,l=this._grip,c=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState){if(c&&e.hand){i=!0;var u,d=Object(o.a)(e.hand.values());try{for(d.s();!(u=d.n()).done;){var h=u.value,f=t.getJointPose(h,n),p=this._getHandJoint(c,h);null!==f&&(p.matrix.fromArray(f.transform.matrix),p.matrix.decompose(p.position,p.rotation,p.scale),p.matrixWorldNeedsUpdate=!0,p.jointRadius=f.radius),p.visible=null!==f}}catch(y){d.e(y)}finally{d.f()}var m=c.joints["index-finger-tip"],v=c.joints["thumb-tip"],g=m.position.distanceTo(v.position);c.inputState.pinching&&g>.025?(c.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!c.inputState.pinching&&g<=.015&&(c.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==l&&e.gripSpace&&null!==(a=t.getPose(e.gripSpace,n))&&(l.matrix.fromArray(a.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,a.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(a.linearVelocity)):l.hasLinearVelocity=!1,a.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(a.angularVelocity)):l.hasAngularVelocity=!1);null!==s&&(null===(r=t.getPose(e.targetRaySpace,n))&&null!==a&&(r=a),null!==r&&(s.matrix.fromArray(r.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,r.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(r.linearVelocity)):s.hasLinearVelocity=!1,r.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(r.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(ni)))}return null!==s&&(s.visible=null!==r),null!==l&&(l.visible=null!==a),null!==c&&(c.visible=null!==i),this}},{key:"_getHandJoint",value:function(e,t){if(void 0===e.joints[t.jointName]){var n=new ti;n.matrixAutoUpdate=!1,n.visible=!1,e.joints[t.jointName]=n,e.add(n)}return e.joints[t.jointName]}}])}(),ai=function(e){function t(e,n,r,a,i,o,s,l,c,u){var d;if(Object(p.a)(this,t),1026!==(u=void 0!==u?u:1026)&&1027!==u)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===r&&1026===u&&(r=1014),void 0===r&&1027===u&&(r=1020),(d=v(this,t,[null,a,i,o,s,l,u,r,c])).isDepthTexture=!0,d.image={width:e,height:n},d.magFilter=void 0!==s?s:1003,d.minFilter=void 0!==l?l:1003,d.flipY=!1,d.generateMipmaps=!1,d.compareFunction=null,d}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e){return c(Object(l.a)(t.prototype),"copy",this).call(this,e),this.compareFunction=e.compareFunction,this}},{key:"toJSON",value:function(e){var n=c(Object(l.a)(t.prototype),"toJSON",this).call(this,e);return null!==this.compareFunction&&(n.compareFunction=this.compareFunction),n}}])}(ae),ii=function(e){function t(e,n){var r;Object(p.a)(this,t);var a=r=v(this,t),o=null,s=1,l=null,c="local-floor",u=1,d=null,h=null,f=null,m=null,y=null,b=null,_=n.getContextAttributes(),x=null,E=null,S=[],M=[],T=new _n;T.layers.enable(1),T.viewport=new ie;var w=new _n;w.layers.enable(2),w.viewport=new ie;var O=[T,w],R=new ei;R.layers.enable(1),R.layers.enable(2);var C=null,k=null;function P(e){var t=M.indexOf(e.inputSource);if(-1!==t){var n=S[t];void 0!==n&&(n.update(e.inputSource,e.frame,d||l),n.dispatchEvent({type:e.type,data:e.inputSource}))}}function L(){o.removeEventListener("select",P),o.removeEventListener("selectstart",P),o.removeEventListener("selectend",P),o.removeEventListener("squeeze",P),o.removeEventListener("squeezestart",P),o.removeEventListener("squeezeend",P),o.removeEventListener("end",L),o.removeEventListener("inputsourceschange",I);for(var t=0;t<S.length;t++){var n=M[t];null!==n&&(M[t]=null,S[t].disconnect(n))}C=null,k=null,e.setRenderTarget(x),y=null,m=null,f=null,o=null,E=null,F.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function I(e){for(var t=0;t<e.removed.length;t++){var n=e.removed[t],r=M.indexOf(n);r>=0&&(M[r]=null,S[r].disconnect(n))}for(var a=0;a<e.added.length;a++){var i=e.added[a],o=M.indexOf(i);if(-1===o){for(var s=0;s<S.length;s++){if(s>=M.length){M.push(i),o=s;break}if(null===M[s]){M[s]=i,o=s;break}}if(-1===o)break}var l=S[o];l&&l.connect(i)}}r.cameraAutoUpdate=!0,r.enabled=!1,r.isPresenting=!1,r.getController=function(e){var t=S[e];return void 0===t&&(t=new ri,S[e]=t),t.getTargetRaySpace()},r.getControllerGrip=function(e){var t=S[e];return void 0===t&&(t=new ri,S[e]=t),t.getGripSpace()},r.getHand=function(e){var t=S[e];return void 0===t&&(t=new ri,S[e]=t),t.getHandSpace()},r.setFramebufferScaleFactor=function(e){s=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},r.setReferenceSpaceType=function(e){c=e,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},r.getReferenceSpace=function(){return d||l},r.setReferenceSpace=function(e){d=e},r.getBaseLayer=function(){return null!==m?m:y},r.getBinding=function(){return f},r.getFrame=function(){return b},r.getSession=function(){return o},r.setSession=function(){var t=Object(i.a)(g().mark((function t(r){var i,h,p,v,b;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null===(o=r)){t.next=25;break}if(x=e.getRenderTarget(),o.addEventListener("select",P),o.addEventListener("selectstart",P),o.addEventListener("selectend",P),o.addEventListener("squeeze",P),o.addEventListener("squeezestart",P),o.addEventListener("squeezeend",P),o.addEventListener("end",L),o.addEventListener("inputsourceschange",I),!0===_.xrCompatible){t.next=14;break}return t.next=14,n.makeXRCompatible();case 14:return void 0===o.renderState.layers||!1===e.capabilities.isWebGL2?(i={antialias:void 0!==o.renderState.layers||_.antialias,alpha:!0,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s},y=new XRWebGLLayer(o,n,i),o.updateRenderState({baseLayer:y}),E=new oe(y.framebufferWidth,y.framebufferHeight,{format:1023,type:1009,colorSpace:e.outputColorSpace,stencilBuffer:_.stencil})):(h=null,p=null,v=null,_.depth&&(v=_.stencil?n.DEPTH24_STENCIL8:n.DEPTH_COMPONENT24,h=_.stencil?1027:1026,p=_.stencil?1020:1014),b={colorFormat:n.RGBA8,depthFormat:v,scaleFactor:s},f=new XRWebGLBinding(o,n),m=f.createProjectionLayer(b),o.updateRenderState({layers:[m]}),E=new oe(m.textureWidth,m.textureHeight,{format:1023,type:1009,depthTexture:new ai(m.textureWidth,m.textureHeight,p,void 0,void 0,void 0,void 0,void 0,void 0,h),stencilBuffer:_.stencil,colorSpace:e.outputColorSpace,samples:_.antialias?4:0}),e.properties.get(E).__ignoreDepthValues=m.ignoreDepthValues),E.isXRRenderTarget=!0,this.setFoveation(u),d=null,t.next=20,o.requestReferenceSpace(c);case 20:l=t.sent,F.setContext(o),F.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"});case 25:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}(),r.getEnvironmentBlendMode=function(){if(null!==o)return o.environmentBlendMode};var N=new ue,D=new ue;function U(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}r.updateCamera=function(e){if(null!==o){R.near=w.near=T.near=e.near,R.far=w.far=T.far=e.far,C===R.near&&k===R.far||(o.updateRenderState({depthNear:R.near,depthFar:R.far}),C=R.near,k=R.far);var t=e.parent,n=R.cameras;U(R,t);for(var r=0;r<n.length;r++)U(n[r],t);2===n.length?function(e,t,n){N.setFromMatrixPosition(t.matrixWorld),D.setFromMatrixPosition(n.matrixWorld);var r=N.distanceTo(D),a=t.projectionMatrix.elements,i=n.projectionMatrix.elements,o=a[14]/(a[10]-1),s=a[14]/(a[10]+1),l=(a[9]+1)/a[5],c=(a[9]-1)/a[5],u=(a[8]-1)/a[0],d=(i[8]+1)/i[0],h=o*u,f=o*d,p=r/(-u+d),m=p*-u;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(m),e.translateZ(p),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var v=o+p,g=s+p,y=h-m,b=f+(r-m),_=l*s/g*v,x=c*s/g*v;e.projectionMatrix.makePerspective(y,b,_,x,v,g),e.projectionMatrixInverse.copy(e.projectionMatrix).invert()}(R,T,w):R.projectionMatrix.copy(T.projectionMatrix),function(e,t,n){null===n?e.matrix.copy(t.matrixWorld):(e.matrix.copy(n.matrixWorld),e.matrix.invert(),e.matrix.multiply(t.matrixWorld));e.matrix.decompose(e.position,e.quaternion,e.scale),e.updateMatrixWorld(!0);for(var r=e.children,a=0,i=r.length;a<i;a++)r[a].updateMatrixWorld(!0);e.projectionMatrix.copy(t.projectionMatrix),e.projectionMatrixInverse.copy(t.projectionMatrixInverse),e.isPerspectiveCamera&&(e.fov=2*A*Math.atan(1/e.projectionMatrix.elements[5]),e.zoom=1)}(e,R,t)}},r.getCamera=function(){return R},r.getFoveation=function(){if(null!==m||null!==y)return u},r.setFoveation=function(e){u=e,null!==m&&(m.fixedFoveation=e),null!==y&&void 0!==y.fixedFoveation&&(y.fixedFoveation=e)};var j=null;var F=new kn;return F.setAnimationLoop((function(t,n){if(h=n.getViewerPose(d||l),b=n,null!==h){var r=h.views;null!==y&&(e.setRenderTargetFramebuffer(E,y.framebuffer),e.setRenderTarget(E));var i=!1;r.length!==R.cameras.length&&(R.cameras.length=0,i=!0);for(var o=0;o<r.length;o++){var s=r[o],c=null;if(null!==y)c=y.getViewport(s);else{var u=f.getViewSubImage(m,s);c=u.viewport,0===o&&(e.setRenderTargetTextures(E,u.colorTexture,m.ignoreDepthValues?void 0:u.depthStencilTexture),e.setRenderTarget(E))}var p=O[o];void 0===p&&((p=new _n).layers.enable(o),p.viewport=new ie,O[o]=p),p.matrix.fromArray(s.transform.matrix),p.matrix.decompose(p.position,p.quaternion,p.scale),p.projectionMatrix.fromArray(s.projectionMatrix),p.projectionMatrixInverse.copy(p.projectionMatrix).invert(),p.viewport.set(c.x,c.y,c.width,c.height),0===o&&(R.matrix.copy(p.matrix),R.matrix.decompose(R.position,R.quaternion,R.scale)),!0===i&&R.cameras.push(p)}}for(var v=0;v<S.length;v++){var g=M[v],_=S[v];null!==g&&void 0!==_&&_.update(g,n,d||l)}j&&j(t,n),n.detectedPlanes&&a.dispatchEvent({type:"planesdetected",data:n}),b=null})),r.setAnimationLoop=function(e){j=e},r.dispose=function(){},r}return Object(h.a)(t,e),Object(m.a)(t)}(T);function oi(e,t){function n(e,t){!0===e.matrixAutoUpdate&&e.updateMatrix(),t.value.copy(e.matrix)}function r(r,a){r.opacity.value=a.opacity,a.color&&r.diffuse.value.copy(a.color),a.emissive&&r.emissive.value.copy(a.emissive).multiplyScalar(a.emissiveIntensity),a.map&&(r.map.value=a.map,n(a.map,r.mapTransform)),a.alphaMap&&(r.alphaMap.value=a.alphaMap,n(a.alphaMap,r.alphaMapTransform)),a.bumpMap&&(r.bumpMap.value=a.bumpMap,n(a.bumpMap,r.bumpMapTransform),r.bumpScale.value=a.bumpScale,1===a.side&&(r.bumpScale.value*=-1)),a.normalMap&&(r.normalMap.value=a.normalMap,n(a.normalMap,r.normalMapTransform),r.normalScale.value.copy(a.normalScale),1===a.side&&r.normalScale.value.negate()),a.displacementMap&&(r.displacementMap.value=a.displacementMap,n(a.displacementMap,r.displacementMapTransform),r.displacementScale.value=a.displacementScale,r.displacementBias.value=a.displacementBias),a.emissiveMap&&(r.emissiveMap.value=a.emissiveMap,n(a.emissiveMap,r.emissiveMapTransform)),a.specularMap&&(r.specularMap.value=a.specularMap,n(a.specularMap,r.specularMapTransform)),a.alphaTest>0&&(r.alphaTest.value=a.alphaTest);var i=t.get(a).envMap;if(i&&(r.envMap.value=i,r.flipEnvMap.value=i.isCubeTexture&&!1===i.isRenderTargetTexture?-1:1,r.reflectivity.value=a.reflectivity,r.ior.value=a.ior,r.refractionRatio.value=a.refractionRatio),a.lightMap){r.lightMap.value=a.lightMap;var o=!0===e._useLegacyLights?Math.PI:1;r.lightMapIntensity.value=a.lightMapIntensity*o,n(a.lightMap,r.lightMapTransform)}a.aoMap&&(r.aoMap.value=a.aoMap,r.aoMapIntensity.value=a.aoMapIntensity,n(a.aoMap,r.aoMapTransform))}return{refreshFogUniforms:function(t,n){n.color.getRGB(t.fogColor.value,vn(e)),n.isFog?(t.fogNear.value=n.near,t.fogFar.value=n.far):n.isFogExp2&&(t.fogDensity.value=n.density)},refreshMaterialUniforms:function(e,a,i,o,s){a.isMeshBasicMaterial||a.isMeshLambertMaterial?r(e,a):a.isMeshToonMaterial?(r(e,a),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap)}(e,a)):a.isMeshPhongMaterial?(r(e,a),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4)}(e,a)):a.isMeshStandardMaterial?(r(e,a),function(e,r){e.metalness.value=r.metalness,r.metalnessMap&&(e.metalnessMap.value=r.metalnessMap,n(r.metalnessMap,e.metalnessMapTransform));e.roughness.value=r.roughness,r.roughnessMap&&(e.roughnessMap.value=r.roughnessMap,n(r.roughnessMap,e.roughnessMapTransform));t.get(r).envMap&&(e.envMapIntensity.value=r.envMapIntensity)}(e,a),a.isMeshPhysicalMaterial&&function(e,t,r){e.ior.value=t.ior,t.sheen>0&&(e.sheenColor.value.copy(t.sheenColor).multiplyScalar(t.sheen),e.sheenRoughness.value=t.sheenRoughness,t.sheenColorMap&&(e.sheenColorMap.value=t.sheenColorMap,n(t.sheenColorMap,e.sheenColorMapTransform)),t.sheenRoughnessMap&&(e.sheenRoughnessMap.value=t.sheenRoughnessMap,n(t.sheenRoughnessMap,e.sheenRoughnessMapTransform)));t.clearcoat>0&&(e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap,n(t.clearcoatMap,e.clearcoatMapTransform)),t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap,n(t.clearcoatRoughnessMap,e.clearcoatRoughnessMapTransform)),t.clearcoatNormalMap&&(e.clearcoatNormalMap.value=t.clearcoatNormalMap,n(t.clearcoatNormalMap,e.clearcoatNormalMapTransform),e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),1===t.side&&e.clearcoatNormalScale.value.negate()));t.iridescence>0&&(e.iridescence.value=t.iridescence,e.iridescenceIOR.value=t.iridescenceIOR,e.iridescenceThicknessMinimum.value=t.iridescenceThicknessRange[0],e.iridescenceThicknessMaximum.value=t.iridescenceThicknessRange[1],t.iridescenceMap&&(e.iridescenceMap.value=t.iridescenceMap,n(t.iridescenceMap,e.iridescenceMapTransform)),t.iridescenceThicknessMap&&(e.iridescenceThicknessMap.value=t.iridescenceThicknessMap,n(t.iridescenceThicknessMap,e.iridescenceThicknessMapTransform)));t.transmission>0&&(e.transmission.value=t.transmission,e.transmissionSamplerMap.value=r.texture,e.transmissionSamplerSize.value.set(r.width,r.height),t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap,n(t.transmissionMap,e.transmissionMapTransform)),e.thickness.value=t.thickness,t.thicknessMap&&(e.thicknessMap.value=t.thicknessMap,n(t.thicknessMap,e.thicknessMapTransform)),e.attenuationDistance.value=t.attenuationDistance,e.attenuationColor.value.copy(t.attenuationColor));t.anisotropy>0&&(e.anisotropyVector.value.set(t.anisotropy*Math.cos(t.anisotropyRotation),t.anisotropy*Math.sin(t.anisotropyRotation)),t.anisotropyMap&&(e.anisotropyMap.value=t.anisotropyMap,n(t.anisotropyMap,e.anisotropyMapTransform)));e.specularIntensity.value=t.specularIntensity,e.specularColor.value.copy(t.specularColor),t.specularColorMap&&(e.specularColorMap.value=t.specularColorMap,n(t.specularColorMap,e.specularColorMapTransform));t.specularIntensityMap&&(e.specularIntensityMap.value=t.specularIntensityMap,n(t.specularIntensityMap,e.specularIntensityMapTransform))}(e,a,s)):a.isMeshMatcapMaterial?(r(e,a),function(e,t){t.matcap&&(e.matcap.value=t.matcap)}(e,a)):a.isMeshDepthMaterial?r(e,a):a.isMeshDistanceMaterial?(r(e,a),function(e,n){var r=t.get(n).light;e.referencePosition.value.setFromMatrixPosition(r.matrixWorld),e.nearDistance.value=r.shadow.camera.near,e.farDistance.value=r.shadow.camera.far}(e,a)):a.isMeshNormalMaterial?r(e,a):a.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform))}(e,a),a.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,a)):a.isPointsMaterial?function(e,t,r,a){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*r,e.scale.value=.5*a,t.map&&(e.map.value=t.map,n(t.map,e.uvTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,a,i,o):a.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map,n(t.map,e.mapTransform));t.alphaMap&&(e.alphaMap.value=t.alphaMap,n(t.alphaMap,e.alphaMapTransform));t.alphaTest>0&&(e.alphaTest.value=t.alphaTest)}(e,a):a.isShadowMaterial?(e.color.value.copy(a.color),e.opacity.value=a.opacity):a.isShaderMaterial&&(a.uniformsNeedUpdate=!1)}}}function si(e,t,n,r){var a={},i={},o=[],s=n.isWebGL2?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0;function l(e,t,n){var r=e.value;if(void 0===n[t]){if("number"===typeof r)n[t]=r;else{for(var a=Array.isArray(r)?r:[r],i=[],o=0;o<a.length;o++)i.push(a[o].clone());n[t]=i}return!0}if("number"===typeof r){if(n[t]!==r)return n[t]=r,!0}else for(var s=Array.isArray(n[t])?n[t]:[n[t]],l=Array.isArray(r)?r:[r],c=0;c<s.length;c++){var u=s[c];if(!1===u.equals(l[c]))return u.copy(l[c]),!0}return!1}function c(e){var t={boundary:0,storage:0};return"number"===typeof e?(t.boundary=4,t.storage=4):e.isVector2?(t.boundary=8,t.storage=8):e.isVector3||e.isColor?(t.boundary=16,t.storage=12):e.isVector4?(t.boundary=16,t.storage=16):e.isMatrix3?(t.boundary=48,t.storage=48):e.isMatrix4?(t.boundary=64,t.storage=64):e.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",e),t}function u(t){var n=t.target;n.removeEventListener("dispose",u);var r=o.indexOf(n.__bindingPointIndex);o.splice(r,1),e.deleteBuffer(a[n.id]),delete a[n.id],delete i[n.id]}return{bind:function(e,t){var n=t.program;r.uniformBlockBinding(e,n)},update:function(n,d){var h=a[n.id];void 0===h&&(!function(e){for(var t=e.uniforms,n=0,r=0,a=0,i=t.length;a<i;a++){for(var o=t[a],s={boundary:0,storage:0},l=Array.isArray(o.value)?o.value:[o.value],u=0,d=l.length;u<d;u++){var h=c(l[u]);s.boundary+=h.boundary,s.storage+=h.storage}if(o.__data=new Float32Array(s.storage/Float32Array.BYTES_PER_ELEMENT),o.__offset=n,a>0){var f=16-(r=n%16);0!==r&&f-s.boundary<0&&(n+=16-r,o.__offset=n)}n+=s.storage}(r=n%16)>0&&(n+=16-r);e.__size=n,e.__cache={}}(n),h=function(t){var n=function(){for(var e=0;e<s;e++)if(-1===o.indexOf(e))return o.push(e),e;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}();t.__bindingPointIndex=n;var r=e.createBuffer(),a=t.__size,i=t.usage;return e.bindBuffer(e.UNIFORM_BUFFER,r),e.bufferData(e.UNIFORM_BUFFER,a,i),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,n,r),r}(n),a[n.id]=h,n.addEventListener("dispose",u));var f=d.program;r.updateUBOMapping(n,f);var p=t.render.frame;i[n.id]!==p&&(!function(t){var n=a[t.id],r=t.uniforms,i=t.__cache;e.bindBuffer(e.UNIFORM_BUFFER,n);for(var o=0,s=r.length;o<s;o++){var u=r[o];if(!0===l(u,o,i)){for(var d=u.__offset,h=Array.isArray(u.value)?u.value:[u.value],f=0,p=0;p<h.length;p++){var m=h[p],v=c(m);"number"===typeof m?(u.__data[0]=m,e.bufferSubData(e.UNIFORM_BUFFER,d+f,u.__data)):m.isMatrix3?(u.__data[0]=m.elements[0],u.__data[1]=m.elements[1],u.__data[2]=m.elements[2],u.__data[3]=m.elements[0],u.__data[4]=m.elements[3],u.__data[5]=m.elements[4],u.__data[6]=m.elements[5],u.__data[7]=m.elements[0],u.__data[8]=m.elements[6],u.__data[9]=m.elements[7],u.__data[10]=m.elements[8],u.__data[11]=m.elements[0]):(m.toArray(u.__data,f),f+=v.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,d,u.__data)}}e.bindBuffer(e.UNIFORM_BUFFER,null)}(n),i[n.id]=p)},dispose:function(){for(var t in a)e.deleteBuffer(a[t]);o=[],a={},i={}}}}function li(){var e=H("canvas");return e.style.display="block",e}(function(e){function t(){return Object(p.a)(this,t),v(this,t,arguments)}return Object(h.a)(t,e),Object(m.a)(t)})(function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e);var n,r=t.canvas,a=void 0===r?li():r,i=t.context,o=void 0===i?null:i,s=t.depth,l=void 0===s||s,c=t.stencil,u=void 0===c||c,d=t.alpha,h=void 0!==d&&d,f=t.antialias,m=void 0!==f&&f,v=t.premultipliedAlpha,g=void 0===v||v,y=t.preserveDrawingBuffer,b=void 0!==y&&y,_=t.powerPreference,x=void 0===_?"default":_,E=t.failIfMajorPerformanceCaveat,S=void 0!==E&&E;this.isWebGLRenderer=!0,n=null!==o?o.getContextAttributes().alpha:h;var M=new Uint32Array(4),T=new Int32Array(4),w=null,O=null,A=[],R=[];this.domElement=a,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputColorSpace="srgb",this._useLegacyLights=!1,this.toneMapping=0,this.toneMappingExposure=1;var C=this,k=!1,P=0,L=0,N=null,D=-1,U=null,F=new ie,z=new ie,B=null,H=new Ct(0),V=0,G=a.width,W=a.height,X=1,q=null,Y=null,K=new ie(0,0,G,W),Z=new ie(0,0,G,W),J=!1,Q=new Cn,$=!1,ee=!1,te=null,ne=new ze,re=new j,ae=new ue,se={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function le(){return null===N?X:1}var ce,de,he,fe,pe,me,ve,ge,ye,be,_e,xe,Ee,Se,Me,Te,we,Oe,Ae,Re,Ce,ke,Pe,Le,Ie=o;function Ne(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=a.getContext(r,t);if(null!==i)return i}return null}try{var De={alpha:!0,depth:l,stencil:u,antialias:m,premultipliedAlpha:g,preserveDrawingBuffer:b,powerPreference:x,failIfMajorPerformanceCaveat:S};if("setAttribute"in a&&a.setAttribute("data-engine","three.js r".concat("155")),a.addEventListener("webglcontextlost",Be,!1),a.addEventListener("webglcontextrestored",He,!1),a.addEventListener("webglcontextcreationerror",Ve,!1),null===Ie){var Ue=["webgl2","webgl","experimental-webgl"];if(!0===C.isWebGL1Renderer&&Ue.shift(),null===(Ie=Ne(Ue,De)))throw Ne(Ue)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}"undefined"!==typeof WebGLRenderingContext&&Ie instanceof WebGLRenderingContext&&console.warn("THREE.WebGLRenderer: WebGL 1 support was deprecated in r153 and will be removed in r163."),void 0===Ie.getShaderPrecisionFormat&&(Ie.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(lt){throw console.error("THREE.WebGLRenderer: "+lt.message),lt}function je(){ce=new ar(Ie),de=new Bn(Ie,ce,t),ce.init(de),ke=new $a(Ie,ce,de),he=new Ja(Ie,ce,de),fe=new sr(Ie),pe=new Ua,me=new Qa(Ie,ce,he,pe,de,ke,fe),ve=new Vn(C),ge=new rr(C),ye=new Pn(Ie,de),Pe=new Fn(Ie,ce,ye,de),be=new ir(Ie,ye,fe,Pe),_e=new dr(Ie,be,ye,fe),Ae=new ur(Ie,de,me),Te=new Hn(pe),xe=new Da(C,ve,ge,ce,de,Pe,Te),Ee=new oi(C,pe),Se=new Ba,Me=new qa(ce,de),Oe=new jn(C,ve,ge,he,_e,n,g),we=new Za(C,_e,de),Le=new si(Ie,fe,de,he),Re=new zn(Ie,ce,fe,de),Ce=new or(Ie,ce,fe,de),fe.programs=xe.programs,C.capabilities=de,C.extensions=ce,C.properties=pe,C.renderLists=Se,C.shadowMap=we,C.state=he,C.info=fe}je();var Fe=new ii(C,Ie);function Be(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),k=!0}function He(){console.log("THREE.WebGLRenderer: Context Restored."),k=!1;var e=fe.autoReset,t=we.enabled,n=we.autoUpdate,r=we.needsUpdate,a=we.type;je(),fe.autoReset=e,we.enabled=t,we.autoUpdate=n,we.needsUpdate=r,we.type=a}function Ve(e){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",e.statusMessage)}function Ge(e){var t=e.target;t.removeEventListener("dispose",Ge),We(t)}function We(e){Xe(e),pe.remove(e)}function Xe(e){var t=pe.get(e).programs;void 0!==t&&(t.forEach((function(e){xe.releaseProgram(e)})),e.isShaderMaterial&&xe.releaseShaderCache(e))}this.xr=Fe,this.getContext=function(){return Ie},this.getContextAttributes=function(){return Ie.getContextAttributes()},this.forceContextLoss=function(){var e=ce.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=ce.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return X},this.setPixelRatio=function(e){void 0!==e&&(X=e,this.setSize(G,W,!1))},this.getSize=function(e){return e.set(G,W)},this.setSize=function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];Fe.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(G=e,W=t,a.width=Math.floor(e*X),a.height=Math.floor(t*X),!0===n&&(a.style.width=e+"px",a.style.height=t+"px"),this.setViewport(0,0,e,t))},this.getDrawingBufferSize=function(e){return e.set(G*X,W*X).floor()},this.setDrawingBufferSize=function(e,t,n){G=e,W=t,X=n,a.width=Math.floor(e*n),a.height=Math.floor(t*n),this.setViewport(0,0,e,t)},this.getCurrentViewport=function(e){return e.copy(F)},this.getViewport=function(e){return e.copy(K)},this.setViewport=function(e,t,n,r){e.isVector4?K.set(e.x,e.y,e.z,e.w):K.set(e,t,n,r),he.viewport(F.copy(K).multiplyScalar(X).floor())},this.getScissor=function(e){return e.copy(Z)},this.setScissor=function(e,t,n,r){e.isVector4?Z.set(e.x,e.y,e.z,e.w):Z.set(e,t,n,r),he.scissor(z.copy(Z).multiplyScalar(X).floor())},this.getScissorTest=function(){return J},this.setScissorTest=function(e){he.setScissorTest(J=e)},this.setOpaqueSort=function(e){q=e},this.setTransparentSort=function(e){Y=e},this.getClearColor=function(e){return e.copy(Oe.getClearColor())},this.setClearColor=function(){Oe.setClearColor.apply(Oe,arguments)},this.getClearAlpha=function(){return Oe.getClearAlpha()},this.setClearAlpha=function(){Oe.setClearAlpha.apply(Oe,arguments)},this.clear=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=0;if(e){var a=!1;if(null!==N){var i=N.texture.format;a=1033===i||1031===i||1029===i}if(a){var o=N.texture.type,s=1009===o||1014===o||1012===o||1020===o||1017===o||1018===o,l=Oe.getClearColor(),c=Oe.getClearAlpha(),u=l.r,d=l.g,h=l.b;s?(M[0]=u,M[1]=d,M[2]=h,M[3]=c,Ie.clearBufferuiv(Ie.COLOR,0,M)):(T[0]=u,T[1]=d,T[2]=h,T[3]=c,Ie.clearBufferiv(Ie.COLOR,0,T))}else r|=Ie.COLOR_BUFFER_BIT}t&&(r|=Ie.DEPTH_BUFFER_BIT),n&&(r|=Ie.STENCIL_BUFFER_BIT),Ie.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){a.removeEventListener("webglcontextlost",Be,!1),a.removeEventListener("webglcontextrestored",He,!1),a.removeEventListener("webglcontextcreationerror",Ve,!1),Se.dispose(),Me.dispose(),pe.dispose(),ve.dispose(),ge.dispose(),_e.dispose(),Pe.dispose(),Le.dispose(),xe.dispose(),Fe.dispose(),Fe.removeEventListener("sessionstart",Ke),Fe.removeEventListener("sessionend",Ze),te&&(te.dispose(),te=null),Je.stop()},this.renderBufferDirect=function(e,t,n,r,a,i){null===t&&(t=se);var o=a.isMesh&&a.matrixWorld.determinant()<0,s=it(e,t,n,r,a);he.setMaterial(r,o);var l=n.index,c=1;if(!0===r.wireframe){if(void 0===(l=be.getWireframeAttribute(n)))return;c=2}var u=n.drawRange,d=n.attributes.position,h=u.start*c,f=(u.start+u.count)*c;null!==i&&(h=Math.max(h,i.start*c),f=Math.min(f,(i.start+i.count)*c)),null!==l?(h=Math.max(h,0),f=Math.min(f,l.count)):void 0!==d&&null!==d&&(h=Math.max(h,0),f=Math.min(f,d.count));var p=f-h;if(!(p<0||p===1/0)){var m;Pe.setup(a,r,s,n,l);var v=Re;if(null!==l&&(m=ye.get(l),(v=Ce).setIndex(m)),a.isMesh)!0===r.wireframe?(he.setLineWidth(r.wireframeLinewidth*le()),v.setMode(Ie.LINES)):v.setMode(Ie.TRIANGLES);else if(a.isLine){var g=r.linewidth;void 0===g&&(g=1),he.setLineWidth(g*le()),a.isLineSegments?v.setMode(Ie.LINES):a.isLineLoop?v.setMode(Ie.LINE_LOOP):v.setMode(Ie.LINE_STRIP)}else a.isPoints?v.setMode(Ie.POINTS):a.isSprite&&v.setMode(Ie.TRIANGLES);if(a.isInstancedMesh)v.renderInstances(h,p,a.count);else if(n.isInstancedBufferGeometry){var y=void 0!==n._maxInstanceCount?n._maxInstanceCount:1/0,b=Math.min(n.instanceCount,y);v.renderInstances(h,p,b)}else v.render(h,p)}},this.compile=function(e,t){function n(e,t,n){!0===e.transparent&&2===e.side&&!1===e.forceSinglePass?(e.side=1,e.needsUpdate=!0,rt(e,t,n),e.side=0,e.needsUpdate=!0,rt(e,t,n),e.side=2):rt(e,t,n)}(O=Me.get(e)).init(),R.push(O),e.traverseVisible((function(e){e.isLight&&e.layers.test(t.layers)&&(O.pushLight(e),e.castShadow&&O.pushShadow(e))})),O.setupLights(C._useLegacyLights),e.traverse((function(t){var r=t.material;if(r)if(Array.isArray(r))for(var a=0;a<r.length;a++){n(r[a],e,t)}else n(r,e,t)})),R.pop(),O=null};var qe=null;function Ye(e){qe&&qe(e)}function Ke(){Je.stop()}function Ze(){Je.start()}var Je=new kn;function Qe(e,t,n,r){if(!1!==e.visible){if(e.layers.test(t.layers))if(e.isGroup)n=e.renderOrder;else if(e.isLOD)!0===e.autoUpdate&&e.update(t);else if(e.isLight)O.pushLight(e),e.castShadow&&O.pushShadow(e);else if(e.isSprite){if(!e.frustumCulled||Q.intersectsSprite(e)){r&&ae.setFromMatrixPosition(e.matrixWorld).applyMatrix4(ne);var a=_e.update(e),i=e.material;i.visible&&w.push(e,a,i,n,ae.z,null)}}else if((e.isMesh||e.isLine||e.isPoints)&&(!e.frustumCulled||Q.intersectsObject(e))){var o=_e.update(e),s=e.material;if(r&&(void 0!==e.boundingSphere?(null===e.boundingSphere&&e.computeBoundingSphere(),ae.copy(e.boundingSphere.center)):(null===o.boundingSphere&&o.computeBoundingSphere(),ae.copy(o.boundingSphere.center)),ae.applyMatrix4(e.matrixWorld).applyMatrix4(ne)),Array.isArray(s))for(var l=o.groups,c=0,u=l.length;c<u;c++){var d=l[c],h=s[d.materialIndex];h&&h.visible&&w.push(e,o,h,n,ae.z,d)}else s.visible&&w.push(e,o,s,n,ae.z,null)}for(var f=e.children,p=0,m=f.length;p<m;p++)Qe(f[p],t,n,r)}}function $e(e,t,n,r){var a=e.opaque,i=e.transmissive,o=e.transparent;O.setupLightsView(n),!0===$&&Te.setGlobalState(C.clippingPlanes,n),i.length>0&&et(a,i,t,n),r&&he.viewport(F.copy(r)),a.length>0&&tt(a,t,n),i.length>0&&tt(i,t,n),o.length>0&&tt(o,t,n),he.buffers.depth.setTest(!0),he.buffers.depth.setMask(!0),he.buffers.color.setMask(!0),he.setPolygonOffset(!1)}function et(e,t,n,r){var a=de.isWebGL2;null===te&&(te=new oe(1,1,{generateMipmaps:!0,type:ce.has("EXT_color_buffer_half_float")?1016:1009,minFilter:1008,samples:a?4:0})),C.getDrawingBufferSize(re),a?te.setSize(re.x,re.y):te.setSize(I(re.x),I(re.y));var i=C.getRenderTarget();C.setRenderTarget(te),C.getClearColor(H),(V=C.getClearAlpha())<1&&C.setClearColor(16777215,.5),C.clear();var o=C.toneMapping;C.toneMapping=0,tt(e,n,r),me.updateMultisampleRenderTarget(te),me.updateRenderTargetMipmap(te);for(var s=!1,l=0,c=t.length;l<c;l++){var u=t[l],d=u.object,h=u.geometry,f=u.material,p=u.group;if(2===f.side&&d.layers.test(r.layers)){var m=f.side;f.side=1,f.needsUpdate=!0,nt(d,n,r,h,f,p),f.side=m,f.needsUpdate=!0,s=!0}}!0===s&&(me.updateMultisampleRenderTarget(te),me.updateRenderTargetMipmap(te)),C.setRenderTarget(i),C.setClearColor(H,V),C.toneMapping=o}function tt(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,a=0,i=e.length;a<i;a++){var o=e[a],s=o.object,l=o.geometry,c=null===r?o.material:r,u=o.group;s.layers.test(n.layers)&&nt(s,t,n,l,c,u)}}function nt(e,t,n,r,a,i){e.onBeforeRender(C,t,n,r,a,i),e.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,e.matrixWorld),e.normalMatrix.getNormalMatrix(e.modelViewMatrix),a.onBeforeRender(C,t,n,r,e,i),!0===a.transparent&&2===a.side&&!1===a.forceSinglePass?(a.side=1,a.needsUpdate=!0,C.renderBufferDirect(n,t,r,a,e,i),a.side=0,a.needsUpdate=!0,C.renderBufferDirect(n,t,r,a,e,i),a.side=2):C.renderBufferDirect(n,t,r,a,e,i),e.onAfterRender(C,t,n,r,a,i)}function rt(e,t,n){!0!==t.isScene&&(t=se);var r=pe.get(e),a=O.state.lights,i=O.state.shadowsArray,o=a.state.version,s=xe.getParameters(e,a.state,i,t,n),l=xe.getProgramCacheKey(s),c=r.programs;r.environment=e.isMeshStandardMaterial?t.environment:null,r.fog=t.fog,r.envMap=(e.isMeshStandardMaterial?ge:ve).get(e.envMap||r.environment),void 0===c&&(e.addEventListener("dispose",Ge),c=new Map,r.programs=c);var u=c.get(l);if(void 0!==u){if(r.currentProgram===u&&r.lightsStateVersion===o)return at(e,s),u}else s.uniforms=xe.getUniforms(e),e.onBuild(n,s,C),e.onBeforeCompile(s,C),u=xe.acquireProgram(s,l),c.set(l,u),r.uniforms=s.uniforms;var d=r.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(d.clippingPlanes=Te.uniform),at(e,s),r.needsLights=st(e),r.lightsStateVersion=o,r.needsLights&&(d.ambientLightColor.value=a.state.ambient,d.lightProbe.value=a.state.probe,d.directionalLights.value=a.state.directional,d.directionalLightShadows.value=a.state.directionalShadow,d.spotLights.value=a.state.spot,d.spotLightShadows.value=a.state.spotShadow,d.rectAreaLights.value=a.state.rectArea,d.ltc_1.value=a.state.rectAreaLTC1,d.ltc_2.value=a.state.rectAreaLTC2,d.pointLights.value=a.state.point,d.pointLightShadows.value=a.state.pointShadow,d.hemisphereLights.value=a.state.hemi,d.directionalShadowMap.value=a.state.directionalShadowMap,d.directionalShadowMatrix.value=a.state.directionalShadowMatrix,d.spotShadowMap.value=a.state.spotShadowMap,d.spotLightMatrix.value=a.state.spotLightMatrix,d.spotLightMap.value=a.state.spotLightMap,d.pointShadowMap.value=a.state.pointShadowMap,d.pointShadowMatrix.value=a.state.pointShadowMatrix);var h=u.getUniforms(),f=ma.seqWithValue(h.seq,d);return r.currentProgram=u,r.uniformsList=f,u}function at(e,t){var n=pe.get(e);n.outputColorSpace=t.outputColorSpace,n.instancing=t.instancing,n.instancingColor=t.instancingColor,n.skinning=t.skinning,n.morphTargets=t.morphTargets,n.morphNormals=t.morphNormals,n.morphColors=t.morphColors,n.morphTargetsCount=t.morphTargetsCount,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas,n.vertexTangents=t.vertexTangents,n.toneMapping=t.toneMapping}function it(e,t,n,r,a){!0!==t.isScene&&(t=se),me.resetTextureUnits();var i=t.fog,o=r.isMeshStandardMaterial?t.environment:null,s=null===N?C.outputColorSpace:!0===N.isXRRenderTarget?N.texture.colorSpace:"srgb-linear",l=(r.isMeshStandardMaterial?ge:ve).get(r.envMap||o),c=!0===r.vertexColors&&!!n.attributes.color&&4===n.attributes.color.itemSize,u=!!n.attributes.tangent&&(!!r.normalMap||r.anisotropy>0),d=!!n.morphAttributes.position,h=!!n.morphAttributes.normal,f=!!n.morphAttributes.color,p=0;r.toneMapped&&(null!==N&&!0!==N.isXRRenderTarget||(p=C.toneMapping));var m=n.morphAttributes.position||n.morphAttributes.normal||n.morphAttributes.color,v=void 0!==m?m.length:0,g=pe.get(r),y=O.state.lights;if(!0===$&&(!0===ee||e!==U)){var b=e===U&&r.id===D;Te.setState(r,e,b)}var _=!1;r.version===g.__version?g.needsLights&&g.lightsStateVersion!==y.state.version||g.outputColorSpace!==s||a.isInstancedMesh&&!1===g.instancing?_=!0:a.isInstancedMesh||!0!==g.instancing?a.isSkinnedMesh&&!1===g.skinning?_=!0:a.isSkinnedMesh||!0!==g.skinning?a.isInstancedMesh&&!0===g.instancingColor&&null===a.instanceColor||a.isInstancedMesh&&!1===g.instancingColor&&null!==a.instanceColor||g.envMap!==l||!0===r.fog&&g.fog!==i?_=!0:void 0===g.numClippingPlanes||g.numClippingPlanes===Te.numPlanes&&g.numIntersection===Te.numIntersection?(g.vertexAlphas!==c||g.vertexTangents!==u||g.morphTargets!==d||g.morphNormals!==h||g.morphColors!==f||g.toneMapping!==p||!0===de.isWebGL2&&g.morphTargetsCount!==v)&&(_=!0):_=!0:_=!0:_=!0:(_=!0,g.__version=r.version);var x=g.currentProgram;!0===_&&(x=rt(r,t,a));var E=!1,S=!1,M=!1,T=x.getUniforms(),w=g.uniforms;if(he.useProgram(x.program)&&(E=!0,S=!0,M=!0),r.id!==D&&(D=r.id,S=!0),E||U!==e){if(T.setValue(Ie,"projectionMatrix",e.projectionMatrix),de.logarithmicDepthBuffer&&T.setValue(Ie,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),U!==e&&(U=e,S=!0,M=!0),r.isShaderMaterial||r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshStandardMaterial||r.envMap){var A=T.map.cameraPosition;void 0!==A&&A.setValue(Ie,ae.setFromMatrixPosition(e.matrixWorld))}(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial)&&T.setValue(Ie,"isOrthographic",!0===e.isOrthographicCamera),(r.isMeshPhongMaterial||r.isMeshToonMaterial||r.isMeshLambertMaterial||r.isMeshBasicMaterial||r.isMeshStandardMaterial||r.isShaderMaterial||r.isShadowMaterial||a.isSkinnedMesh)&&T.setValue(Ie,"viewMatrix",e.matrixWorldInverse)}if(a.isSkinnedMesh){T.setOptional(Ie,a,"bindMatrix"),T.setOptional(Ie,a,"bindMatrixInverse");var R=a.skeleton;R&&(de.floatVertexTextures?(null===R.boneTexture&&R.computeBoneTexture(),T.setValue(Ie,"boneTexture",R.boneTexture,me),T.setValue(Ie,"boneTextureSize",R.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}var k=n.morphAttributes;if((void 0!==k.position||void 0!==k.normal||void 0!==k.color&&!0===de.isWebGL2)&&Ae.update(a,n,x),(S||g.receiveShadow!==a.receiveShadow)&&(g.receiveShadow=a.receiveShadow,T.setValue(Ie,"receiveShadow",a.receiveShadow)),r.isMeshGouraudMaterial&&null!==r.envMap&&(w.envMap.value=l,w.flipEnvMap.value=l.isCubeTexture&&!1===l.isRenderTargetTexture?-1:1),S&&(T.setValue(Ie,"toneMappingExposure",C.toneMappingExposure),g.needsLights&&ot(w,M),i&&!0===r.fog&&Ee.refreshFogUniforms(w,i),Ee.refreshMaterialUniforms(w,r,X,W,te),ma.upload(Ie,g.uniformsList,w,me)),r.isShaderMaterial&&!0===r.uniformsNeedUpdate&&(ma.upload(Ie,g.uniformsList,w,me),r.uniformsNeedUpdate=!1),r.isSpriteMaterial&&T.setValue(Ie,"center",a.center),T.setValue(Ie,"modelViewMatrix",a.modelViewMatrix),T.setValue(Ie,"normalMatrix",a.normalMatrix),T.setValue(Ie,"modelMatrix",a.matrixWorld),r.isShaderMaterial||r.isRawShaderMaterial)for(var P=r.uniformsGroups,L=0,I=P.length;L<I;L++)if(de.isWebGL2){var j=P[L];Le.update(j,x),Le.bind(j,x)}else console.warn("THREE.WebGLRenderer: Uniform Buffer Objects can only be used with WebGL 2.");return x}function ot(e,t){e.ambientLightColor.needsUpdate=t,e.lightProbe.needsUpdate=t,e.directionalLights.needsUpdate=t,e.directionalLightShadows.needsUpdate=t,e.pointLights.needsUpdate=t,e.pointLightShadows.needsUpdate=t,e.spotLights.needsUpdate=t,e.spotLightShadows.needsUpdate=t,e.rectAreaLights.needsUpdate=t,e.hemisphereLights.needsUpdate=t}function st(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}Je.setAnimationLoop(Ye),"undefined"!==typeof self&&Je.setContext(self),this.setAnimationLoop=function(e){qe=e,Fe.setAnimationLoop(e),null===e?Je.stop():Je.start()},Fe.addEventListener("sessionstart",Ke),Fe.addEventListener("sessionend",Ze),this.render=function(e,t){if(void 0===t||!0===t.isCamera){if(!0!==k){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),!0===Fe.enabled&&!0===Fe.isPresenting&&(!0===Fe.cameraAutoUpdate&&Fe.updateCamera(t),t=Fe.getCamera()),!0===e.isScene&&e.onBeforeRender(C,e,t,N),(O=Me.get(e,R.length)).init(),R.push(O),ne.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),Q.setFromProjectionMatrix(ne),ee=this.localClippingEnabled,$=Te.init(this.clippingPlanes,ee),(w=Se.get(e,A.length)).init(),A.push(w),Qe(e,t,0,C.sortObjects),w.finish(),!0===C.sortObjects&&w.sort(q,Y),this.info.render.frame++,!0===$&&Te.beginShadows();var n=O.state.shadowsArray;if(we.render(n,e,t),!0===$&&Te.endShadows(),!0===this.info.autoReset&&this.info.reset(),Oe.render(w,e),O.setupLights(C._useLegacyLights),t.isArrayCamera)for(var r=t.cameras,a=0,i=r.length;a<i;a++){var o=r[a];$e(w,e,o,o.viewport)}else $e(w,e,t);null!==N&&(me.updateMultisampleRenderTarget(N),me.updateRenderTargetMipmap(N)),!0===e.isScene&&e.onAfterRender(C,e,t),Pe.resetDefaultState(),D=-1,U=null,R.pop(),O=R.length>0?R[R.length-1]:null,A.pop(),w=A.length>0?A[A.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return P},this.getActiveMipmapLevel=function(){return L},this.getRenderTarget=function(){return N},this.setRenderTargetTextures=function(e,t,n){pe.get(e.texture).__webglTexture=t,pe.get(e.depthTexture).__webglTexture=n;var r=pe.get(e);r.__hasExternalTextures=!0,r.__hasExternalTextures&&(r.__autoAllocateDepthBuffer=void 0===n,r.__autoAllocateDepthBuffer||!0===ce.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),r.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(e,t){var n=pe.get(e);n.__webglFramebuffer=t,n.__useDefaultFramebuffer=void 0===t},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;N=e,P=t,L=n;var r=!0,a=null,i=!1,o=!1;if(e){var s=pe.get(e);void 0!==s.__useDefaultFramebuffer?(he.bindFramebuffer(Ie.FRAMEBUFFER,null),r=!1):void 0===s.__webglFramebuffer?me.setupRenderTarget(e):s.__hasExternalTextures&&me.rebindTextures(e,pe.get(e.texture).__webglTexture,pe.get(e.depthTexture).__webglTexture);var l=e.texture;(l.isData3DTexture||l.isDataArrayTexture||l.isCompressedArrayTexture)&&(o=!0);var c=pe.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(a=Array.isArray(c[t])?c[t][n]:c[t],i=!0):a=de.isWebGL2&&e.samples>0&&!1===me.useMultisampledRTT(e)?pe.get(e).__webglMultisampledFramebuffer:Array.isArray(c)?c[n]:c,F.copy(e.viewport),z.copy(e.scissor),B=e.scissorTest}else F.copy(K).multiplyScalar(X).floor(),z.copy(Z).multiplyScalar(X).floor(),B=J;var u=he.bindFramebuffer(Ie.FRAMEBUFFER,a);if(u&&de.drawBuffers&&r&&he.drawBuffers(e,a),he.viewport(F),he.scissor(z),he.setScissorTest(B),i){var d=pe.get(e.texture);Ie.framebufferTexture2D(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,Ie.TEXTURE_CUBE_MAP_POSITIVE_X+t,d.__webglTexture,n)}else if(o){var h=pe.get(e.texture),f=t||0;Ie.framebufferTextureLayer(Ie.FRAMEBUFFER,Ie.COLOR_ATTACHMENT0,h.__webglTexture,n||0,f)}D=-1},this.readRenderTargetPixels=function(e,t,n,r,a,i,o){if(e&&e.isWebGLRenderTarget){var s=pe.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==o&&(s=s[o]),s){he.bindFramebuffer(Ie.FRAMEBUFFER,s);try{var l=e.texture,c=l.format,u=l.type;if(1023!==c&&ke.convert(c)!==Ie.getParameter(Ie.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var d=1016===u&&(ce.has("EXT_color_buffer_half_float")||de.isWebGL2&&ce.has("EXT_color_buffer_float"));if(1009!==u&&ke.convert(u)!==Ie.getParameter(Ie.IMPLEMENTATION_COLOR_READ_TYPE)&&(1015!==u||!(de.isWebGL2||ce.has("OES_texture_float")||ce.has("WEBGL_color_buffer_float")))&&!d)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");t>=0&&t<=e.width-r&&n>=0&&n<=e.height-a&&Ie.readPixels(t,n,r,a,ke.convert(c),ke.convert(u),i)}finally{var h=null!==N?pe.get(N).__webglFramebuffer:null;he.bindFramebuffer(Ie.FRAMEBUFFER,h)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),a=Math.floor(t.image.width*r),i=Math.floor(t.image.height*r);me.setTexture2D(t,0),Ie.copyTexSubImage2D(Ie.TEXTURE_2D,n,0,0,e.x,e.y,a,i),he.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=t.image.width,i=t.image.height,o=ke.convert(n.format),s=ke.convert(n.type);me.setTexture2D(n,0),Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,n.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,n.unpackAlignment),t.isDataTexture?Ie.texSubImage2D(Ie.TEXTURE_2D,r,e.x,e.y,a,i,o,s,t.image.data):t.isCompressedTexture?Ie.compressedTexSubImage2D(Ie.TEXTURE_2D,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,o,t.mipmaps[0].data):Ie.texSubImage2D(Ie.TEXTURE_2D,r,e.x,e.y,o,s,t.image),0===r&&n.generateMipmaps&&Ie.generateMipmap(Ie.TEXTURE_2D),he.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(C.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var i,o=e.max.x-e.min.x+1,s=e.max.y-e.min.y+1,l=e.max.z-e.min.z+1,c=ke.convert(r.format),u=ke.convert(r.type);if(r.isData3DTexture)me.setTexture3D(r,0),i=Ie.TEXTURE_3D;else{if(!r.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");me.setTexture2DArray(r,0),i=Ie.TEXTURE_2D_ARRAY}Ie.pixelStorei(Ie.UNPACK_FLIP_Y_WEBGL,r.flipY),Ie.pixelStorei(Ie.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),Ie.pixelStorei(Ie.UNPACK_ALIGNMENT,r.unpackAlignment);var d=Ie.getParameter(Ie.UNPACK_ROW_LENGTH),h=Ie.getParameter(Ie.UNPACK_IMAGE_HEIGHT),f=Ie.getParameter(Ie.UNPACK_SKIP_PIXELS),p=Ie.getParameter(Ie.UNPACK_SKIP_ROWS),m=Ie.getParameter(Ie.UNPACK_SKIP_IMAGES),v=n.isCompressedTexture?n.mipmaps[0]:n.image;Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,v.width),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,v.height),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,e.min.x),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,e.min.y),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,e.min.z),n.isDataTexture||n.isData3DTexture?Ie.texSubImage3D(i,a,t.x,t.y,t.z,o,s,l,c,u,v.data):n.isCompressedArrayTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Ie.compressedTexSubImage3D(i,a,t.x,t.y,t.z,o,s,l,c,v.data)):Ie.texSubImage3D(i,a,t.x,t.y,t.z,o,s,l,c,u,v),Ie.pixelStorei(Ie.UNPACK_ROW_LENGTH,d),Ie.pixelStorei(Ie.UNPACK_IMAGE_HEIGHT,h),Ie.pixelStorei(Ie.UNPACK_SKIP_PIXELS,f),Ie.pixelStorei(Ie.UNPACK_SKIP_ROWS,p),Ie.pixelStorei(Ie.UNPACK_SKIP_IMAGES,m),0===a&&r.generateMipmaps&&Ie.generateMipmap(i),he.unbindTexture()}},this.initTexture=function(e){e.isCubeTexture?me.setTextureCube(e,0):e.isData3DTexture?me.setTexture3D(e,0):e.isDataArrayTexture||e.isCompressedArrayTexture?me.setTexture2DArray(e,0):me.setTexture2D(e,0),he.unbindTexture()},this.resetState=function(){P=0,L=0,N=null,he.reset(),Pe.reset()},"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}),[{key:"coordinateSystem",get:function(){return 2e3}},{key:"physicallyCorrectLights",get:function(){return console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),!this.useLegacyLights},set:function(e){console.warn("THREE.WebGLRenderer: The property .physicallyCorrectLights has been removed. Set renderer.useLegacyLights instead."),this.useLegacyLights=!e}},{key:"outputEncoding",get:function(){return console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),"srgb"===this.outputColorSpace?3001:3e3},set:function(e){console.warn("THREE.WebGLRenderer: Property .outputEncoding has been removed. Use .outputColorSpace instead."),this.outputColorSpace=3001===e?"srgb":"srgb-linear"}},{key:"useLegacyLights",get:function(){return console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights},set:function(e){console.warn("THREE.WebGLRenderer: The property .useLegacyLights has been deprecated. Migrate your lighting according to the following guide: https://discourse.threejs.org/t/updates-to-lighting-in-three-js-r155/53733."),this._useLegacyLights=e}}])}()).prototype.isWebGL1Renderer=!0;var ci=function(e){function t(){var e;return Object(p.a)(this,t),(e=v(this,t)).isScene=!0,e.type="Scene",e.background=null,e.environment=null,e.fog=null,e.backgroundBlurriness=0,e.backgroundIntensity=1,e.overrideMaterial=null,"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:e})),e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e,n){return c(Object(l.a)(t.prototype),"copy",this).call(this,e,n),null!==e.background&&(this.background=e.background.clone()),null!==e.environment&&(this.environment=e.environment.clone()),null!==e.fog&&(this.fog=e.fog.clone()),this.backgroundBlurriness=e.backgroundBlurriness,this.backgroundIntensity=e.backgroundIntensity,null!==e.overrideMaterial&&(this.overrideMaterial=e.overrideMaterial.clone()),this.matrixAutoUpdate=e.matrixAutoUpdate,this}},{key:"toJSON",value:function(e){var n=c(Object(l.a)(t.prototype),"toJSON",this).call(this,e);return null!==this.fog&&(n.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(n.object.backgroundBlurriness=this.backgroundBlurriness),1!==this.backgroundIntensity&&(n.object.backgroundIntensity=this.backgroundIntensity),n}}])}(dt);function ui(e,t,n){return hi(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)}function di(e,t,n){return!e||!n&&e.constructor===t?e:"number"===typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)}function hi(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}var fi=function(){return Object(m.a)((function e(t,n,r,a){Object(p.a)(this,e),this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==a?a:new n.constructor(r),this.sampleValues=n,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}),[{key:"evaluate",value:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],a=t[n-1];e:{t:{var i;n:{r:if(!(e<r)){for(var o=n+2;;){if(void 0===r){if(e<a)break r;return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}if(n===o)break;if(a=r,e<(r=t[++n]))break t}i=t.length;break n}if(e>=a)break e;var s=t[1];e<s&&(n=2,a=s);for(var l=n-2;;){if(void 0===a)return this._cachedIndex=0,this.copySampleValue_(0);if(n===l)break;if(r=a,e>=(a=t[--n-1]))break t}i=n,n=0}for(;n<i;){var c=n+i>>>1;e<t[c]?i=c:n=c+1}if(r=t[n],void 0===(a=t[n-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===r)return n=t.length,this._cachedIndex=n,this.copySampleValue_(n-1)}this._cachedIndex=n,this.intervalChanged_(n,a,r)}return this.interpolate_(n,a,e,r)}},{key:"getSettings_",value:function(){return this.settings||this.DefaultSettings_}},{key:"copySampleValue_",value:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,a=e*r,i=0;i!==r;++i)t[i]=n[a+i];return t}},{key:"interpolate_",value:function(){throw new Error("call to abstract method")}},{key:"intervalChanged_",value:function(){}}])}(),pi=function(e){function t(e,n,r,a){var i;return Object(p.a)(this,t),(i=v(this,t,[e,n,r,a]))._weightPrev=-0,i._offsetPrev=-0,i._weightNext=-0,i._offsetNext=-0,i.DefaultSettings_={endingStart:2400,endingEnd:2400},i}return Object(h.a)(t,e),Object(m.a)(t,[{key:"intervalChanged_",value:function(e,t,n){var r=this.parameterPositions,a=e-2,i=e+1,o=r[a],s=r[i];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:a=e,o=2*t-n;break;case 2402:o=t+r[a=r.length-2]-r[a+1];break;default:a=e,o=n}if(void 0===s)switch(this.getSettings_().endingEnd){case 2401:i=e,s=2*n-t;break;case 2402:i=1,s=n+r[1]-r[0];break;default:i=e-1,s=t}var l=.5*(n-t),c=this.valueSize;this._weightPrev=l/(t-o),this._weightNext=l/(s-n),this._offsetPrev=a*c,this._offsetNext=i*c}},{key:"interpolate_",value:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=this._offsetPrev,u=this._offsetNext,d=this._weightPrev,h=this._weightNext,f=(n-t)/(r-t),p=f*f,m=p*f,v=-d*m+2*d*p-d*f,g=(1+d)*m+(-1.5-2*d)*p+(-.5+d)*f+1,y=(-1-h)*m+(1.5+h)*p+.5*f,b=h*m-h*p,_=0;_!==o;++_)a[_]=v*i[c+_]+g*i[l+_]+y*i[s+_]+b*i[u+_];return a}}])}(fi),mi=function(e){function t(e,n,r,a){return Object(p.a)(this,t),v(this,t,[e,n,r,a])}return Object(h.a)(t,e),Object(m.a)(t,[{key:"interpolate_",value:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=e*o,l=s-o,c=(n-t)/(r-t),u=1-c,d=0;d!==o;++d)a[d]=i[l+d]*u+i[s+d]*c;return a}}])}(fi),vi=function(e){function t(e,n,r,a){return Object(p.a)(this,t),v(this,t,[e,n,r,a])}return Object(h.a)(t,e),Object(m.a)(t,[{key:"interpolate_",value:function(e){return this.copySampleValue_(e-1)}}])}(fi),gi=function(){return Object(m.a)((function e(t,n,r,a){if(Object(p.a)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=di(n,this.TimeBufferType),this.values=di(r,this.ValueBufferType),this.setInterpolation(a||this.DefaultInterpolation)}),[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new vi(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new mi(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new pi(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case 2300:t=this.InterpolantFactoryMethodDiscrete;break;case 2301:t=this.InterpolantFactoryMethodLinear;break;case 2302:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,a=0,i=r-1;a!==r&&n[a]<e;)++a;for(;-1!==i&&n[i]>t;)--i;if(++i,0!==a||i!==r){a>=i&&(a=(i=Math.max(i,1))-1);var o=this.getValueSize();this.times=ui(n,a,i),this.values=ui(this.values,a*o,i*o)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,a=n.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var i=null,o=0;o!==a;o++){var s=n[o];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,o,s),e=!1;break}if(null!==i&&i>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,o,s,i),e=!1;break}i=s}if(void 0!==r&&hi(r))for(var l=0,c=r.length;l!==c;++l){var u=r[l];if(isNaN(u)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,l,u),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=ui(this.times),t=ui(this.values),n=this.getValueSize(),r=2302===this.getInterpolation(),a=e.length-1,i=1,o=1;o<a;++o){var s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==e[0]))if(r)s=!0;else for(var c=o*n,u=c-n,d=c+n,h=0;h!==n;++h){var f=t[c+h];if(f!==t[u+h]||f!==t[d+h]){s=!0;break}}if(s){if(o!==i){e[i]=e[o];for(var p=o*n,m=i*n,v=0;v!==n;++v)t[m+v]=t[p+v]}++i}}if(a>0){e[i]=e[a];for(var g=a*n,y=i*n,b=0;b!==n;++b)t[y+b]=t[g+b];++i}return i!==e.length?(this.times=ui(e,0,i),this.values=ui(t,0,i*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=ui(this.times,0),t=ui(this.values,0),n=new(0,this.constructor)(this.name,e,t);return n.createInterpolant=this.createInterpolant,n}}],[{key:"toJSON",value:function(e){var t,n=e.constructor;if(n.toJSON!==this.toJSON)t=n.toJSON(e);else{t={name:e.name,times:di(e.times,Array),values:di(e.values,Array)};var r=e.getInterpolation();r!==e.DefaultInterpolation&&(t.interpolation=r)}return t.type=e.ValueTypeName,t}}])}();gi.prototype.TimeBufferType=Float32Array,gi.prototype.ValueBufferType=Float32Array,gi.prototype.DefaultInterpolation=2301;var yi=function(e){function t(){return Object(p.a)(this,t),v(this,t,arguments)}return Object(h.a)(t,e),Object(m.a)(t)}(gi);yi.prototype.ValueTypeName="bool",yi.prototype.ValueBufferType=Array,yi.prototype.DefaultInterpolation=2300,yi.prototype.InterpolantFactoryMethodLinear=void 0,yi.prototype.InterpolantFactoryMethodSmooth=void 0;var bi=function(e){function t(){return Object(p.a)(this,t),v(this,t,arguments)}return Object(h.a)(t,e),Object(m.a)(t)}(gi);bi.prototype.ValueTypeName="color";var _i=function(e){function t(){return Object(p.a)(this,t),v(this,t,arguments)}return Object(h.a)(t,e),Object(m.a)(t)}(gi);_i.prototype.ValueTypeName="number";var xi=function(e){function t(e,n,r,a){return Object(p.a)(this,t),v(this,t,[e,n,r,a])}return Object(h.a)(t,e),Object(m.a)(t,[{key:"interpolate_",value:function(e,t,n,r){for(var a=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=(n-t)/(r-t),l=e*o,c=l+o;l!==c;l+=4)ce.slerpFlat(a,0,i,l-o,i,l,s);return a}}])}(fi),Ei=function(e){function t(){return Object(p.a)(this,t),v(this,t,arguments)}return Object(h.a)(t,e),Object(m.a)(t,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new xi(this.times,this.values,this.getValueSize(),e)}}])}(gi);Ei.prototype.ValueTypeName="quaternion",Ei.prototype.DefaultInterpolation=2301,Ei.prototype.InterpolantFactoryMethodSmooth=void 0;var Si=function(e){function t(){return Object(p.a)(this,t),v(this,t,arguments)}return Object(h.a)(t,e),Object(m.a)(t)}(gi);Si.prototype.ValueTypeName="string",Si.prototype.ValueBufferType=Array,Si.prototype.DefaultInterpolation=2300,Si.prototype.InterpolantFactoryMethodLinear=void 0,Si.prototype.InterpolantFactoryMethodSmooth=void 0;var Mi=function(e){function t(){return Object(p.a)(this,t),v(this,t,arguments)}return Object(h.a)(t,e),Object(m.a)(t)}(gi);Mi.prototype.ValueTypeName="vector";var Ti=Object(m.a)((function e(t,n,r){Object(p.a)(this,e);var a=this,i=!1,o=0,s=0,l=void 0,c=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=r,this.itemStart=function(e){s++,!1===i&&void 0!==a.onStart&&a.onStart(e,o,s),i=!0},this.itemEnd=function(e){o++,void 0!==a.onProgress&&a.onProgress(e,o,s),o===s&&(i=!1,void 0!==a.onLoad&&a.onLoad())},this.itemError=function(e){void 0!==a.onError&&a.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this},this.addHandler=function(e,t){return c.push(e,t),this},this.removeHandler=function(e){var t=c.indexOf(e);return-1!==t&&c.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=c.length;t<n;t+=2){var r=c[t],a=c[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return a}return null}})),wi=new Ti,Oi=function(){return Object(m.a)((function e(t){Object(p.a)(this,e),this.manager=void 0!==t?t:wi,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}),[{key:"load",value:function(){}},{key:"loadAsync",value:function(e,t){var n=this;return new Promise((function(r,a){n.load(e,r,t,a)}))}},{key:"parse",value:function(){}},{key:"setCrossOrigin",value:function(e){return this.crossOrigin=e,this}},{key:"setWithCredentials",value:function(e){return this.withCredentials=e,this}},{key:"setPath",value:function(e){return this.path=e,this}},{key:"setResourcePath",value:function(e){return this.resourcePath=e,this}},{key:"setRequestHeader",value:function(e){return this.requestHeader=e,this}}])}();Oi.DEFAULT_MATERIAL_NAME="__DEFAULT";Error;var Ai=new RegExp("[\\[\\]\\.:\\/]","g"),Ri="[^"+"\\[\\]\\.:\\/".replace("\\.","")+"]",Ci=new RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC","[^\\[\\]\\.:\\/]")+/(WCOD+)?/.source.replace("WCOD",Ri)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC","[^\\[\\]\\.:\\/]")+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC","[^\\[\\]\\.:\\/]")+"$"),ki=["material","materials","bones","map"],Pi=function(){return Object(m.a)((function e(t,n,r){Object(p.a)(this,e);var a=r||Li.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,a)}),[{key:"getValue",value:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)}},{key:"setValue",value:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,a=n.length;r!==a;++r)n[r].setValue(e,t)}},{key:"bind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()}},{key:"unbind",value:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}])}(),Li=function(){function e(t,n,r){Object(p.a)(this,e),this.path=n,this.parsedPath=r||e.parseTrackName(n),this.node=e.findNode(t,this.parsedPath.nodeName),this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}return Object(m.a)(e,[{key:"_getValue_unavailable",value:function(){}},{key:"_setValue_unavailable",value:function(){}},{key:"_getValue_direct",value:function(e,t){e[t]=this.targetObject[this.propertyName]}},{key:"_getValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)e[t++]=n[r]}},{key:"_getValue_arrayElement",value:function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]}},{key:"_getValue_toArray",value:function(e,t){this.resolvedProperty.toArray(e,t)}},{key:"_setValue_direct",value:function(e,t){this.targetObject[this.propertyName]=e[t]}},{key:"_setValue_direct_setNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_direct_setMatrixWorldNeedsUpdate",value:function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_array",value:function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++]}},{key:"_setValue_array_setNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0}},{key:"_setValue_array_setMatrixWorldNeedsUpdate",value:function(e,t){for(var n=this.resolvedProperty,r=0,a=n.length;r!==a;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_arrayElement",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]}},{key:"_setValue_arrayElement_setNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0}},{key:"_setValue_arrayElement_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_setValue_fromArray",value:function(e,t){this.resolvedProperty.fromArray(e,t)}},{key:"_setValue_fromArray_setNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0}},{key:"_setValue_fromArray_setMatrixWorldNeedsUpdate",value:function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}},{key:"_getValue_unbound",value:function(e,t){this.bind(),this.getValue(e,t)}},{key:"_setValue_unbound",value:function(e,t){this.bind(),this.setValue(e,t)}},{key:"bind",value:function(){var t=this.node,n=this.parsedPath,r=n.objectName,a=n.propertyName,i=n.propertyIndex;if(t||(t=e.findNode(this.rootNode,n.nodeName),this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,t){if(r){var o=n.objectIndex;switch(r){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var s=0;s<t.length;s++)if(t[s].name===o){o=s;break}break;case"map":if("map"in t){t=t.map;break}if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.map)return void console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);t=t.material.map;break;default:if(void 0===t[r])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[r]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var l=t[a];if(void 0!==l){var c=this.Versioning.None;this.targetObject=t,void 0!==t.needsUpdate?c=this.Versioning.NeedsUpdate:void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate);var u=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===a){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==t.morphTargetDictionary[i]&&(i=t.morphTargetDictionary[i])}u=this.BindingType.ArrayElement,this.resolvedProperty=l,this.propertyIndex=i}else void 0!==l.fromArray&&void 0!==l.toArray?(u=this.BindingType.HasFromToArray,this.resolvedProperty=l):Array.isArray(l)?(u=this.BindingType.EntireArray,this.resolvedProperty=l):this.propertyName=a;this.getValue=this.GetterByBindingType[u],this.setValue=this.SetterByBindingTypeAndVersioning[u][c]}else{var d=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+d+"."+a+" but it wasn't found.",t)}}else console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".")}},{key:"unbind",value:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}],[{key:"create",value:function(t,n,r){return t&&t.isAnimationObjectGroup?new e.Composite(t,n,r):new e(t,n,r)}},{key:"sanitizeNodeName",value:function(e){return e.replace(/\s/g,"_").replace(Ai,"")}},{key:"parseTrackName",value:function(e){var t=Ci.exec(e);if(null===t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var a=n.nodeName.substring(r+1);-1!==ki.indexOf(a)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=a)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n}},{key:"findNode",value:function(e,t){if(void 0===t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var a=n[r];if(a.name===t||a.uuid===t)return a;var i=e(a.children);if(i)return i}return null}(e.children);if(r)return r}return null}}])}();Li.Composite=Pi,Li.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Li.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Li.prototype.GetterByBindingType=[Li.prototype._getValue_direct,Li.prototype._getValue_array,Li.prototype._getValue_arrayElement,Li.prototype._getValue_toArray],Li.prototype.SetterByBindingTypeAndVersioning=[[Li.prototype._setValue_direct,Li.prototype._setValue_direct_setNeedsUpdate,Li.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Li.prototype._setValue_array,Li.prototype._setValue_array_setNeedsUpdate,Li.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Li.prototype._setValue_arrayElement,Li.prototype._setValue_arrayElement_setNeedsUpdate,Li.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Li.prototype._setValue_fromArray,Li.prototype._setValue_fromArray_setNeedsUpdate,Li.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];new Float32Array(1);var Ii=function(){return Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(p.a)(this,e),this.radius=t,this.phi=n,this.theta=r,this}),[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(C(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}])}();function Ni(e,t,n){return t=Object(l.a)(t),Object(u.a)(e,Object(d.a)()?Reflect.construct(t,n||[],Object(l.a)(e).constructor):t.apply(e,n))}"undefined"!==typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"155"}})),"undefined"!==typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="155");var Di=new ue,Ui=new ce,ji=new ue,Fi=function(e){function t(){var e,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.createElement("div");return Object(p.a)(this,t),(e=Ni(this,t)).isCSS3DObject=!0,e.element=n,e.element.style.position="absolute",e.element.style.pointerEvents="auto",e.element.style.userSelect="none",e.element.setAttribute("draggable",!1),e.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))})),e}return Object(h.a)(t,e),Object(m.a)(t,[{key:"copy",value:function(e,n){return c(Object(l.a)(t.prototype),"copy",this).call(this,e,n),this.element=e.element.cloneNode(!0),this}}])}(dt),zi=new ze,Bi=new ze,Hi=Object(m.a)((function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(p.a)(this,e);var n,r,a,i,o=this,s={camera:{fov:0,style:""},objects:new WeakMap},l=void 0!==t.element?t.element:document.createElement("div");l.style.overflow="hidden",this.domElement=l;var c=document.createElement("div");c.style.transformOrigin="0 0",c.style.pointerEvents="none",l.appendChild(c);var u=document.createElement("div");function d(e){return Math.abs(e)<1e-10?0:e}function h(e){var t=e.elements;return"matrix3d("+d(t[0])+","+d(-t[1])+","+d(t[2])+","+d(t[3])+","+d(t[4])+","+d(-t[5])+","+d(t[6])+","+d(t[7])+","+d(t[8])+","+d(-t[9])+","+d(t[10])+","+d(t[11])+","+d(t[12])+","+d(-t[13])+","+d(t[14])+","+d(t[15])+")"}function f(e){var t=e.elements;return"translate(-50%,-50%)"+("matrix3d("+d(t[0])+","+d(t[1])+","+d(t[2])+","+d(t[3])+","+d(-t[4])+","+d(-t[5])+","+d(-t[6])+","+d(-t[7])+","+d(t[8])+","+d(t[9])+","+d(t[10])+","+d(t[11])+","+d(t[12])+","+d(t[13])+","+d(t[14])+","+d(t[15])+")")}function m(e,t,n,r){if(e.isCSS3DObject){var a=!0===e.visible&&!0===e.layers.test(n.layers);if(e.element.style.display=!0===a?"":"none",!0===a){var i;e.onBeforeRender(o,t,n),e.isCSS3DSprite?(zi.copy(n.matrixWorldInverse),zi.transpose(),0!==e.rotation2D&&zi.multiply(Bi.makeRotationZ(e.rotation2D)),e.matrixWorld.decompose(Di,Ui,ji),zi.setPosition(Di),zi.scale(ji),zi.elements[3]=0,zi.elements[7]=0,zi.elements[11]=0,zi.elements[15]=1,i=f(zi)):i=f(e.matrixWorld);var l=e.element,c=s.objects.get(e);if(void 0===c||c.style!==i){l.style.transform=i;var d={style:i};s.objects.set(e,d)}l.parentNode!==u&&u.appendChild(l),e.onAfterRender(o,t,n)}}for(var h=0,p=e.children.length;h<p;h++)m(e.children[h],t,n,r)}u.style.transformStyle="preserve-3d",c.appendChild(u),this.getSize=function(){return{width:n,height:r}},this.render=function(e,t){var o,l,f=t.projectionMatrix.elements[5]*i;s.camera.fov!==f&&(c.style.perspective=t.isPerspectiveCamera?f+"px":"",s.camera.fov=f),t.view&&t.view.enabled?(c.style.transform="translate( ".concat(-t.view.offsetX*(n/t.view.width),"px, ").concat(-t.view.offsetY*(r/t.view.height),"px )"),c.style.transform+="scale( ".concat(t.view.fullWidth/t.view.width,", ").concat(t.view.fullHeight/t.view.height," )")):c.style.transform="",!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),t.isOrthographicCamera&&(o=-(t.right+t.left)/2,l=(t.top+t.bottom)/2);var p=t.view&&t.view.enabled?t.view.height/t.view.fullHeight:1,v=t.isOrthographicCamera?"scale( ".concat(p," )")+"scale("+f+")translate("+d(o)+"px,"+d(l)+"px)"+h(t.matrixWorldInverse):"scale( ".concat(p," )")+"translateZ("+f+"px)"+h(t.matrixWorldInverse),g=v+"translate("+a+"px,"+i+"px)";s.camera.style!==g&&(u.style.transform=g,s.camera.style=g),m(e,e,t,v)},this.setSize=function(e,t){a=(n=e)/2,i=(r=t)/2,l.style.width=e+"px",l.style.height=t+"px",c.style.width=e+"px",c.style.height=t+"px",u.style.width=e+"px",u.style.height=t+"px"}}));var Vi,Gi,Wi,Xi={type:"change"},qi={type:"start"},Yi={type:"end"},Ki=new Fe,Zi=new On,Ji=Math.cos(70*U),Qi=function(e){function t(e,n){var r,a,i,o;Object(p.a)(this,t),a=this,i=t,i=Object(l.a)(i),(r=Object(u.a)(a,Object(d.a)()?Reflect.construct(i,o||[],Object(l.a)(a).constructor):i.apply(a,o))).object=e,r.domElement=n,r.domElement.style.touchAction="none",r.enabled=!0,r.target=new ue,r.minDistance=0,r.maxDistance=1/0,r.minZoom=0,r.maxZoom=1/0,r.minPolarAngle=0,r.maxPolarAngle=Math.PI,r.minAzimuthAngle=-1/0,r.maxAzimuthAngle=1/0,r.enableDamping=!1,r.dampingFactor=.05,r.enableZoom=!0,r.zoomSpeed=1,r.enableRotate=!0,r.rotateSpeed=1,r.enablePan=!0,r.panSpeed=1,r.screenSpacePanning=!0,r.keyPanSpeed=7,r.zoomToCursor=!1,r.autoRotate=!1,r.autoRotateSpeed=2,r.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},r.mouseButtons={LEFT:y,MIDDLE:b,RIGHT:_},r.touches={ONE:x,TWO:S},r.target0=r.target.clone(),r.position0=r.object.position.clone(),r.zoom0=r.object.zoom,r._domElementKeyEvents=null,r.getPolarAngle=function(){return m.phi},r.getAzimuthalAngle=function(){return m.theta},r.getDistance=function(){return this.object.position.distanceTo(this.target)},r.listenToKeyEvents=function(e){e.addEventListener("keydown",de),this._domElementKeyEvents=e},r.stopListenToKeyEvents=function(){this._domElementKeyEvents.removeEventListener("keydown",de),this._domElementKeyEvents=null},r.saveState=function(){s.target0.copy(s.target),s.position0.copy(s.object.position),s.zoom0=s.object.zoom},r.reset=function(){s.target.copy(s.target0),s.object.position.copy(s.position0),s.object.zoom=s.zoom0,s.object.updateProjectionMatrix(),s.dispatchEvent(Xi),s.update(),h=c.NONE},r.update=function(){var t=new ue,n=(new ce).setFromUnitVectors(e.up,new ue(0,1,0)),r=n.clone().invert(),a=new ue,i=new ce,o=new ue,l=2*Math.PI;return function(){var u=s.object.position;t.copy(u).sub(s.target),t.applyQuaternion(n),m.setFromVector3(t),s.autoRotate&&h===c.NONE&&H(2*Math.PI/60/60*s.autoRotateSpeed),s.enableDamping?(m.theta+=v.theta*s.dampingFactor,m.phi+=v.phi*s.dampingFactor):(m.theta+=v.theta,m.phi+=v.phi);var d=s.minAzimuthAngle,p=s.maxAzimuthAngle;isFinite(d)&&isFinite(p)&&(d<-Math.PI?d+=l:d>Math.PI&&(d-=l),p<-Math.PI?p+=l:p>Math.PI&&(p-=l),m.theta=d<=p?Math.max(d,Math.min(p,m.theta)):m.theta>(d+p)/2?Math.max(d,m.theta):Math.min(p,m.theta)),m.phi=Math.max(s.minPolarAngle,Math.min(s.maxPolarAngle,m.phi)),m.makeSafe(),!0===s.enableDamping?s.target.addScaledVector(T,s.dampingFactor):s.target.add(T),s.zoomToCursor&&U||s.object.isOrthographicCamera?m.radius=Z(m.radius):m.radius=Z(m.radius*g),t.setFromSpherical(m),t.applyQuaternion(r),u.copy(s.target).add(t),s.object.lookAt(s.target),!0===s.enableDamping?(v.theta*=1-s.dampingFactor,v.phi*=1-s.dampingFactor,T.multiplyScalar(1-s.dampingFactor)):(v.set(0,0,0),T.set(0,0,0));var y=!1;if(s.zoomToCursor&&U){var b=null;if(s.object.isPerspectiveCamera){var _=t.length(),x=_-(b=Z(_*g));s.object.position.addScaledVector(N,x),s.object.updateMatrixWorld()}else if(s.object.isOrthographicCamera){var E=new ue(D.x,D.y,0);E.unproject(s.object),s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/g)),s.object.updateProjectionMatrix(),y=!0;var S=new ue(D.x,D.y,0);S.unproject(s.object),s.object.position.sub(S).add(E),s.object.updateMatrixWorld(),b=t.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),s.zoomToCursor=!1;null!==b&&(this.screenSpacePanning?s.target.set(0,0,-1).transformDirection(s.object.matrix).multiplyScalar(b).add(s.object.position):(Ki.origin.copy(s.object.position),Ki.direction.set(0,0,-1).transformDirection(s.object.matrix),Math.abs(s.object.up.dot(Ki.direction))<Ji?e.lookAt(s.target):(Zi.setFromNormalAndCoplanarPoint(s.object.up,s.target),Ki.intersectPlane(Zi,s.target))))}else s.object.isOrthographicCamera&&(s.object.zoom=Math.max(s.minZoom,Math.min(s.maxZoom,s.object.zoom/g)),s.object.updateProjectionMatrix(),y=!0);return g=1,U=!1,!!(y||a.distanceToSquared(s.object.position)>f||8*(1-i.dot(s.object.quaternion))>f||o.distanceToSquared(s.target)>0)&&(s.dispatchEvent(Xi),a.copy(s.object.position),i.copy(s.object.quaternion),o.copy(s.target),y=!1,!0)}}(),r.dispose=function(){s.domElement.removeEventListener("contextmenu",he),s.domElement.removeEventListener("pointerdown",ie),s.domElement.removeEventListener("pointercancel",se),s.domElement.removeEventListener("wheel",le),s.domElement.removeEventListener("pointermove",oe),s.domElement.removeEventListener("pointerup",se),null!==s._domElementKeyEvents&&(s._domElementKeyEvents.removeEventListener("keydown",de),s._domElementKeyEvents=null)};var s=r,c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},h=c.NONE,f=1e-6,m=new Ii,v=new Ii,g=1,T=new ue,w=new j,O=new j,A=new j,R=new j,C=new j,k=new j,P=new j,L=new j,I=new j,N=new ue,D=new j,U=!1,F=[],z={};function B(){return Math.pow(.95,s.zoomSpeed)}function H(e){v.theta-=e}function V(e){v.phi-=e}var G=function(){var e=new ue;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),T.add(e)}}(),W=function(){var e=new ue;return function(t,n){!0===s.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(s.object.up,e)),e.multiplyScalar(t),T.add(e)}}(),X=function(){var e=new ue;return function(t,n){var r=s.domElement;if(s.object.isPerspectiveCamera){var a=s.object.position;e.copy(a).sub(s.target);var i=e.length();i*=Math.tan(s.object.fov/2*Math.PI/180),G(2*t*i/r.clientHeight,s.object.matrix),W(2*n*i/r.clientHeight,s.object.matrix)}else s.object.isOrthographicCamera?(G(t*(s.object.right-s.object.left)/s.object.zoom/r.clientWidth,s.object.matrix),W(n*(s.object.top-s.object.bottom)/s.object.zoom/r.clientHeight,s.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),s.enablePan=!1)}}();function q(e){s.object.isPerspectiveCamera||s.object.isOrthographicCamera?g/=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function Y(e){s.object.isPerspectiveCamera||s.object.isOrthographicCamera?g*=e:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),s.enableZoom=!1)}function K(t){if(s.zoomToCursor){U=!0;var n=s.domElement.getBoundingClientRect(),r=t.clientX-n.left,a=t.clientY-n.top,i=n.width,o=n.height;D.x=r/i*2-1,D.y=-a/o*2+1,N.set(D.x,D.y,1).unproject(e).sub(e.position).normalize()}}function Z(e){return Math.max(s.minDistance,Math.min(s.maxDistance,e))}function J(e){w.set(e.clientX,e.clientY)}function Q(e){R.set(e.clientX,e.clientY)}function $(){if(1===F.length)w.set(F[0].pageX,F[0].pageY);else{var e=.5*(F[0].pageX+F[1].pageX),t=.5*(F[0].pageY+F[1].pageY);w.set(e,t)}}function ee(){if(1===F.length)R.set(F[0].pageX,F[0].pageY);else{var e=.5*(F[0].pageX+F[1].pageX),t=.5*(F[0].pageY+F[1].pageY);R.set(e,t)}}function te(){var e=F[0].pageX-F[1].pageX,t=F[0].pageY-F[1].pageY,n=Math.sqrt(e*e+t*t);P.set(0,n)}function ne(e){if(1==F.length)O.set(e.pageX,e.pageY);else{var t=pe(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);O.set(n,r)}A.subVectors(O,w).multiplyScalar(s.rotateSpeed);var a=s.domElement;H(2*Math.PI*A.x/a.clientHeight),V(2*Math.PI*A.y/a.clientHeight),w.copy(O)}function re(e){if(1===F.length)C.set(e.pageX,e.pageY);else{var t=pe(e),n=.5*(e.pageX+t.x),r=.5*(e.pageY+t.y);C.set(n,r)}k.subVectors(C,R).multiplyScalar(s.panSpeed),X(k.x,k.y),R.copy(C)}function ae(e){var t=pe(e),n=e.pageX-t.x,r=e.pageY-t.y,a=Math.sqrt(n*n+r*r);L.set(0,a),I.set(0,Math.pow(L.y/P.y,s.zoomSpeed)),q(I.y),P.copy(L)}function ie(e){!1!==s.enabled&&(0===F.length&&(s.domElement.setPointerCapture(e.pointerId),s.domElement.addEventListener("pointermove",oe),s.domElement.addEventListener("pointerup",se)),function(e){F.push(e)}(e),"touch"===e.pointerType?function(e){switch(fe(e),F.length){case 1:switch(s.touches.ONE){case x:if(!1===s.enableRotate)return;$(),h=c.TOUCH_ROTATE;break;case E:if(!1===s.enablePan)return;ee(),h=c.TOUCH_PAN;break;default:h=c.NONE}break;case 2:switch(s.touches.TWO){case S:if(!1===s.enableZoom&&!1===s.enablePan)return;s.enableZoom&&te(),s.enablePan&&ee(),h=c.TOUCH_DOLLY_PAN;break;case M:if(!1===s.enableZoom&&!1===s.enableRotate)return;s.enableZoom&&te(),s.enableRotate&&$(),h=c.TOUCH_DOLLY_ROTATE;break;default:h=c.NONE}break;default:h=c.NONE}h!==c.NONE&&s.dispatchEvent(qi)}(e):function(e){var t;switch(e.button){case 0:t=s.mouseButtons.LEFT;break;case 1:t=s.mouseButtons.MIDDLE;break;case 2:t=s.mouseButtons.RIGHT;break;default:t=-1}switch(t){case b:if(!1===s.enableZoom)return;!function(e){K(e),P.set(e.clientX,e.clientY)}(e),h=c.DOLLY;break;case y:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enablePan)return;Q(e),h=c.PAN}else{if(!1===s.enableRotate)return;J(e),h=c.ROTATE}break;case _:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===s.enableRotate)return;J(e),h=c.ROTATE}else{if(!1===s.enablePan)return;Q(e),h=c.PAN}break;default:h=c.NONE}h!==c.NONE&&s.dispatchEvent(qi)}(e))}function oe(e){!1!==s.enabled&&("touch"===e.pointerType?function(e){switch(fe(e),h){case c.TOUCH_ROTATE:if(!1===s.enableRotate)return;ne(e),s.update();break;case c.TOUCH_PAN:if(!1===s.enablePan)return;re(e),s.update();break;case c.TOUCH_DOLLY_PAN:if(!1===s.enableZoom&&!1===s.enablePan)return;!function(e){s.enableZoom&&ae(e),s.enablePan&&re(e)}(e),s.update();break;case c.TOUCH_DOLLY_ROTATE:if(!1===s.enableZoom&&!1===s.enableRotate)return;!function(e){s.enableZoom&&ae(e),s.enableRotate&&ne(e)}(e),s.update();break;default:h=c.NONE}}(e):function(e){switch(h){case c.ROTATE:if(!1===s.enableRotate)return;!function(e){O.set(e.clientX,e.clientY),A.subVectors(O,w).multiplyScalar(s.rotateSpeed);var t=s.domElement;H(2*Math.PI*A.x/t.clientHeight),V(2*Math.PI*A.y/t.clientHeight),w.copy(O),s.update()}(e);break;case c.DOLLY:if(!1===s.enableZoom)return;!function(e){L.set(e.clientX,e.clientY),I.subVectors(L,P),I.y>0?q(B()):I.y<0&&Y(B()),P.copy(L),s.update()}(e);break;case c.PAN:if(!1===s.enablePan)return;!function(e){C.set(e.clientX,e.clientY),k.subVectors(C,R).multiplyScalar(s.panSpeed),X(k.x,k.y),R.copy(C),s.update()}(e)}}(e))}function se(e){!function(e){delete z[e.pointerId];for(var t=0;t<F.length;t++)if(F[t].pointerId==e.pointerId)return void F.splice(t,1)}(e),0===F.length&&(s.domElement.releasePointerCapture(e.pointerId),s.domElement.removeEventListener("pointermove",oe),s.domElement.removeEventListener("pointerup",se)),s.dispatchEvent(Yi),h=c.NONE}function le(e){!1!==s.enabled&&!1!==s.enableZoom&&h===c.NONE&&(e.preventDefault(),s.dispatchEvent(qi),function(e){K(e),e.deltaY<0?Y(B()):e.deltaY>0&&q(B()),s.update()}(e),s.dispatchEvent(Yi))}function de(e){!1!==s.enabled&&!1!==s.enablePan&&function(e){var t=!1;switch(e.code){case s.keys.UP:e.ctrlKey||e.metaKey||e.shiftKey?V(2*Math.PI*s.rotateSpeed/s.domElement.clientHeight):X(0,s.keyPanSpeed),t=!0;break;case s.keys.BOTTOM:e.ctrlKey||e.metaKey||e.shiftKey?V(-2*Math.PI*s.rotateSpeed/s.domElement.clientHeight):X(0,-s.keyPanSpeed),t=!0;break;case s.keys.LEFT:e.ctrlKey||e.metaKey||e.shiftKey?H(2*Math.PI*s.rotateSpeed/s.domElement.clientHeight):X(s.keyPanSpeed,0),t=!0;break;case s.keys.RIGHT:e.ctrlKey||e.metaKey||e.shiftKey?H(-2*Math.PI*s.rotateSpeed/s.domElement.clientHeight):X(-s.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),s.update())}(e)}function he(e){!1!==s.enabled&&e.preventDefault()}function fe(e){var t=z[e.pointerId];void 0===t&&(t=new j,z[e.pointerId]=t),t.set(e.pageX,e.pageY)}function pe(e){var t=e.pointerId===F[0].pointerId?F[1]:F[0];return z[t.pointerId]}return s.domElement.addEventListener("contextmenu",he),s.domElement.addEventListener("pointerdown",ie),s.domElement.addEventListener("pointercancel",se),s.domElement.addEventListener("wheel",le,{passive:!1}),r.update(),r}return Object(h.a)(t,e),Object(m.a)(t)}(T),$i=n(1082),eo=n(972),to=n(964),no=n(1054),ro=n.n(no),ao=[],io=[],oo=[],so=!1,lo=0,co=null,uo=null,ho=null,fo=null,po=null,mo=to.c(to.d),vo=!0;function go(e){po=e}function yo(e){e}function bo(e){e}function _o(e,t,n,r,a){var i=document.querySelector(".tooltip");if(i)i.style.left=t+"px",i.style.top=n+"px",i.style.opacity=1,i.style.backgroundColor=r,i.style.boxShadow="0px 0px 5px 0px "+r,i.innerHTML=e;else{var o=document.createElement("div");o.classList.add("tooltip"),o.style.left=t+"px",o.style.top=n+"px",o.style.opacity=1,o.style.backgroundColor=r,o.style.boxShadow="0px 0px 5px 0px "+r,o.innerHTML=e,document.body.appendChild(o)}}function xo(){var e=document.querySelector(".tooltip");e&&e.remove()}function Eo(e){fo=e}function So(e,t,n){var r=Vi.position.y,a=Vi.position.z;Vi.position.set(100*e,r,a),Vi.rotation.set(0,0,0),lo=e,wo(e,t,n)}function Mo(e,t,n,r){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5];vo=i,r,uo=t,mo=to.c(to.d);var o=window.innerWidth/window.innerHeight,s=uo.getBoundingClientRect();(Vi=new Gn(1e3*o/-2,1e3*o/2,500,-500,1,1e3)).position.set(-0,0,200),Vi.rotation.set(0,0,0),Gi=new ci;for(var l=1;l<=e;l++)oo.push(!1),h(72,72/n,l,new ue(1e4*Math.random()-5e3,2e3*Math.random()-1e3,2e3*Math.random()),new Ze(0,0,0));for(var c={line:[]},u=0;u<ao.length;u++){var d=new dt;d.position.x=100*u,d.position.y=0,d.position.z=0,c.line.push(d)}function h(e,t,a,i,o){var s=document.createElement("div");s.style.width=e+"px",s.style.height=t+"px",s.style.backgroundColor="white",s.style.backgroundSize="contain",s.style.backgroundRepeat="no-repeat",s.style.backgroundPosition="center",s.className="plane",s.addEventListener("pointerdown",(function(){if(lo===a)so||(so=!0);else{lo=a,so=!0;var e=Vi.position.y,t=Vi.position.z;Vi.position.set(100*lo,e,t)}wo(a,n,r)}));var l=new Fi(s);l.position.copy(i),l.rotation.copy(o),Gi.add(l),ao.push(l),io.push(s)}uo.style.height=s.height+"px",(Wi=new Hi).setSize(s.width,s.height),Wi.domElement.style.position="absolute",Wi.domElement.style.top=0,uo.appendChild(Wi.domElement),Vi.zoom=.45,(co=new Qi(Vi,Wi.domElement)).minZoom=.3,co.maxZoom=5,co.zoomSpeed=2,co.enableRotate=!1,co.enablePan=!1,co.enableZoom=!1,co.update(),setTimeout((function(){Ro(c.line,3)}),350),setTimeout((function(){so=!0,lo=a,wo(a,n,r)}),1e3),window.addEventListener("resize",Co)}function To(e){var t=lo-1,n=t-10,r=t+10;n<0&&(n=0,r=20),r>ao.length&&(n=ao.length-20,r=ao.length);for(var a=[],i=n;i<r;i++)!1===oo[i]&&a.push(i);eo.f(e,a,"small",vo).then((function(e){for(var t=0;t<a.length;t++){oo[a[t]]=!0;var n=ao[a[t]],r="data:image/jpg;base64,"+e[t].data;lo!==a[t]+1&&(n.element.style.backgroundColor="transparent"),n.element.style.backgroundImage='url("'+r+'")'}}))}function wo(e,t,n){if(fo(e),so){ho&&clearTimeout(ho),ho=setTimeout((function(){To(n),function(e){eo.f(e,[lo-1],"big",vo).then((function(e){try{var t=ao[lo-1],n="data:image/jpg;base64,"+e[0].data;t.element.style.backgroundColor="transparent",t.element.style.backgroundImage='url("'+n+'")'}catch(r){console.log(r)}}))}(n)}),250),co.enablePan=!0,co.enableZoom=!0,co.update();for(var r=0;r<e-1;r++){for(var a=ao[r];a.element.firstChild;)a.element.removeChild(a.element.firstChild);a.element.style.transition="all 1s cubic-bezier(0.215, 0.610, 0.355, 1)",a.element.style.width="72px",a.element.style.height=72/t+"px",a.position.x=100*r-1e3,a.position.y=0,a.position.z=0}for(var i=e;i<ao.length;i++){for(var o=ao[i];o.element.firstChild;)o.element.removeChild(o.element.firstChild);o.element.style.transition="all 1s cubic-bezier(0.215, 0.610, 0.355, 1)",o.element.style.width="72px",o.element.style.height=72/t+"px",o.position.x=100*i+1e3,o.position.y=0,o.position.z=0}Vi.position.set(100*(e-1),0,200);var s=ao[e-1];s&&(s.element.style.transition="all 1s cubic-bezier(0.215, 0.610, 0.355, 1)",s.element.style.width="1440px",s.element.style.height=1440/t+"px",s.position.z=1e3,s.position.y=10,s.position.x=100*(e-1))}else{ho&&clearTimeout(ho),ho=setTimeout((function(){To(n)}),250),co.enablePan=!1,co.enableZoom=!1,co.update();for(var l=0;l<e-1;l++){var c=ao[l];c.element.style.transition="all 1s cubic-bezier(0.215, 0.610, 0.355, 1)",c.element.style.width="72px",c.element.style.height=72/t+"px",c.position.x=100*l,c.position.y=0,c.position.z=0}for(var u=e;u<ao.length;u++){var d=ao[u];d.element.style.transition="all 1s cubic-bezier(0.215, 0.610, 0.355, 1)",d.element.style.width="72px",d.element.style.height=72/t+"px",d.position.x=100*u,d.position.y=0,d.position.z=0}Vi.position.set(100*(e-1),0,200);var h=ao[e-1];h.element.style.transition="all 1s cubic-bezier(0.215, 0.610, 0.355, 1)",h.element.style.width="72px",h.element.style.height=72/t+"px",h.position.x=100*(e-1),h.position.z=1e3,h.position.y=10}}function Oo(e){for(var t=ao[e-1];t.element.firstChild;)t.element.removeChild(t.element.firstChild);t.element.classList.remove("dark")}function Ao(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(e,t){};Oo(t);var i=document.createElementNS("http://www.w3.org/2000/svg","svg");function o(e){return Array.isArray(e.label)?e.label.length>0?"O"===e.label[0]?"transparent":mo(e.label[0]):void 0:e.type?mo(e.type):"transparent"}function s(e,t,n){var r=e.clientX,a=e.clientY;Array.isArray(t.label)?t.label.length>0&&("O"===t.label[0]?(n.setAttribute("stroke","black"),n.setAttribute("stroke-width",.05),n.setAttribute("fill","transparent")):(n.setAttribute("stroke","black"),n.setAttribute("stroke-width",.05),n.setAttribute("fill","transparent"),_o(t.label[0],r,a-20,o(t),n.getBoundingClientRect().height))):t.type?(n.setAttribute("stroke","black"),n.setAttribute("stroke-width",.05),n.setAttribute("fill","transparent"),_o(t.type,r,a-20,o(t),n.getBoundingClientRect().height)):(n.setAttribute("stroke","black"),n.setAttribute("stroke-width",.05),n.setAttribute("fill","transparent"),_o(t.text,r,a-20,mo(t.text),n.getBoundingClientRect().height))}function l(e,t,n){a(t,n)}if(i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("viewBox","0 0 100 ".concat(100/n)),i.setAttribute("preserveAspectRatio","none"),null===po)e.forEach((function(e,t){var r=document.createElementNS("http://www.w3.org/2000/svg","rect");r.setAttribute("x",100*e.bbox.x),r.setAttribute("y",100*e.bbox.y/n),r.setAttribute("width",100*e.bbox.width),r.setAttribute("height",100*e.bbox.height/n),r.setAttribute("fill",o(e,r)),r.setAttribute("fill-opacity",.3),r.addEventListener("mousemove",(function(t){s(t,e,r)})),r.addEventListener("mouseout",(function(){r.setAttribute("stroke","transparent"),r.setAttribute("fill",o(e)),xo()})),r.addEventListener("mousedown",(function(n){l(0,e,t)})),i.appendChild(r)}));else{xo();var c=document.createElementNS("http://www.w3.org/2000/svg","rect");c.setAttribute("x",100*po.bbox.x),c.setAttribute("y",100*po.bbox.y/n),c.setAttribute("width",100*po.bbox.width),c.setAttribute("height",100*po.bbox.height/n),c.setAttribute("fill",o(po,c)),c.setAttribute("fill-opacity",.3),ro()(c).resizable({edges:{left:!1,right:!0,bottom:!0,top:!1},listeners:{move:function(e){var i=e.target.width.animVal.value,o=e.target.height.animVal.value,s=ao[t-1].element.getBoundingClientRect().width,l=o/100*s,c=i/100*s+e.delta.x,u=l+e.delta.y;c=c/s*100,u=u/s*100,e.target.setAttribute("width","".concat(c)),e.target.setAttribute("height","".concat(u));var d={x:parseFloat(e.target.getAttribute("x"))/100,y:parseFloat(e.target.getAttribute("y"))/100*n,width:c/100,height:u/100*n},h=Object(r.a)({},po);h.bbox=d,a(h)}}}).draggable({listeners:{move:function(e){var i=parseFloat(e.target.getAttribute("x")),o=parseFloat(e.target.getAttribute("y")),s=parseFloat(e.target.getAttribute("width")),l=parseFloat(e.target.getAttribute("height")),c=ao[t-1].element.getBoundingClientRect().width,u=o/100*c;i=(i=i/100*c+e.delta.x)/c*100,o=(o=u+e.delta.y)/c*100,e.target.setAttribute("x",i),e.target.setAttribute("y",o);var d={x:i/100,y:o/100*n,width:s/100,height:l/100*n},h=Object(r.a)({},po);h.bbox=d,a(h)}}}),i.appendChild(c)}var u=ao[t-1];u.element.appendChild(i)}function Ro(e,t){$i.a.removeAll();for(var n=0;n<ao.length;n++){var r=ao[n],a=e[n];r.position.x=a.position.x,r.position.y=a.position.y,r.position.z=a.position.z,r.element.style.transition="all "+t*Math.random()+"s cubic-bezier(0.215, 0.610, 0.355, 1)"}}function Co(){var e=uo.getBoundingClientRect(),t=window.innerWidth/window.innerHeight;uo.style.height=e.width/t+"px",Vi.left=-1e3*t/2,Vi.right=1e3*t/2,Vi.top=500,Vi.bottom=-500,Vi.updateProjectionMatrix(),Wi.setSize(e.width,e.width/t)}function ko(){Wi&&(requestAnimationFrame(ko),Vi.rotation.set(0,0,0),.5===Vi.zoom&&Vi.position.set(100*(lo-1),0,200),Wi.render(Gi,Vi))}function Po(){Gi&&Wi&&Gi.clear(),window.removeEventListener("resize",Co),ao=[],oo=[],io=[],Wi=null,Gi=null,mo=to.c(to.d)}},1031:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"}),"Home")},1032:function(e,t,n){"use strict";var r=n(2),a=n(209);t.a=Object(a.a)(r.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete")},1041:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M17.77 3.77 16 2 6 12l10 10 1.77-1.77L9.54 12z"}),"ArrowBackIosNew")},1042:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"}),"ArrowForwardIos")},1043:function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return x}));var r=n(202),a=n(16),i=n(2),o=n.n(i),s=n(930),l=n(1392),c=n(843),u=n(46),d=n(264),h=n.n(d),f=n(964),p=function(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,".")},m=function(e){return o.a.createElement("div",null,e.data.map((function(e,t){return o.a.createElement("div",{key:t},o.a.createElement("div",{style:{position:"relative",height:"10px",borderRadius:"10px",marginTop:"15px",border:"1px solid #acbbd1",marginBottom:"5px"}},o.a.createElement("div",{style:{width:"".concat(e.percent,"%"),position:"absolute",height:"100%",background:"#acbbd1",borderRadius:"10px"}})),o.a.createElement("div",null,o.a.createElement("div",null,e.name," ",o.a.createElement("span",{style:{float:"right",color:"#fff",fontWeight:"bold",backgroundColor:"#56749a",minWidth:"20px",height:"20px",lineHeight:"20px",textAlign:"center",fontSize:"8px",borderRadius:"10px",padding:"0px 10px"}},p(e.count)))))})))},v=function(e){var t,n=Object(i.useRef)(null);return Object(i.useEffect)((function(){!function(){var t=e.data.map((function(e){return{type:e._id?e._id:"Sin procesar",value:e.count,color:e.color}})),r=f.f(n.current);r.attr("viewBox","0 0 200 200");var a=f.a().innerRadius(70).outerRadius(85),i=f.b().value((function(e){return e.value})),o=(f.a().innerRadius(95).outerRadius(95),i(t));r.append("g").attr("class","donut-container").attr("transform","translate(".concat(100,", ").concat(100,")")).selectAll("path").data(o).join("path").style("stroke","white").style("stroke-width",2).style("fill",(function(e){return e.data.color})).attr("d",a)}()}),[]),o.a.createElement("div",{style:{display:"flex",justifyContent:"space-around",alignItems:"center",position:"relative"}},o.a.createElement("svg",{style:{maxWidth:130},ref:n,className:e.className}),o.a.createElement("div",null,null===(t=e.data)||void 0===t?void 0:t.map((function(e,t){return o.a.createElement("div",{style:{textTransform:"uppercase",fontSize:"10px",fontWeight:"bold"},key:t},e._id?u.a.find((function(t){return t.value===e._id})).label:"Sin procesar",o.a.createElement("div",{style:{background:e.color,textAlign:"center",fontWeight:"bold",color:"white",maxWidth:60,borderRadius:3}},p(e.count)))}))))},g=Object(c.a)((function(e){return{container:{display:"flex",flexDirection:"column",width:"90%",overflowY:"auto",marginLeft:"5%",marginTop:"20px",backgroundColor:"#fff",borderRadius:"5px",boxShadow:"inset 0 0 5px rgba(0,0,0,.1)"},item:{padding:"10px",borderBottom:"1px solid #f2f8ff",overflow:"hidden",color:"#777",paddingTop:25,fontSize:14,position:"relative"},itemName:Object(a.a)({fontWeight:"bold",color:"#333",marginBottom:5,position:"absolute",top:15,transform:"translateY(-50%)",textTransform:"uppercase",fontSize:12},"color","#56749a"),chip:{margin:2,padding:2,"& .MuiChip-avatar":{width:"20px !important",height:"20px !important",marginLeft:"13px !important"}}}})),y=function(e){var t=g();return o.a.createElement(s.a,{className:t.item,style:e.style?e.style:{}},o.a.createElement("div",{className:t.itemName},e.title),e.item?e.item:e.children)},b=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=1024,r=t<0?0:t,a=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+a[i]},_=function(e){var t,n,r=g();return Object(i.useEffect)((function(){0===e.record.parent.length?e.setMetadata(null):e.metadata&&e.setMetadata(e.record.parent[0])}),[e.record]),o.a.createElement(s.a,{className:r.container},o.a.createElement(y,{title:"Nombre del archivo",item:(null===e||void 0===e||null===(t=e.record)||void 0===t?void 0:t.displayName)?null===e||void 0===e||null===(n=e.record)||void 0===n?void 0:n.displayName:e.record.name}),o.a.createElement(y,{title:"HASH",item:e.record.hash}),o.a.createElement(y,{title:"Tama\xf1o",item:b(e.record.size)}),e.record.parent.length>0&&o.a.createElement(y,{title:"Contenido relacionado"},e.record.parent.map((function(t,n){return o.a.createElement(l.a,{avatar:u.d.filter((function(e){return e.value===t.icon}))?u.d.filter((function(e){return e.value===t.icon}))[0].iconlight:o.a.createElement(h.a,null),key:n,label:t.name,className:r.chip,onClick:function(){e.setMetadata(t)}})}))))},x=function(e){var t,n=g();return o.a.createElement(s.a,{className:n.container},o.a.createElement(y,{title:"Descripci\xf3n",item:e.type.description}),e.parents.length>0&&o.a.createElement(y,{title:"Tipos de contenido relacionados",item:(t=e.parents,t.map((function(e,t){return o.a.createElement(l.a,{avatar:u.d.filter((function(t){return t.value===e.icon}))?u.d.filter((function(t){return t.value===e.icon}))[0].iconlight:o.a.createElement(h.a,null),key:t,label:e.name,className:n.chip})})))}),o.a.createElement(y,{title:"Balance general del contenido",item:o.a.createElement(m,{data:[].concat(Object(r.a)(e.parents),[e.type])})}),o.a.createElement(y,{title:"Balance general de los documentos",item:o.a.createElement(v,{data:e.files.data})}))}},1049:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return l}));var r=n(46),a=n(204);function i(e){var t={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/snaps",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function o(e){var t={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/users/snaps",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function s(e){var t="/snaps/"+e,n={method:"DELETE",headers:new Headers({Authorization:Object(a.a)()}),mode:"cors",cache:"default"};return fetch(r.e+t,n).then((function(e){return 204!==e.status?Promise.reject(e):e}))}function l(e){var t="/snaps/"+e,n={method:"GET",headers:new Headers({Authorization:Object(a.a)()}),mode:"cors",cache:"default"};return fetch(r.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.blob()}))}},1050:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M17 5h-2V3h2zm-2 16h2v-2.59L19.59 21 21 19.59 18.41 17H21v-2h-6zm4-12h2V7h-2zm0 4h2v-2h-2zm-8 8h2v-2h-2zM7 5h2V3H7zM3 17h2v-2H3zm2 4v-2H3c0 1.1.9 2 2 2M19 3v2h2c0-1.1-.9-2-2-2m-8 2h2V3h-2zM3 9h2V7H3zm4 12h2v-2H7zm-4-8h2v-2H3zm0-8h2V3c-1.1 0-2 .9-2 2"}),"HighlightAlt")},1051:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PrecisionManufacturing")},1052:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow")},1053:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause")},1054:function(e,t,n){(function(e){e.exports=function(){"use strict";function t(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function n(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?t(Object(r),!0).forEach((function(t){s(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function s(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t)}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var a=c(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return d(e)}(this,n)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=c(e)););return e}(e,t);if(r){var a=Object.getOwnPropertyDescriptor(r,t);return a.get?a.get.call(arguments.length<3?e:n):a.value}}).apply(this,arguments)}function p(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof t?t:t+""}var m=function(e){return!(!e||!e.Window)&&e instanceof e.Window},v=void 0,g=void 0;function y(e){v=e;var t=e.document.createTextNode("");t.ownerDocument!==e.document&&"function"==typeof e.wrap&&e.wrap(t)===t&&(e=e.wrap(e)),g=e}function b(e){return m(e)?e:(e.ownerDocument||e).defaultView||g.window}"undefined"!=typeof window&&window&&y(window);var _=function(e){return!!e&&"object"===r(e)},x=function(e){return"function"==typeof e},E=function(e){return e===g||m(e)},S=function(e){return _(e)&&11===e.nodeType},M=_,T=x,w=function(e){return"number"==typeof e},O=function(e){return"boolean"==typeof e},A=function(e){return"string"==typeof e},R=function(e){if(!e||"object"!==r(e))return!1;var t=b(e)||g;return/object|function/.test("undefined"==typeof Element?"undefined":r(Element))?e instanceof Element||e instanceof t.Element:1===e.nodeType&&"string"==typeof e.nodeName},C=function(e){return _(e)&&!!e.constructor&&/function Object\b/.test(e.constructor.toString())},k=function(e){return _(e)&&void 0!==e.length&&x(e.splice)};function P(e){var t=e.interaction;if("drag"===t.prepared.name){var n=t.prepared.axis;"x"===n?(t.coords.cur.page.y=t.coords.start.page.y,t.coords.cur.client.y=t.coords.start.client.y,t.coords.velocity.client.y=0,t.coords.velocity.page.y=0):"y"===n&&(t.coords.cur.page.x=t.coords.start.page.x,t.coords.cur.client.x=t.coords.start.client.x,t.coords.velocity.client.x=0,t.coords.velocity.page.x=0)}}function L(e){var t=e.iEvent,n=e.interaction;if("drag"===n.prepared.name){var r=n.prepared.axis;if("x"===r||"y"===r){var a="x"===r?"y":"x";t.page[a]=n.coords.start.page[a],t.client[a]=n.coords.start.client[a],t.delta[a]=0}}}var I={id:"actions/drag",install:function(e){var t=e.actions,n=e.Interactable,r=e.defaults;n.prototype.draggable=I.draggable,t.map.drag=I,t.methodDict.drag="draggable",r.actions.drag=I.defaults},listeners:{"interactions:before-action-move":P,"interactions:action-resume":P,"interactions:action-move":L,"auto-start:check":function(e){var t=e.interaction,n=e.interactable,r=e.buttons,a=n.options.drag;if(a&&a.enabled&&(!t.pointerIsDown||!/mouse|pointer/.test(t.pointerType)||0!=(r&n.options.drag.mouseButtons)))return e.action={name:"drag",axis:"start"===a.lockAxis?a.startAxis:a.lockAxis},!1}},draggable:function(e){return M(e)?(this.options.drag.enabled=!1!==e.enabled,this.setPerAction("drag",e),this.setOnEvents("drag",e),/^(xy|x|y|start)$/.test(e.lockAxis)&&(this.options.drag.lockAxis=e.lockAxis),/^(xy|x|y)$/.test(e.startAxis)&&(this.options.drag.startAxis=e.startAxis),this):O(e)?(this.options.drag.enabled=e,this):this.options.drag},beforeMove:P,move:L,defaults:{startAxis:"xy",lockAxis:"xy"},getCursor:function(){return"move"},filterEventType:function(e){return 0===e.search("drag")}},N=I,D={init:function(e){var t=e;D.document=t.document,D.DocumentFragment=t.DocumentFragment||U,D.SVGElement=t.SVGElement||U,D.SVGSVGElement=t.SVGSVGElement||U,D.SVGElementInstance=t.SVGElementInstance||U,D.Element=t.Element||U,D.HTMLElement=t.HTMLElement||D.Element,D.Event=t.Event,D.Touch=t.Touch||U,D.PointerEvent=t.PointerEvent||t.MSPointerEvent},document:null,DocumentFragment:null,SVGElement:null,SVGSVGElement:null,SVGElementInstance:null,Element:null,HTMLElement:null,Event:null,Touch:null,PointerEvent:null};function U(){}var j=D,F={init:function(e){var t=j.Element,n=e.navigator||{};F.supportsTouch="ontouchstart"in e||T(e.DocumentTouch)&&j.document instanceof e.DocumentTouch,F.supportsPointerEvent=!1!==n.pointerEnabled&&!!j.PointerEvent,F.isIOS=/iP(hone|od|ad)/.test(n.platform),F.isIOS7=/iP(hone|od|ad)/.test(n.platform)&&/OS 7[^\d]/.test(n.appVersion),F.isIe9=/MSIE 9/.test(n.userAgent),F.isOperaMobile="Opera"===n.appName&&F.supportsTouch&&/Presto/.test(n.userAgent),F.prefixedMatchesSelector="matches"in t.prototype?"matches":"webkitMatchesSelector"in t.prototype?"webkitMatchesSelector":"mozMatchesSelector"in t.prototype?"mozMatchesSelector":"oMatchesSelector"in t.prototype?"oMatchesSelector":"msMatchesSelector",F.pEventTypes=F.supportsPointerEvent?j.PointerEvent===e.MSPointerEvent?{up:"MSPointerUp",down:"MSPointerDown",over:"mouseover",out:"mouseout",move:"MSPointerMove",cancel:"MSPointerCancel"}:{up:"pointerup",down:"pointerdown",over:"pointerover",out:"pointerout",move:"pointermove",cancel:"pointercancel"}:null,F.wheelEvent=j.document&&"onmousewheel"in j.document?"mousewheel":"wheel"},supportsTouch:null,supportsPointerEvent:null,isIOS7:null,isIOS:null,isIe9:null,isOperaMobile:null,prefixedMatchesSelector:null,pEventTypes:null,wheelEvent:null},z=F;function B(e,t){if(e.contains)return e.contains(t);for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function H(e,t){for(;R(e);){if(G(e,t))return e;e=V(e)}return null}function V(e){var t=e.parentNode;if(S(t)){for(;(t=t.host)&&S(t););return t}return t}function G(e,t){return g!==v&&(t=t.replace(/\/deep\//g," ")),e[z.prefixedMatchesSelector](t)}var W=function(e){return e.parentNode||e.host};function X(e,t){for(var n,r=[],a=e;(n=W(a))&&a!==t&&n!==a.ownerDocument;)r.unshift(a),a=n;return r}function q(e,t,n){for(;R(e);){if(G(e,t))return!0;if((e=V(e))===n)return G(e,t)}return!1}function Y(e){return e.correspondingUseElement||e}function K(e){var t=e instanceof j.SVGElement?e.getBoundingClientRect():e.getClientRects()[0];return t&&{left:t.left,right:t.right,top:t.top,bottom:t.bottom,width:t.width||t.right-t.left,height:t.height||t.bottom-t.top}}function Z(e){var t,n=K(e);if(!z.isIOS7&&n){var r={x:(t=(t=b(e))||g).scrollX||t.document.documentElement.scrollLeft,y:t.scrollY||t.document.documentElement.scrollTop};n.left+=r.x,n.right+=r.x,n.top+=r.y,n.bottom+=r.y}return n}function J(e){for(var t=[];e;)t.push(e),e=V(e);return t}function Q(e){return!!A(e)&&(j.document.querySelector(e),!0)}function $(e,t){for(var n in t)e[n]=t[n];return e}function ee(e,t,n){return"parent"===e?V(n):"self"===e?t.getRect(n):H(n,e)}function te(e,t,n,r){var a=e;return A(a)?a=ee(a,t,n):T(a)&&(a=a.apply(void 0,r)),R(a)&&(a=Z(a)),a}function ne(e){return e&&{x:"x"in e?e.x:e.left,y:"y"in e?e.y:e.top}}function re(e){return!e||"x"in e&&"y"in e||((e=$({},e)).x=e.left||0,e.y=e.top||0,e.width=e.width||(e.right||0)-e.x,e.height=e.height||(e.bottom||0)-e.y),e}function ae(e,t,n){e.left&&(t.left+=n.x),e.right&&(t.right+=n.x),e.top&&(t.top+=n.y),e.bottom&&(t.bottom+=n.y),t.width=t.right-t.left,t.height=t.bottom-t.top}function ie(e,t,n){var r=n&&e.options[n];return ne(te(r&&r.origin||e.options.origin,e,t,[e&&t]))||{x:0,y:0}}function oe(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return!0},r=arguments.length>3?arguments[3]:void 0;if(r=r||{},A(e)&&-1!==e.search(" ")&&(e=se(e)),k(e))return e.forEach((function(e){return oe(e,t,n,r)})),r;if(M(e)&&(t=e,e=""),T(t)&&n(e))r[e]=r[e]||[],r[e].push(t);else if(k(t))for(var a=0,i=t;a<i.length;a++){var o=i[a];oe(e,o,n,r)}else if(M(t))for(var s in t)oe(se(s).map((function(t){return"".concat(e).concat(t)})),t[s],n,r);return r}function se(e){return e.trim().split(/ +/)}var le=function(e,t){return Math.sqrt(e*e+t*t)},ce=["webkit","moz"];function ue(e,t){e.__set||(e.__set={});var n=function(n){if(ce.some((function(e){return 0===n.indexOf(e)})))return 1;"function"!=typeof e[n]&&"__set"!==n&&Object.defineProperty(e,n,{get:function(){return n in e.__set?e.__set[n]:e.__set[n]=t[n]},set:function(t){e.__set[n]=t},configurable:!0})};for(var r in t)n(r);return e}function de(e,t){e.page=e.page||{},e.page.x=t.page.x,e.page.y=t.page.y,e.client=e.client||{},e.client.x=t.client.x,e.client.y=t.client.y,e.timeStamp=t.timeStamp}function he(e){e.page.x=0,e.page.y=0,e.client.x=0,e.client.y=0}function fe(e){return e instanceof j.Event||e instanceof j.Touch}function pe(e,t,n){return e=e||"page",(n=n||{}).x=t[e+"X"],n.y=t[e+"Y"],n}function me(e,t){return t=t||{x:0,y:0},z.isOperaMobile&&fe(e)?(pe("screen",e,t),t.x+=window.scrollX,t.y+=window.scrollY):pe("page",e,t),t}function ve(e){return w(e.pointerId)?e.pointerId:e.identifier}function ge(e){var t=[];return k(e)?(t[0]=e[0],t[1]=e[1]):"touchend"===e.type?1===e.touches.length?(t[0]=e.touches[0],t[1]=e.changedTouches[0]):0===e.touches.length&&(t[0]=e.changedTouches[0],t[1]=e.changedTouches[1]):(t[0]=e.touches[0],t[1]=e.touches[1]),t}function ye(e){for(var t={pageX:0,pageY:0,clientX:0,clientY:0,screenX:0,screenY:0},n=0;n<e.length;n++){var r=e[n];for(var a in t)t[a]+=r[a]}for(var i in t)t[i]/=e.length;return t}function be(e){if(!e.length)return null;var t=ge(e),n=Math.min(t[0].pageX,t[1].pageX),r=Math.min(t[0].pageY,t[1].pageY),a=Math.max(t[0].pageX,t[1].pageX),i=Math.max(t[0].pageY,t[1].pageY);return{x:n,y:r,left:n,top:r,right:a,bottom:i,width:a-n,height:i-r}}function _e(e,t){var n=t+"X",r=t+"Y",a=ge(e),i=a[0][n]-a[1][n],o=a[0][r]-a[1][r];return le(i,o)}function xe(e,t){var n=t+"X",r=t+"Y",a=ge(e),i=a[1][n]-a[0][n],o=a[1][r]-a[0][r];return 180*Math.atan2(o,i)/Math.PI}function Ee(e){return A(e.pointerType)?e.pointerType:w(e.pointerType)?[void 0,void 0,"touch","pen","mouse"][e.pointerType]:/touch/.test(e.type||"")||e instanceof j.Touch?"touch":"mouse"}function Se(e){var t=T(e.composedPath)?e.composedPath():e.path;return[Y(t?t[0]:e.target),Y(e.currentTarget)]}var Me=function(){function e(t){a(this,e),this.immediatePropagationStopped=!1,this.propagationStopped=!1,this._interaction=t}return o(e,[{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),e}();Object.defineProperty(Me.prototype,"interaction",{get:function(){return this._interaction._proxy},set:function(){}});var Te=function(e,t){for(var n=0;n<t.length;n++){var r=t[n];e.push(r)}return e},we=function(e){return Te([],e)},Oe=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n,e))return n;return-1},Ae=function(e,t){return e[Oe(e,t)]},Re=function(e){l(n,e);var t=h(n);function n(e,r,i){var o;a(this,n),(o=t.call(this,r._interaction)).dropzone=void 0,o.dragEvent=void 0,o.relatedTarget=void 0,o.draggable=void 0,o.propagationStopped=!1,o.immediatePropagationStopped=!1;var s="dragleave"===i?e.prev:e.cur,l=s.element,c=s.dropzone;return o.type=i,o.target=l,o.currentTarget=l,o.dropzone=c,o.dragEvent=r,o.relatedTarget=r.target,o.draggable=r.interactable,o.timeStamp=r.timeStamp,o}return o(n,[{key:"reject",value:function(){var e=this,t=this._interaction.dropState;if("dropactivate"===this.type||this.dropzone&&t.cur.dropzone===this.dropzone&&t.cur.element===this.target)if(t.prev.dropzone=this.dropzone,t.prev.element=this.target,t.rejected=!0,t.events.enter=null,this.stopImmediatePropagation(),"dropactivate"===this.type){var r=t.activeDrops,a=Oe(r,(function(t){var n=t.dropzone,r=t.element;return n===e.dropzone&&r===e.target}));t.activeDrops.splice(a,1);var i=new n(t,this.dragEvent,"dropdeactivate");i.dropzone=this.dropzone,i.target=this.target,this.dropzone.fire(i)}else this.dropzone.fire(new n(t,this.dragEvent,"dragleave"))}},{key:"preventDefault",value:function(){}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}}]),n}(Me);function Ce(e,t){for(var n=0,r=e.slice();n<r.length;n++){var a=r[n],i=a.dropzone,o=a.element;t.dropzone=i,t.target=o,i.fire(t),t.propagationStopped=t.immediatePropagationStopped=!1}}function ke(e,t){for(var n=function(e,t){for(var n=[],r=0,a=e.interactables.list;r<a.length;r++){var i=a[r];if(i.options.drop.enabled){var o=i.options.drop.accept;if(!(R(o)&&o!==t||A(o)&&!G(t,o)||T(o)&&!o({dropzone:i,draggableElement:t})))for(var s=0,l=i.getAllElements();s<l.length;s++){var c=l[s];c!==t&&n.push({dropzone:i,element:c,rect:i.getRect(c)})}}}return n}(e,t),r=0;r<n.length;r++){var a=n[r];a.rect=a.dropzone.getRect(a.element)}return n}function Pe(e,t,n){for(var r=e.dropState,a=e.interactable,i=e.element,o=[],s=0,l=r.activeDrops;s<l.length;s++){var c=l[s],u=c.dropzone,d=c.element,h=c.rect,f=u.dropCheck(t,n,a,i,d,h);o.push(f?d:null)}var p=function(e){for(var t,n,r,a=[],i=0;i<e.length;i++){var o=e[i],s=e[t];if(o&&i!==t)if(s){var l=W(o),c=W(s);if(l!==o.ownerDocument)if(c!==o.ownerDocument)if(l!==c){a=a.length?a:X(s);var u=void 0;if(s instanceof j.HTMLElement&&o instanceof j.SVGElement&&!(o instanceof j.SVGSVGElement)){if(o===c)continue;u=o.ownerSVGElement}else u=o;for(var d=X(u,s.ownerDocument),h=0;d[h]&&d[h]===a[h];)h++;var f=[d[h-1],d[h],a[h]];if(f[0])for(var p=f[0].lastChild;p;){if(p===f[1]){t=i,a=d;break}if(p===f[2])break;p=p.previousSibling}}else r=s,(parseInt(b(n=o).getComputedStyle(n).zIndex,10)||0)>=(parseInt(b(r).getComputedStyle(r).zIndex,10)||0)&&(t=i);else t=i}else t=i}return t}(o);return r.activeDrops[p]||null}function Le(e,t,n){var r=e.dropState,a={enter:null,leave:null,activate:null,deactivate:null,move:null,drop:null};return"dragstart"===n.type&&(a.activate=new Re(r,n,"dropactivate"),a.activate.target=null,a.activate.dropzone=null),"dragend"===n.type&&(a.deactivate=new Re(r,n,"dropdeactivate"),a.deactivate.target=null,a.deactivate.dropzone=null),r.rejected||(r.cur.element!==r.prev.element&&(r.prev.dropzone&&(a.leave=new Re(r,n,"dragleave"),n.dragLeave=a.leave.target=r.prev.element,n.prevDropzone=a.leave.dropzone=r.prev.dropzone),r.cur.dropzone&&(a.enter=new Re(r,n,"dragenter"),n.dragEnter=r.cur.element,n.dropzone=r.cur.dropzone)),"dragend"===n.type&&r.cur.dropzone&&(a.drop=new Re(r,n,"drop"),n.dropzone=r.cur.dropzone,n.relatedTarget=r.cur.element),"dragmove"===n.type&&r.cur.dropzone&&(a.move=new Re(r,n,"dropmove"),n.dropzone=r.cur.dropzone)),a}function Ie(e,t){var n=e.dropState,r=n.activeDrops,a=n.cur,i=n.prev;t.leave&&i.dropzone.fire(t.leave),t.enter&&a.dropzone.fire(t.enter),t.move&&a.dropzone.fire(t.move),t.drop&&a.dropzone.fire(t.drop),t.deactivate&&Ce(r,t.deactivate),n.prev.dropzone=a.dropzone,n.prev.element=a.element}function Ne(e,t){var n=e.interaction,r=e.iEvent,a=e.event;if("dragmove"===r.type||"dragend"===r.type){var i=n.dropState;t.dynamicDrop&&(i.activeDrops=ke(t,n.element));var o=r,s=Pe(n,o,a);i.rejected=i.rejected&&!!s&&s.dropzone===i.cur.dropzone&&s.element===i.cur.element,i.cur.dropzone=s&&s.dropzone,i.cur.element=s&&s.element,i.events=Le(n,0,o)}}var De={id:"actions/drop",install:function(e){var t=e.actions,n=e.interactStatic,r=e.Interactable,a=e.defaults;e.usePlugin(N),r.prototype.dropzone=function(e){return function(e,t){if(M(t)){if(e.options.drop.enabled=!1!==t.enabled,t.listeners){var n=oe(t.listeners),r=Object.keys(n).reduce((function(e,t){return e[/^(enter|leave)/.test(t)?"drag".concat(t):/^(activate|deactivate|move)/.test(t)?"drop".concat(t):t]=n[t],e}),{}),a=e.options.drop.listeners;a&&e.off(a),e.on(r),e.options.drop.listeners=r}return T(t.ondrop)&&e.on("drop",t.ondrop),T(t.ondropactivate)&&e.on("dropactivate",t.ondropactivate),T(t.ondropdeactivate)&&e.on("dropdeactivate",t.ondropdeactivate),T(t.ondragenter)&&e.on("dragenter",t.ondragenter),T(t.ondragleave)&&e.on("dragleave",t.ondragleave),T(t.ondropmove)&&e.on("dropmove",t.ondropmove),/^(pointer|center)$/.test(t.overlap)?e.options.drop.overlap=t.overlap:w(t.overlap)&&(e.options.drop.overlap=Math.max(Math.min(1,t.overlap),0)),"accept"in t&&(e.options.drop.accept=t.accept),"checker"in t&&(e.options.drop.checker=t.checker),e}return O(t)?(e.options.drop.enabled=t,e):e.options.drop}(this,e)},r.prototype.dropCheck=function(e,t,n,r,a,i){return function(e,t,n,r,a,i,o){var s=!1;if(!(o=o||e.getRect(i)))return!!e.options.drop.checker&&e.options.drop.checker(t,n,s,e,i,r,a);var l=e.options.drop.overlap;if("pointer"===l){var c=ie(r,a,"drag"),u=me(t);u.x+=c.x,u.y+=c.y;var d=u.x>o.left&&u.x<o.right,h=u.y>o.top&&u.y<o.bottom;s=d&&h}var f=r.getRect(a);if(f&&"center"===l){var p=f.left+f.width/2,m=f.top+f.height/2;s=p>=o.left&&p<=o.right&&m>=o.top&&m<=o.bottom}return f&&w(l)&&(s=Math.max(0,Math.min(o.right,f.right)-Math.max(o.left,f.left))*Math.max(0,Math.min(o.bottom,f.bottom)-Math.max(o.top,f.top))/(f.width*f.height)>=l),e.options.drop.checker&&(s=e.options.drop.checker(t,n,s,e,i,r,a)),s}(this,e,t,n,r,a,i)},n.dynamicDrop=function(t){return O(t)?(e.dynamicDrop=t,n):e.dynamicDrop},$(t.phaselessTypes,{dragenter:!0,dragleave:!0,dropactivate:!0,dropdeactivate:!0,dropmove:!0,drop:!0}),t.methodDict.drop="dropzone",e.dynamicDrop=!1,a.actions.drop=De.defaults},listeners:{"interactions:before-action-start":function(e){var t=e.interaction;"drag"===t.prepared.name&&(t.dropState={cur:{dropzone:null,element:null},prev:{dropzone:null,element:null},rejected:null,events:null,activeDrops:[]})},"interactions:after-action-start":function(e,t){var n=e.interaction,r=(e.event,e.iEvent);if("drag"===n.prepared.name){var a=n.dropState;a.activeDrops=[],a.events={},a.activeDrops=ke(t,n.element),a.events=Le(n,0,r),a.events.activate&&(Ce(a.activeDrops,a.events.activate),t.fire("actions/drop:start",{interaction:n,dragEvent:r}))}},"interactions:action-move":Ne,"interactions:after-action-move":function(e,t){var n=e.interaction,r=e.iEvent;if("drag"===n.prepared.name){var a=n.dropState;Ie(n,a.events),t.fire("actions/drop:move",{interaction:n,dragEvent:r}),a.events={}}},"interactions:action-end":function(e,t){if("drag"===e.interaction.prepared.name){var n=e.interaction,r=e.iEvent;Ne(e,t),Ie(n,n.dropState.events),t.fire("actions/drop:end",{interaction:n,dragEvent:r})}},"interactions:stop":function(e){var t=e.interaction;if("drag"===t.prepared.name){var n=t.dropState;n&&(n.activeDrops=null,n.events=null,n.cur.dropzone=null,n.cur.element=null,n.prev.dropzone=null,n.prev.element=null,n.rejected=!1)}}},getActiveDrops:ke,getDrop:Pe,getDropEvents:Le,fireDropEvents:Ie,filterEventType:function(e){return 0===e.search("drag")||0===e.search("drop")},defaults:{enabled:!1,accept:null,overlap:"pointer"}},Ue=De;function je(e){var t=e.interaction,n=e.iEvent,r=e.phase;if("gesture"===t.prepared.name){var a=t.pointers.map((function(e){return e.pointer})),i="start"===r,o="end"===r,s=t.interactable.options.deltaSource;if(n.touches=[a[0],a[1]],i)n.distance=_e(a,s),n.box=be(a),n.scale=1,n.ds=0,n.angle=xe(a,s),n.da=0,t.gesture.startDistance=n.distance,t.gesture.startAngle=n.angle;else if(o||t.pointers.length<2){var l=t.prevEvent;n.distance=l.distance,n.box=l.box,n.scale=l.scale,n.ds=0,n.angle=l.angle,n.da=0}else n.distance=_e(a,s),n.box=be(a),n.scale=n.distance/t.gesture.startDistance,n.angle=xe(a,s),n.ds=n.scale-t.gesture.scale,n.da=n.angle-t.gesture.angle;t.gesture.distance=n.distance,t.gesture.angle=n.angle,w(n.scale)&&n.scale!==1/0&&!isNaN(n.scale)&&(t.gesture.scale=n.scale)}}var Fe={id:"actions/gesture",before:["actions/drag","actions/resize"],install:function(e){var t=e.actions,n=e.Interactable,r=e.defaults;n.prototype.gesturable=function(e){return M(e)?(this.options.gesture.enabled=!1!==e.enabled,this.setPerAction("gesture",e),this.setOnEvents("gesture",e),this):O(e)?(this.options.gesture.enabled=e,this):this.options.gesture},t.map.gesture=Fe,t.methodDict.gesture="gesturable",r.actions.gesture=Fe.defaults},listeners:{"interactions:action-start":je,"interactions:action-move":je,"interactions:action-end":je,"interactions:new":function(e){e.interaction.gesture={angle:0,distance:0,scale:1,startAngle:0,startDistance:0}},"auto-start:check":function(e){if(!(e.interaction.pointers.length<2)){var t=e.interactable.options.gesture;if(t&&t.enabled)return e.action={name:"gesture"},!1}}},defaults:{},getCursor:function(){return""},filterEventType:function(e){return 0===e.search("gesture")}},ze=Fe;function Be(e,t,n,r,a,i,o){if(!t)return!1;if(!0===t){var s=w(i.width)?i.width:i.right-i.left,l=w(i.height)?i.height:i.bottom-i.top;if(o=Math.min(o,Math.abs(("left"===e||"right"===e?s:l)/2)),s<0&&("left"===e?e="right":"right"===e&&(e="left")),l<0&&("top"===e?e="bottom":"bottom"===e&&(e="top")),"left"===e){var c=s>=0?i.left:i.right;return n.x<c+o}if("top"===e){var u=l>=0?i.top:i.bottom;return n.y<u+o}if("right"===e)return n.x>(s>=0?i.right:i.left)-o;if("bottom"===e)return n.y>(l>=0?i.bottom:i.top)-o}return!!R(r)&&(R(t)?t===r:q(r,t,a))}function He(e){var t=e.iEvent,n=e.interaction;if("resize"===n.prepared.name&&n.resizeAxes){var r=t;n.interactable.options.resize.square?("y"===n.resizeAxes?r.delta.x=r.delta.y:r.delta.y=r.delta.x,r.axes="xy"):(r.axes=n.resizeAxes,"x"===n.resizeAxes?r.delta.y=0:"y"===n.resizeAxes&&(r.delta.x=0))}}var Ve,Ge,We={id:"actions/resize",before:["actions/drag"],install:function(e){var t=e.actions,n=e.browser,r=e.Interactable,a=e.defaults;We.cursors=function(e){return e.isIe9?{x:"e-resize",y:"s-resize",xy:"se-resize",top:"n-resize",left:"w-resize",bottom:"s-resize",right:"e-resize",topleft:"se-resize",bottomright:"se-resize",topright:"ne-resize",bottomleft:"ne-resize"}:{x:"ew-resize",y:"ns-resize",xy:"nwse-resize",top:"ns-resize",left:"ew-resize",bottom:"ns-resize",right:"ew-resize",topleft:"nwse-resize",bottomright:"nwse-resize",topright:"nesw-resize",bottomleft:"nesw-resize"}}(n),We.defaultMargin=n.supportsTouch||n.supportsPointerEvent?20:10,r.prototype.resizable=function(t){return function(e,t,n){return M(t)?(e.options.resize.enabled=!1!==t.enabled,e.setPerAction("resize",t),e.setOnEvents("resize",t),A(t.axis)&&/^x$|^y$|^xy$/.test(t.axis)?e.options.resize.axis=t.axis:null===t.axis&&(e.options.resize.axis=n.defaults.actions.resize.axis),O(t.preserveAspectRatio)?e.options.resize.preserveAspectRatio=t.preserveAspectRatio:O(t.square)&&(e.options.resize.square=t.square),e):O(t)?(e.options.resize.enabled=t,e):e.options.resize}(this,t,e)},t.map.resize=We,t.methodDict.resize="resizable",a.actions.resize=We.defaults},listeners:{"interactions:new":function(e){e.interaction.resizeAxes="xy"},"interactions:action-start":function(e){!function(e){var t=e.iEvent,n=e.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var r=t,a=n.rect;n._rects={start:$({},a),corrected:$({},a),previous:$({},a),delta:{left:0,right:0,width:0,top:0,bottom:0,height:0}},r.edges=n.prepared.edges,r.rect=n._rects.corrected,r.deltaRect=n._rects.delta}}(e),He(e)},"interactions:action-move":function(e){!function(e){var t=e.iEvent,n=e.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var r=t,a=n.interactable.options.resize.invert,i="reposition"===a||"negate"===a,o=n.rect,s=n._rects,l=s.start,c=s.corrected,u=s.delta,d=s.previous;if($(d,c),i){if($(c,o),"reposition"===a){if(c.top>c.bottom){var h=c.top;c.top=c.bottom,c.bottom=h}if(c.left>c.right){var f=c.left;c.left=c.right,c.right=f}}}else c.top=Math.min(o.top,l.bottom),c.bottom=Math.max(o.bottom,l.top),c.left=Math.min(o.left,l.right),c.right=Math.max(o.right,l.left);for(var p in c.width=c.right-c.left,c.height=c.bottom-c.top,c)u[p]=c[p]-d[p];r.edges=n.prepared.edges,r.rect=c,r.deltaRect=u}}(e),He(e)},"interactions:action-end":function(e){var t=e.iEvent,n=e.interaction;if("resize"===n.prepared.name&&n.prepared.edges){var r=t;r.edges=n.prepared.edges,r.rect=n._rects.corrected,r.deltaRect=n._rects.delta}},"auto-start:check":function(e){var t=e.interaction,n=e.interactable,r=e.element,a=e.rect,i=e.buttons;if(a){var o=$({},t.coords.cur.page),s=n.options.resize;if(s&&s.enabled&&(!t.pointerIsDown||!/mouse|pointer/.test(t.pointerType)||0!=(i&s.mouseButtons))){if(M(s.edges)){var l={left:!1,right:!1,top:!1,bottom:!1};for(var c in l)l[c]=Be(c,s.edges[c],o,t._latestPointer.eventTarget,r,a,s.margin||We.defaultMargin);l.left=l.left&&!l.right,l.top=l.top&&!l.bottom,(l.left||l.right||l.top||l.bottom)&&(e.action={name:"resize",edges:l})}else{var u="y"!==s.axis&&o.x>a.right-We.defaultMargin,d="x"!==s.axis&&o.y>a.bottom-We.defaultMargin;(u||d)&&(e.action={name:"resize",axes:(u?"x":"")+(d?"y":"")})}return!e.action&&void 0}}}},defaults:{square:!1,preserveAspectRatio:!1,axis:"xy",margin:NaN,edges:null,invert:"none"},cursors:null,getCursor:function(e){var t=e.edges,n=e.axis,r=e.name,a=We.cursors,i=null;if(n)i=a[r+n];else if(t){for(var o="",s=0,l=["top","bottom","left","right"];s<l.length;s++){var c=l[s];t[c]&&(o+=c)}i=a[o]}return i},filterEventType:function(e){return 0===e.search("resize")},defaultMargin:null},Xe=We,qe={id:"actions",install:function(e){e.usePlugin(ze),e.usePlugin(Xe),e.usePlugin(N),e.usePlugin(Ue)}},Ye=0,Ke=function(e){return Ve(e)},Ze=function(e){return Ge(e)},Je=function(e){if(Ve=e.requestAnimationFrame,Ge=e.cancelAnimationFrame,!Ve)for(var t=["ms","moz","webkit","o"],n=0;n<t.length;n++){var r=t[n];Ve=e["".concat(r,"RequestAnimationFrame")],Ge=e["".concat(r,"CancelAnimationFrame")]||e["".concat(r,"CancelRequestAnimationFrame")]}Ve=Ve&&Ve.bind(e),Ge=Ge&&Ge.bind(e),Ve||(Ve=function(t){var n=Date.now(),r=Math.max(0,16-(n-Ye)),a=e.setTimeout((function(){t(n+r)}),r);return Ye=n+r,a},Ge=function(e){return clearTimeout(e)})},Qe={defaults:{enabled:!1,margin:60,container:null,speed:300},now:Date.now,interaction:null,i:0,x:0,y:0,isScrolling:!1,prevTime:0,margin:0,speed:0,start:function(e){Qe.isScrolling=!0,Ze(Qe.i),e.autoScroll=Qe,Qe.interaction=e,Qe.prevTime=Qe.now(),Qe.i=Ke(Qe.scroll)},stop:function(){Qe.isScrolling=!1,Qe.interaction&&(Qe.interaction.autoScroll=null),Ze(Qe.i)},scroll:function(){var e=Qe.interaction,t=e.interactable,n=e.element,r=e.prepared.name,a=t.options[r].autoScroll,i=$e(a.container,t,n),o=Qe.now(),s=(o-Qe.prevTime)/1e3,l=a.speed*s;if(l>=1){var c={x:Qe.x*l,y:Qe.y*l};if(c.x||c.y){var u=et(i);E(i)?i.scrollBy(c.x,c.y):i&&(i.scrollLeft+=c.x,i.scrollTop+=c.y);var d=et(i),h={x:d.x-u.x,y:d.y-u.y};(h.x||h.y)&&t.fire({type:"autoscroll",target:n,interactable:t,delta:h,interaction:e,container:i})}Qe.prevTime=o}Qe.isScrolling&&(Ze(Qe.i),Qe.i=Ke(Qe.scroll))},check:function(e,t){var n;return null==(n=e.options[t].autoScroll)?void 0:n.enabled},onInteractionMove:function(e){var t=e.interaction,n=e.pointer;if(t.interacting()&&Qe.check(t.interactable,t.prepared.name))if(t.simulation)Qe.x=Qe.y=0;else{var r,a,i,o,s=t.interactable,l=t.element,c=t.prepared.name,u=s.options[c].autoScroll,d=$e(u.container,s,l);if(E(d))o=n.clientX<Qe.margin,r=n.clientY<Qe.margin,a=n.clientX>d.innerWidth-Qe.margin,i=n.clientY>d.innerHeight-Qe.margin;else{var h=K(d);o=n.clientX<h.left+Qe.margin,r=n.clientY<h.top+Qe.margin,a=n.clientX>h.right-Qe.margin,i=n.clientY>h.bottom-Qe.margin}Qe.x=a?1:o?-1:0,Qe.y=i?1:r?-1:0,Qe.isScrolling||(Qe.margin=u.margin,Qe.speed=u.speed,Qe.start(t))}}};function $e(e,t,n){return(A(e)?ee(e,t,n):e)||b(n)}function et(e){return E(e)&&(e=window.document.body),{x:e.scrollLeft,y:e.scrollTop}}var tt={id:"auto-scroll",install:function(e){var t=e.defaults,n=e.actions;e.autoScroll=Qe,Qe.now=function(){return e.now()},n.phaselessTypes.autoscroll=!0,t.perAction.autoScroll=Qe.defaults},listeners:{"interactions:new":function(e){e.interaction.autoScroll=null},"interactions:destroy":function(e){e.interaction.autoScroll=null,Qe.stop(),Qe.interaction&&(Qe.interaction=null)},"interactions:stop":Qe.stop,"interactions:action-move":function(e){return Qe.onInteractionMove(e)}}};function nt(e,t){var n=!1;return function(){return n||(g.console.warn(t),n=!0),e.apply(this,arguments)}}function rt(e,t){return e.name=t.name,e.axis=t.axis,e.edges=t.edges,e}function at(e){return O(e)?(this.options.styleCursor=e,this):null===e?(delete this.options.styleCursor,this):this.options.styleCursor}function it(e){return T(e)?(this.options.actionChecker=e,this):null===e?(delete this.options.actionChecker,this):this.options.actionChecker}var ot={id:"auto-start/interactableMethods",install:function(e){var t=e.Interactable;t.prototype.getAction=function(t,n,r,a){var i=function(e,t,n,r,a){var i=e.getRect(r),o={action:null,interactable:e,interaction:n,element:r,rect:i,buttons:t.buttons||{0:1,1:4,3:8,4:16}[t.button]};return a.fire("auto-start:check",o),o.action}(this,n,r,a,e);return this.options.actionChecker?this.options.actionChecker(t,n,i,this,a,r):i},t.prototype.ignoreFrom=nt((function(e){return this._backCompatOption("ignoreFrom",e)}),"Interactable.ignoreFrom() has been deprecated. Use Interactble.draggable({ignoreFrom: newValue})."),t.prototype.allowFrom=nt((function(e){return this._backCompatOption("allowFrom",e)}),"Interactable.allowFrom() has been deprecated. Use Interactble.draggable({allowFrom: newValue})."),t.prototype.actionChecker=it,t.prototype.styleCursor=at}};function st(e,t,n,r,a){return t.testIgnoreAllow(t.options[e.name],n,r)&&t.options[e.name].enabled&&dt(t,n,e,a)?e:null}function lt(e,t,n,r,a,i,o){for(var s=0,l=r.length;s<l;s++){var c=r[s],u=a[s],d=c.getAction(t,n,e,u);if(d){var h=st(d,c,u,i,o);if(h)return{action:h,interactable:c,element:u}}}return{action:null,interactable:null,element:null}}function ct(e,t,n,r,a){var i=[],o=[],s=r;function l(e){i.push(e),o.push(s)}for(;R(s);){i=[],o=[],a.interactables.forEachMatch(s,l);var c=lt(e,t,n,i,o,r,a);if(c.action&&!c.interactable.options[c.action.name].manualStart)return c;s=V(s)}return{action:null,interactable:null,element:null}}function ut(e,t,n){var r=t.action,a=t.interactable,i=t.element;r=r||{name:null},e.interactable=a,e.element=i,rt(e.prepared,r),e.rect=a&&r.name?a.getRect(i):null,pt(e,n),n.fire("autoStart:prepared",{interaction:e})}function dt(e,t,n,r){var a=e.options,i=a[n.name].max,o=a[n.name].maxPerElement,s=r.autoStart.maxInteractions,l=0,c=0,u=0;if(!(i&&o&&s))return!1;for(var d=0,h=r.interactions.list;d<h.length;d++){var f=h[d],p=f.prepared.name;if(f.interacting()){if(++l>=s)return!1;if(f.interactable===e){if((c+=p===n.name?1:0)>=i)return!1;if(f.element===t&&(u++,p===n.name&&u>=o))return!1}}}return s>0}function ht(e,t){return w(e)?(t.autoStart.maxInteractions=e,this):t.autoStart.maxInteractions}function ft(e,t,n){var r=n.autoStart.cursorElement;r&&r!==e&&(r.style.cursor=""),e.ownerDocument.documentElement.style.cursor=t,e.style.cursor=t,n.autoStart.cursorElement=t?e:null}function pt(e,t){var n=e.interactable,r=e.element,a=e.prepared;if("mouse"===e.pointerType&&n&&n.options.styleCursor){var i="";if(a.name){var o=n.options[a.name].cursorChecker;i=T(o)?o(a,n,r,e._interacting):t.actions.map[a.name].getCursor(a)}ft(e.element,i||"",t)}else t.autoStart.cursorElement&&ft(t.autoStart.cursorElement,"",t)}var mt={id:"auto-start/base",before:["actions"],install:function(e){var t=e.interactStatic,n=e.defaults;e.usePlugin(ot),n.base.actionChecker=null,n.base.styleCursor=!0,$(n.perAction,{manualStart:!1,max:1/0,maxPerElement:1,allowFrom:null,ignoreFrom:null,mouseButtons:1}),t.maxInteractions=function(t){return ht(t,e)},e.autoStart={maxInteractions:1/0,withinInteractionLimit:dt,cursorElement:null}},listeners:{"interactions:down":function(e,t){var n=e.interaction,r=e.pointer,a=e.event,i=e.eventTarget;n.interacting()||ut(n,ct(n,r,a,i,t),t)},"interactions:move":function(e,t){!function(e,t){var n=e.interaction,r=e.pointer,a=e.event,i=e.eventTarget;"mouse"!==n.pointerType||n.pointerIsDown||n.interacting()||ut(n,ct(n,r,a,i,t),t)}(e,t),function(e,t){var n=e.interaction;if(n.pointerIsDown&&!n.interacting()&&n.pointerWasMoved&&n.prepared.name){t.fire("autoStart:before-start",e);var r=n.interactable,a=n.prepared.name;a&&r&&(r.options[a].manualStart||!dt(r,n.element,n.prepared,t)?n.stop():(n.start(n.prepared,r,n.element),pt(n,t)))}}(e,t)},"interactions:stop":function(e,t){var n=e.interaction,r=n.interactable;r&&r.options.styleCursor&&ft(n.element,"",t)}},maxInteractions:ht,withinInteractionLimit:dt,validateAction:st},vt={id:"auto-start/dragAxis",listeners:{"autoStart:before-start":function(e,t){var n=e.interaction,r=e.eventTarget,a=e.dx,i=e.dy;if("drag"===n.prepared.name){var o=Math.abs(a),s=Math.abs(i),l=n.interactable.options.drag,c=l.startAxis,u=o>s?"x":o<s?"y":"xy";if(n.prepared.axis="start"===l.lockAxis?u[0]:l.lockAxis,"xy"!==u&&"xy"!==c&&c!==u){n.prepared.name=null;for(var d=r,h=function(e){if(e!==n.interactable){var a=n.interactable.options.drag;if(!a.manualStart&&e.testIgnoreAllow(a,d,r)){var i=e.getAction(n.downPointer,n.downEvent,n,d);if(i&&"drag"===i.name&&function(e,t){if(!t)return!1;var n=t.options.drag.startAxis;return"xy"===e||"xy"===n||n===e}(u,e)&&mt.validateAction(i,e,d,r,t))return e}}};R(d);){var f=t.interactables.forEachMatch(d,h);if(f){n.prepared.name="drag",n.interactable=f,n.element=d;break}d=V(d)}}}}}};function gt(e){var t=e.prepared&&e.prepared.name;if(!t)return null;var n=e.interactable.options;return n[t].hold||n[t].delay}var yt={id:"auto-start/hold",install:function(e){var t=e.defaults;e.usePlugin(mt),t.perAction.hold=0,t.perAction.delay=0},listeners:{"interactions:new":function(e){e.interaction.autoStartHoldTimer=null},"autoStart:prepared":function(e){var t=e.interaction,n=gt(t);n>0&&(t.autoStartHoldTimer=setTimeout((function(){t.start(t.prepared,t.interactable,t.element)}),n))},"interactions:move":function(e){var t=e.interaction,n=e.duplicate;t.autoStartHoldTimer&&t.pointerWasMoved&&!n&&(clearTimeout(t.autoStartHoldTimer),t.autoStartHoldTimer=null)},"autoStart:before-start":function(e){var t=e.interaction;gt(t)>0&&(t.prepared.name=null)}},getHoldDuration:gt},bt={id:"auto-start",install:function(e){e.usePlugin(mt),e.usePlugin(yt),e.usePlugin(vt)}},_t=function(e){return/^(always|never|auto)$/.test(e)?(this.options.preventDefault=e,this):O(e)?(this.options.preventDefault=e?"always":"never",this):this.options.preventDefault};function xt(e){var t=e.interaction,n=e.event;t.interactable&&t.interactable.checkAndPreventDefault(n)}var Et={id:"core/interactablePreventDefault",install:function(e){var t=e.Interactable;t.prototype.preventDefault=_t,t.prototype.checkAndPreventDefault=function(t){return function(e,t,n){var r=e.options.preventDefault;if("never"!==r)if("always"!==r){if(t.events.supportsPassive&&/^touch(start|move)$/.test(n.type)){var a=b(n.target).document,i=t.getDocOptions(a);if(!i||!i.events||!1!==i.events.passive)return}/^(mouse|pointer|touch)*(down|start)/i.test(n.type)||R(n.target)&&G(n.target,"input,select,textarea,[contenteditable=true],[contenteditable=true] *")||n.preventDefault()}else n.preventDefault()}(this,e,t)},e.interactions.docEvents.push({type:"dragstart",listener:function(t){for(var n=0,r=e.interactions.list;n<r.length;n++){var a=r[n];if(a.element&&(a.element===t.target||B(a.element,t.target)))return void a.interactable.checkAndPreventDefault(t)}}})},listeners:["down","move","up","cancel"].reduce((function(e,t){return e["interactions:".concat(t)]=xt,e}),{})};function St(e,t){if(t.phaselessTypes[e])return!0;for(var n in t.map)if(0===e.indexOf(n)&&e.substr(n.length)in t.phases)return!0;return!1}function Mt(e){var t={};for(var n in e){var r=e[n];C(r)?t[n]=Mt(r):k(r)?t[n]=we(r):t[n]=r}return t}var Tt=function(){function e(t){a(this,e),this.states=[],this.startOffset={left:0,right:0,top:0,bottom:0},this.startDelta=void 0,this.result=void 0,this.endResult=void 0,this.startEdges=void 0,this.edges=void 0,this.interaction=void 0,this.interaction=t,this.result=wt(),this.edges={left:!1,right:!1,top:!1,bottom:!1}}return o(e,[{key:"start",value:function(e,t){var n,r,a=e.phase,i=this.interaction,o=function(e){var t=e.interactable.options[e.prepared.name],n=t.modifiers;return n&&n.length?n:["snap","snapSize","snapEdges","restrict","restrictEdges","restrictSize"].map((function(e){var n=t[e];return n&&n.enabled&&{options:n,methods:n._methods}})).filter((function(e){return!!e}))}(i);this.prepareStates(o),this.startEdges=$({},i.edges),this.edges=$({},this.startEdges),this.startOffset=(r=t,(n=i.rect)?{left:r.x-n.left,top:r.y-n.top,right:n.right-r.x,bottom:n.bottom-r.y}:{left:0,top:0,right:0,bottom:0}),this.startDelta={x:0,y:0};var s=this.fillArg({phase:a,pageCoords:t,preEnd:!1});return this.result=wt(),this.startAll(s),this.result=this.setAll(s)}},{key:"fillArg",value:function(e){var t=this.interaction;return e.interaction=t,e.interactable=t.interactable,e.element=t.element,e.rect||(e.rect=t.rect),e.edges||(e.edges=this.startEdges),e.startOffset=this.startOffset,e}},{key:"startAll",value:function(e){for(var t=0,n=this.states;t<n.length;t++){var r=n[t];r.methods.start&&(e.state=r,r.methods.start(e))}}},{key:"setAll",value:function(e){var t=e.phase,n=e.preEnd,r=e.skipModifiers,a=e.rect,i=e.edges;e.coords=$({},e.pageCoords),e.rect=$({},a),e.edges=$({},i);for(var o=r?this.states.slice(r):this.states,s=wt(e.coords,e.rect),l=0;l<o.length;l++){var c,u=o[l],d=u.options,h=$({},e.coords),f=null;null!=(c=u.methods)&&c.set&&this.shouldDo(d,n,t)&&(e.state=u,f=u.methods.set(e),ae(e.edges,e.rect,{x:e.coords.x-h.x,y:e.coords.y-h.y})),s.eventProps.push(f)}$(this.edges,e.edges),s.delta.x=e.coords.x-e.pageCoords.x,s.delta.y=e.coords.y-e.pageCoords.y,s.rectDelta.left=e.rect.left-a.left,s.rectDelta.right=e.rect.right-a.right,s.rectDelta.top=e.rect.top-a.top,s.rectDelta.bottom=e.rect.bottom-a.bottom;var p=this.result.coords,m=this.result.rect;if(p&&m){var v=s.rect.left!==m.left||s.rect.right!==m.right||s.rect.top!==m.top||s.rect.bottom!==m.bottom;s.changed=v||p.x!==s.coords.x||p.y!==s.coords.y}return s}},{key:"applyToInteraction",value:function(e){var t=this.interaction,n=e.phase,r=t.coords.cur,a=t.coords.start,i=this.result,o=this.startDelta,s=i.delta;"start"===n&&$(this.startDelta,i.delta);for(var l=0,c=[[a,o],[r,s]];l<c.length;l++){var u=c[l],d=u[0],h=u[1];d.page.x+=h.x,d.page.y+=h.y,d.client.x+=h.x,d.client.y+=h.y}var f=this.result.rectDelta,p=e.rect||t.rect;p.left+=f.left,p.right+=f.right,p.top+=f.top,p.bottom+=f.bottom,p.width=p.right-p.left,p.height=p.bottom-p.top}},{key:"setAndApply",value:function(e){var t=this.interaction,n=e.phase,r=e.preEnd,a=e.skipModifiers,i=this.setAll(this.fillArg({preEnd:r,phase:n,pageCoords:e.modifiedCoords||t.coords.cur.page}));if(this.result=i,!i.changed&&(!a||a<this.states.length)&&t.interacting())return!1;if(e.modifiedCoords){var o=t.coords.cur.page,s={x:e.modifiedCoords.x-o.x,y:e.modifiedCoords.y-o.y};i.coords.x+=s.x,i.coords.y+=s.y,i.delta.x+=s.x,i.delta.y+=s.y}this.applyToInteraction(e)}},{key:"beforeEnd",value:function(e){var t=e.interaction,n=e.event,r=this.states;if(r&&r.length){for(var a=!1,i=0;i<r.length;i++){var o=r[i];e.state=o;var s=o.options,l=o.methods,c=l.beforeEnd&&l.beforeEnd(e);if(c)return this.endResult=c,!1;a=a||!a&&this.shouldDo(s,!0,e.phase,!0)}a&&t.move({event:n,preEnd:!0})}}},{key:"stop",value:function(e){var t=e.interaction;if(this.states&&this.states.length){var n=$({states:this.states,interactable:t.interactable,element:t.element,rect:null},e);this.fillArg(n);for(var r=0,a=this.states;r<a.length;r++){var i=a[r];n.state=i,i.methods.stop&&i.methods.stop(n)}this.states=null,this.endResult=null}}},{key:"prepareStates",value:function(e){this.states=[];for(var t=0;t<e.length;t++){var n=e[t],r=n.options,a=n.methods,i=n.name;this.states.push({options:r,methods:a,index:t,name:i})}return this.states}},{key:"restoreInteractionCoords",value:function(e){var t=e.interaction,n=t.coords,r=t.rect,a=t.modification;if(a.result){for(var i=a.startDelta,o=a.result,s=o.delta,l=o.rectDelta,c=0,u=[[n.start,i],[n.cur,s]];c<u.length;c++){var d=u[c],h=d[0],f=d[1];h.page.x-=f.x,h.page.y-=f.y,h.client.x-=f.x,h.client.y-=f.y}r.left-=l.left,r.right-=l.right,r.top-=l.top,r.bottom-=l.bottom}}},{key:"shouldDo",value:function(e,t,n,r){return!(!e||!1===e.enabled||r&&!e.endOnly||e.endOnly&&!t||"start"===n&&!e.setStart)}},{key:"copyFrom",value:function(e){this.startOffset=e.startOffset,this.startDelta=e.startDelta,this.startEdges=e.startEdges,this.edges=e.edges,this.states=e.states.map((function(e){return Mt(e)})),this.result=wt($({},e.result.coords),$({},e.result.rect))}},{key:"destroy",value:function(){for(var e in this)this[e]=null}}]),e}();function wt(e,t){return{rect:t,coords:e,delta:{x:0,y:0},rectDelta:{left:0,right:0,top:0,bottom:0},eventProps:[],changed:!0}}function Ot(e,t){var n=e.defaults,r={start:e.start,set:e.set,beforeEnd:e.beforeEnd,stop:e.stop},a=function(e){var a=e||{};for(var i in a.enabled=!1!==a.enabled,n)i in a||(a[i]=n[i]);var o={options:a,methods:r,name:t,enable:function(){return a.enabled=!0,o},disable:function(){return a.enabled=!1,o}};return o};return t&&"string"==typeof t&&(a._defaults=n,a._methods=r),a}function At(e){var t=e.iEvent,n=e.interaction.modification.result;n&&(t.modifiers=n.eventProps)}var Rt={id:"modifiers/base",before:["actions"],install:function(e){e.defaults.perAction.modifiers=[]},listeners:{"interactions:new":function(e){var t=e.interaction;t.modification=new Tt(t)},"interactions:before-action-start":function(e){var t=e.interaction,n=e.interaction.modification;n.start(e,t.coords.start.page),t.edges=n.edges,n.applyToInteraction(e)},"interactions:before-action-move":function(e){var t=e.interaction,n=t.modification,r=n.setAndApply(e);return t.edges=n.edges,r},"interactions:before-action-end":function(e){var t=e.interaction,n=t.modification,r=n.beforeEnd(e);return t.edges=n.startEdges,r},"interactions:action-start":At,"interactions:action-move":At,"interactions:action-end":At,"interactions:after-action-start":function(e){return e.interaction.modification.restoreInteractionCoords(e)},"interactions:after-action-move":function(e){return e.interaction.modification.restoreInteractionCoords(e)},"interactions:stop":function(e){return e.interaction.modification.stop(e)}}},Ct={base:{preventDefault:"auto",deltaSource:"page"},perAction:{enabled:!1,origin:{x:0,y:0}},actions:{}},kt=function(e){l(n,e);var t=h(n);function n(e,r,i,o,s,l,c){var u;a(this,n),(u=t.call(this,e)).relatedTarget=null,u.screenX=void 0,u.screenY=void 0,u.button=void 0,u.buttons=void 0,u.ctrlKey=void 0,u.shiftKey=void 0,u.altKey=void 0,u.metaKey=void 0,u.page=void 0,u.client=void 0,u.delta=void 0,u.rect=void 0,u.x0=void 0,u.y0=void 0,u.t0=void 0,u.dt=void 0,u.duration=void 0,u.clientX0=void 0,u.clientY0=void 0,u.velocity=void 0,u.speed=void 0,u.swipe=void 0,u.axes=void 0,u.preEnd=void 0,s=s||e.element;var h=e.interactable,f=(h&&h.options||Ct).deltaSource,p=ie(h,s,i),m="start"===o,v="end"===o,g=m?d(u):e.prevEvent,y=m?e.coords.start:v?{page:g.page,client:g.client,timeStamp:e.coords.cur.timeStamp}:e.coords.cur;return u.page=$({},y.page),u.client=$({},y.client),u.rect=$({},e.rect),u.timeStamp=y.timeStamp,v||(u.page.x-=p.x,u.page.y-=p.y,u.client.x-=p.x,u.client.y-=p.y),u.ctrlKey=r.ctrlKey,u.altKey=r.altKey,u.shiftKey=r.shiftKey,u.metaKey=r.metaKey,u.button=r.button,u.buttons=r.buttons,u.target=s,u.currentTarget=s,u.preEnd=l,u.type=c||i+(o||""),u.interactable=h,u.t0=m?e.pointers[e.pointers.length-1].downTime:g.t0,u.x0=e.coords.start.page.x-p.x,u.y0=e.coords.start.page.y-p.y,u.clientX0=e.coords.start.client.x-p.x,u.clientY0=e.coords.start.client.y-p.y,u.delta=m||v?{x:0,y:0}:{x:u[f].x-g[f].x,y:u[f].y-g[f].y},u.dt=e.coords.delta.timeStamp,u.duration=u.timeStamp-u.t0,u.velocity=$({},e.coords.velocity[f]),u.speed=le(u.velocity.x,u.velocity.y),u.swipe=v||"inertiastart"===o?u.getSwipe():null,u}return o(n,[{key:"getSwipe",value:function(){var e=this._interaction;if(e.prevEvent.speed<600||this.timeStamp-e.prevEvent.timeStamp>150)return null;var t=180*Math.atan2(e.prevEvent.velocityY,e.prevEvent.velocityX)/Math.PI;t<0&&(t+=360);var n=112.5<=t&&t<247.5,r=202.5<=t&&t<337.5;return{up:r,down:!r&&22.5<=t&&t<157.5,left:n,right:!n&&(292.5<=t||t<67.5),angle:t,speed:e.prevEvent.speed,velocity:{x:e.prevEvent.velocityX,y:e.prevEvent.velocityY}}}},{key:"preventDefault",value:function(){}},{key:"stopImmediatePropagation",value:function(){this.immediatePropagationStopped=this.propagationStopped=!0}},{key:"stopPropagation",value:function(){this.propagationStopped=!0}}]),n}(Me);Object.defineProperties(kt.prototype,{pageX:{get:function(){return this.page.x},set:function(e){this.page.x=e}},pageY:{get:function(){return this.page.y},set:function(e){this.page.y=e}},clientX:{get:function(){return this.client.x},set:function(e){this.client.x=e}},clientY:{get:function(){return this.client.y},set:function(e){this.client.y=e}},dx:{get:function(){return this.delta.x},set:function(e){this.delta.x=e}},dy:{get:function(){return this.delta.y},set:function(e){this.delta.y=e}},velocityX:{get:function(){return this.velocity.x},set:function(e){this.velocity.x=e}},velocityY:{get:function(){return this.velocity.y},set:function(e){this.velocity.y=e}}});var Pt=o((function e(t,n,r,i,o){a(this,e),this.id=void 0,this.pointer=void 0,this.event=void 0,this.downTime=void 0,this.downTarget=void 0,this.id=t,this.pointer=n,this.event=r,this.downTime=i,this.downTarget=o})),Lt=function(e){return e.interactable="",e.element="",e.prepared="",e.pointerIsDown="",e.pointerWasMoved="",e._proxy="",e}({}),It=function(e){return e.start="",e.move="",e.end="",e.stop="",e.interacting="",e}({}),Nt=0,Dt=function(){function e(t){var n=this,r=t.pointerType,i=t.scopeFire;a(this,e),this.interactable=null,this.element=null,this.rect=null,this._rects=void 0,this.edges=null,this._scopeFire=void 0,this.prepared={name:null,axis:null,edges:null},this.pointerType=void 0,this.pointers=[],this.downEvent=null,this.downPointer={},this._latestPointer={pointer:null,event:null,eventTarget:null},this.prevEvent=null,this.pointerIsDown=!1,this.pointerWasMoved=!1,this._interacting=!1,this._ending=!1,this._stopped=!0,this._proxy=void 0,this.simulation=null,this.doMove=nt((function(e){this.move(e)}),"The interaction.doMove() method has been renamed to interaction.move()"),this.coords={start:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},prev:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},cur:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},delta:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0},velocity:{page:{x:0,y:0},client:{x:0,y:0},timeStamp:0}},this._id=Nt++,this._scopeFire=i,this.pointerType=r;var o=this;this._proxy={};var s=function(e){Object.defineProperty(n._proxy,e,{get:function(){return o[e]}})};for(var l in Lt)s(l);var c=function(e){Object.defineProperty(n._proxy,e,{value:function(){return o[e].apply(o,arguments)}})};for(var u in It)c(u);this._scopeFire("interactions:new",{interaction:this})}return o(e,[{key:"pointerMoveTolerance",get:function(){return 1}},{key:"pointerDown",value:function(e,t,n){var r=this.updatePointer(e,t,n,!0),a=this.pointers[r];this._scopeFire("interactions:down",{pointer:e,event:t,eventTarget:n,pointerIndex:r,pointerInfo:a,type:"down",interaction:this})}},{key:"start",value:function(e,t,n){return!(this.interacting()||!this.pointerIsDown||this.pointers.length<("gesture"===e.name?2:1)||!t.options[e.name].enabled)&&(rt(this.prepared,e),this.interactable=t,this.element=n,this.rect=t.getRect(n),this.edges=this.prepared.edges?$({},this.prepared.edges):{left:!0,right:!0,top:!0,bottom:!0},this._stopped=!1,this._interacting=this._doPhase({interaction:this,event:this.downEvent,phase:"start"})&&!this._stopped,this._interacting)}},{key:"pointerMove",value:function(e,t,n){this.simulation||this.modification&&this.modification.endResult||this.updatePointer(e,t,n,!1);var r,a,i=this.coords.cur.page.x===this.coords.prev.page.x&&this.coords.cur.page.y===this.coords.prev.page.y&&this.coords.cur.client.x===this.coords.prev.client.x&&this.coords.cur.client.y===this.coords.prev.client.y;this.pointerIsDown&&!this.pointerWasMoved&&(r=this.coords.cur.client.x-this.coords.start.client.x,a=this.coords.cur.client.y-this.coords.start.client.y,this.pointerWasMoved=le(r,a)>this.pointerMoveTolerance);var o,s,l,c=this.getPointerIndex(e),u={pointer:e,pointerIndex:c,pointerInfo:this.pointers[c],event:t,type:"move",eventTarget:n,dx:r,dy:a,duplicate:i,interaction:this};i||(o=this.coords.velocity,s=this.coords.delta,l=Math.max(s.timeStamp/1e3,.001),o.page.x=s.page.x/l,o.page.y=s.page.y/l,o.client.x=s.client.x/l,o.client.y=s.client.y/l,o.timeStamp=l),this._scopeFire("interactions:move",u),i||this.simulation||(this.interacting()&&(u.type=null,this.move(u)),this.pointerWasMoved&&de(this.coords.prev,this.coords.cur))}},{key:"move",value:function(e){e&&e.event||he(this.coords.delta),(e=$({pointer:this._latestPointer.pointer,event:this._latestPointer.event,eventTarget:this._latestPointer.eventTarget,interaction:this},e||{})).phase="move",this._doPhase(e)}},{key:"pointerUp",value:function(e,t,n,r){var a=this.getPointerIndex(e);-1===a&&(a=this.updatePointer(e,t,n,!1));var i=/cancel$/i.test(t.type)?"cancel":"up";this._scopeFire("interactions:".concat(i),{pointer:e,pointerIndex:a,pointerInfo:this.pointers[a],event:t,eventTarget:n,type:i,curEventTarget:r,interaction:this}),this.simulation||this.end(t),this.removePointer(e,t)}},{key:"documentBlur",value:function(e){this.end(e),this._scopeFire("interactions:blur",{event:e,type:"blur",interaction:this})}},{key:"end",value:function(e){var t;this._ending=!0,e=e||this._latestPointer.event,this.interacting()&&(t=this._doPhase({event:e,interaction:this,phase:"end"})),this._ending=!1,!0===t&&this.stop()}},{key:"currentAction",value:function(){return this._interacting?this.prepared.name:null}},{key:"interacting",value:function(){return this._interacting}},{key:"stop",value:function(){this._scopeFire("interactions:stop",{interaction:this}),this.interactable=this.element=null,this._interacting=!1,this._stopped=!0,this.prepared.name=this.prevEvent=null}},{key:"getPointerIndex",value:function(e){var t=ve(e);return"mouse"===this.pointerType||"pen"===this.pointerType?this.pointers.length-1:Oe(this.pointers,(function(e){return e.id===t}))}},{key:"getPointerInfo",value:function(e){return this.pointers[this.getPointerIndex(e)]}},{key:"updatePointer",value:function(e,t,n,r){var a,i,o,s=ve(e),l=this.getPointerIndex(e),c=this.pointers[l];return r=!1!==r&&(r||/(down|start)$/i.test(t.type)),c?c.pointer=e:(c=new Pt(s,e,t,null,null),l=this.pointers.length,this.pointers.push(c)),function(e,t,n){var r=t.length>1?ye(t):t[0];me(r,e.page),function(e,t){t=t||{},z.isOperaMobile&&fe(e)?pe("screen",e,t):pe("client",e,t)}(r,e.client),e.timeStamp=n}(this.coords.cur,this.pointers.map((function(e){return e.pointer})),this._now()),a=this.coords.delta,i=this.coords.prev,o=this.coords.cur,a.page.x=o.page.x-i.page.x,a.page.y=o.page.y-i.page.y,a.client.x=o.client.x-i.client.x,a.client.y=o.client.y-i.client.y,a.timeStamp=o.timeStamp-i.timeStamp,r&&(this.pointerIsDown=!0,c.downTime=this.coords.cur.timeStamp,c.downTarget=n,ue(this.downPointer,e),this.interacting()||(de(this.coords.start,this.coords.cur),de(this.coords.prev,this.coords.cur),this.downEvent=t,this.pointerWasMoved=!1)),this._updateLatestPointer(e,t,n),this._scopeFire("interactions:update-pointer",{pointer:e,event:t,eventTarget:n,down:r,pointerInfo:c,pointerIndex:l,interaction:this}),l}},{key:"removePointer",value:function(e,t){var n=this.getPointerIndex(e);if(-1!==n){var r=this.pointers[n];this._scopeFire("interactions:remove-pointer",{pointer:e,event:t,eventTarget:null,pointerIndex:n,pointerInfo:r,interaction:this}),this.pointers.splice(n,1),this.pointerIsDown=!1}}},{key:"_updateLatestPointer",value:function(e,t,n){this._latestPointer.pointer=e,this._latestPointer.event=t,this._latestPointer.eventTarget=n}},{key:"destroy",value:function(){this._latestPointer.pointer=null,this._latestPointer.event=null,this._latestPointer.eventTarget=null}},{key:"_createPreparedEvent",value:function(e,t,n,r){return new kt(this,e,this.prepared.name,t,this.element,n,r)}},{key:"_fireEvent",value:function(e){var t;null==(t=this.interactable)||t.fire(e),(!this.prevEvent||e.timeStamp>=this.prevEvent.timeStamp)&&(this.prevEvent=e)}},{key:"_doPhase",value:function(e){var t=e.event,n=e.phase,r=e.preEnd,a=e.type,i=this.rect;if(i&&"move"===n&&(ae(this.edges,i,this.coords.delta[this.interactable.options.deltaSource]),i.width=i.right-i.left,i.height=i.bottom-i.top),!1===this._scopeFire("interactions:before-action-".concat(n),e))return!1;var o=e.iEvent=this._createPreparedEvent(t,n,r,a);return this._scopeFire("interactions:action-".concat(n),e),"start"===n&&(this.prevEvent=o),this._fireEvent(o),this._scopeFire("interactions:after-action-".concat(n),e),!0}},{key:"_now",value:function(){return Date.now()}}]),e}();function Ut(e){jt(e.interaction)}function jt(e){if(!function(e){return!(!e.offset.pending.x&&!e.offset.pending.y)}(e))return!1;var t=e.offset.pending;return zt(e.coords.cur,t),zt(e.coords.delta,t),ae(e.edges,e.rect,t),t.x=0,t.y=0,!0}function Ft(e){var t=e.x,n=e.y;this.offset.pending.x+=t,this.offset.pending.y+=n,this.offset.total.x+=t,this.offset.total.y+=n}function zt(e,t){var n=e.page,r=e.client,a=t.x,i=t.y;n.x+=a,n.y+=i,r.x+=a,r.y+=i}It.offsetBy="";var Bt={id:"offset",before:["modifiers","pointer-events","actions","inertia"],install:function(e){e.Interaction.prototype.offsetBy=Ft},listeners:{"interactions:new":function(e){e.interaction.offset={total:{x:0,y:0},pending:{x:0,y:0}}},"interactions:update-pointer":function(e){return function(e){e.pointerIsDown&&(zt(e.coords.cur,e.offset.total),e.offset.pending.x=0,e.offset.pending.y=0)}(e.interaction)},"interactions:before-action-start":Ut,"interactions:before-action-move":Ut,"interactions:before-action-end":function(e){var t=e.interaction;if(jt(t))return t.move({offset:!0}),t.end(),!1},"interactions:stop":function(e){var t=e.interaction;t.offset.total.x=0,t.offset.total.y=0,t.offset.pending.x=0,t.offset.pending.y=0}}},Ht=function(){function e(t){a(this,e),this.active=!1,this.isModified=!1,this.smoothEnd=!1,this.allowResume=!1,this.modification=void 0,this.modifierCount=0,this.modifierArg=void 0,this.startCoords=void 0,this.t0=0,this.v0=0,this.te=0,this.targetOffset=void 0,this.modifiedOffset=void 0,this.currentOffset=void 0,this.lambda_v0=0,this.one_ve_v0=0,this.timeout=void 0,this.interaction=void 0,this.interaction=t}return o(e,[{key:"start",value:function(e){var t=this.interaction,n=Vt(t);if(!n||!n.enabled)return!1;var r=t.coords.velocity.client,a=le(r.x,r.y),i=this.modification||(this.modification=new Tt(t));if(i.copyFrom(t.modification),this.t0=t._now(),this.allowResume=n.allowResume,this.v0=a,this.currentOffset={x:0,y:0},this.startCoords=t.coords.cur.page,this.modifierArg=i.fillArg({pageCoords:this.startCoords,preEnd:!0,phase:"inertiastart"}),this.t0-t.coords.cur.timeStamp<50&&a>n.minSpeed&&a>n.endSpeed)this.startInertia();else{if(i.result=i.setAll(this.modifierArg),!i.result.changed)return!1;this.startSmoothEnd()}return t.modification.result.rect=null,t.offsetBy(this.targetOffset),t._doPhase({interaction:t,event:e,phase:"inertiastart"}),t.offsetBy({x:-this.targetOffset.x,y:-this.targetOffset.y}),t.modification.result.rect=null,this.active=!0,t.simulation=this,!0}},{key:"startInertia",value:function(){var e=this,t=this.interaction.coords.velocity.client,n=Vt(this.interaction),r=n.resistance,a=-Math.log(n.endSpeed/this.v0)/r;this.targetOffset={x:(t.x-a)/r,y:(t.y-a)/r},this.te=a,this.lambda_v0=r/this.v0,this.one_ve_v0=1-n.endSpeed/this.v0;var i=this.modification,o=this.modifierArg;o.pageCoords={x:this.startCoords.x+this.targetOffset.x,y:this.startCoords.y+this.targetOffset.y},i.result=i.setAll(o),i.result.changed&&(this.isModified=!0,this.modifiedOffset={x:this.targetOffset.x+i.result.delta.x,y:this.targetOffset.y+i.result.delta.y}),this.onNextFrame((function(){return e.inertiaTick()}))}},{key:"startSmoothEnd",value:function(){var e=this;this.smoothEnd=!0,this.isModified=!0,this.targetOffset={x:this.modification.result.delta.x,y:this.modification.result.delta.y},this.onNextFrame((function(){return e.smoothEndTick()}))}},{key:"onNextFrame",value:function(e){var t=this;this.timeout=Ke((function(){t.active&&e()}))}},{key:"inertiaTick",value:function(){var e,t,n,r,a,i=this,o=this.interaction,s=Vt(o).resistance,l=(o._now()-this.t0)/1e3;if(l<this.te){var c,u=1-(Math.exp(-s*l)-this.lambda_v0)/this.one_ve_v0;this.isModified?(e=this.targetOffset.x,t=this.targetOffset.y,n=this.modifiedOffset.x,r=this.modifiedOffset.y,c={x:Gt(a=u,0,e,n),y:Gt(a,0,t,r)}):c={x:this.targetOffset.x*u,y:this.targetOffset.y*u};var d={x:c.x-this.currentOffset.x,y:c.y-this.currentOffset.y};this.currentOffset.x+=d.x,this.currentOffset.y+=d.y,o.offsetBy(d),o.move(),this.onNextFrame((function(){return i.inertiaTick()}))}else o.offsetBy({x:this.modifiedOffset.x-this.currentOffset.x,y:this.modifiedOffset.y-this.currentOffset.y}),this.end()}},{key:"smoothEndTick",value:function(){var e=this,t=this.interaction,n=t._now()-this.t0,r=Vt(t).smoothEndDuration;if(n<r){var a={x:Wt(n,0,this.targetOffset.x,r),y:Wt(n,0,this.targetOffset.y,r)},i={x:a.x-this.currentOffset.x,y:a.y-this.currentOffset.y};this.currentOffset.x+=i.x,this.currentOffset.y+=i.y,t.offsetBy(i),t.move({skipModifiers:this.modifierCount}),this.onNextFrame((function(){return e.smoothEndTick()}))}else t.offsetBy({x:this.targetOffset.x-this.currentOffset.x,y:this.targetOffset.y-this.currentOffset.y}),this.end()}},{key:"resume",value:function(e){var t=e.pointer,n=e.event,r=e.eventTarget,a=this.interaction;a.offsetBy({x:-this.currentOffset.x,y:-this.currentOffset.y}),a.updatePointer(t,n,r,!0),a._doPhase({interaction:a,event:n,phase:"resume"}),de(a.coords.prev,a.coords.cur),this.stop()}},{key:"end",value:function(){this.interaction.move(),this.interaction.end(),this.stop()}},{key:"stop",value:function(){this.active=this.smoothEnd=!1,this.interaction.simulation=null,Ze(this.timeout)}}]),e}();function Vt(e){var t=e.interactable,n=e.prepared;return t&&t.options&&n.name&&t.options[n.name].inertia}function Gt(e,t,n,r){var a=1-e;return a*a*t+2*a*e*n+e*e*r}function Wt(e,t,n,r){return-n*(e/=r)*(e-2)+t}var Xt={id:"inertia",before:["modifiers","actions"],install:function(e){var t=e.defaults;e.usePlugin(Bt),e.usePlugin(Rt),e.actions.phases.inertiastart=!0,e.actions.phases.resume=!0,t.perAction.inertia={enabled:!1,resistance:10,minSpeed:100,endSpeed:10,allowResume:!0,smoothEndDuration:300}},listeners:{"interactions:new":function(e){var t=e.interaction;t.inertia=new Ht(t)},"interactions:before-action-end":function(e){var t=e.interaction,n=e.event;return(!t._interacting||t.simulation||!t.inertia.start(n))&&null},"interactions:down":function(e){var t=e.interaction,n=e.eventTarget,r=t.inertia;if(r.active)for(var a=n;R(a);){if(a===t.element){r.resume(e);break}a=V(a)}},"interactions:stop":function(e){var t=e.interaction.inertia;t.active&&t.stop()},"interactions:before-action-resume":function(e){var t=e.interaction.modification;t.stop(e),t.start(e,e.interaction.coords.cur.page),t.applyToInteraction(e)},"interactions:before-action-inertiastart":function(e){return e.interaction.modification.setAndApply(e)},"interactions:action-resume":At,"interactions:action-inertiastart":At,"interactions:after-action-inertiastart":function(e){return e.interaction.modification.restoreInteractionCoords(e)},"interactions:after-action-resume":function(e){return e.interaction.modification.restoreInteractionCoords(e)}}};function qt(e,t){for(var n=0;n<t.length;n++){var r=t[n];if(e.immediatePropagationStopped)break;r(e)}}var Yt=function(){function e(t){a(this,e),this.options=void 0,this.types={},this.propagationStopped=!1,this.immediatePropagationStopped=!1,this.global=void 0,this.options=$({},t||{})}return o(e,[{key:"fire",value:function(e){var t,n=this.global;(t=this.types[e.type])&&qt(e,t),!e.propagationStopped&&n&&(t=n[e.type])&&qt(e,t)}},{key:"on",value:function(e,t){var n=oe(e,t);for(e in n)this.types[e]=Te(this.types[e]||[],n[e])}},{key:"off",value:function(e,t){var n=oe(e,t);for(e in n){var r=this.types[e];if(r&&r.length)for(var a=0,i=n[e];a<i.length;a++){var o=i[a],s=r.indexOf(o);-1!==s&&r.splice(s,1)}}}},{key:"getRect",value:function(e){return null}}]),e}(),Kt=function(){function e(t){a(this,e),this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=t,ue(this,t)}return o(e,[{key:"preventOriginalDefault",value:function(){this.originalEvent.preventDefault()}},{key:"stopPropagation",value:function(){this.originalEvent.stopPropagation()}},{key:"stopImmediatePropagation",value:function(){this.originalEvent.stopImmediatePropagation()}}]),e}();function Zt(e){return M(e)?{capture:!!e.capture,passive:!!e.passive}:{capture:!!e,passive:!1}}function Jt(e,t){return e===t||("boolean"==typeof e?!!t.capture===e&&0==!!t.passive:!!e.capture==!!t.capture&&!!e.passive==!!t.passive)}var Qt={id:"events",install:function(e){var t,n=[],r={},a=[],i={add:o,remove:s,addDelegate:function(e,t,n,i,s){var u=Zt(s);if(!r[n]){r[n]=[];for(var d=0;d<a.length;d++){var h=a[d];o(h,n,l),o(h,n,c,!0)}}var f=r[n],p=Ae(f,(function(n){return n.selector===e&&n.context===t}));p||(p={selector:e,context:t,listeners:[]},f.push(p)),p.listeners.push({func:i,options:u})},removeDelegate:function(e,t,n,a,i){var o,u=Zt(i),d=r[n],h=!1;if(d)for(o=d.length-1;o>=0;o--){var f=d[o];if(f.selector===e&&f.context===t){for(var p=f.listeners,m=p.length-1;m>=0;m--){var v=p[m];if(v.func===a&&Jt(v.options,u)){p.splice(m,1),p.length||(d.splice(o,1),s(t,n,l),s(t,n,c,!0)),h=!0;break}}if(h)break}}},delegateListener:l,delegateUseCapture:c,delegatedEvents:r,documents:a,targets:n,supportsOptions:!1,supportsPassive:!1};function o(e,t,r,a){if(e.addEventListener){var o=Zt(a),s=Ae(n,(function(t){return t.eventTarget===e}));s||(s={eventTarget:e,events:{}},n.push(s)),s.events[t]||(s.events[t]=[]),Ae(s.events[t],(function(e){return e.func===r&&Jt(e.options,o)}))||(e.addEventListener(t,r,i.supportsOptions?o:o.capture),s.events[t].push({func:r,options:o}))}}function s(e,t,r,a){if(e.addEventListener&&e.removeEventListener){var o=Oe(n,(function(t){return t.eventTarget===e})),l=n[o];if(l&&l.events)if("all"!==t){var c=!1,u=l.events[t];if(u){if("all"===r){for(var d=u.length-1;d>=0;d--){var h=u[d];s(e,t,h.func,h.options)}return}for(var f=Zt(a),p=0;p<u.length;p++){var m=u[p];if(m.func===r&&Jt(m.options,f)){e.removeEventListener(t,r,i.supportsOptions?f:f.capture),u.splice(p,1),0===u.length&&(delete l.events[t],c=!0);break}}}c&&!Object.keys(l.events).length&&n.splice(o,1)}else for(t in l.events)l.events.hasOwnProperty(t)&&s(e,t,"all")}}function l(e,t){for(var n=Zt(t),a=new Kt(e),i=r[e.type],o=Se(e)[0],s=o;R(s);){for(var l=0;l<i.length;l++){var c=i[l],u=c.selector,d=c.context;if(G(s,u)&&B(d,o)&&B(d,s)){var h=c.listeners;a.currentTarget=s;for(var f=0;f<h.length;f++){var p=h[f];Jt(p.options,n)&&p.func(a)}}}s=V(s)}}function c(e){return l(e,!0)}return null==(t=e.document)||t.createElement("div").addEventListener("test",null,{get capture(){return i.supportsOptions=!0},get passive(){return i.supportsPassive=!0}}),e.events=i,i}},$t={methodOrder:["simulationResume","mouseOrPen","hasPointer","idle"],search:function(e){for(var t=0,n=$t.methodOrder;t<n.length;t++){var r=n[t],a=$t[r](e);if(a)return a}return null},simulationResume:function(e){var t=e.pointerType,n=e.eventType,r=e.eventTarget,a=e.scope;if(!/down|start/i.test(n))return null;for(var i=0,o=a.interactions.list;i<o.length;i++){var s=o[i],l=r;if(s.simulation&&s.simulation.allowResume&&s.pointerType===t)for(;l;){if(l===s.element)return s;l=V(l)}}return null},mouseOrPen:function(e){var t,n=e.pointerId,r=e.pointerType,a=e.eventType,i=e.scope;if("mouse"!==r&&"pen"!==r)return null;for(var o=0,s=i.interactions.list;o<s.length;o++){var l=s[o];if(l.pointerType===r){if(l.simulation&&!en(l,n))continue;if(l.interacting())return l;t||(t=l)}}if(t)return t;for(var c=0,u=i.interactions.list;c<u.length;c++){var d=u[c];if(!(d.pointerType!==r||/down/i.test(a)&&d.simulation))return d}return null},hasPointer:function(e){for(var t=e.pointerId,n=0,r=e.scope.interactions.list;n<r.length;n++){var a=r[n];if(en(a,t))return a}return null},idle:function(e){for(var t=e.pointerType,n=0,r=e.scope.interactions.list;n<r.length;n++){var a=r[n];if(1===a.pointers.length){var i=a.interactable;if(i&&(!i.options.gesture||!i.options.gesture.enabled))continue}else if(a.pointers.length>=2)continue;if(!a.interacting()&&t===a.pointerType)return a}return null}};function en(e,t){return e.pointers.some((function(e){return e.id===t}))}var tn=$t,nn=["pointerDown","pointerMove","pointerUp","updatePointer","removePointer","windowBlur"];function rn(e,t){return function(n){var r=t.interactions.list,a=Ee(n),i=Se(n),o=i[0],s=i[1],l=[];if(/^touch/.test(n.type)){t.prevTouchTime=t.now();for(var c=0,u=n.changedTouches;c<u.length;c++){var d=u[c],h={pointer:d,pointerId:ve(d),pointerType:a,eventType:n.type,eventTarget:o,curEventTarget:s,scope:t},f=an(h);l.push([h.pointer,h.eventTarget,h.curEventTarget,f])}}else{var p=!1;if(!z.supportsPointerEvent&&/mouse/.test(n.type)){for(var m=0;m<r.length&&!p;m++)p="mouse"!==r[m].pointerType&&r[m].pointerIsDown;p=p||t.now()-t.prevTouchTime<500||0===n.timeStamp}if(!p){var v={pointer:n,pointerId:ve(n),pointerType:a,eventType:n.type,curEventTarget:s,eventTarget:o,scope:t},g=an(v);l.push([v.pointer,v.eventTarget,v.curEventTarget,g])}}for(var y=0;y<l.length;y++){var b=l[y],_=b[0],x=b[1],E=b[2];b[3][e](_,n,x,E)}}}function an(e){var t=e.pointerType,n=e.scope,r={interaction:tn.search(e),searchDetails:e};return n.fire("interactions:find",r),r.interaction||n.interactions.new({pointerType:t})}function on(e,t){var n=e.doc,r=e.scope,a=e.options,i=r.interactions.docEvents,o=r.events,s=o[t];for(var l in r.browser.isIOS&&!a.events&&(a.events={passive:!1}),o.delegatedEvents)s(n,l,o.delegateListener),s(n,l,o.delegateUseCapture,!0);for(var c=a&&a.events,u=0;u<i.length;u++){var d=i[u];s(n,d.type,d.listener,c)}}var sn={id:"core/interactions",install:function(e){for(var t={},n=0;n<nn.length;n++){var r=nn[n];t[r]=rn(r,e)}var i,s=z.pEventTypes;function c(){for(var t=0,n=e.interactions.list;t<n.length;t++){var r=n[t];if(r.pointerIsDown&&"touch"===r.pointerType&&!r._interacting)for(var a=function(){var t=o[i];e.documents.some((function(e){return B(e.doc,t.downTarget)}))||r.removePointer(t.pointer,t.event)},i=0,o=r.pointers;i<o.length;i++)a()}}(i=j.PointerEvent?[{type:s.down,listener:c},{type:s.down,listener:t.pointerDown},{type:s.move,listener:t.pointerMove},{type:s.up,listener:t.pointerUp},{type:s.cancel,listener:t.pointerUp}]:[{type:"mousedown",listener:t.pointerDown},{type:"mousemove",listener:t.pointerMove},{type:"mouseup",listener:t.pointerUp},{type:"touchstart",listener:c},{type:"touchstart",listener:t.pointerDown},{type:"touchmove",listener:t.pointerMove},{type:"touchend",listener:t.pointerUp},{type:"touchcancel",listener:t.pointerUp}]).push({type:"blur",listener:function(t){for(var n=0,r=e.interactions.list;n<r.length;n++)r[n].documentBlur(t)}}),e.prevTouchTime=0,e.Interaction=function(t){l(r,t);var n=h(r);function r(){return a(this,r),n.apply(this,arguments)}return o(r,[{key:"pointerMoveTolerance",get:function(){return e.interactions.pointerMoveTolerance},set:function(t){e.interactions.pointerMoveTolerance=t}},{key:"_now",value:function(){return e.now()}}]),r}(Dt),e.interactions={list:[],new:function(t){t.scopeFire=function(t,n){return e.fire(t,n)};var n=new e.Interaction(t);return e.interactions.list.push(n),n},listeners:t,docEvents:i,pointerMoveTolerance:1},e.usePlugin(Et)},listeners:{"scope:add-document":function(e){return on(e,"add")},"scope:remove-document":function(e){return on(e,"remove")},"interactable:unset":function(e,t){for(var n=e.interactable,r=t.interactions.list.length-1;r>=0;r--){var a=t.interactions.list[r];a.interactable===n&&(a.stop(),t.fire("interactions:destroy",{interaction:a}),a.destroy(),t.interactions.list.length>2&&t.interactions.list.splice(r,1))}}},onDocSignal:on,doOnInteractions:rn,methodNames:nn},ln=function(e){return e[e.On=0]="On",e[e.Off=1]="Off",e}(ln||{}),cn=function(){function e(t,n,r,i){a(this,e),this.target=void 0,this.options=void 0,this._actions=void 0,this.events=new Yt,this._context=void 0,this._win=void 0,this._doc=void 0,this._scopeEvents=void 0,this._actions=n.actions,this.target=t,this._context=n.context||r,this._win=b(Q(t)?this._context:t),this._doc=this._win.document,this._scopeEvents=i,this.set(n)}return o(e,[{key:"_defaults",get:function(){return{base:{},perAction:{},actions:{}}}},{key:"setOnEvents",value:function(e,t){return T(t.onstart)&&this.on("".concat(e,"start"),t.onstart),T(t.onmove)&&this.on("".concat(e,"move"),t.onmove),T(t.onend)&&this.on("".concat(e,"end"),t.onend),T(t.oninertiastart)&&this.on("".concat(e,"inertiastart"),t.oninertiastart),this}},{key:"updatePerActionListeners",value:function(e,t,n){var r,a=this,i=null==(r=this._actions.map[e])?void 0:r.filterEventType,o=function(e){return(null==i||i(e))&&St(e,a._actions)};(k(t)||M(t))&&this._onOff(ln.Off,e,t,void 0,o),(k(n)||M(n))&&this._onOff(ln.On,e,n,void 0,o)}},{key:"setPerAction",value:function(e,t){var n=this._defaults;for(var r in t){var a=r,i=this.options[e],o=t[a];"listeners"===a&&this.updatePerActionListeners(e,i.listeners,o),k(o)?i[a]=we(o):C(o)?(i[a]=$(i[a]||{},Mt(o)),M(n.perAction[a])&&"enabled"in n.perAction[a]&&(i[a].enabled=!1!==o.enabled)):O(o)&&M(n.perAction[a])?i[a].enabled=o:i[a]=o}}},{key:"getRect",value:function(e){return e=e||(R(this.target)?this.target:null),A(this.target)&&(e=e||this._context.querySelector(this.target)),Z(e)}},{key:"rectChecker",value:function(e){var t=this;return T(e)?(this.getRect=function(n){var r=$({},e.apply(t,n));return"width"in r||(r.width=r.right-r.left,r.height=r.bottom-r.top),r},this):null===e?(delete this.getRect,this):this.getRect}},{key:"_backCompatOption",value:function(e,t){if(Q(t)||M(t)){for(var n in this.options[e]=t,this._actions.map)this.options[n][e]=t;return this}return this.options[e]}},{key:"origin",value:function(e){return this._backCompatOption("origin",e)}},{key:"deltaSource",value:function(e){return"page"===e||"client"===e?(this.options.deltaSource=e,this):this.options.deltaSource}},{key:"getAllElements",value:function(){var e=this.target;return A(e)?Array.from(this._context.querySelectorAll(e)):T(e)&&e.getAllElements?e.getAllElements():R(e)?[e]:[]}},{key:"context",value:function(){return this._context}},{key:"inContext",value:function(e){return this._context===e.ownerDocument||B(this._context,e)}},{key:"testIgnoreAllow",value:function(e,t,n){return!this.testIgnore(e.ignoreFrom,t,n)&&this.testAllow(e.allowFrom,t,n)}},{key:"testAllow",value:function(e,t,n){return!e||!!R(n)&&(A(e)?q(n,e,t):!!R(e)&&B(e,n))}},{key:"testIgnore",value:function(e,t,n){return!(!e||!R(n))&&(A(e)?q(n,e,t):!!R(e)&&B(e,n))}},{key:"fire",value:function(e){return this.events.fire(e),this}},{key:"_onOff",value:function(e,t,n,r,a){M(t)&&!k(t)&&(r=n,n=null);var i=oe(t,n,a);for(var o in i){"wheel"===o&&(o=z.wheelEvent);for(var s=0,l=i[o];s<l.length;s++){var c=l[s];St(o,this._actions)?this.events[e===ln.On?"on":"off"](o,c):A(this.target)?this._scopeEvents[e===ln.On?"addDelegate":"removeDelegate"](this.target,this._context,o,c,r):this._scopeEvents[e===ln.On?"add":"remove"](this.target,o,c,r)}}return this}},{key:"on",value:function(e,t,n){return this._onOff(ln.On,e,t,n)}},{key:"off",value:function(e,t,n){return this._onOff(ln.Off,e,t,n)}},{key:"set",value:function(e){var t=this._defaults;for(var n in M(e)||(e={}),this.options=Mt(t.base),this._actions.methodDict){var r=n,a=this._actions.methodDict[r];this.options[r]={},this.setPerAction(r,$($({},t.perAction),t.actions[r])),this[a](e[r])}for(var i in e)"getRect"!==i?T(this[i])&&this[i](e[i]):this.rectChecker(e.getRect);return this}},{key:"unset",value:function(){if(A(this.target))for(var e in this._scopeEvents.delegatedEvents)for(var t=this._scopeEvents.delegatedEvents[e],n=t.length-1;n>=0;n--){var r=t[n],a=r.selector,i=r.context,o=r.listeners;a===this.target&&i===this._context&&t.splice(n,1);for(var s=o.length-1;s>=0;s--)this._scopeEvents.removeDelegate(this.target,this._context,e,o[s][0],o[s][1])}else this._scopeEvents.remove(this.target,"all")}}]),e}(),un=function(){function e(t){var n=this;a(this,e),this.list=[],this.selectorMap={},this.scope=void 0,this.scope=t,t.addListeners({"interactable:unset":function(e){var t=e.interactable,r=t.target,a=A(r)?n.selectorMap[r]:r[n.scope.id],i=Oe(a,(function(e){return e===t}));a.splice(i,1)}})}return o(e,[{key:"new",value:function(e,t){t=$(t||{},{actions:this.scope.actions});var n=new this.scope.Interactable(e,t,this.scope.document,this.scope.events);return this.scope.addDocument(n._doc),this.list.push(n),A(e)?(this.selectorMap[e]||(this.selectorMap[e]=[]),this.selectorMap[e].push(n)):(n.target[this.scope.id]||Object.defineProperty(e,this.scope.id,{value:[],configurable:!0}),e[this.scope.id].push(n)),this.scope.fire("interactable:new",{target:e,options:t,interactable:n,win:this.scope._win}),n}},{key:"getExisting",value:function(e,t){var n=t&&t.context||this.scope.document,r=A(e),a=r?this.selectorMap[e]:e[this.scope.id];if(a)return Ae(a,(function(t){return t._context===n&&(r||t.inContext(e))}))}},{key:"forEachMatch",value:function(e,t){for(var n=0,r=this.list;n<r.length;n++){var a=r[n],i=void 0;if((A(a.target)?R(e)&&G(e,a.target):e===a.target)&&a.inContext(e)&&(i=t(a)),void 0!==i)return i}}}]),e}();function dn(e){return e&&e.replace(/\/.*$/,"")}var hn=new(function(){function e(){var t=this;a(this,e),this.id="__interact_scope_".concat(Math.floor(100*Math.random())),this.isInitialized=!1,this.listenerMaps=[],this.browser=z,this.defaults=Mt(Ct),this.Eventable=Yt,this.actions={map:{},phases:{start:!0,move:!0,end:!0},methodDict:{},phaselessTypes:{}},this.interactStatic=function(e){var t=function t(n,r){var a=e.interactables.getExisting(n,r);return a||((a=e.interactables.new(n,r)).events.global=t.globalEvents),a};return t.getPointerAverage=ye,t.getTouchBBox=be,t.getTouchDistance=_e,t.getTouchAngle=xe,t.getElementRect=Z,t.getElementClientRect=K,t.matchesSelector=G,t.closest=H,t.globalEvents={},t.version="1.10.27",t.scope=e,t.use=function(e,t){return this.scope.usePlugin(e,t),this},t.isSet=function(e,t){return!!this.scope.interactables.get(e,t&&t.context)},t.on=nt((function(e,t,n){if(A(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),k(e)){for(var r=0,a=e;r<a.length;r++){var i=a[r];this.on(i,t,n)}return this}if(M(e)){for(var o in e)this.on(o,e[o],t);return this}return St(e,this.scope.actions)?this.globalEvents[e]?this.globalEvents[e].push(t):this.globalEvents[e]=[t]:this.scope.events.add(this.scope.document,e,t,{options:n}),this}),"The interact.on() method is being deprecated"),t.off=nt((function(e,t,n){if(A(e)&&-1!==e.search(" ")&&(e=e.trim().split(/ +/)),k(e)){for(var r=0,a=e;r<a.length;r++){var i=a[r];this.off(i,t,n)}return this}if(M(e)){for(var o in e)this.off(o,e[o],t);return this}var s;return St(e,this.scope.actions)?e in this.globalEvents&&-1!==(s=this.globalEvents[e].indexOf(t))&&this.globalEvents[e].splice(s,1):this.scope.events.remove(this.scope.document,e,t,n),this}),"The interact.off() method is being deprecated"),t.debug=function(){return this.scope},t.supportsTouch=function(){return z.supportsTouch},t.supportsPointerEvent=function(){return z.supportsPointerEvent},t.stop=function(){for(var e=0,t=this.scope.interactions.list;e<t.length;e++)t[e].stop();return this},t.pointerMoveTolerance=function(e){return w(e)?(this.scope.interactions.pointerMoveTolerance=e,this):this.scope.interactions.pointerMoveTolerance},t.addDocument=function(e,t){this.scope.addDocument(e,t)},t.removeDocument=function(e){this.scope.removeDocument(e)},t}(this),this.InteractEvent=kt,this.Interactable=void 0,this.interactables=new un(this),this._win=void 0,this.document=void 0,this.window=void 0,this.documents=[],this._plugins={list:[],map:{}},this.onWindowUnload=function(e){return t.removeDocument(e.target)};var n=this;this.Interactable=function(e){l(r,e);var t=h(r);function r(){return a(this,r),t.apply(this,arguments)}return o(r,[{key:"_defaults",get:function(){return n.defaults}},{key:"set",value:function(e){return f(c(r.prototype),"set",this).call(this,e),n.fire("interactable:set",{options:e,interactable:this}),this}},{key:"unset",value:function(){f(c(r.prototype),"unset",this).call(this);var e=n.interactables.list.indexOf(this);e<0||(n.interactables.list.splice(e,1),n.fire("interactable:unset",{interactable:this}))}}]),r}(cn)}return o(e,[{key:"addListeners",value:function(e,t){this.listenerMaps.push({id:t,map:e})}},{key:"fire",value:function(e,t){for(var n=0,r=this.listenerMaps;n<r.length;n++){var a=r[n].map[e];if(a&&!1===a(t,this,e))return!1}}},{key:"init",value:function(e){return this.isInitialized?this:function(e,t){return e.isInitialized=!0,E(t)&&y(t),j.init(t),z.init(t),Je(t),e.window=t,e.document=t.document,e.usePlugin(sn),e.usePlugin(Qt),e}(this,e)}},{key:"pluginIsInstalled",value:function(e){var t=e.id;return t?!!this._plugins.map[t]:-1!==this._plugins.list.indexOf(e)}},{key:"usePlugin",value:function(e,t){if(!this.isInitialized)return this;if(this.pluginIsInstalled(e))return this;if(e.id&&(this._plugins.map[e.id]=e),this._plugins.list.push(e),e.install&&e.install(this,t),e.listeners&&e.before){for(var n=0,r=this.listenerMaps.length,a=e.before.reduce((function(e,t){return e[t]=!0,e[dn(t)]=!0,e}),{});n<r;n++){var i=this.listenerMaps[n].id;if(i&&(a[i]||a[dn(i)]))break}this.listenerMaps.splice(n,0,{id:e.id,map:e.listeners})}else e.listeners&&this.listenerMaps.push({id:e.id,map:e.listeners});return this}},{key:"addDocument",value:function(e,t){if(-1!==this.getDocIndex(e))return!1;var n=b(e);t=t?$({},t):{},this.documents.push({doc:e,options:t}),this.events.documents.push(e),e!==this.document&&this.events.add(n,"unload",this.onWindowUnload),this.fire("scope:add-document",{doc:e,window:n,scope:this,options:t})}},{key:"removeDocument",value:function(e){var t=this.getDocIndex(e),n=b(e),r=this.documents[t].options;this.events.remove(n,"unload",this.onWindowUnload),this.documents.splice(t,1),this.events.documents.splice(t,1),this.fire("scope:remove-document",{doc:e,window:n,scope:this,options:r})}},{key:"getDocIndex",value:function(e){for(var t=0;t<this.documents.length;t++)if(this.documents[t].doc===e)return t;return-1}},{key:"getDocOptions",value:function(e){var t=this.getDocIndex(e);return-1===t?null:this.documents[t].options}},{key:"now",value:function(){return(this.window.Date||Date).now()}}]),e}()),fn=hn.interactStatic,pn="undefined"!=typeof globalThis?globalThis:window;hn.init(pn);var mn=Object.freeze({__proto__:null,edgeTarget:function(){},elements:function(){},grid:function(e){var t=[["x","y"],["left","top"],["right","bottom"],["width","height"]].filter((function(t){var n=t[0],r=t[1];return n in e||r in e})),n=function(n,r){for(var a=e.range,i=e.limits,o=void 0===i?{left:-1/0,right:1/0,top:-1/0,bottom:1/0}:i,s=e.offset,l=void 0===s?{x:0,y:0}:s,c={range:a,grid:e,x:null,y:null},u=0;u<t.length;u++){var d=t[u],h=d[0],f=d[1],p=Math.round((n-l.x)/e[h]),m=Math.round((r-l.y)/e[f]);c[h]=Math.max(o.left,Math.min(o.right,p*e[h]+l.x)),c[f]=Math.max(o.top,Math.min(o.bottom,m*e[f]+l.y))}return c};return n.grid=e,n.coordFields=t,n}}),vn={id:"snappers",install:function(e){var t=e.interactStatic;t.snappers=$(t.snappers||{},mn),t.createSnapGrid=t.snappers.grid}};function gn(e,t,n){var r=e.startCoords,a=e.edgeSign;t?n.y=r.y+(n.x-r.x)*a.y:n.x=r.x+(n.y-r.y)*a.x}function yn(e,t,n,r){var a=e.startRect,i=e.startCoords,o=e.ratio,s=e.edgeSign;if(t){var l=r.width/o;n.y=i.y+(l-a.height)*s.y}else{var c=r.height*o;n.x=i.x+(c-a.width)*s.x}}var bn=Ot({start:function(e){var t=e.state,r=e.rect,a=e.edges,i=e.pageCoords,o=t.options,s=o.ratio,l=o.enabled,c=t.options,u=c.equalDelta,d=c.modifiers;"preserve"===s&&(s=r.width/r.height),t.startCoords=$({},i),t.startRect=$({},r),t.ratio=s,t.equalDelta=u;var h=t.linkedEdges={top:a.top||a.left&&!a.bottom,left:a.left||a.top&&!a.right,bottom:a.bottom||a.right&&!a.top,right:a.right||a.bottom&&!a.left};if(t.xIsPrimaryAxis=!(!a.left&&!a.right),t.equalDelta){var f=(h.left?1:-1)*(h.top?1:-1);t.edgeSign={x:f,y:f}}else t.edgeSign={x:h.left?-1:1,y:h.top?-1:1};if(!1!==l&&$(a,h),null!=d&&d.length){var p=new Tt(e.interaction);p.copyFrom(e.interaction.modification),p.prepareStates(d),t.subModification=p,p.startAll(n({},e))}},set:function(e){var t=e.state,r=e.rect,a=e.coords,i=t.linkedEdges,o=$({},a),s=t.equalDelta?gn:yn;if($(e.edges,i),s(t,t.xIsPrimaryAxis,a,r),!t.subModification)return null;var l=$({},r);ae(i,l,{x:a.x-o.x,y:a.y-o.y});var c=t.subModification.setAll(n(n({},e),{},{rect:l,edges:i,pageCoords:a,prevCoords:a,prevRect:l})),u=c.delta;return c.changed&&(s(t,Math.abs(u.x)>Math.abs(u.y),c.coords,c.rect),$(a,c.coords)),c.eventProps},defaults:{ratio:"preserve",equalDelta:!1,modifiers:[],enabled:!1}},"aspectRatio"),_n=function(){};_n._defaults={};var xn=_n;function En(e,t,n){return T(e)?te(e,t.interactable,t.element,[n.x,n.y,t]):te(e,t.interactable,t.element)}var Sn={start:function(e){var t=e.rect,n=e.startOffset,r=e.state,a=e.interaction,i=e.pageCoords,o=r.options,s=o.elementRect,l=$({left:0,top:0,right:0,bottom:0},o.offset||{});if(t&&s){var c=En(o.restriction,a,i);if(c){var u=c.right-c.left-t.width,d=c.bottom-c.top-t.height;u<0&&(l.left+=u,l.right+=u),d<0&&(l.top+=d,l.bottom+=d)}l.left+=n.left-t.width*s.left,l.top+=n.top-t.height*s.top,l.right+=n.right-t.width*(1-s.right),l.bottom+=n.bottom-t.height*(1-s.bottom)}r.offset=l},set:function(e){var t=e.coords,n=e.interaction,r=e.state,a=r.options,i=r.offset,o=En(a.restriction,n,t);if(o){var s=function(e){return!e||"left"in e&&"top"in e||((e=$({},e)).left=e.x||0,e.top=e.y||0,e.right=e.right||e.left+e.width,e.bottom=e.bottom||e.top+e.height),e}(o);t.x=Math.max(Math.min(s.right-i.right,t.x),s.left+i.left),t.y=Math.max(Math.min(s.bottom-i.bottom,t.y),s.top+i.top)}},defaults:{restriction:null,elementRect:null,offset:null,endOnly:!1,enabled:!1}},Mn=Ot(Sn,"restrict"),Tn={top:1/0,left:1/0,bottom:-1/0,right:-1/0},wn={top:-1/0,left:-1/0,bottom:1/0,right:1/0};function On(e,t){for(var n=0,r=["top","left","bottom","right"];n<r.length;n++){var a=r[n];a in e||(e[a]=t[a])}return e}var An={noInner:Tn,noOuter:wn,start:function(e){var t,n=e.interaction,r=e.startOffset,a=e.state,i=a.options;i&&(t=ne(En(i.offset,n,n.coords.start.page))),t=t||{x:0,y:0},a.offset={top:t.y+r.top,left:t.x+r.left,bottom:t.y-r.bottom,right:t.x-r.right}},set:function(e){var t=e.coords,n=e.edges,r=e.interaction,a=e.state,i=a.offset,o=a.options;if(n){var s=$({},t),l=En(o.inner,r,s)||{},c=En(o.outer,r,s)||{};On(l,Tn),On(c,wn),n.top?t.y=Math.min(Math.max(c.top+i.top,s.y),l.top+i.top):n.bottom&&(t.y=Math.max(Math.min(c.bottom+i.bottom,s.y),l.bottom+i.bottom)),n.left?t.x=Math.min(Math.max(c.left+i.left,s.x),l.left+i.left):n.right&&(t.x=Math.max(Math.min(c.right+i.right,s.x),l.right+i.right))}},defaults:{inner:null,outer:null,offset:null,endOnly:!1,enabled:!1}},Rn=Ot(An,"restrictEdges"),Cn=$({get elementRect(){return{top:0,left:0,bottom:1,right:1}},set elementRect(e){}},Sn.defaults),kn=Ot({start:Sn.start,set:Sn.set,defaults:Cn},"restrictRect"),Pn={width:-1/0,height:-1/0},Ln={width:1/0,height:1/0},In=Ot({start:function(e){return An.start(e)},set:function(e){var t=e.interaction,n=e.state,r=e.rect,a=e.edges,i=n.options;if(a){var o=re(En(i.min,t,e.coords))||Pn,s=re(En(i.max,t,e.coords))||Ln;n.options={endOnly:i.endOnly,inner:$({},An.noInner),outer:$({},An.noOuter)},a.top?(n.options.inner.top=r.bottom-o.height,n.options.outer.top=r.bottom-s.height):a.bottom&&(n.options.inner.bottom=r.top+o.height,n.options.outer.bottom=r.top+s.height),a.left?(n.options.inner.left=r.right-o.width,n.options.outer.left=r.right-s.width):a.right&&(n.options.inner.right=r.left+o.width,n.options.outer.right=r.left+s.width),An.set(e),n.options=i}},defaults:{min:null,max:null,endOnly:!1,enabled:!1}},"restrictSize"),Nn={start:function(e){var t,n=e.interaction,r=e.interactable,a=e.element,i=e.rect,o=e.state,s=e.startOffset,l=o.options,c=l.offsetWithOrigin?function(e){var t=e.interaction.element;return ne(te(e.state.options.origin,null,null,[t]))||ie(e.interactable,t,e.interaction.prepared.name)}(e):{x:0,y:0};if("startCoords"===l.offset)t={x:n.coords.start.page.x,y:n.coords.start.page.y};else{var u=te(l.offset,r,a,[n]);(t=ne(u)||{x:0,y:0}).x+=c.x,t.y+=c.y}var d=l.relativePoints;o.offsets=i&&d&&d.length?d.map((function(e,n){return{index:n,relativePoint:e,x:s.left-i.width*e.x+t.x,y:s.top-i.height*e.y+t.y}})):[{index:0,relativePoint:null,x:t.x,y:t.y}]},set:function(e){var t=e.interaction,n=e.coords,r=e.state,a=r.options,i=r.offsets,o=ie(t.interactable,t.element,t.prepared.name),s=$({},n),l=[];a.offsetWithOrigin||(s.x-=o.x,s.y-=o.y);for(var c=0,u=i;c<u.length;c++)for(var d=u[c],h=s.x-d.x,f=s.y-d.y,p=0,m=a.targets.length;p<m;p++){var v,g=a.targets[p];(v=T(g)?g(h,f,t._proxy,d,p):g)&&l.push({x:(w(v.x)?v.x:h)+d.x,y:(w(v.y)?v.y:f)+d.y,range:w(v.range)?v.range:a.range,source:g,index:p,offset:d})}for(var y={target:null,inRange:!1,distance:0,range:0,delta:{x:0,y:0}},b=0;b<l.length;b++){var _=l[b],x=_.range,E=_.x-s.x,S=_.y-s.y,M=le(E,S),O=M<=x;x===1/0&&y.inRange&&y.range!==1/0&&(O=!1),y.target&&!(O?y.inRange&&x!==1/0?M/x<y.distance/y.range:x===1/0&&y.range!==1/0||M<y.distance:!y.inRange&&M<y.distance)||(y.target=_,y.distance=M,y.range=x,y.inRange=O,y.delta.x=E,y.delta.y=S)}return y.inRange&&(n.x=y.target.x,n.y=y.target.y),r.closest=y,y},defaults:{range:1/0,targets:null,offset:null,offsetWithOrigin:!0,origin:null,relativePoints:null,endOnly:!1,enabled:!1}},Dn=Ot(Nn,"snap"),Un={start:function(e){var t=e.state,n=e.edges,r=t.options;if(!n)return null;e.state={options:{targets:null,relativePoints:[{x:n.left?0:1,y:n.top?0:1}],offset:r.offset||"self",origin:{x:0,y:0},range:r.range}},t.targetFields=t.targetFields||[["width","height"],["x","y"]],Nn.start(e),t.offsets=e.state.offsets,e.state=t},set:function(e){var t=e.interaction,n=e.state,r=e.coords,a=n.options,i=n.offsets,o={x:r.x-i[0].x,y:r.y-i[0].y};n.options=$({},a),n.options.targets=[];for(var s=0,l=a.targets||[];s<l.length;s++){var c=l[s],u=void 0;if(u=T(c)?c(o.x,o.y,t):c){for(var d=0,h=n.targetFields;d<h.length;d++){var f=h[d],p=f[0],m=f[1];if(p in u||m in u){u.x=u[p],u.y=u[m];break}}n.options.targets.push(u)}}var v=Nn.set(e);return n.options=a,v},defaults:{range:1/0,targets:null,offset:null,endOnly:!1,enabled:!1}},jn=Ot(Un,"snapSize"),Fn={aspectRatio:bn,restrictEdges:Rn,restrict:Mn,restrictRect:kn,restrictSize:In,snapEdges:Ot({start:function(e){var t=e.edges;return t?(e.state.targetFields=e.state.targetFields||[[t.left?"left":"right",t.top?"top":"bottom"]],Un.start(e)):null},set:Un.set,defaults:$(Mt(Un.defaults),{targets:void 0,range:void 0,offset:{x:0,y:0}})},"snapEdges"),snap:Dn,snapSize:jn,spring:xn,avoid:xn,transform:xn,rubberband:xn},zn={id:"modifiers",install:function(e){var t=e.interactStatic;for(var n in e.usePlugin(Rt),e.usePlugin(vn),t.modifiers=Fn,Fn){var r=Fn[n],a=r._defaults,i=r._methods;a._methods=i,e.defaults.perAction[n]=a}}},Bn=function(e){l(n,e);var t=h(n);function n(e,r,i,o,s,l){var c;if(a(this,n),ue(d(c=t.call(this,s)),i),i!==r&&ue(d(c),r),c.timeStamp=l,c.originalEvent=i,c.type=e,c.pointerId=ve(r),c.pointerType=Ee(r),c.target=o,c.currentTarget=null,"tap"===e){var u=s.getPointerIndex(r);c.dt=c.timeStamp-s.pointers[u].downTime;var h=c.timeStamp-s.tapTime;c.double=!!s.prevTap&&"doubletap"!==s.prevTap.type&&s.prevTap.target===c.target&&h<500}else"doubletap"===e&&(c.dt=r.timeStamp-s.tapTime,c.double=!0);return c}return o(n,[{key:"_subtractOrigin",value:function(e){var t=e.x,n=e.y;return this.pageX-=t,this.pageY-=n,this.clientX-=t,this.clientY-=n,this}},{key:"_addOrigin",value:function(e){var t=e.x,n=e.y;return this.pageX+=t,this.pageY+=n,this.clientX+=t,this.clientY+=n,this}},{key:"preventDefault",value:function(){this.originalEvent.preventDefault()}}]),n}(Me),Hn={id:"pointer-events/base",before:["inertia","modifiers","auto-start","actions"],install:function(e){e.pointerEvents=Hn,e.defaults.actions.pointerEvents=Hn.defaults,$(e.actions.phaselessTypes,Hn.types)},listeners:{"interactions:new":function(e){var t=e.interaction;t.prevTap=null,t.tapTime=0},"interactions:update-pointer":function(e){var t=e.down,n=e.pointerInfo;!t&&n.hold||(n.hold={duration:1/0,timeout:null})},"interactions:move":function(e,t){var n=e.interaction,r=e.pointer,a=e.event,i=e.eventTarget;e.duplicate||n.pointerIsDown&&!n.pointerWasMoved||(n.pointerIsDown&&Wn(e),Vn({interaction:n,pointer:r,event:a,eventTarget:i,type:"move"},t))},"interactions:down":function(e,t){!function(e,t){for(var n=e.interaction,r=e.pointer,a=e.event,i=e.eventTarget,o=e.pointerIndex,s=n.pointers[o].hold,l=J(i),c={interaction:n,pointer:r,event:a,eventTarget:i,type:"hold",targets:[],path:l,node:null},u=0;u<l.length;u++){var d=l[u];c.node=d,t.fire("pointerEvents:collect-targets",c)}if(c.targets.length){for(var h=1/0,f=0,p=c.targets;f<p.length;f++){var m=p[f].eventable.options.holdDuration;m<h&&(h=m)}s.duration=h,s.timeout=setTimeout((function(){Vn({interaction:n,eventTarget:i,pointer:r,event:a,type:"hold"},t)}),h)}}(e,t),Vn(e,t)},"interactions:up":function(e,t){Wn(e),Vn(e,t),function(e,t){var n=e.interaction,r=e.pointer,a=e.event,i=e.eventTarget;n.pointerWasMoved||Vn({interaction:n,eventTarget:i,pointer:r,event:a,type:"tap"},t)}(e,t)},"interactions:cancel":function(e,t){Wn(e),Vn(e,t)}},PointerEvent:Bn,fire:Vn,collectEventTargets:Gn,defaults:{holdDuration:600,ignoreFrom:null,allowFrom:null,origin:{x:0,y:0}},types:{down:!0,move:!0,up:!0,cancel:!0,tap:!0,doubletap:!0,hold:!0}};function Vn(e,t){var n=e.interaction,r=e.pointer,a=e.event,i=e.eventTarget,o=e.type,s=e.targets,l=void 0===s?Gn(e,t):s,c=new Bn(o,r,a,i,n,t.now());t.fire("pointerEvents:new",{pointerEvent:c});for(var u={interaction:n,pointer:r,event:a,eventTarget:i,targets:l,type:o,pointerEvent:c},d=0;d<l.length;d++){var h=l[d];for(var f in h.props||{})c[f]=h.props[f];var p=ie(h.eventable,h.node);if(c._subtractOrigin(p),c.eventable=h.eventable,c.currentTarget=h.node,h.eventable.fire(c),c._addOrigin(p),c.immediatePropagationStopped||c.propagationStopped&&d+1<l.length&&l[d+1].node!==c.currentTarget)break}if(t.fire("pointerEvents:fired",u),"tap"===o){var m=c.double?Vn({interaction:n,pointer:r,event:a,eventTarget:i,type:"doubletap"},t):c;n.prevTap=m,n.tapTime=m.timeStamp}return c}function Gn(e,t){var n=e.interaction,r=e.pointer,a=e.event,i=e.eventTarget,o=e.type,s=n.getPointerIndex(r),l=n.pointers[s];if("tap"===o&&(n.pointerWasMoved||!l||l.downTarget!==i))return[];for(var c=J(i),u={interaction:n,pointer:r,event:a,eventTarget:i,type:o,path:c,targets:[],node:null},d=0;d<c.length;d++){var h=c[d];u.node=h,t.fire("pointerEvents:collect-targets",u)}return"hold"===o&&(u.targets=u.targets.filter((function(e){var t,r;return e.eventable.options.holdDuration===(null==(t=n.pointers[s])||null==(r=t.hold)?void 0:r.duration)}))),u.targets}function Wn(e){var t=e.interaction,n=e.pointerIndex,r=t.pointers[n].hold;r&&r.timeout&&(clearTimeout(r.timeout),r.timeout=null)}var Xn=Object.freeze({__proto__:null,default:Hn});function qn(e){var t=e.interaction;t.holdIntervalHandle&&(clearInterval(t.holdIntervalHandle),t.holdIntervalHandle=null)}var Yn={id:"pointer-events/holdRepeat",install:function(e){e.usePlugin(Hn);var t=e.pointerEvents;t.defaults.holdRepeatInterval=0,t.types.holdrepeat=e.actions.phaselessTypes.holdrepeat=!0},listeners:["move","up","cancel","endall"].reduce((function(e,t){return e["pointerEvents:".concat(t)]=qn,e}),{"pointerEvents:new":function(e){var t=e.pointerEvent;"hold"===t.type&&(t.count=(t.count||0)+1)},"pointerEvents:fired":function(e,t){var n=e.interaction,r=e.pointerEvent,a=e.eventTarget,i=e.targets;if("hold"===r.type&&i.length){var o=i[0].eventable.options.holdRepeatInterval;o<=0||(n.holdIntervalHandle=setTimeout((function(){t.pointerEvents.fire({interaction:n,eventTarget:a,type:"hold",pointer:r,event:r},t)}),o))}}})},Kn={id:"pointer-events/interactableTargets",install:function(e){var t=e.Interactable;t.prototype.pointerEvents=function(e){return $(this.events.options,e),this};var n=t.prototype._backCompatOption;t.prototype._backCompatOption=function(e,t){var r=n.call(this,e,t);return r===this&&(this.events.options[e]=t),r}},listeners:{"pointerEvents:collect-targets":function(e,t){var n=e.targets,r=e.node,a=e.type,i=e.eventTarget;t.interactables.forEachMatch(r,(function(e){var t=e.events,o=t.options;t.types[a]&&t.types[a].length&&e.testIgnoreAllow(o,r,i)&&n.push({node:r,eventable:t,props:{interactable:e}})}))},"interactable:new":function(e){var t=e.interactable;t.events.getRect=function(e){return t.getRect(e)}},"interactable:set":function(e,t){var n=e.interactable,r=e.options;$(n.events.options,t.pointerEvents.defaults),$(n.events.options,r.pointerEvents||{})}}},Zn={id:"pointer-events",install:function(e){e.usePlugin(Xn),e.usePlugin(Yn),e.usePlugin(Kn)}},Jn={id:"reflow",install:function(e){var t=e.Interactable;e.actions.phases.reflow=!0,t.prototype.reflow=function(t){return function(e,t,n){for(var r=e.getAllElements(),a=n.window.Promise,i=a?[]:null,o=function(){var o=r[s],l=e.getRect(o);if(!l)return 1;var c,u=Ae(n.interactions.list,(function(n){return n.interacting()&&n.interactable===e&&n.element===o&&n.prepared.name===t.name}));if(u)u.move(),i&&(c=u._reflowPromise||new a((function(e){u._reflowResolve=e})));else{var d=re(l),h=function(e){return{coords:e,get page(){return this.coords.page},get client(){return this.coords.client},get timeStamp(){return this.coords.timeStamp},get pageX(){return this.coords.page.x},get pageY(){return this.coords.page.y},get clientX(){return this.coords.client.x},get clientY(){return this.coords.client.y},get pointerId(){return this.coords.pointerId},get target(){return this.coords.target},get type(){return this.coords.type},get pointerType(){return this.coords.pointerType},get buttons(){return this.coords.buttons},preventDefault:function(){}}}({page:{x:d.x,y:d.y},client:{x:d.x,y:d.y},timeStamp:n.now()});c=function(e,t,n,r,a){var i=e.interactions.new({pointerType:"reflow"}),o={interaction:i,event:a,pointer:a,eventTarget:n,phase:"reflow"};i.interactable=t,i.element=n,i.prevEvent=a,i.updatePointer(a,a,n,!0),he(i.coords.delta),rt(i.prepared,r),i._doPhase(o);var s=e.window.Promise,l=s?new s((function(e){i._reflowResolve=e})):void 0;return i._reflowPromise=l,i.start(r,t,n),i._interacting?(i.move(o),i.end(a)):(i.stop(),i._reflowResolve()),i.removePointer(a,a),l}(n,e,o,t,h)}i&&i.push(c)},s=0;s<r.length&&!o();s++);return i&&a.all(i).then((function(){return e}))}(this,t,e)}},listeners:{"interactions:stop":function(e,t){var n=e.interaction;"reflow"===n.pointerType&&(n._reflowResolve&&n._reflowResolve(),function(e,t){e.splice(e.indexOf(t),1)}(t.interactions.list,n))}}};if(fn.use(Et),fn.use(Bt),fn.use(Zn),fn.use(Xt),fn.use(zn),fn.use(bt),fn.use(qe),fn.use(tt),fn.use(Jn),fn.default=fn,"object"===r(e)&&e)try{e.exports=fn}catch(t){}return fn.default=fn,fn}()}).call(this,n(503)(e))},1082:function(e,t,n){"use strict";(function(e){var n={Linear:{None:function(e){return e}},Quadratic:{In:function(e){return e*e},Out:function(e){return e*(2-e)},InOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}},Cubic:{In:function(e){return e*e*e},Out:function(e){return--e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)}},Quartic:{In:function(e){return e*e*e*e},Out:function(e){return 1- --e*e*e*e},InOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}},Quintic:{In:function(e){return e*e*e*e*e},Out:function(e){return--e*e*e*e*e+1},InOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)}},Sinusoidal:{In:function(e){return 1-Math.cos(e*Math.PI/2)},Out:function(e){return Math.sin(e*Math.PI/2)},InOut:function(e){return.5*(1-Math.cos(Math.PI*e))}},Exponential:{In:function(e){return 0===e?0:Math.pow(1024,e-1)},Out:function(e){return 1===e?1:1-Math.pow(2,-10*e)},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(2-Math.pow(2,-10*(e-1)))}},Circular:{In:function(e){return 1-Math.sqrt(1-e*e)},Out:function(e){return Math.sqrt(1- --e*e)},InOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)}},Elastic:{In:function(e){return 0===e?0:1===e?1:-Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)},Out:function(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1},InOut:function(e){return 0===e?0:1===e?1:(e*=2)<1?-.5*Math.pow(2,10*(e-1))*Math.sin(5*(e-1.1)*Math.PI):.5*Math.pow(2,-10*(e-1))*Math.sin(5*(e-1.1)*Math.PI)+1}},Back:{In:function(e){var t=1.70158;return e*e*((t+1)*e-t)},Out:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},InOut:function(e){var t=2.5949095;return(e*=2)<1?e*e*((t+1)*e-t)*.5:.5*((e-=2)*e*((t+1)*e+t)+2)}},Bounce:{In:function(e){return 1-n.Bounce.Out(1-e)},Out:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},InOut:function(e){return e<.5?.5*n.Bounce.In(2*e):.5*n.Bounce.Out(2*e-1)+.5}}},r="undefined"===typeof self&&"undefined"!==typeof e&&e.hrtime?function(){var t=e.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!==typeof self&&void 0!==self.performance&&void 0!==self.performance.now?self.performance.now.bind(self.performance):void 0!==Date.now?Date.now:function(){return(new Date).getTime()},a=function(){function e(){this._tweens={},this._tweensAddedDuringUpdate={}}return e.prototype.getAll=function(){var e=this;return Object.keys(this._tweens).map((function(t){return e._tweens[t]}))},e.prototype.removeAll=function(){this._tweens={}},e.prototype.add=function(e){this._tweens[e.getId()]=e,this._tweensAddedDuringUpdate[e.getId()]=e},e.prototype.remove=function(e){delete this._tweens[e.getId()],delete this._tweensAddedDuringUpdate[e.getId()]},e.prototype.update=function(e,t){void 0===e&&(e=r()),void 0===t&&(t=!1);var n=Object.keys(this._tweens);if(0===n.length)return!1;for(;n.length>0;){this._tweensAddedDuringUpdate={};for(var a=0;a<n.length;a++){var i=this._tweens[n[a]],o=!t;i&&!1===i.update(e,o)&&!t&&delete this._tweens[n[a]]}n=Object.keys(this._tweensAddedDuringUpdate)}return!0},e}(),i={Linear:function(e,t){var n=e.length-1,r=n*t,a=Math.floor(r),o=i.Utils.Linear;return t<0?o(e[0],e[1],r):t>1?o(e[n],e[n-1],n-r):o(e[a],e[a+1>n?n:a+1],r-a)},Bezier:function(e,t){for(var n=0,r=e.length-1,a=Math.pow,o=i.Utils.Bernstein,s=0;s<=r;s++)n+=a(1-t,r-s)*a(t,s)*e[s]*o(r,s);return n},CatmullRom:function(e,t){var n=e.length-1,r=n*t,a=Math.floor(r),o=i.Utils.CatmullRom;return e[0]===e[n]?(t<0&&(a=Math.floor(r=n*(1+t))),o(e[(a-1+n)%n],e[a],e[(a+1)%n],e[(a+2)%n],r-a)):t<0?e[0]-(o(e[0],e[0],e[1],e[1],-r)-e[0]):t>1?e[n]-(o(e[n],e[n],e[n-1],e[n-1],r-n)-e[n]):o(e[a?a-1:0],e[a],e[n<a+1?n:a+1],e[n<a+2?n:a+2],r-a)},Utils:{Linear:function(e,t,n){return(t-e)*n+e},Bernstein:function(e,t){var n=i.Utils.Factorial;return n(e)/n(t)/n(e-t)},Factorial:function(){var e=[1];return function(t){var n=1;if(e[t])return e[t];for(var r=t;r>1;r--)n*=r;return e[t]=n,n}}(),CatmullRom:function(e,t,n,r,a){var i=.5*(n-e),o=.5*(r-t),s=a*a;return(2*t-2*n+i+o)*(a*s)+(-3*t+3*n-2*i-o)*s+i*a+t}}},o=function(){function e(){}return e.nextId=function(){return e._nextId++},e._nextId=0,e}(),s=new a,l=function(){function e(e,t){void 0===t&&(t=s),this._object=e,this._group=t,this._isPaused=!1,this._pauseStart=0,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._initialRepeat=0,this._repeat=0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=0,this._easingFunction=n.Linear.None,this._interpolationFunction=i.Linear,this._chainedTweens=[],this._onStartCallbackFired=!1,this._id=o.nextId(),this._isChainStopped=!1,this._goToEnd=!1}return e.prototype.getId=function(){return this._id},e.prototype.isPlaying=function(){return this._isPlaying},e.prototype.isPaused=function(){return this._isPaused},e.prototype.to=function(e,t){return this._valuesEnd=Object.create(e),void 0!==t&&(this._duration=t),this},e.prototype.duration=function(e){return this._duration=e,this},e.prototype.start=function(e){if(this._isPlaying)return this;if(this._group&&this._group.add(this),this._repeat=this._initialRepeat,this._reversed)for(var t in this._reversed=!1,this._valuesStartRepeat)this._swapEndStartRepeatValues(t),this._valuesStart[t]=this._valuesStartRepeat[t];return this._isPlaying=!0,this._isPaused=!1,this._onStartCallbackFired=!1,this._isChainStopped=!1,this._startTime=void 0!==e?"string"===typeof e?r()+parseFloat(e):e:r(),this._startTime+=this._delayTime,this._setupProperties(this._object,this._valuesStart,this._valuesEnd,this._valuesStartRepeat),this},e.prototype._setupProperties=function(e,t,n,r){for(var a in n){var i=e[a],o=Array.isArray(i),s=o?"array":typeof i,l=!o&&Array.isArray(n[a]);if("undefined"!==s&&"function"!==s){if(l){var c=n[a];if(0===c.length)continue;c=c.map(this._handleRelativeValue.bind(this,i)),n[a]=[i].concat(c)}if("object"!==s&&!o||!i||l)"undefined"===typeof t[a]&&(t[a]=i),o||(t[a]*=1),r[a]=l?n[a].slice().reverse():t[a]||0;else{for(var u in t[a]=o?[]:{},i)t[a][u]=i[u];r[a]=o?[]:{},this._setupProperties(i,t[a],n[a],r[a])}}}},e.prototype.stop=function(){return this._isChainStopped||(this._isChainStopped=!0,this.stopChainedTweens()),this._isPlaying?(this._group&&this._group.remove(this),this._isPlaying=!1,this._isPaused=!1,this._onStopCallback&&this._onStopCallback(this._object),this):this},e.prototype.end=function(){return this._goToEnd=!0,this.update(1/0),this},e.prototype.pause=function(e){return void 0===e&&(e=r()),this._isPaused||!this._isPlaying||(this._isPaused=!0,this._pauseStart=e,this._group&&this._group.remove(this)),this},e.prototype.resume=function(e){return void 0===e&&(e=r()),this._isPaused&&this._isPlaying?(this._isPaused=!1,this._startTime+=e-this._pauseStart,this._pauseStart=0,this._group&&this._group.add(this),this):this},e.prototype.stopChainedTweens=function(){for(var e=0,t=this._chainedTweens.length;e<t;e++)this._chainedTweens[e].stop();return this},e.prototype.group=function(e){return this._group=e,this},e.prototype.delay=function(e){return this._delayTime=e,this},e.prototype.repeat=function(e){return this._initialRepeat=e,this._repeat=e,this},e.prototype.repeatDelay=function(e){return this._repeatDelayTime=e,this},e.prototype.yoyo=function(e){return this._yoyo=e,this},e.prototype.easing=function(e){return this._easingFunction=e,this},e.prototype.interpolation=function(e){return this._interpolationFunction=e,this},e.prototype.chain=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._chainedTweens=e,this},e.prototype.onStart=function(e){return this._onStartCallback=e,this},e.prototype.onUpdate=function(e){return this._onUpdateCallback=e,this},e.prototype.onRepeat=function(e){return this._onRepeatCallback=e,this},e.prototype.onComplete=function(e){return this._onCompleteCallback=e,this},e.prototype.onStop=function(e){return this._onStopCallback=e,this},e.prototype.update=function(e,t){if(void 0===e&&(e=r()),void 0===t&&(t=!0),this._isPaused)return!0;var n,a,i=this._startTime+this._duration;if(!this._goToEnd&&!this._isPlaying){if(e>i)return!1;t&&this.start(e)}if(this._goToEnd=!1,e<this._startTime)return!0;!1===this._onStartCallbackFired&&(this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),a=(e-this._startTime)/this._duration,a=0===this._duration||a>1?1:a;var o=this._easingFunction(a);if(this._updateProperties(this._object,this._valuesStart,this._valuesEnd,o),this._onUpdateCallback&&this._onUpdateCallback(this._object,a),1===a){if(this._repeat>0){for(n in isFinite(this._repeat)&&this._repeat--,this._valuesStartRepeat)this._yoyo||"string"!==typeof this._valuesEnd[n]||(this._valuesStartRepeat[n]=this._valuesStartRepeat[n]+parseFloat(this._valuesEnd[n])),this._yoyo&&this._swapEndStartRepeatValues(n),this._valuesStart[n]=this._valuesStartRepeat[n];return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=e+this._repeatDelayTime:this._startTime=e+this._delayTime,this._onRepeatCallback&&this._onRepeatCallback(this._object),!0}this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,l=this._chainedTweens.length;s<l;s++)this._chainedTweens[s].start(this._startTime+this._duration);return this._isPlaying=!1,!1}return!0},e.prototype._updateProperties=function(e,t,n,r){for(var a in n)if(void 0!==t[a]){var i=t[a]||0,o=n[a],s=Array.isArray(e[a]),l=Array.isArray(o);!s&&l?e[a]=this._interpolationFunction(o,r):"object"===typeof o&&o?this._updateProperties(e[a],i,o,r):"number"===typeof(o=this._handleRelativeValue(i,o))&&(e[a]=i+(o-i)*r)}},e.prototype._handleRelativeValue=function(e,t){return"string"!==typeof t?t:"+"===t.charAt(0)||"-"===t.charAt(0)?e+parseFloat(t):parseFloat(t)},e.prototype._swapEndStartRepeatValues=function(e){var t=this._valuesStartRepeat[e],n=this._valuesEnd[e];this._valuesStartRepeat[e]="string"===typeof n?this._valuesStartRepeat[e]+parseFloat(n):this._valuesEnd[e],this._valuesEnd[e]=t},e}(),c=o.nextId,u=s,d=u.getAll.bind(u),h=u.removeAll.bind(u),f=u.add.bind(u),p=u.remove.bind(u),m=u.update.bind(u),v={Easing:n,Group:a,Interpolation:i,now:r,Sequence:o,nextId:c,Tween:l,VERSION:"18.6.4",getAll:d,removeAll:h,add:f,remove:p,update:m};t.a=v}).call(this,n(1073))},1151:function(e,t,n){"use strict";n.r(t),n.d(t,"useStyles",(function(){return mn})),n.d(t,"BloqueContenido",(function(){return vn})),n.d(t,"Main",(function(){return gn}));var r=n(35),a=n(2),i=n.n(a),o=n(50),s=n(119),l=n(941),c=n(940),u=n(843),d=n(926),h=n(972),f=n(1400),p=n(1402),m=n(945),v=n.n(m),g=n(953),y=n(1043),b=n(1051),_=n.n(b),x=n(950),E=n.n(x),S=n(970),M=n.n(S),T=n(203),w=n.n(T),O=n(852),A=n(1403),R=n(930),C=n(1052),k=n.n(C),P=n(1053),L=n.n(P),I=n(958),N=n(957),D=n(959),U=n(202),j=n(999),F=n(964),z=Object(O.a)((function(e){return{segment:{transition:"all .35s",cursor:"pointer","&:hover":{background:"rgba(86,116,154,0.25)"},"&.selected":{opacity:1,background:"#56749a",color:"white"}},speaker:{fontWeight:"bold",marginRight:"10px"},paragraph:{fontSize:"16px",maxWidth:"650px",margin:"0 auto",marginBottom:"20px"},selected:{background:"#56749a",color:"white",borderRadius:"3px"}}})),B=function(e){return i.a.createElement(R.a,{style:{padding:"5px",background:"white"}},e.speakers.map((function(t,n){return i.a.createElement(R.a,{key:n,style:{padding:"10px",border:"1px solid #dcdcdc",marginBottom:"5px",borderRadius:"5px",display:"flex",maxWidth:"450px",background:"white",alignItems:"center"}},i.a.createElement("div",{style:{width:"150px",textAlign:"center",fontWeight:"bold",color:t.color}},t.name.replace("SPEAKER","Persona")),i.a.createElement("div",{style:{position:"relative",width:"350px",marginLeft:"10px",background:"#f2f2f2",borderRadius:"3px",height:"10px"}},t.segments.map((function(n,r){return i.a.createElement("div",{style:{position:"absolute",top:"0",height:"100%",left:"".concat(n.start/e.totalTime*100,"%"),width:"".concat((n.end-n.start)/e.totalTime*100,"%"),background:t.color,cursor:"pointer"},onClick:function(t){e.setVideoTime(n.start)}})}))),i.a.createElement("div",{style:{marginLeft:"10px",background:t.color,color:"white",padding:"5px",fontSize:"10px",borderRadius:"5px"}},e.totalTime&&i.a.createElement(i.a.Fragment,null,Math.round(t.total/e.totalTime*100),"%")))})))},H=function(e){var t=z(),n=Object(a.useState)(null),o=Object(r.a)(n,2),s=o[0],l=o[1],c=Object(a.useState)(1),u=Object(r.a)(c,2),d=u[0],f=(u[1],Object(a.useState)(null)),p=Object(r.a)(f,2),m=p[0],v=p[1];Object(a.useEffect)((function(){h.h(e.id,e.slug).then((function(t){var n=F.e,r=F.c(t.speakers.map((function(e){return e.name})),n);t.segments.forEach((function(e){e.color=r(e.speaker)})),l(t.segments),t.speakers.forEach((function(e){e.color=r(e.name)})),e.setSpeakers(t.speakers)}))}),[]),Object(a.useEffect)((function(){if(s){s.forEach((function(n,r){if(n.index=r,n.start<=e.time&&n.end>=e.time&&m!==r){v(r);var a=document.querySelector(".seg_".concat(r));a&&(document.querySelectorAll(".".concat(t.segment)).forEach((function(e){e.classList.remove("selected")})),a.classList.add("selected"),a&&a.scrollIntoView({behavior:"smooth",block:"center"}))}}))}}),[e.time]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(R.a,{style:{position:"absolute",top:0,width:"100%",height:"100%"}},1===d&&s&&i.a.createElement(j.BloqueContenido,{style:{height:"calc(100% - 20px)",margin:"10px",borderRadius:"5px",width:"calc(100% - 20px)"}},i.a.createElement("div",{style:{float:"right",paddingTop:80}},function(){var n=null,r=[],a=[];return s.map((function(o,s){var l=i.a.createElement("span",{key:s,onClick:function(t){return e.setVideoTime(o.start)},className:"".concat(t.segment," seg_").concat(s)},o.text);l={container:l,speaker:o.speaker,color:o.color},o.speaker!==n&&(n=o.speaker,a.push(r),r=[]),r.push(l)})),a.push(r),i.a.createElement(i.a.Fragment,null,a.map((function(e,n){return i.a.createElement("p",{key:n,className:t.paragraph},e.map((function(e,n){return n>0?e.container:e.speaker?i.a.createElement(i.a.Fragment,null,i.a.createElement("span",{style:{color:e.color},className:t.speaker},e.speaker.replace("SPEAKER","Persona")),e.container):void 0})))})))}()))))},V=Object(O.a)((function(e){return{bloqueReproduccion:{width:"calc(100% - 40px)",margin:"20px",display:"flex",alignItems:"center",position:"absolute",zIndex:1,"&:hover .num_currentTime":{opacity:1}},playPauseBtn:{width:"70px",height:"70px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer","& svg":{width:"50%",height:"50%","& path":{fill:"#56749a"}}},progressContainer:{width:"calc(100% - 140px)",height:"5px",backgroundColor:"#ececec",display:"flex",alignItems:"center",borderRadius:"5px",cursor:"pointer"},progress:{width:"0%",height:"100%",backgroundColor:"#56749a",borderRadius:"5px",position:"relative",transition:"all .3s"},currentTime:{position:"absolute",top:"-20px",right:"-56px",fontSize:"12px",fontWeight:"bold",color:"#56749a",opacity:0,transition:"all .3s"},duration:{width:"100px",height:"70px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",color:"#555",fontSize:"12px",fontWeight:"bold"}}})),G=function(e){var t,n,o,s=V(),l=Object(a.useRef)(null),c=Object(a.useState)(!1),u=Object(r.a)(c,2),d=u[0],f=u[1],p=Object(a.useState)(0),m=Object(r.a)(p,2),v=m[0],g=m[1],y=Object(a.useState)(null),b=Object(r.a)(y,2),_=b[0],x=b[1],E=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))},S=function(){f(!1)},M=function(){w.a.fire({title:"Error",text:"No se pudo cargar el archivo",icon:"error",confirmButtonText:"Ok"})},T=function(){var e=l.current.duration;g(E(e))},O=function(){e.setPlayTime(l.current.currentTime);var t=l.current.currentTime/l.current.duration*100,n=document.querySelector(".".concat(s.progress)),r=document.querySelector(".".concat(s.currentTime));n.style.width="".concat(t,"%"),r.innerHTML=E(l.current.currentTime)};Object(a.useEffect)((function(){return h.g(e.id).then((function(e){var t=URL.createObjectURL(e);l.current.src=t,l.current.addEventListener("ended",S),l.current.addEventListener("error",M),l.current.addEventListener("loadedmetadata",T),l.current.addEventListener("timeupdate",O)})).catch((function(e){w.a.fire({title:"Error",text:"No se pudo cargar el archivo: "+e.message,icon:"error",confirmButtonText:"Ok"})})),function(){l.current.removeEventListener("ended",S),l.current.removeEventListener("error",M),l.current.removeEventListener("loadedmetadata",T),l.current.removeEventListener("timeupdate",O)}}),[]),Object(a.useEffect)((function(){e.time&&(l.current.currentTime=e.time)}),[e.time]);var C=function(e){l.current.currentTime=e};return i.a.createElement(N.a,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")}},i.a.createElement(A.a,{className:s.bloqueReproduccion,style:{display:(null===l||void 0===l||null===(t=l.current)||void 0===t?void 0:t.duration)?"flex":"none"}},i.a.createElement(R.a,{onClick:function(){l.current.paused?(l.current.play(),f(!0)):(l.current.pause(),f(!1))},className:s.playPauseBtn},d?i.a.createElement(L.a,null):i.a.createElement(k.a,null)),i.a.createElement(R.a,{className:s.progressContainer,onClick:function(e){var t=document.querySelector(".".concat(s.progressContainer)),n=e.nativeEvent.offsetX/t.offsetWidth*100;l.current.currentTime=l.current.duration*n/100}},i.a.createElement(R.a,{className:s.progress},i.a.createElement(R.a,{className:"".concat(s.currentTime," num_currentTime")}))),i.a.createElement(R.a,{className:s.duration},v)),i.a.Children.map(e.children,(function(e){return i.a.isValidElement(e)?i.a.cloneElement(e,{setVideoTime:C,textAlign:"center",totalTime:l.current.duration,setSpeakers:x}):e})),i.a.createElement(I.a,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"}},i.a.createElement(D.a,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})),i.a.createElement(I.a,{id:"speakers",initialPosition:{x:0,y:0},style:{display:(null===l||void 0===l||null===(n=l.current)||void 0===n?void 0:n.duration)&&_?"block":"none"}},(null===l||void 0===l||null===(o=l.current)||void 0===o?void 0:o.duration)&&_&&i.a.createElement(B,{speakers:_,totalTime:l.current.duration,setVideoTime:C})),i.a.createElement("audio",{ref:l},i.a.createElement("source",{src:"",type:"audio/mpeg"}),i.a.createElement("source",{src:"",type:"audio/ogg"})))},W=Object(O.a)((function(e){return{bloqueReproduccion:{width:"calc(100% - 20px)",margin:"10px",display:"flex",alignItems:"center",position:"absolute",bottom:0,backgroundColor:"rgba(0, 0, 0, .5)",backdropFilter:"blur(5px) saturate(10%) brightness(40%)",transition:"all .3s !important",overflow:"visible",opacity:1,"&:hover .num_currentTime":{opacity:1},"&.hide":{opacity:0}},playPauseBtn:{width:"50px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer","& svg":{width:"50%",height:"50%","& path":{fill:"#fff"}}},progressContainer:{width:"calc(100% - 140px)",height:"5px",backgroundColor:"rgba(255,255,255,.1)",display:"flex",alignItems:"center",borderRadius:"5px",cursor:"pointer"},progress:{width:"0%",height:"100%",backgroundColor:"#fff",borderRadius:"5px",position:"relative",transition:"all .3s"},currentTime:{position:"absolute",top:"0px",right:"-56px",fontSize:"12px",transform:"translateY(-170%)",fontWeight:"bold",color:"#fff",opacity:0,transition:"all .3s",textShadow:"0 0 5px rgba(0,0,0,0.6)"},duration:{width:"150px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",color:"rgba(255,255,255,1)",fontSize:"12px",fontWeight:"bold"},hide:{visibility:"hidden"}}})),X=function(e){var t,n,o,s,l=W(),c=Object(a.useRef)(null),u=Object(a.useState)(!1),d=Object(r.a)(u,2),f=d[0],p=d[1],m=Object(a.useState)(0),v=Object(r.a)(m,2),g=v[0],y=v[1],b=Object(a.useState)(null),_=Object(r.a)(b,2),x=_[0],E=_[1],S=Object(a.useState)(!1),M=Object(r.a)(S,2),T=M[0],O=M[1],C=null,P=function(e){var t=Math.floor(e/3600),n=Math.floor(e%3600/60),r=Math.floor(e%3600%60);return"".concat(t.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"))},U=function(){p(!1)},j=function(){w.a.fire({title:"Error",text:"No se pudo cargar el archivo",icon:"error",confirmButtonText:"Ok"})},F=function(){var e=c.current.duration;y(P(e))},z=function(){e.setPlayTime(c.current.currentTime);var t=c.current.currentTime/c.current.duration*100,n=document.querySelector(".".concat(l.progress)),r=document.querySelector(".".concat(l.currentTime));n.style.width="".concat(t,"%"),r.innerHTML=P(c.current.currentTime)},H=function(){clearTimeout(C);var e=document.querySelector(".".concat(l.bloqueReproduccion));e.classList.remove("hide"),C=setTimeout((function(){e.classList.add("hide")}),4e3)},V=function(){O(!0)},G=function(){c.current.paused?(c.current.play(),p(!0)):(c.current.pause(),p(!1))};Object(a.useEffect)((function(){return h.g(e.id).then((function(e){var t=URL.createObjectURL(e);c.current.src=t,c.current.addEventListener("ended",U),c.current.addEventListener("error",j),c.current.addEventListener("loadedmetadata",F),c.current.addEventListener("canplay",V),c.current.addEventListener("timeupdate",z),c.current.addEventListener("mousemove",H),c.current.addEventListener("click",G)})).catch((function(e){console.log(e),w.a.fire({title:"Error",text:"No se pudo cargar el archivo",icon:"error",confirmButtonText:"Ok"})})),function(){c.current.removeEventListener("ended",U),c.current.removeEventListener("error",j),c.current.removeEventListener("loadedmetadata",F),c.current.removeEventListener("timeupdate",z),c.current.removeEventListener("mousemove",H),c.current.removeEventListener("click",G)}}),[]);var X=function(e){c.current.currentTime=e};return i.a.createElement(N.a,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")}},i.a.createElement(I.a,{id:"videoPlayer",style:{display:"flex",flexWrap:"wrap",justifyContent:"center",position:"absolute",zIndex:1,backgroundColor:"#000",visibility:T?"visible":"hidden"},initialPosition:{x:0,y:0}},i.a.createElement("div",null,i.a.createElement("video",{style:{width:550,height:"auto",maxWidth:"100%",marginBottom:-7,cursor:"move"},ref:c}),i.a.createElement(A.a,{className:l.bloqueReproduccion,style:{backgroundColor:"rgba(255, 255, 255, .25)"},sx:{overflow:"visible"},onMouseMove:function(){clearTimeout(C)}},i.a.createElement(R.a,{onClick:G,className:l.playPauseBtn},f?i.a.createElement(L.a,null):i.a.createElement(k.a,null)),i.a.createElement(R.a,{className:l.progressContainer,onClick:function(e){var t=document.querySelector(".".concat(l.progressContainer)),n=e.nativeEvent.offsetX/t.offsetWidth*100;c.current.currentTime=c.current.duration*n/100}},i.a.createElement(R.a,{className:l.progress},i.a.createElement(R.a,{className:"".concat(l.currentTime," num_currentTime")}))),i.a.createElement(R.a,{className:l.duration},g)))),i.a.Children.map(e.children,(function(e){return i.a.isValidElement(e)?i.a.cloneElement(e,{setVideoTime:X,totalTime:c.current.duration,setSpeakers:E}):e})),i.a.createElement(I.a,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"}},i.a.createElement(D.a,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})),i.a.createElement(I.a,{id:"speakers",initialPosition:{x:0,y:0},style:{display:(null===c||void 0===c||null===(t=c.current)||void 0===t?void 0:t.duration)&&x?"block":"none"}},(null===c||void 0===c||null===(n=c.current)||void 0===n?void 0:n.duration)&&x&&i.a.createElement(B,{speakers:x,totalTime:c.current.duration,setVideoTime:X})),i.a.createElement(I.a,{id:"edit_av_transcribe",initialPosition:{x:0,y:0},style:{display:(null===c||void 0===c||null===(o=c.current)||void 0===o?void 0:o.duration)&&"edit_av_transcribe"===e.subView?"block":"none"}},(null===c||void 0===c||null===(s=c.current)||void 0===s?void 0:s.duration)&&"edit_av_transcribe"===e.subView&&i.a.createElement(i.a.Fragment,null,"HOMA")))},q=n(18),Y=n(938),K=n(1049),Z=n(1389),J=n(1392),Q=n(16),$=n(15),ee=n(3),te=n(332),ne=n(1383),re=n(1245),ae=n(912),ie=n(489),oe=n(839),se=n(443),le=n(842),ce=n(841),ue=n(490),de=n(840),he={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"};var fe=n(1247);function pe(e,t){return e-t}function me(e,t){var n;return(null!=(n=e.reduce((function(e,n,r){var a=Math.abs(t-n);return null===e||a<e.distance||a===e.distance?{distance:a,index:r}:e}),null))?n:{}).index}function ve(e,t){if(void 0!==t.current&&e.changedTouches){for(var n=e,r=0;r<n.changedTouches.length;r+=1){var a=n.changedTouches[r];if(a.identifier===t.current)return{x:a.clientX,y:a.clientY}}return!1}return{x:e.clientX,y:e.clientY}}function ge(e,t,n){return 100*(e-t)/(n-t)}function ye(e,t,n){var r=Math.round((e-n)/t)*t+n;return Number(r.toFixed(function(e){if(Math.abs(e)<1){var t=e.toExponential().split("e-"),n=t[0].split(".")[1];return(n?n.length:0)+parseInt(t[1],10)}var r=e.toString().split(".")[1];return r?r.length:0}(t)))}function be(e){var t=e.values,n=e.newValue,r=e.index,a=t.slice();return a[r]=n,a.sort(pe)}function _e(e){var t,n,r,a=e.sliderRef,i=e.activeIndex,o=e.setActive,s=Object(ie.a)(a.current);null!=(t=a.current)&&t.contains(s.activeElement)&&Number(null==s||null==(n=s.activeElement)?void 0:n.getAttribute("data-index"))===i||(null==(r=a.current)||r.querySelector('[type="range"][data-index="'.concat(i,'"]')).focus());o&&o(i)}function xe(e,t){return"number"===typeof e&&"number"===typeof t?e===t:"object"===typeof e&&"object"===typeof t&&function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return e===t};return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}(e,t)}var Ee,Se={horizontal:{offset:function(e){return{left:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},"horizontal-reverse":{offset:function(e){return{right:"".concat(e,"%")}},leap:function(e){return{width:"".concat(e,"%")}}},vertical:{offset:function(e){return{bottom:"".concat(e,"%")}},leap:function(e){return{height:"".concat(e,"%")}}}},Me=function(e){return e};function Te(){return void 0===Ee&&(Ee="undefined"===typeof CSS||"function"!==typeof CSS.supports||CSS.supports("touch-action","none")),Ee}var we=n(207),Oe=n(337),Ae=n(1060),Re=n(333),Ce=n(214),ke=function(e){return!e||!Object(re.a)(e)},Pe=n(118),Le=n(913),Ie=n(833);function Ne(e){return Object(Ie.a)("MuiSlider",e)}var De=Object(Le.a)("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Ue=n(0);var je=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"],Fe=Object(Ae.a)("MuiSlider");function ze(e){return e}var Be,He=Object(Re.a)("span",{name:"MuiSlider",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,t["color".concat(Object(Pe.a)(n.color))],"medium"!==n.size&&t["size".concat(Object(Pe.a)(n.size))],n.marked&&t.marked,"vertical"===n.orientation&&t.vertical,"inverted"===n.track&&t.trackInverted,!1===n.track&&t.trackFalse]}})((function(e){var t,n=e.theme;return Object(Q.a)(Object(Q.a)(Object(Q.a)({borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"}},"&.".concat(De.disabled),{pointerEvents:"none",cursor:"default",color:(n.vars||n).palette.grey[400]}),"&.".concat(De.dragging),Object(Q.a)({},"& .".concat(De.thumb,", & .").concat(De.track),{transition:"none"})),"variants",[].concat(Object(U.a)(Object.keys((null!=(t=n.vars)?t:n).palette).filter((function(e){var t;return(null!=(t=n.vars)?t:n).palette[e].main})).map((function(e){return{props:{color:e},style:{color:(n.vars||n).palette[e].main}}}))),[{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]))})),Ve=Object(Re.a)("span",{name:"MuiSlider",slot:"Rail",overridesResolver:function(e,t){return t.rail}})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),Ge=Object(Re.a)("span",{name:"MuiSlider",slot:"Track",overridesResolver:function(e,t){return t.track}})((function(e){var t,n=e.theme;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:n.transitions.create(["left","width","bottom","height"],{duration:n.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}}].concat(Object(U.a)(Object.keys((null!=(t=n.vars)?t:n).palette).filter((function(e){var t;return(null!=(t=n.vars)?t:n).palette[e].main})).map((function(e){return{props:{color:e,track:"inverted"},style:Object(ee.a)({},n.vars?{backgroundColor:n.vars.palette.Slider["".concat(e,"Track")],borderColor:n.vars.palette.Slider["".concat(e,"Track")]}:Object(ee.a)({backgroundColor:Object(we.lighten)(n.palette[e].main,.62),borderColor:Object(we.lighten)(n.palette[e].main,.62)},n.applyStyles("dark",{backgroundColor:Object(we.darken)(n.palette[e].main,.5)}),n.applyStyles("dark",{borderColor:Object(we.darken)(n.palette[e].main,.5)})))}}))))}})),We=Object(Re.a)("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:function(e,t){var n=e.ownerState;return[t.thumb,t["thumbColor".concat(Object(Pe.a)(n.color))],"medium"!==n.size&&t["thumbSize".concat(Object(Pe.a)(n.size))]]}})((function(e){var t,n=e.theme;return Object(Q.a)(Object(Q.a)({position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:n.transitions.create(["box-shadow","left","bottom"],{duration:n.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(n.vars||n).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},"&.".concat(De.disabled),{"&:hover":{boxShadow:"none"}}),"variants",[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}}].concat(Object(U.a)(Object.keys((null!=(t=n.vars)?t:n).palette).filter((function(e){var t;return(null!=(t=n.vars)?t:n).palette[e].main})).map((function(e){return{props:{color:e},style:Object(Q.a)(Object(Q.a)({},"&:hover, &.".concat(De.focusVisible),Object(ee.a)({},n.vars?{boxShadow:"0px 0px 0px 8px rgba(".concat(n.vars.palette[e].mainChannel," / 0.16)")}:{boxShadow:"0px 0px 0px 8px ".concat(Object(we.alpha)(n.palette[e].main,.16))},{"@media (hover: none)":{boxShadow:"none"}})),"&.".concat(De.active),Object(ee.a)({},n.vars?{boxShadow:"0px 0px 0px 14px rgba(".concat(n.vars.palette[e].mainChannel," / 0.16)")}:{boxShadow:"0px 0px 0px 14px ".concat(Object(we.alpha)(n.palette[e].main,.16))}))}})))))})),Xe=Object(Re.a)((function(e){var t=e.children,n=e.className,r=e.value,i=function(e){var t=e.open;return{offset:Object(te.a)(t&&De.valueLabelOpen),circle:De.valueLabelCircle,label:De.valueLabelLabel}}(e);return t?a.cloneElement(t,{className:Object(te.a)(t.props.className)},Object(Ue.jsxs)(a.Fragment,{children:[t.props.children,Object(Ue.jsx)("span",{className:Object(te.a)(i.offset,n),"aria-hidden":!0,children:Object(Ue.jsx)("span",{className:i.circle,children:Object(Ue.jsx)("span",{className:i.label,children:r})})})]})):null}),{name:"MuiSlider",slot:"ValueLabel",overridesResolver:function(e,t){return t.valueLabel}})((function(e){var t=e.theme;return Object(ee.a)({zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:Object(Q.a)({transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"}},"&.".concat(De.valueLabelOpen),{transform:"translateY(-100%) scale(1)"})},{props:{orientation:"vertical"},style:Object(Q.a)({transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"}},"&.".concat(De.valueLabelOpen),{transform:"translateY(-50%) scale(1)"})},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})})),qe=Object(Re.a)("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:function(e){return Object(Ce.a)(e)&&"markActive"!==e},overridesResolver:function(e,t){var n=e.markActive;return[t.mark,n&&t.markActive]}})((function(e){var t=e.theme;return{position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]}})),Ye=Object(Re.a)("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:function(e){return Object(Ce.a)(e)&&"markLabelActive"!==e},overridesResolver:function(e,t){return t.markLabel}})((function(e){var t=e.theme;return Object(ee.a)({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})})),Ke=function(e){return e.children},Ze=a.forwardRef((function(e,t){var n,i,o,s,l,c,u,d,h,f,p,m,v,g,y,b,_,x,E,S,M,T,w,O,A=Fe({props:e,name:"MuiSlider"}),R=Object(Oe.b)(),C=A["aria-label"],k=A["aria-valuetext"],P=A["aria-labelledby"],L=A.component,I=void 0===L?"span":L,N=A.components,D=void 0===N?{}:N,j=A.componentsProps,F=void 0===j?{}:j,z=A.color,B=void 0===z?"primary":z,H=A.classes,V=A.className,G=A.disableSwap,W=void 0!==G&&G,X=A.disabled,q=void 0!==X&&X,Y=A.getAriaLabel,K=A.getAriaValueText,Z=A.marks,J=void 0!==Z&&Z,Q=A.max,Ee=void 0===Q?100:Q,we=A.min,Ae=void 0===we?0:we,Re=A.orientation,Ce=void 0===Re?"horizontal":Re,Le=A.shiftStep,Ie=void 0===Le?10:Le,De=A.size,Be=void 0===De?"medium":De,Ze=A.step,Je=void 0===Ze?1:Ze,Qe=A.scale,$e=void 0===Qe?ze:Qe,et=A.slotProps,tt=A.slots,nt=A.track,rt=void 0===nt?"normal":nt,at=A.valueLabelDisplay,it=void 0===at?"off":at,ot=A.valueLabelFormat,st=void 0===ot?ze:ot,lt=Object($.a)(A,je),ct=Object(ee.a)({},A,{isRtl:R,max:Ee,min:Ae,classes:H,disabled:q,disableSwap:W,orientation:Ce,marks:J,color:B,size:Be,step:Je,shiftStep:Ie,scale:$e,track:rt,valueLabelDisplay:it,valueLabelFormat:st}),ut=function(e){var t=e["aria-labelledby"],n=e.defaultValue,i=e.disabled,o=void 0!==i&&i,s=e.disableSwap,l=void 0!==s&&s,c=e.isRtl,u=void 0!==c&&c,d=e.marks,h=void 0!==d&&d,f=e.max,p=void 0===f?100:f,m=e.min,v=void 0===m?0:m,g=e.name,y=e.onChange,b=e.onChangeCommitted,_=e.orientation,x=void 0===_?"horizontal":_,E=e.rootRef,S=e.scale,M=void 0===S?Me:S,T=e.step,w=void 0===T?1:T,O=e.shiftStep,A=void 0===O?10:O,R=e.tabIndex,C=e.value,k=a.useRef(),P=a.useState(-1),L=Object(r.a)(P,2),I=L[0],N=L[1],D=a.useState(-1),j=Object(r.a)(D,2),F=j[0],z=j[1],B=a.useState(!1),H=Object(r.a)(B,2),V=H[0],G=H[1],W=a.useRef(0),X=Object(oe.a)({controlled:C,default:null!=n?n:v,name:"Slider"}),q=Object(r.a)(X,2),Y=q[0],K=q[1],Z=y&&function(e,t,n){var r=e.nativeEvent||e,a=new r.constructor(r.type,r);Object.defineProperty(a,"target",{writable:!0,value:{value:t,name:g}}),y(a,t,n)},J=Array.isArray(Y),Q=J?Y.slice().sort(pe):[Y];Q=Q.map((function(e){return null==e?v:Object(se.a)(e,v,p)}));var $=!0===h&&null!==w?Object(U.a)(Array(Math.floor((p-v)/w)+1)).map((function(e,t){return{value:v+w*t}})):h||[],te=$.map((function(e){return e.value})),ne=Object(le.a)(),re=ne.isFocusVisibleRef,ae=ne.onBlur,Ee=ne.onFocus,we=ne.ref,Oe=a.useState(-1),Ae=Object(r.a)(Oe,2),Re=Ae[0],Ce=Ae[1],ke=a.useRef(),Pe=Object(ce.a)(we,ke),Le=Object(ce.a)(E,Pe),Ie=function(e){return function(t){var n,r=Number(t.currentTarget.getAttribute("data-index"));Ee(t),!0===re.current&&Ce(r),z(r),null==e||null==(n=e.onFocus)||n.call(e,t)}},Ne=function(e){return function(t){var n;ae(t),!1===re.current&&Ce(-1),z(-1),null==e||null==(n=e.onBlur)||n.call(e,t)}},De=function(e,t){var n=Number(e.currentTarget.getAttribute("data-index")),r=Q[n],a=te.indexOf(r),i=t;if($&&null==w){var o=te[te.length-1];i=i>o?o:i<te[0]?te[0]:i<r?te[a-1]:te[a+1]}if(i=Object(se.a)(i,v,p),J){l&&(i=Object(se.a)(i,Q[n-1]||-1/0,Q[n+1]||1/0));var s=i;i=be({values:Q,newValue:i,index:n});var c=n;l||(c=i.indexOf(s)),_e({sliderRef:ke,activeIndex:c})}K(i),Ce(n),Z&&!xe(i,Y)&&Z(e,i,n),b&&b(e,i)},Ue=function(e){return function(t){var n;if(null!==w){var r=Number(t.currentTarget.getAttribute("data-index")),a=Q[r],i=null;("ArrowLeft"===t.key||"ArrowDown"===t.key)&&t.shiftKey||"PageDown"===t.key?i=Math.max(a-A,v):(("ArrowRight"===t.key||"ArrowUp"===t.key)&&t.shiftKey||"PageUp"===t.key)&&(i=Math.min(a+A,p)),null!==i&&(De(t,i),t.preventDefault())}null==e||null==(n=e.onKeyDown)||n.call(e,t)}};Object(ue.a)((function(){var e;o&&ke.current.contains(document.activeElement)&&(null==(e=document.activeElement)||e.blur())}),[o]),o&&-1!==I&&N(-1),o&&-1!==Re&&Ce(-1);var je=function(e){return function(t){var n;null==(n=e.onChange)||n.call(e,t),De(t,t.target.valueAsNumber)}},Fe=a.useRef(),ze=x;u&&"horizontal"===x&&(ze+="-reverse");var Be=function(e){var t,n,r=e.finger,a=e.move,i=void 0!==a&&a,o=ke.current.getBoundingClientRect(),s=o.width,c=o.height,u=o.bottom,d=o.left;if(t=0===ze.indexOf("vertical")?(u-r.y)/c:(r.x-d)/s,-1!==ze.indexOf("-reverse")&&(t=1-t),n=function(e,t,n){return(n-t)*e+t}(t,v,p),w)n=ye(n,w,v);else{var h=me(te,n);n=te[h]}n=Object(se.a)(n,v,p);var f=0;if(J){f=i?Fe.current:me(Q,n),l&&(n=Object(se.a)(n,Q[f-1]||-1/0,Q[f+1]||1/0));var m=n;n=be({values:Q,newValue:n,index:f}),l&&i||(f=n.indexOf(m),Fe.current=f)}return{newValue:n,activeIndex:f}},He=Object(de.a)((function(e){var t=ve(e,k);if(t)if(W.current+=1,"mousemove"!==e.type||0!==e.buttons){var n=Be({finger:t,move:!0}),r=n.newValue,a=n.activeIndex;_e({sliderRef:ke,activeIndex:a,setActive:N}),K(r),!V&&W.current>2&&G(!0),Z&&!xe(r,Y)&&Z(e,r,a)}else Ve(e)})),Ve=Object(de.a)((function(e){var t=ve(e,k);if(G(!1),t){var n=Be({finger:t,move:!0}).newValue;N(-1),"touchend"===e.type&&z(-1),b&&b(e,n),k.current=void 0,We()}})),Ge=Object(de.a)((function(e){if(!o){Te()||e.preventDefault();var t=e.changedTouches[0];null!=t&&(k.current=t.identifier);var n=ve(e,k);if(!1!==n){var r=Be({finger:n}),a=r.newValue,i=r.activeIndex;_e({sliderRef:ke,activeIndex:i,setActive:N}),K(a),Z&&!xe(a,Y)&&Z(e,a,i)}W.current=0;var s=Object(ie.a)(ke.current);s.addEventListener("touchmove",He,{passive:!0}),s.addEventListener("touchend",Ve,{passive:!0})}})),We=a.useCallback((function(){var e=Object(ie.a)(ke.current);e.removeEventListener("mousemove",He),e.removeEventListener("mouseup",Ve),e.removeEventListener("touchmove",He),e.removeEventListener("touchend",Ve)}),[Ve,He]);a.useEffect((function(){var e=ke.current;return e.addEventListener("touchstart",Ge,{passive:Te()}),function(){e.removeEventListener("touchstart",Ge),We()}}),[We,Ge]),a.useEffect((function(){o&&We()}),[o,We]);var Xe=function(e){return function(t){var n;if(null==(n=e.onMouseDown)||n.call(e,t),!o&&!t.defaultPrevented&&0===t.button){t.preventDefault();var r=ve(t,k);if(!1!==r){var a=Be({finger:r}),i=a.newValue,s=a.activeIndex;_e({sliderRef:ke,activeIndex:s,setActive:N}),K(i),Z&&!xe(i,Y)&&Z(t,i,s)}W.current=0;var l=Object(ie.a)(ke.current);l.addEventListener("mousemove",He,{passive:!0}),l.addEventListener("mouseup",Ve)}}},qe=ge(J?Q[0]:v,v,p),Ye=ge(Q[Q.length-1],v,p)-qe,Ke=function(e){return function(t){var n;null==(n=e.onMouseOver)||n.call(e,t);var r=Number(t.currentTarget.getAttribute("data-index"));z(r)}},Ze=function(e){return function(t){var n;null==(n=e.onMouseLeave)||n.call(e,t),z(-1)}};return{active:I,axis:ze,axisProps:Se,dragging:V,focusedThumbIndex:Re,getHiddenInputProps:function(){var n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=Object(fe.a)(r),i={onChange:je(a||{}),onFocus:Ie(a||{}),onBlur:Ne(a||{}),onKeyDown:Ue(a||{})},s=Object(ee.a)({},a,i);return Object(ee.a)({tabIndex:R,"aria-labelledby":t,"aria-orientation":x,"aria-valuemax":M(p),"aria-valuemin":M(v),name:g,type:"range",min:e.min,max:e.max,step:null===e.step&&e.marks?"any":null!=(n=e.step)?n:void 0,disabled:o},r,s,{style:Object(ee.a)({},he,{direction:u?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(fe.a)(e),n={onMouseDown:Xe(t||{})},r=Object(ee.a)({},t,n);return Object(ee.a)({},e,{ref:Le},r)},getThumbProps:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object(fe.a)(e),n={onMouseOver:Ke(t||{}),onMouseLeave:Ze(t||{})};return Object(ee.a)({},e,t,n)},marks:$,open:F,range:J,rootRef:Le,trackLeap:Ye,trackOffset:qe,values:Q,getThumbStyle:function(e){return{pointerEvents:-1!==I&&I!==e?"none":void 0}}}}(Object(ee.a)({},ct,{rootRef:t})),dt=ut.axisProps,ht=ut.getRootProps,ft=ut.getHiddenInputProps,pt=ut.getThumbProps,mt=ut.open,vt=ut.active,gt=ut.axis,yt=ut.focusedThumbIndex,bt=ut.range,_t=ut.dragging,xt=ut.marks,Et=ut.values,St=ut.trackOffset,Mt=ut.trackLeap,Tt=ut.getThumbStyle;ct.marked=xt.length>0&&xt.some((function(e){return e.label})),ct.dragging=_t,ct.focusedThumbIndex=yt;var wt=function(e){var t=e.disabled,n=e.dragging,r=e.marked,a=e.orientation,i=e.track,o=e.classes,s=e.color,l=e.size,c={root:["root",t&&"disabled",n&&"dragging",r&&"marked","vertical"===a&&"vertical","inverted"===i&&"trackInverted",!1===i&&"trackFalse",s&&"color".concat(Object(Pe.a)(s)),l&&"size".concat(Object(Pe.a)(l))],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",t&&"disabled",l&&"thumbSize".concat(Object(Pe.a)(l)),s&&"thumbColor".concat(Object(Pe.a)(s))],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return Object(ae.a)(c,Ne,o)}(ct),Ot=null!=(n=null!=(i=null==tt?void 0:tt.root)?i:D.Root)?n:He,At=null!=(o=null!=(s=null==tt?void 0:tt.rail)?s:D.Rail)?o:Ve,Rt=null!=(l=null!=(c=null==tt?void 0:tt.track)?c:D.Track)?l:Ge,Ct=null!=(u=null!=(d=null==tt?void 0:tt.thumb)?d:D.Thumb)?u:We,kt=null!=(h=null!=(f=null==tt?void 0:tt.valueLabel)?f:D.ValueLabel)?h:Xe,Pt=null!=(p=null!=(m=null==tt?void 0:tt.mark)?m:D.Mark)?p:qe,Lt=null!=(v=null!=(g=null==tt?void 0:tt.markLabel)?g:D.MarkLabel)?v:Ye,It=null!=(y=null!=(b=null==tt?void 0:tt.input)?b:D.Input)?y:"input",Nt=null!=(_=null==et?void 0:et.root)?_:F.root,Dt=null!=(x=null==et?void 0:et.rail)?x:F.rail,Ut=null!=(E=null==et?void 0:et.track)?E:F.track,jt=null!=(S=null==et?void 0:et.thumb)?S:F.thumb,Ft=null!=(M=null==et?void 0:et.valueLabel)?M:F.valueLabel,zt=null!=(T=null==et?void 0:et.mark)?T:F.mark,Bt=null!=(w=null==et?void 0:et.markLabel)?w:F.markLabel,Ht=null!=(O=null==et?void 0:et.input)?O:F.input,Vt=Object(ne.a)({elementType:Ot,getSlotProps:ht,externalSlotProps:Nt,externalForwardedProps:lt,additionalProps:Object(ee.a)({},ke(Ot)&&{as:I}),ownerState:Object(ee.a)({},ct,null==Nt?void 0:Nt.ownerState),className:[wt.root,V]}),Gt=Object(ne.a)({elementType:At,externalSlotProps:Dt,ownerState:ct,className:wt.rail}),Wt=Object(ne.a)({elementType:Rt,externalSlotProps:Ut,additionalProps:{style:Object(ee.a)({},dt[gt].offset(St),dt[gt].leap(Mt))},ownerState:Object(ee.a)({},ct,null==Ut?void 0:Ut.ownerState),className:wt.track}),Xt=Object(ne.a)({elementType:Ct,getSlotProps:pt,externalSlotProps:jt,ownerState:Object(ee.a)({},ct,null==jt?void 0:jt.ownerState),className:wt.thumb}),qt=Object(ne.a)({elementType:kt,externalSlotProps:Ft,ownerState:Object(ee.a)({},ct,null==Ft?void 0:Ft.ownerState),className:wt.valueLabel}),Yt=Object(ne.a)({elementType:Pt,externalSlotProps:zt,ownerState:ct,className:wt.mark}),Kt=Object(ne.a)({elementType:Lt,externalSlotProps:Bt,ownerState:ct,className:wt.markLabel}),Zt=Object(ne.a)({elementType:It,getSlotProps:ft,externalSlotProps:Ht,ownerState:ct});return Object(Ue.jsxs)(Ot,Object(ee.a)({},Vt,{children:[Object(Ue.jsx)(At,Object(ee.a)({},Gt)),Object(Ue.jsx)(Rt,Object(ee.a)({},Wt)),xt.filter((function(e){return e.value>=Ae&&e.value<=Ee})).map((function(e,t){var n,r=ge(e.value,Ae,Ee),i=dt[gt].offset(r);return n=!1===rt?-1!==Et.indexOf(e.value):"normal"===rt&&(bt?e.value>=Et[0]&&e.value<=Et[Et.length-1]:e.value<=Et[0])||"inverted"===rt&&(bt?e.value<=Et[0]||e.value>=Et[Et.length-1]:e.value>=Et[0]),Object(Ue.jsxs)(a.Fragment,{children:[Object(Ue.jsx)(Pt,Object(ee.a)({"data-index":t},Yt,!Object(re.a)(Pt)&&{markActive:n},{style:Object(ee.a)({},i,Yt.style),className:Object(te.a)(Yt.className,n&&wt.markActive)})),null!=e.label?Object(Ue.jsx)(Lt,Object(ee.a)({"aria-hidden":!0,"data-index":t},Kt,!Object(re.a)(Lt)&&{markLabelActive:n},{style:Object(ee.a)({},i,Kt.style),className:Object(te.a)(wt.markLabel,Kt.className,n&&wt.markLabelActive),children:e.label})):null]},t)})),Et.map((function(e,t){var n=ge(e,Ae,Ee),r=dt[gt].offset(n),a="off"===it?Ke:kt;return Object(Ue.jsx)(a,Object(ee.a)({},!Object(re.a)(a)&&{valueLabelFormat:st,valueLabelDisplay:it,value:"function"===typeof st?st($e(e),t):st,index:t,open:mt===t||vt===t||"on"===it,disabled:q},qt,{children:Object(Ue.jsx)(Ct,Object(ee.a)({"data-index":t},Xt,{className:Object(te.a)(wt.thumb,Xt.className,vt===t&&wt.active,yt===t&&wt.focusVisible),style:Object(ee.a)({},r,Tt(t),Xt.style),children:Object(Ue.jsx)(It,Object(ee.a)({"data-index":t,"aria-label":Y?Y(t):C,"aria-valuenow":$e(e),"aria-labelledby":P,"aria-valuetext":K?K($e(e),t):k,value:Et[t]},Zt))}))}),t)}))]}))})),Je=n(1017),Qe=n(1041),$e=n.n(Qe),et=n(1042),tt=n.n(et),nt=n(995),rt=n.n(nt),at=(n(1047),n(334)),it=n(1048),ot=n(343);function st(){if(Be)return Be;var e=document.createElement("div"),t=document.createElement("div");return t.style.width="10px",t.style.height="1px",e.appendChild(t),e.dir="rtl",e.style.fontSize="14px",e.style.width="4px",e.style.height="1px",e.style.position="absolute",e.style.top="-1000px",e.style.overflow="scroll",document.body.appendChild(e),Be="reverse",e.scrollLeft>0?Be="default":(e.scrollLeft=1,0===e.scrollLeft&&(Be="negative")),document.body.removeChild(e),Be}function lt(e,t){var n=e.scrollLeft;if("rtl"!==t)return n;switch(st()){case"negative":return e.scrollWidth-e.clientWidth+n;case"reverse":return e.scrollWidth-e.clientWidth-n;default:return n}}function ct(e){return(1+Math.sin(Math.PI*e-Math.PI/2))/2}function ut(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},i=r.ease,o=void 0===i?ct:i,s=r.duration,l=void 0===s?300:s,c=null,u=t[e],d=!1,h=function(){d=!0},f=function r(i){if(d)a(new Error("Animation cancelled"));else{null===c&&(c=i);var s=Math.min(1,(i-c)/l);t[e]=o(s)*(n-u)+u,s>=1?requestAnimationFrame((function(){a(null)})):requestAnimationFrame(r)}};return u===n?(a(new Error("Element already at target position")),h):(requestAnimationFrame(f),h)}var dt=n(346),ht=n(345),ft=["onChange"],pt={width:99,height:99,position:"absolute",top:-9999,overflow:"scroll"};var mt=n(1077),vt=n(1076),gt=n(1382);function yt(e){return Object(Ie.a)("MuiTabScrollButton",e)}var bt=Object(Le.a)("MuiTabScrollButton",["root","vertical","horizontal","disabled"]),_t=["className","slots","slotProps","direction","orientation","disabled"],xt=Object(Re.a)(gt.a,{name:"MuiTabScrollButton",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.orientation&&t[n.orientation]]}})((function(e){var t=e.ownerState;return Object(ee.a)(Object(Q.a)({width:40,flexShrink:0,opacity:.8},"&.".concat(bt.disabled),{opacity:0}),"vertical"===t.orientation&&{width:"100%",height:40,"& svg":{transform:"rotate(".concat(t.isRtl?-90:90,"deg)")}})})),Et=a.forwardRef((function(e,t){var n,r,a=Object(at.a)({props:e,name:"MuiTabScrollButton"}),i=a.className,o=a.slots,s=void 0===o?{}:o,l=a.slotProps,c=void 0===l?{}:l,u=a.direction,d=Object($.a)(a,_t),h=Object(Oe.b)(),f=Object(ee.a)({isRtl:h},a),p=function(e){var t=e.classes,n={root:["root",e.orientation,e.disabled&&"disabled"]};return Object(ae.a)(n,yt,t)}(f),m=null!=(n=s.StartScrollButtonIcon)?n:mt.a,v=null!=(r=s.EndScrollButtonIcon)?r:vt.a,g=Object(ne.a)({elementType:m,externalSlotProps:c.startScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:f}),y=Object(ne.a)({elementType:v,externalSlotProps:c.endScrollButtonIcon,additionalProps:{fontSize:"small"},ownerState:f});return Object(Ue.jsx)(xt,Object(ee.a)({component:"div",className:Object(te.a)(p.root,i),ref:t,role:null,ownerState:f,tabIndex:null},d,{children:"left"===u?Object(Ue.jsx)(m,Object(ee.a)({},g)):Object(Ue.jsx)(v,Object(ee.a)({},y))}))})),St=n(347);function Mt(e){return Object(Ie.a)("MuiTabs",e)}var Tt=Object(Le.a)("MuiTabs",["root","vertical","flexContainer","flexContainerVertical","centered","scroller","fixed","scrollableX","scrollableY","hideScrollbar","scrollButtons","scrollButtonsHideMobile","indicator"]),wt=n(344),Ot=["aria-label","aria-labelledby","action","centered","children","className","component","allowScrollButtonsMobile","indicatorColor","onChange","orientation","ScrollButtonComponent","scrollButtons","selectionFollowsFocus","slots","slotProps","TabIndicatorProps","TabScrollButtonProps","textColor","value","variant","visibleScrollbar"],At=function(e,t){return e===t?e.firstChild:t&&t.nextElementSibling?t.nextElementSibling:e.firstChild},Rt=function(e,t){return e===t?e.lastChild:t&&t.previousElementSibling?t.previousElementSibling:e.lastChild},Ct=function(e,t,n){for(var r=!1,a=n(e,t);a;){if(a===e.firstChild){if(r)return;r=!0}var i=a.disabled||"true"===a.getAttribute("aria-disabled");if(a.hasAttribute("tabindex")&&!i)return void a.focus();a=n(e,a)}},kt=Object(Re.a)("div",{name:"MuiTabs",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[Object(Q.a)({},"& .".concat(Tt.scrollButtons),t.scrollButtons),Object(Q.a)({},"& .".concat(Tt.scrollButtons),n.scrollButtonsHideMobile&&t.scrollButtonsHideMobile),t.root,n.vertical&&t.vertical]}})((function(e){var t=e.ownerState,n=e.theme;return Object(ee.a)({overflow:"hidden",minHeight:48,WebkitOverflowScrolling:"touch",display:"flex"},t.vertical&&{flexDirection:"column"},t.scrollButtonsHideMobile&&Object(Q.a)({},"& .".concat(Tt.scrollButtons),Object(Q.a)({},n.breakpoints.down("sm"),{display:"none"})))})),Pt=Object(Re.a)("div",{name:"MuiTabs",slot:"Scroller",overridesResolver:function(e,t){var n=e.ownerState;return[t.scroller,n.fixed&&t.fixed,n.hideScrollbar&&t.hideScrollbar,n.scrollableX&&t.scrollableX,n.scrollableY&&t.scrollableY]}})((function(e){var t=e.ownerState;return Object(ee.a)({position:"relative",display:"inline-block",flex:"1 1 auto",whiteSpace:"nowrap"},t.fixed&&{overflowX:"hidden",width:"100%"},t.hideScrollbar&&{scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}},t.scrollableX&&{overflowX:"auto",overflowY:"hidden"},t.scrollableY&&{overflowY:"auto",overflowX:"hidden"})})),Lt=Object(Re.a)("div",{name:"MuiTabs",slot:"FlexContainer",overridesResolver:function(e,t){var n=e.ownerState;return[t.flexContainer,n.vertical&&t.flexContainerVertical,n.centered&&t.centered]}})((function(e){var t=e.ownerState;return Object(ee.a)({display:"flex"},t.vertical&&{flexDirection:"column"},t.centered&&{justifyContent:"center"})})),It=Object(Re.a)("span",{name:"MuiTabs",slot:"Indicator",overridesResolver:function(e,t){return t.indicator}})((function(e){var t=e.ownerState,n=e.theme;return Object(ee.a)({position:"absolute",height:2,bottom:0,width:"100%",transition:n.transitions.create()},"primary"===t.indicatorColor&&{backgroundColor:(n.vars||n).palette.primary.main},"secondary"===t.indicatorColor&&{backgroundColor:(n.vars||n).palette.secondary.main},t.vertical&&{height:"100%",width:2,right:0})})),Nt=Object(Re.a)((function(e){var t=e.onChange,n=Object($.a)(e,ft),r=a.useRef(),i=a.useRef(null),o=function(){r.current=i.current.offsetHeight-i.current.clientHeight};return Object(dt.a)((function(){var e=Object(ot.a)((function(){var e=r.current;o(),e!==r.current&&t(r.current)})),n=Object(ht.a)(i.current);return n.addEventListener("resize",e),function(){e.clear(),n.removeEventListener("resize",e)}}),[t]),a.useEffect((function(){o(),t(r.current)}),[t]),Object(Ue.jsx)("div",Object(ee.a)({style:pt,ref:i},n))}))({overflowX:"auto",overflowY:"hidden",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}),Dt={},Ut=a.forwardRef((function(e,t){var n=Object(at.a)({props:e,name:"MuiTabs"}),i=Object(it.a)(),o=Object(Oe.b)(),s=n["aria-label"],l=n["aria-labelledby"],c=n.action,u=n.centered,d=void 0!==u&&u,h=n.children,f=n.className,p=n.component,m=void 0===p?"div":p,v=n.allowScrollButtonsMobile,g=void 0!==v&&v,y=n.indicatorColor,b=void 0===y?"primary":y,_=n.onChange,x=n.orientation,E=void 0===x?"horizontal":x,S=n.ScrollButtonComponent,M=void 0===S?Et:S,T=n.scrollButtons,w=void 0===T?"auto":T,O=n.selectionFollowsFocus,A=n.slots,R=void 0===A?{}:A,C=n.slotProps,k=void 0===C?{}:C,P=n.TabIndicatorProps,L=void 0===P?{}:P,I=n.TabScrollButtonProps,N=void 0===I?{}:I,D=n.textColor,U=void 0===D?"primary":D,j=n.value,F=n.variant,z=void 0===F?"standard":F,B=n.visibleScrollbar,H=void 0!==B&&B,V=Object($.a)(n,Ot),G="scrollable"===z,W="vertical"===E,X=W?"scrollTop":"scrollLeft",q=W?"top":"left",Y=W?"bottom":"right",K=W?"clientHeight":"clientWidth",Z=W?"height":"width",J=Object(ee.a)({},n,{component:m,allowScrollButtonsMobile:g,indicatorColor:b,orientation:E,vertical:W,scrollButtons:w,textColor:U,variant:z,visibleScrollbar:H,fixed:!G,hideScrollbar:G&&!H,scrollableX:G&&!W,scrollableY:G&&W,centered:d&&!G,scrollButtonsHideMobile:!g}),re=function(e){var t=e.vertical,n=e.fixed,r=e.hideScrollbar,a=e.scrollableX,i=e.scrollableY,o=e.centered,s=e.scrollButtonsHideMobile,l=e.classes,c={root:["root",t&&"vertical"],scroller:["scroller",n&&"fixed",r&&"hideScrollbar",a&&"scrollableX",i&&"scrollableY"],flexContainer:["flexContainer",t&&"flexContainerVertical",o&&"centered"],indicator:["indicator"],scrollButtons:["scrollButtons",s&&"scrollButtonsHideMobile"],scrollableX:[a&&"scrollableX"],hideScrollbar:[r&&"hideScrollbar"]};return Object(ae.a)(c,Mt,l)}(J),ie=Object(ne.a)({elementType:R.StartScrollButtonIcon,externalSlotProps:k.startScrollButtonIcon,ownerState:J}),oe=Object(ne.a)({elementType:R.EndScrollButtonIcon,externalSlotProps:k.endScrollButtonIcon,ownerState:J});var se=a.useState(!1),le=Object(r.a)(se,2),ce=le[0],ue=le[1],de=a.useState(Dt),he=Object(r.a)(de,2),fe=he[0],pe=he[1],me=a.useState(!1),ve=Object(r.a)(me,2),ge=ve[0],ye=ve[1],be=a.useState(!1),_e=Object(r.a)(be,2),xe=_e[0],Ee=_e[1],Se=a.useState(!1),Me=Object(r.a)(Se,2),Te=Me[0],we=Me[1],Ae=a.useState({overflow:"hidden",scrollbarWidth:0}),Re=Object(r.a)(Ae,2),Ce=Re[0],ke=Re[1],Pe=new Map,Le=a.useRef(null),Ie=a.useRef(null),Ne=function(){var e,t,n=Le.current;if(n){var r=n.getBoundingClientRect();e={clientWidth:n.clientWidth,scrollLeft:n.scrollLeft,scrollTop:n.scrollTop,scrollLeftNormalized:lt(n,o?"rtl":"ltr"),scrollWidth:n.scrollWidth,top:r.top,bottom:r.bottom,left:r.left,right:r.right}}if(n&&!1!==j){var a=Ie.current.children;if(a.length>0){var i=a[Pe.get(j)];0,t=i?i.getBoundingClientRect():null}}return{tabsMeta:e,tabMeta:t}},De=Object(St.a)((function(){var e,t=Ne(),n=t.tabsMeta,r=t.tabMeta,a=0;if(W)e="top",r&&n&&(a=r.top-n.top+n.scrollTop);else if(e=o?"right":"left",r&&n){var i=o?n.scrollLeftNormalized+n.clientWidth-n.scrollWidth:n.scrollLeft;a=(o?-1:1)*(r[e]-n[e]+i)}var s=Object(Q.a)(Object(Q.a)({},e,a),Z,r?r[Z]:0);if(isNaN(fe[e])||isNaN(fe[Z]))pe(s);else{var l=Math.abs(fe[e]-s[e]),c=Math.abs(fe[Z]-s[Z]);(l>=1||c>=1)&&pe(s)}})),je=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.animation,r=void 0===n||n;r?ut(X,Le.current,e,{duration:i.transitions.duration.standard}):Le.current[X]=e},Fe=function(e){var t=Le.current[X];W?t+=e:(t+=e*(o?-1:1),t*=o&&"reverse"===st()?-1:1),je(t)},ze=function(){for(var e=Le.current[K],t=0,n=Array.from(Ie.current.children),r=0;r<n.length;r+=1){var a=n[r];if(t+a[K]>e){0===r&&(t=e);break}t+=a[K]}return t},Be=function(){Fe(-1*ze())},He=function(){Fe(ze())},Ve=a.useCallback((function(e){ke({overflow:null,scrollbarWidth:e})}),[]),Ge=Object(St.a)((function(e){var t=Ne(),n=t.tabsMeta,r=t.tabMeta;if(r&&n)if(r[q]<n[q]){var a=n[X]+(r[q]-n[q]);je(a,{animation:e})}else if(r[Y]>n[Y]){var i=n[X]+(r[Y]-n[Y]);je(i,{animation:e})}})),We=Object(St.a)((function(){G&&!1!==w&&we(!Te)}));a.useEffect((function(){var e,t,n=Object(ot.a)((function(){Le.current&&De()})),r=Object(ht.a)(Le.current);return r.addEventListener("resize",n),"undefined"!==typeof ResizeObserver&&(e=new ResizeObserver(n),Array.from(Ie.current.children).forEach((function(t){e.observe(t)}))),"undefined"!==typeof MutationObserver&&(t=new MutationObserver((function(t){t.forEach((function(t){t.removedNodes.forEach((function(t){var n;null==(n=e)||n.unobserve(t)})),t.addedNodes.forEach((function(t){var n;null==(n=e)||n.observe(t)}))})),n(),We()}))).observe(Ie.current,{childList:!0}),function(){var a,i;n.clear(),r.removeEventListener("resize",n),null==(a=t)||a.disconnect(),null==(i=e)||i.disconnect()}}),[De,We]),a.useEffect((function(){var e=Array.from(Ie.current.children),t=e.length;if("undefined"!==typeof IntersectionObserver&&t>0&&G&&!1!==w){var n=e[0],r=e[t-1],a={root:Le.current,threshold:.99},i=new IntersectionObserver((function(e){ye(!e[0].isIntersecting)}),a);i.observe(n);var o=new IntersectionObserver((function(e){Ee(!e[0].isIntersecting)}),a);return o.observe(r),function(){i.disconnect(),o.disconnect()}}}),[G,w,Te,null==h?void 0:h.length]),a.useEffect((function(){ue(!0)}),[]),a.useEffect((function(){De()})),a.useEffect((function(){Ge(Dt!==fe)}),[Ge,fe]),a.useImperativeHandle(c,(function(){return{updateIndicator:De,updateScrollButtons:We}}),[De,We]);var Xe=Object(Ue.jsx)(It,Object(ee.a)({},L,{className:Object(te.a)(re.indicator,L.className),ownerState:J,style:Object(ee.a)({},fe,L.style)})),qe=0,Ye=a.Children.map(h,(function(e){if(!a.isValidElement(e))return null;var t=void 0===e.props.value?qe:e.props.value;Pe.set(t,qe);var n=t===j;return qe+=1,a.cloneElement(e,Object(ee.a)({fullWidth:"fullWidth"===z,indicator:n&&!ce&&Xe,selected:n,selectionFollowsFocus:O,onChange:_,textColor:U,value:t},1!==qe||!1!==j||e.props.tabIndex?{}:{tabIndex:0}))})),Ke=function(){var e={};e.scrollbarSizeListener=G?Object(Ue.jsx)(Nt,{onChange:Ve,className:Object(te.a)(re.scrollableX,re.hideScrollbar)}):null;var t=G&&("auto"===w&&(ge||xe)||!0===w);return e.scrollButtonStart=t?Object(Ue.jsx)(M,Object(ee.a)({slots:{StartScrollButtonIcon:R.StartScrollButtonIcon},slotProps:{startScrollButtonIcon:ie},orientation:E,direction:o?"right":"left",onClick:Be,disabled:!ge},N,{className:Object(te.a)(re.scrollButtons,N.className)})):null,e.scrollButtonEnd=t?Object(Ue.jsx)(M,Object(ee.a)({slots:{EndScrollButtonIcon:R.EndScrollButtonIcon},slotProps:{endScrollButtonIcon:oe},orientation:E,direction:o?"left":"right",onClick:He,disabled:!xe},N,{className:Object(te.a)(re.scrollButtons,N.className)})):null,e}();return Object(Ue.jsxs)(kt,Object(ee.a)({className:Object(te.a)(re.root,f),ownerState:J,ref:t,as:m},V,{children:[Ke.scrollButtonStart,Ke.scrollbarSizeListener,Object(Ue.jsxs)(Pt,{className:re.scroller,ownerState:J,style:Object(Q.a)({overflow:Ce.overflow},W?"margin".concat(o?"Left":"Right"):"marginBottom",H?void 0:-Ce.scrollbarWidth),ref:Le,children:[Object(Ue.jsx)(Lt,{"aria-label":s,"aria-labelledby":l,"aria-orientation":"vertical"===E?"vertical":null,className:re.flexContainer,ownerState:J,onKeyDown:function(e){var t=Ie.current,n=Object(wt.a)(t).activeElement;if("tab"===n.getAttribute("role")){var r="horizontal"===E?"ArrowLeft":"ArrowUp",a="horizontal"===E?"ArrowRight":"ArrowDown";switch("horizontal"===E&&o&&(r="ArrowRight",a="ArrowLeft"),e.key){case r:e.preventDefault(),Ct(t,n,Rt);break;case a:e.preventDefault(),Ct(t,n,At);break;case"Home":e.preventDefault(),Ct(t,null,At);break;case"End":e.preventDefault(),Ct(t,null,Rt)}}},ref:Ie,role:"tablist",children:Ye}),ce&&Xe]}),Ke.scrollButtonEnd]}))}));function jt(e){return Object(Ie.a)("MuiTab",e)}var Ft=Object(Le.a)("MuiTab",["root","labelIcon","textColorInherit","textColorPrimary","textColorSecondary","selected","disabled","fullWidth","wrapped","iconWrapper"]),zt=["className","disabled","disableFocusRipple","fullWidth","icon","iconPosition","indicator","label","onChange","onClick","onFocus","selected","selectionFollowsFocus","textColor","value","wrapped"],Bt=Object(Re.a)(gt.a,{name:"MuiTab",slot:"Root",overridesResolver:function(e,t){var n=e.ownerState;return[t.root,n.label&&n.icon&&t.labelIcon,t["textColor".concat(Object(Pe.a)(n.textColor))],n.fullWidth&&t.fullWidth,n.wrapped&&t.wrapped,Object(Q.a)({},"& .".concat(Ft.iconWrapper),t.iconWrapper)]}})((function(e){var t=e.theme,n=e.ownerState;return Object(ee.a)({},t.typography.button,{maxWidth:360,minWidth:90,position:"relative",minHeight:48,flexShrink:0,padding:"12px 16px",overflow:"hidden",whiteSpace:"normal",textAlign:"center"},n.label&&{flexDirection:"top"===n.iconPosition||"bottom"===n.iconPosition?"column":"row"},{lineHeight:1.25},n.icon&&n.label&&Object(Q.a)({minHeight:72,paddingTop:9,paddingBottom:9},"& > .".concat(Ft.iconWrapper),Object(ee.a)({},"top"===n.iconPosition&&{marginBottom:6},"bottom"===n.iconPosition&&{marginTop:6},"start"===n.iconPosition&&{marginRight:t.spacing(1)},"end"===n.iconPosition&&{marginLeft:t.spacing(1)})),"inherit"===n.textColor&&Object(Q.a)(Object(Q.a)({color:"inherit",opacity:.6},"&.".concat(Ft.selected),{opacity:1}),"&.".concat(Ft.disabled),{opacity:(t.vars||t).palette.action.disabledOpacity}),"primary"===n.textColor&&Object(Q.a)(Object(Q.a)({color:(t.vars||t).palette.text.secondary},"&.".concat(Ft.selected),{color:(t.vars||t).palette.primary.main}),"&.".concat(Ft.disabled),{color:(t.vars||t).palette.text.disabled}),"secondary"===n.textColor&&Object(Q.a)(Object(Q.a)({color:(t.vars||t).palette.text.secondary},"&.".concat(Ft.selected),{color:(t.vars||t).palette.secondary.main}),"&.".concat(Ft.disabled),{color:(t.vars||t).palette.text.disabled}),n.fullWidth&&{flexShrink:1,flexGrow:1,flexBasis:0,maxWidth:"none"},n.wrapped&&{fontSize:t.typography.pxToRem(12)})})),Ht=a.forwardRef((function(e,t){var n=Object(at.a)({props:e,name:"MuiTab"}),r=n.className,i=n.disabled,o=void 0!==i&&i,s=n.disableFocusRipple,l=void 0!==s&&s,c=n.fullWidth,u=n.icon,d=n.iconPosition,h=void 0===d?"top":d,f=n.indicator,p=n.label,m=n.onChange,v=n.onClick,g=n.onFocus,y=n.selected,b=n.selectionFollowsFocus,_=n.textColor,x=void 0===_?"inherit":_,E=n.value,S=n.wrapped,M=void 0!==S&&S,T=Object($.a)(n,zt),w=Object(ee.a)({},n,{disabled:o,disableFocusRipple:l,selected:y,icon:!!u,iconPosition:h,label:!!p,fullWidth:c,textColor:x,wrapped:M}),O=function(e){var t=e.classes,n=e.textColor,r=e.fullWidth,a=e.wrapped,i=e.icon,o=e.label,s=e.selected,l=e.disabled,c={root:["root",i&&o&&"labelIcon","textColor".concat(Object(Pe.a)(n)),r&&"fullWidth",a&&"wrapped",s&&"selected",l&&"disabled"],iconWrapper:["iconWrapper"]};return Object(ae.a)(c,jt,t)}(w),A=u&&p&&a.isValidElement(u)?a.cloneElement(u,{className:Object(te.a)(O.iconWrapper,u.props.className)}):u;return Object(Ue.jsxs)(Bt,Object(ee.a)({focusRipple:!l,className:Object(te.a)(O.root,r),ref:t,role:"tab","aria-selected":y,disabled:o,onClick:function(e){!y&&m&&m(e,E),v&&v(e)},onFocus:function(e){b&&!y&&m&&m(e,E),g&&g(e)},ownerState:w,tabIndex:y?0:-1},T,{children:["top"===h||"start"===h?Object(Ue.jsxs)(a.Fragment,{children:[A,p]}):Object(Ue.jsxs)(a.Fragment,{children:[p,A]}),f]}))})),Vt=n(1388),Gt=n(939),Wt=Object(O.a)((function(e){return{segment:{fontSize:"20px",opacity:.25,transition:"all .5s",textAlign:"center",cursor:"pointer","&:hover":{opacity:.55},"&.selected":{opacity:1}},paragraph:{fontSize:"15px",maxWidth:"750px",margin:"0 auto",marginBottom:"20px"}}})),Xt=function(e){Wt();var t=Object(a.useState)(0),n=Object(r.a)(t,2),o=n[0],s=n[1],l=Object(a.useState)(null),c=Object(r.a)(l,2),u=c[0],d=c[1],h=Object(a.useState)(null),f=Object(r.a)(h,2),p=f[0],m=f[1];Object(a.useEffect)((function(){e.view&&(e.setSubView(""),Y.i(e.view.slug,"detail").then((function(e){e.forEach((function(e){"multicheckbox"===e.type&&v(e.id,e.default)})),d(e)})).catch((function(e){})))}),[]);var v=function(e,t){var n=Object(q.a)({},p);n[e]=t,m(n)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(R.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#fff",margin:0}},i.a.createElement(Ut,{value:o,onChange:function(t,n){s(n),e.setSelectedBlock(null),0===n?e.setSubView(""):1===n?e.setSubView("blocks"):2===n&&e.setSubView("words")},indicatorColor:"primary",textColor:"primary",centered:!0},i.a.createElement(Ht,{label:"Documento",id:0}),i.a.createElement(Ht,{label:"Bloques",id:1}),i.a.createElement(Ht,{label:"Palabras",id:2}))),u&&i.a.createElement(R.a,{sx:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:"20px",marginTop:"20px",backgroundColor:"#fff",borderRadius:"25px",boxShadow:"0px 3px 1px -2px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 1px 5px 0px rgba(0,0,0,0.12)"}},u.map((function(t,n){return i.a.createElement(i.a.Fragment,null,"multicheckbox"===t.type&&i.a.createElement(Gt.f,{options:t.options.map((function(e){return{id:e.value,term:e.label}})),value:p[t.id],handleChange:function(e){v(t.id,e)}}),"button"===t.type&&i.a.createElement(Vt.a,{variant:"contained",onClick:function(){var n;e.view.slug,n=t.callback,Y.p(e.view.slug,JSON.stringify(Object(q.a)(Object(q.a)({},p),{},{id:e.id})),n).then((function(e){w.a.fire({title:"\xc9xito",text:"Se ha ejecutado la acci\xf3n correctamente",icon:"success",confirmButtonText:"Ok"})}))},sx:{margin:"10px"}},t.label))}))))},qt=n(209),Yt=Object(qt.a)(a.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save"),Kt=n(1032),Zt=n(954),Jt=n(1054),Qt=n.n(Jt),$t=function(e){var t=Object(a.useRef)(),n=Object(a.useRef)(),o=Object(a.useRef)(),s=!1,l=Object(a.useState)(0),c=Object(r.a)(l,2),u=c[0],d=c[1],f=F.c(F.d);Object(a.useEffect)((function(){var t=setTimeout((function(){var t=document.getElementById("page-".concat(e.page-1));t&&t.scrollIntoView({duration:0})}),200),r=null;n.current=new IntersectionObserver((function(t){return t.forEach((function(t,n){t.isIntersecting&&(r&&clearTimeout(r),r=setTimeout((function(){e.setPage(parseInt(t.target.dataset.index)+1),h.f(e.id,[parseInt(t.target.dataset.index)],"big").then((function(e){var n="data:image/jpg;base64,"+e[0].data;t.target.style.backgroundImage="url(".concat(n,")")}))}),300))}))}),{threshold:.25});var a=n.current;return function(){a.disconnect(),clearTimeout(t)}}),[]),Object(a.useEffect)((function(){var e=n.current;return e.disconnect(),document.querySelectorAll(".page").forEach((function(t){return e.observe(t)})),function(){return e.disconnect()}}),[e.pages]),Object(a.useEffect)((function(){if(!s){var t=Math.abs(e.page-u),n=document.getElementById("page-".concat(e.page-1));n&&n.scrollIntoView({behavior:"smooth",duration:5*t}),d(e.page)}}),[e.page]);var p=null,m=function(e){s=!0,p&&clearTimeout(p),p=setTimeout((function(){s=!1}),2e3)},v=function(e){return Array.isArray(e.label)?e.label.length>0?"O"===e.label[0]?"transparent":f(e.label[0]):void 0:e.type?f(e.type):"transparent"};return Object(a.useEffect)((function(){return t.current&&t.current.addEventListener("wheel",m),function(){t.current&&t.current.removeEventListener("wheel",m)}}),[t]),Object(a.useEffect)((function(){o.current&&Qt()(o.current).resizable({edges:{left:!0,right:!0,bottom:!0,top:!0},listeners:{move:function(n){var r=n.target.width.animVal.value,a=n.target.height.animVal.value,i=t.current.getBoundingClientRect().width,o=a/100*i,s=r/100*i+n.delta.x,l=o+n.delta.y;s=s/i*100,l=l/i*100,n.target.setAttribute("width","".concat(s)),n.target.setAttribute("height","".concat(l));var c={x:parseFloat(n.target.getAttribute("x"))/100,y:parseFloat(n.target.getAttribute("y"))/100*e.aspectRatio,width:s/100,height:l/100*e.aspectRatio},u=Object(q.a)({},e.selectedBlock);u.bbox=c,e.setSelectedBlock(u)}}}).draggable({listeners:{move:function(n){var r=parseFloat(n.target.getAttribute("x")),a=parseFloat(n.target.getAttribute("y")),i=parseFloat(n.target.getAttribute("width")),o=parseFloat(n.target.getAttribute("height")),s=t.current.getBoundingClientRect().width,l=a/100*s;r=(r=r/100*s+n.delta.x)/s*100,a=(a=l+n.delta.y)/s*100,n.target.setAttribute("x",r),n.target.setAttribute("y",a);var c={x:r/100,y:a/100*e.aspectRatio,width:i/100,height:o/100*e.aspectRatio},u=Object(q.a)({},e.selectedBlock);u.bbox=c,e.setSelectedBlock(u)}}})}),[o,e.selectedBlock]),i.a.createElement("div",{ref:t,style:{height:"100%",width:"100%",justifyContent:"center",overflowY:"auto",position:"absolute",top:0,left:0}},Array.from({length:e.pages},(function(t,n){return i.a.createElement("div",{id:"page-".concat(n),className:"page",key:n,"data-index":n,style:{background:"white",marginBottom:30,backgroundSize:"contain"}},i.a.createElement("svg",{width:"100%",height:"100%",viewBox:"0 0 100 ".concat(100/e.aspectRatio),preserveAspectRatio:"none"},e.selectedBlock&&e.selectedBlock.new&&e.page-1===n&&i.a.createElement("rect",{x:100*e.selectedBlock.bbox.x,y:100*e.selectedBlock.bbox.y/e.aspectRatio,width:100*e.selectedBlock.bbox.width,height:100*e.selectedBlock.bbox.height/e.aspectRatio,fill:v(e.selectedBlock,o.current),fillOpacity:.3,ref:o})))})))},en=n(1050),tn=n.n(en),nn=Object(u.a)((function(e){return{scrollbar:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"}}}})),rn=Object(Re.a)(Z.a)((function(e){var t=e.theme;return{width:62,height:26,padding:8,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(30px)","& .MuiSwitch-thumb:before":{backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24"><path fill="white" d="M2 7h4v10H2V7zm5 12h10V5H7v14zM18 7h4v10h-4V7z"></path></svg>\')'},"& + .MuiSwitch-track":{opacity:1,backgroundColor:(t.palette.mode,"#fcfcfc")}}},"& .MuiSwitch-thumb":{backgroundColor:(t.palette.mode,"#acbcd1"),width:23,height:23,"&::before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24"><path fill="white" d="M2 21h19v-3H2v3zM20 8H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zM2 3v3h19V3H2z"></path></svg>\')',backgroundSize:"60%"}},"& .MuiSwitch-track":{opacity:1,backgroundColor:(t.palette.mode,"#fcfcfc"),borderRadius:10,border:"1px solid #dcdcdc",height:10}}})),an=function(e){var t=nn(),n=Object(a.useState)({}),o=Object(r.a)(n,2),s=o[0],l=o[1],c=Object(a.useState)({}),u=Object(r.a)(c,2),d=u[0],f=u[1];Object(a.useEffect)((function(){s[e.subView]||e.slug&&e.subView&&Y.i(e.slug,e.subView).then((function(t){var n=Object(q.a)({},s);n[e.subView]?n[e.subView]=n[e.subView].concat(t):n[e.subView]=t;var r=Object(q.a)({},d);t.forEach((function(t){r[t.id]=e.block[t.id]})),f(r),l(n)})).catch((function(e){}))}),[e.subView]);var p=function(t,n){var r=Object(q.a)({},d);r[n.id]=t.target.value,f(r);var a=Object(q.a)({},e.block);a[n.id]=t.target.value,e.setSelectedBlock(a)};return i.a.createElement("div",{style:{background:"white"}},i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"}},i.a.createElement("div",null,i.a.createElement(J.a,{label:"Guardar",size:"small",onClick:function(){!function(){var t={data:d,id_doc:e.recordId,type_block:e.subView,index:e.block.index,page:e.page,slug:e.slug,bbox:e.block.bbox};e.slug&&e.subView?e.block.new?h.i(t).then((function(t){e.setSelectedBlock(null)})):h.j(t).then((function(t){e.setSelectedBlock(null)})):e.block.new&&K.a({type:"document",record_id:e.recordId,data:{bbox:e.block.bbox,page:e.page}}).then((function(t){e.setSelectedBlock(null),w.a.fire({title:"Guardado",text:"Recorte guardado",icon:"success",confirmButtonText:"Ok"})}))}()},icon:i.a.createElement(Yt,null),style:{margin:3,border:"none"},variant:"outlined",className:t.close}),!e.block.new&&i.a.createElement(J.a,{label:"Eliminar",size:"small",onClick:function(){!function(){var t={id_doc:e.recordId,type_block:e.subView,index:e.block.index,page:e.page,slug:e.slug};h.a(t).then((function(t){console.log(t),e.setSelectedBlock(null)}))}()},icon:i.a.createElement(Kt.a,null),style:{margin:3,border:"none"},variant:"outlined",className:t.close})),i.a.createElement(J.a,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:i.a.createElement(rt.a,null),style:{margin:3,width:24,height:24,border:"none"},className:t.close})),s[e.subView]&&s[e.subView].map((function(t,n){return i.a.createElement("div",{key:n},"text"===t.type&&i.a.createElement(Gt.o,{name:t.id,value:d[t.id],handleChange:function(e){return p(e,t)},style:{width:"100%",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"}}),"text-area"===t.type&&i.a.createElement(Gt.n,{name:t.id,value:d[t.id],handleChange:function(e){return p(e,t)},style:{width:"350px",height:"400px",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"},rootStyle:{width:"100%",margin:"0px",padding:"5px"}}),"select"===t.type&&i.a.createElement(Gt.l,{name:t.id,value:d[t.id],options:e.labels.map((function(e){return{value:e,label:e}})),handleChange:function(e){return p(e,t)},style:{width:"100%",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"},rootStyle:{width:"100%",margin:"0px",padding:"5px"}}))})))},on=function(e){var t,n,o,s=Object(a.useState)(0),l=Object(r.a)(s,2),c=l[0],u=l[1],d=Object(a.useState)(0),m=Object(r.a)(d,2),v=m[0],g=m[1],y=Object(a.useState)(1),b=Object(r.a)(y,2),_=b[0],x=b[1],E=Object(a.useState)([]),S=Object(r.a)(E,2),M=S[0],T=S[1],w=Object(a.useState)([]),O=Object(r.a)(w,2),A=O[0],C=O[1],k=Object(a.useState)(null),P=Object(r.a)(k,2),L=P[0],U=P[1],j=Object(a.useRef)(null),F=Object(a.useRef)(null),z=Object(a.useState)(!1),B=Object(r.a)(z,2),H=B[0],V=B[1],G=Object(Zt.a)("docViewType","carrousel"),W=Object(r.a)(G,2),X=W[0],Y=W[1],K=function(e){return i.a.createElement(R.a,{style:{display:"flex",width:"calc(100% - 20px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",marginTop:"10px",marginLeft:"10px",backgroundColor:"white",borderRadius:"50px"}},i.a.createElement(p.a,{color:"primary",onClick:function(){$(_-1)}},i.a.createElement($e.a,null)),i.a.createElement(Gt.j,{name:null,value:_,handleChange:function(e){$(parseInt(e.target.value))},min:1,max:c,style:{width:"100px",padding:"0px",backgroundColor:"white",marginRight:"10px",borderBottom:"none"}}),i.a.createElement(Ze,{ref:F,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:_,step:1,marks:!0,min:1,max:c,style:{width:"80%"},onChangeCommitted:function(e,t){$(t)}}),i.a.createElement(p.a,{color:"primary",onClick:function(){$(_+1)}},i.a.createElement(tt.a,null)))},Z=function(t){"carrousel"===X?Object(Je.j)():"scroll"===X&&(u(c),g(v),Object(Je.c)(c,j.current,v,e.id,_),Object(Je.f)(x),L&&(Object(Je.g)(L),Object(Je.e)(M,_,v,U)),Object(Je.a)()),Y(t)};Object(a.useEffect)((function(){return h.d(e.id).then((function(t){u(t.pages),g(t.aspect_ratio),"carrousel"===X&&(Object(Je.c)(t.pages,j.current,t.aspect_ratio,e.id),Object(Je.f)(x),Object(Je.a)())})),function(){"carrousel"===X&&Object(Je.j)()}}),[]);var Q=function(t){"blocks"===e.subView?h.b(e.id,t,e.view.slug,e.subView).then((function(e){T(e.blocks),C(e.labels),V(!0)})):"words"===e.subView?h.b(e.id,t,e.view.slug,e.subView).then((function(e){T(e.words),C(e.labels),V(!0)})):(T([]),H&&"carrousel"===X&&Object(Je.b)(t))};Object(a.useEffect)((function(){null===L?("carrousel"===X&&Object(Je.g)(null),H&&"carrousel"===X&&Object(Je.b)(_),Q(_)):(H&&"carrousel"===X&&Object(Je.b)(_),"carrousel"===X&&Object(Je.g)(L),"carrousel"===X&&Object(Je.e)(M,_,v,U))}),[L]),Object(a.useEffect)((function(){null!==e.subView?(Object(Je.i)(e.subView),Q(_)):T([])}),[e.subView,_]),Object(a.useEffect)((function(){Object(Je.h)(e.view.slug)}),[e.view]),Object(a.useEffect)((function(){M&&M.length>0&&"carrousel"===X&&Object(Je.e)(M,_,v,ee)}),[M]);var $=function(t){t>c&&(t=c),t<1&&(t=1),"carrousel"===X&&Object(Je.d)(t,v,e.id),x(t)},ee=function(e,t){var n=Object(q.a)({},e);n.index=t,U(n),"carrousel"===X&&(Object(Je.b)(_),Object(Je.g)(n),Object(Je.e)(M,_,v,U))};return i.a.createElement(N.a,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")}},i.a.createElement(R.a,{ref:j,style:{position:"absolute",width:"100%",height:"100%"}}),"scroll"===X&&i.a.createElement(i.a.Fragment,null,i.a.createElement($t,{pages:c,aspectRatio:v,page:_,id:e.id,setPage:x,selectedBlock:L,setSelectedBlock:U})),i.a.createElement(I.a,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"}},i.a.createElement(D.a,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})),i.a.createElement(I.a,{id:"processing",initialPosition:{x:0,y:0}},"viz"===e.view&&i.a.createElement("div",{style:{paddingTop:"10px",background:"white",paddingBottom:"10px",paddingRight:"10px"}},i.a.createElement(K,null),i.a.createElement("div",{style:{marginTop:"20px",display:"flex",alignItems:"center",justifyContent:"space-between"}},i.a.createElement(J.a,{label:"Agregar un recorte",size:"small",onClick:function(){U({index:M.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:A[0]?A[0]:"default",new:!0}),V(!0)},style:{margin:3,border:"none"},icon:i.a.createElement(tn.a,null),variant:"outlined"}),i.a.createElement(f.a,{disableGutters:!0,variant:"dense"},i.a.createElement(rn,{size:"small",checked:"carrousel"===X,onChange:function(e){return Z(e.target.checked?"carrousel":"scroll")},color:"primary"})))),"lt_extraction"===(null===(t=e.view)||void 0===t?void 0:t.view)&&i.a.createElement("div",{style:{background:"white",paddingBottom:"10px"}},i.a.createElement(Xt,{setSubView:e.setSubView,view:e.view,setSelectedBlock:U}),i.a.createElement(K,null),i.a.createElement("div",{style:{marginTop:"20px",display:"flex",alignItems:"center",justifyContent:"space-between"}},""===e.subView&&null===L&&i.a.createElement(i.a.Fragment,null),"blocks"===e.subView&&null===L&&i.a.createElement(i.a.Fragment,null),"words"===e.subView&&null===L&&i.a.createElement(i.a.Fragment,null),i.a.createElement(f.a,{disableGutters:!0,variant:"dense"},i.a.createElement(rn,{size:"small",checked:"carrousel"===X,onChange:function(e){return Z(e.target.checked?"carrousel":"scroll")},color:"primary"})))),"ner_extraction"===(null===(n=e.view)||void 0===n?void 0:n.view)&&i.a.createElement(Xt,{setSubView:e.setSubView,view:e.view,setSelectedBlock:U,id:e.match.params.id}),"docseg_extraction"===(null===(o=e.view)||void 0===o?void 0:o.view)&&i.a.createElement(Xt,{setSubView:e.setSubView,view:e.view,setSelectedBlock:U,id:e.match.params.id}),L&&i.a.createElement(an,{block:L,labels:A,subView:e.subView,setSelectedBlock:U,slug:e.view.slug,recordId:e.id,page:_})))},sn=function(e){var t=Object(a.useState)(0),n=Object(r.a)(t,2),o=(n[0],n[1]),s=Object(a.useState)(0),l=Object(r.a)(s,2),c=(l[0],l[1]),u=Object(a.useState)(1),d=Object(r.a)(u,2),f=(d[0],d[1]),p=Object(a.useRef)(null);Object(a.useRef)(null);Object(a.useEffect)((function(){return h.d(e.id).then((function(t){o(t.pages),c(t.aspect_ratio),Object(Je.c)(t.pages,p.current,t.aspect_ratio,e.id),Object(Je.f)(f),Object(Je.a)()})),function(){Object(Je.j)()}}),[]);return i.a.createElement(N.a,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")}},i.a.createElement(R.a,{ref:p,style:{position:"absolute",width:"100%",height:"100%"}}),i.a.createElement(I.a,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"}},i.a.createElement(D.a,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})))},ln=n(46),cn=n(1360),un=n(967),dn=n(998),hn=n.n(dn),fn=n(993),pn=n.n(fn),mn=Object(u.a)((function(e){return{bloque:{padding:"10px",backgroundColor:"rgba(255,255,255,.9)",margin:5,width:"100%",height:"100%",overflow:"auto",position:"relative",borderRadius:10,border:"3px solid #fff","&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},tituloBloque:{top:0,fontSize:15,fontWeight:"bold",padding:"10px 15px",position:"sticky",zIndex:10,width:"100%",left:0,background:"#e6e6e6",borderTopLeftRadius:10,borderTopRightRadius:10,color:"#56749a",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},breadcrumbs:{padding:"5px 15px",color:"#fff",borderBottomLeftRadius:10,borderBottomRightRadius:10,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},linkBreadcrumb:{color:"#fff",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:200,display:"inline-block","&:hover":{color:"#fff"}},selectedBread:{color:"#fff !important",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:150,backgroundColor:"rgba(255,255,255,.2)",display:"inline-block",padding:"0 5px",borderRadius:2},columnas:{display:"flex",height:"calc(100vh - 150px)"},separador:{borderBottom:"1px solid #dcdcdc",paddingTop:25,paddingBottom:10,fontWeight:"bold",color:"#56749a","& svg":{marginRight:10,marginLeft:5,width:20,height:20,padding:3,backgroundColor:"#56749a",borderRadius:50,"& path":{fill:"#fff"}}},toolbar:{minHeight:"auto",padding:5,backgroundColor:"#56749a",color:"#fff",borderTopLeftRadius:10,overflow:"hidden",alignItems:"center","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}},bookmarkIcon:{"& path":{fill:"#fff"}},itemMenu:{display:"flex",alignItems:"center",padding:15,borderBottom:"1px solid #dcdcdc","& svg":{"& path":{fill:"#9fb0c6"}},"&:hover":{backgroundColor:e.palette.grey[100],cursor:"pointer"},"&.selected":{backgroundColor:"#9fb0c6",color:"#fff","& path":{fill:"#fff"}}}}})),vn=function(e){var t=mn();return i.a.createElement(d.a,{className:t.bloque,style:e.style},e.title&&i.a.createElement(d.a,{className:t.tituloBloque},e.title),e.topBar&&i.a.createElement(i.a.Fragment,null,e.topBar),e.children)},gn=function(e){var t=mn(),n=Object(a.useState)("viz"),o=Object(r.a)(n,2),s=o[0],u=o[1],m=Object(a.useState)(null),v=Object(r.a)(m,2),b=v[0],x=v[1],S=Object(a.useState)(null),T=Object(r.a)(S,2),O=T[0],A=T[1],R=Object(a.useState)(0),C=Object(r.a)(R,2),k=C[0],P=C[1],L=Object(a.useState)(0),I=Object(r.a)(L,2),N=I[0],D=I[1],U=Object(a.useState)(null),j=Object(r.a)(U,2),F=j[0],z=j[1],B=Object(a.useState)(!1),V=Object(r.a)(B,2),W=V[0],q=V[1];Object(a.useEffect)((function(){Y()}),[e.match]),Object(a.useEffect)((function(){e.user.favorites&&(e.user.favorites.find((function(t){return t.id===e.match.params.id}))?q(!0):q(!1))}),[e.user.favorites,e.match]),Object(a.useEffect)((function(){if(O){for(var e=Object.keys(O.processing),t=e[0];"fileProcessing"===t&&e.length>1;)e.shift(),t=e[0];"fileProcessing"===t||u({slug:t,view:O.processing[t].type})}}),[O]);var Y=function(){e.match.params.id&&(u("viz"),A(null),h.c(e.match.params.id).then((function(e){A(e)})).catch((function(t){w.a.fire({icon:"error",title:"Oops...",text:"No se pudo obtener el archivo"}).then((function(){e.history.push("/dashboard")}))})))},K=function(e){D(e)};return i.a.createElement(c.a,null,i.a.createElement(l.a,{userRoles:e.user.roles,list:function(){var t=[];return t.push({name:"Volver atr\xe1s",icon:i.a.createElement(i.a.Fragment,null,i.a.createElement(E.a,null)),callback:function(){e.history.goBack()}}),t}()}),O&&i.a.createElement(i.a.Fragment,null,i.a.createElement(vn,{style:{width:"calc(100% - 20px)",height:"calc(100vh - 130px)",padding:"2px",background:"rgb(255 255 255 / 34%)",border:"none",backdropFilter:"blur(10px)",display:"flex"}},i.a.createElement(d.a,{style:{width:"400px",height:"100%",background:"white",borderTopLeftRadius:10,borderBottomLeftRadius:10,marginRight:10}},i.a.createElement(f.a,{className:t.toolbar},i.a.createElement(p.a,{sx:{marginRight:"10px"},className:t.bookmarkIcon,size:"large",onClick:function(){var t={type:"records",id:e.match.params.id};W?g.c(t).then((function(t){w.a.fire({icon:"success",title:"Eliminado de favoritos"}),e.requestUser()})).catch((function(e){w.a.fire({icon:"error",title:"Oops...",text:"No se pudo eliminar de favoritos"})})):g.a(t).then((function(t){w.a.fire({icon:"success",title:"Agregado a favoritos"}),e.requestUser()})).catch((function(e){w.a.fire({icon:"error",title:"Oops...",text:"No se pudo agregar a favoritos"})}))}},W?i.a.createElement(pn.a,null):i.a.createElement(hn.a,null)),i.a.createElement("h6",{style:{flexGrow:1}},O.displayName?O.displayName:O.name)),i.a.createElement(d.a,null,i.a.createElement(y.a,{record:O,setMetadata:z}),Object.keys(O.processing).length>1&&i.a.createElement(i.a.Fragment,null,i.a.createElement(yn,{icon:i.a.createElement(_.a,null),title:"Procesamientos"}),Object.keys(O.processing).map((function(e,t){var n=O.processing[e].type,r=ln.b.find((function(e){return e.value===n})),a=n;if("audio"!==n&&"video"!==n&&r)return i.a.createElement(bn,{key:t,icon:i.a.createElement(M.a,null),name:r.label,onClick:function(){u({view:a,slug:e}),x(null)},className:(null===s||void 0===s?void 0:s.view)===a?"selected":""})}))))),i.a.createElement(d.a,{style:{width:"calc(100% - 400px)",position:"relative"}},"audio"===O.processing.fileProcessing.type&&i.a.createElement(cn.a,{backend:un.a},i.a.createElement(G,{id:O._id.$oid,setPlayTime:P,time:N,metadata:F,setMetadata:z,history:e.history},"av_transcribe"===(null===s||void 0===s?void 0:s.view)&&i.a.createElement(H,{id:O._id.$oid,slug:s.slug,subView:b,time:k,setTime:function(e){K(e)}}))),"video"===O.processing.fileProcessing.type&&i.a.createElement(cn.a,{backend:un.a},i.a.createElement(X,{id:O._id.$oid,setPlayTime:P,time:N,metadata:F,setMetadata:z,history:e.history,subView:b},"av_transcribe"===(null===s||void 0===s?void 0:s.view)&&i.a.createElement(H,{id:O._id.$oid,slug:s.slug,subView:b,time:k,setTime:function(e){K(e)}}))),"document"===O.processing.fileProcessing.type&&i.a.createElement(cn.a,{backend:un.a},i.a.createElement(on,{id:O._id.$oid,subView:b,setSubView:x,view:s,metadata:F,setMetadata:z,history:e.history})),"image"===O.processing.fileProcessing.type&&i.a.createElement(cn.a,{backend:un.a},i.a.createElement(sn,{id:O._id.$oid,history:e.history,setMetadata:z,metadata:F}))))))},yn=function(e){var t=mn();return i.a.createElement(d.a,{className:t.separador},e.icon,e.title)},bn=function(e){var t=mn();return i.a.createElement(d.a,{className:"".concat(t.itemMenu," ").concat(e.className),onClick:e.onClick},e.icon,i.a.createElement("div",{style:{flexGrow:1,marginLeft:15}},e.name),i.a.createElement(v.a,null))};t.default=Object(o.b)((function(e){return{user:e.auth.user}}),s.a)(gn)},937:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"h",(function(){return o})),n.d(t,"g",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"i",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"c",(function(){return h})),n.d(t,"d",(function(){return f}));var r=n(204),a=n(46);function i(e,t){var n="/resources/"+e;var i={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:t};return fetch(a.e+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function o(e){var t={method:"POST",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default",body:e};return fetch(a.e+"/resources",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function s(e){var t={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(a.e+"/resources/tree",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function l(e){var t="/resources/"+e,n={method:"DELETE",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function c(e){var t="/resources/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function u(e,t){var n="/resources/"+e,i={method:"PUT",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default",body:t};return fetch(a.e+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),o="/resources/"+e+"/records",s={method:"POST",headers:i,mode:"cors",cache:"default",body:JSON.stringify({page:t,groupImages:n})};return fetch(a.e+o,s).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function h(e){var t={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(a.e+"/records",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function f(e){var t="/resources/"+e+"/imgs",n={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}},938:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"r",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"d",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return d})),n.d(t,"i",(function(){return h})),n.d(t,"p",(function(){return f})),n.d(t,"l",(function(){return p})),n.d(t,"o",(function(){return m})),n.d(t,"a",(function(){return v})),n.d(t,"n",(function(){return g})),n.d(t,"j",(function(){return y})),n.d(t,"k",(function(){return b})),n.d(t,"m",(function(){return _})),n.d(t,"e",(function(){return x})),n.d(t,"q",(function(){return E}));var r=n(204),a=n(46);function i(){var e={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+"/system",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function o(e){var t={method:"PUT",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(a.e+"/system",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function s(){var e={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+"/system/access-rights",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function l(){var e={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+"/system/roles",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function c(){var e={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+"/system/default-cataloging-type",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function u(){var e={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+"/system/plugins",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function d(e){var t="/"+e+"/image",n={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 404===e.status?Promise.reject(e):e.blob()}))}function h(e,t){var n="/"+e+"/settings/"+t,i={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function f(e,t,n){var i="/"+e+"/"+n,o={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:t};return fetch(a.e+i,o).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function p(e,t,n){var i="/"+e+"/"+n,o={method:"POST",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default",body:t};return fetch(a.e+i,o).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function m(e,t){var n="/"+e+"/settings",i={method:"POST",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default",body:t};return fetch(a.e+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function v(e,t){var n="/"+e+"/bulk",i={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:t};return fetch(a.e+n,i).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function g(e){var t="/system/plugins/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function y(e,t){var n="/tasks/"+e,i={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:t};return fetch(a.e+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function b(e){var t="/tasks/total/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function _(e){var t="/tasks/total/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function x(e,t){var n="/"+e+"/filedownload/"+t,i={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+n,i).then((function(e){return 404===e.status||500===e.status||400===e.status||401===e.status?Promise.reject(e):e.blob()}))}function E(e){var t="/system/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 404===e.status||500===e.status||400===e.status||401===e.status?Promise.reject(e):e.json()}))}},939:function(e,t,n){"use strict";n.d(t,"h",(function(){return B})),n.d(t,"o",(function(){return H})),n.d(t,"j",(function(){return V})),n.d(t,"n",(function(){return G})),n.d(t,"l",(function(){return W})),n.d(t,"i",(function(){return X})),n.d(t,"g",(function(){return q})),n.d(t,"c",(function(){return K})),n.d(t,"e",(function(){return J})),n.d(t,"f",(function(){return Q})),n.d(t,"b",(function(){return $})),n.d(t,"q",(function(){return ee})),n.d(t,"r",(function(){return re})),n.d(t,"d",(function(){return ie})),n.d(t,"p",(function(){return oe})),n.d(t,"m",(function(){return le})),n.d(t,"k",(function(){return ce})),n.d(t,"a",(function(){return ue}));var r=n(35),a=n(18),i=n(202),o=n(2),s=n.n(o),l=n(926),c=n(1136),u=n(843),d=n(1378),h=n(1386),f=n(1403),p=n(1402),m=n(1376),v=n(1379),g=n(1392),y=n(1388),b=n(1389),_=n(1029),x=n.n(_),E=n(948),S=n(447),M=n(1027),T=n.n(M),w=n(1028),O=n.n(w),A=n(1358),R=n(1375),C=n(1034),k=n(946),P=n(943),L=n(963),I=n(938),N=n(1026),D=n.n(N),U=n(46),j=(n(263),n(203)),F=n.n(j),z=Object(u.a)((function(e){return{scrollbar:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},item:{display:"flex",paddingTop:10,paddingLeft:5,alignContent:"flex-start",alignItems:"center",textAlign:"left",borderBottom:"1px solid #ccc",paddingBottom:20,position:"relative","&.label-top":{paddingTop:20},"& .MuiAutocomplete-inputRoot":{"&::before":{display:"none"}},"&:last-child":{borderBottom:"none",borderBottomLeftRadius:10,borderBottomRightRadius:10},"&:nth-child(even)":{background:e.palette.grey[100]},"&:first-child":{marginTop:10},"& label":{width:150,textAlign:"left",paddingRight:10,fontWeight:"bold",color:"#666",display:"block","& span":{color:"red",marginLeft:5},"&.simple":{fontWeight:"normal"},"&.inline":{display:"inline-block"},"&.top":{position:"absolute",top:2,width:"100%"}},"& .instructions":{maxWidth:300},"& input":{width:"100%",padding:5,borderRadius:5,border:"1px solid #ccc"},"& textarea":{width:"100%",padding:5,borderRadius:5,border:"1px solid #ccc"},"& select":{width:"100%",padding:5,borderRadius:5,border:"1px solid #ccc"},"& input[type=checkbox]":{width:"auto"},"& input, & textarea, & select":{"&:focus":{outline:"none",border:"1px solid rgba(42, 80, 130, 0.8)"}},"&.error":{background:"rgba(255,0,0,0.05)","& label":{color:"red"}},"& .insideContent":{width:"calc(100% - 150px)","&.top":{width:"100%"}}},arrayContainer:{background:"#f5f5f5",padding:5,width:"100%",borderRadius:5,border:"2px dashed #f0f0f0"},card:{marginTop:5,marginBottom:5,"& .MuiCardHeader-root":{padding:"5px 10px",borderBottom:"1px solid #ececec","& .MuiCardHeader-content":{"& .MuiTypography-root":{fontSize:"14px",fontWeight:"normal",fontFamily:"Montserrat",color:"#333"}}}},cardContent:{display:"flex",alignContent:"flex-start",alignItems:"flex-start"},subItem:{marginTop:5,marginBottom:5,display:"flex",borderBottom:"1px dotted #ccc",paddingBottom:5},subItemOpts:{marginTop:0,marginBottom:0,display:"flex",paddingBottom:0,border:"none",alignItems:"center",paddingLeft:10,"& input":{border:"none",outline:"none",borderRadius:0,borderRight:"1px dashed #ececec",transition:"background 0.3s ease","&:focus":{border:"none",background:"#ececec",fontWeight:"bold",color:"#333"}}}}})),B=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":""),key:e.id},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(C.a,{onChange:function(t){return function(t){e.values&&e.change("files",[].concat(Object(i.a)(e.values.files.filter((function(t){return t.id!==e.id}))),Object(i.a)(t.map((function(t){return{file:t,id:e.id}})))))}(t)},dropzoneText:"Arrastre y suelte un archivo aqu\xed o haga clic para seleccionar un archivo",showFileNames:!0,useChipsForPreview:!0,getFileAddedMessage:function(e){return"Archivo ".concat(e," agregado")},getFileRemovedMessage:function(e){return"Archivo ".concat(e," eliminado")},Icon:A.a,maxFileSize:2e9,filesLimit:e.limit?e.limit:100,acceptedFiles:e.acceptedFiles?e.acceptedFiles:["image/*","application/pdf","application/msword","application/vnd.openxmlformats-officedocument.wordprocessingml.document","video/*","audio/*"],name:e.id}))},H=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":""),key:e.id},(e.label||e.name)&&s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement("input",{type:e.type?e.type:"text",name:e.id,onChange:e.handleChange,onBlur:e.handleBlur,value:e.value,style:{width:"100%"},disabled:e.disabled}))},V=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":""),style:e.style},e.name&&s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement("input",{type:"number",name:e.id,onChange:e.handleChange,onBlur:e.handleBlur,value:e.value,style:{width:"100%"},disabled:e.disabled,min:e.min,max:e.max}))},G=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":""),style:Object(a.a)({},e.rootStyle),key:e.id},(e.label||e.name)&&s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement("textarea",{name:e.id,onChange:e.handleChange,onBlur:e.handleBlur,value:e.value,style:Object(a.a)({width:"100%"},e.style),className:t.scrollbar}))},W=function(e){var t=z();return s.a.createElement(l.a,{key:e.key,className:"".concat(t.item," ").concat(e.errors?"error":""),style:Object(a.a)({},e.rootStyle)},(e.name||e.label)&&s.a.createElement(l.a,null,s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),e.instructions&&s.a.createElement(l.a,{className:"instructions"},e.instructions)),s.a.createElement(d.a,{name:e.id,onChange:e.handleChange,onBlur:e.handleBlur,value:e.value,style:Object(a.a)(Object(a.a)({},e.style),{},{width:"100%"})},s.a.createElement(h.a,{key:-1,value:"none"},"accessRights"===e.destiny?"P\xfablico":"Seleccione una opci\xf3n"),e.options.map((function(e,t){return s.a.createElement(h.a,{key:t,value:e.value},e.label)}))))},X=function(e){var t=s.a.useState([]),n=Object(r.a)(t,2),a=n[0],i=n[1];return s.a.useEffect((function(){e.options&&L.d(e.options).then((function(e){i(e.options)})).catch((function(e){console.log(e)}))}),[e.options]),s.a.createElement(W,{name:e.name,id:e.id,handleChange:e.handleChange,handleBlur:e.handleBlur,value:e.value,options:a?a.map((function(e){return{value:e.id,label:e.term}})):[],required:e.required,errors:e.errors,destiny:e.destiny,key:e.id})},q=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":"")},s.a.createElement(l.a,{style:{marginRight:10}},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),e.instructions&&s.a.createElement(l.a,{className:"instructions"},e.instructions)),s.a.createElement("input",{type:"checkbox",name:e.id,onChange:function(t){e.handleChange(t.target.checked)},onBlur:e.handleBlur,checked:e.value}))},Y=function(e){var t=z(),n=s.a.useState([]),a=Object(r.a)(n,2),i=a[0],o=a[1],u=s.a.useState([]),d=Object(r.a)(u,2),h=d[0],m=d[1],v=s.a.useState(!1),g=Object(r.a)(v,2),y=g[0],b=g[1],_=s.a.useState([]),x=Object(r.a)(_,2),M=(x[0],x[1]);return s.a.useEffect((function(){"select"===e.item.type||"select-multiple2"===e.item.type?L.c().then((function(e){o(e)})).catch((function(e){console.log(e)})):"relation"===e.item.type&&P.b().then((function(e){m(e)})).catch((function(e){console.log(e)})),e.item.accessRights&&e.item.accessRights.length>0&&b(!0)}),[e.item.type]),s.a.createElement(f.a,{className:t.card},s.a.createElement(c.a,{className:t.cardContent},s.a.createElement(l.a,{sx:{width:"calc(100% - 50px)"}},s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".label")},"Nombre"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".label"),type:"text",placeholder:"Nombre"})),!e.editing&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".type")},"Tipo"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".type"),as:"select"},s.a.createElement("option",{value:"text"},"Texto"),s.a.createElement("option",{value:"author"},"Autor"),s.a.createElement("option",{value:"simple-date"},"Fecha"),s.a.createElement("option",{value:"select"},"Lista de selecci\xf3n"),s.a.createElement("option",{value:"select-multiple2"},"Lista de selecci\xf3n m\xfaltiple"),s.a.createElement("option",{value:"file"},"Archivo"),s.a.createElement("option",{value:"text-area"},"\xc1rea de texto"),s.a.createElement("option",{value:"checkbox"},"Verdadero / Falso"),s.a.createElement("option",{value:"separator"},"Separador"),s.a.createElement("option",{value:"relation"},"Relaci\xf3n"),s.a.createElement("option",{value:"number"},"N\xfamero"))),"file"===e.item.type&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".filetag")},"Etiqueta para los archivos"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".filetag"),type:"text"})),s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".maxFiles")},"N\xfamero m\xe1ximo"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".maxFiles"),type:"number",min:1,max:1e3}))),"separator"!==e.item.type&&"file"!==e.item.type&&s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".destiny")},"Destino"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".destiny"),type:"text"})),("select"===e.item.type||"select-multiple2"===e.item.type)&&s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".list")},"Listado"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".list"),as:"select"},i.map((function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.name)})))),"relation"===e.item.type&&s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".relation_type")},"Tipo de contenido"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".relation_type"),as:"select"},h.map((function(e,t){return s.a.createElement("option",{key:t,value:e.slug},e.name)})))),"separator"!==e.item.type&&s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".required")},"Requerido"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".required"),type:"checkbox"})),"separator"!==e.item.type&&"file"!==e.item.type&&s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".setAccess")},"Niveles de acceso"),s.a.createElement(E.a,{type:"checkbox",onClick:function(){y&&M([]),b(!y)},checked:y})),y&&"separator"!==e.item.type&&"file"!==e.item.type&&s.a.createElement(l.a,{className:t.subItem},s.a.createElement(E.a,{name:"fields.".concat(e.index,".accessRights"),as:"select",multiple:!0},e.accessRights.map((function(e,t){return s.a.createElement("option",{key:t,value:e.id},e.term)}))))),e.editing&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".destiny")},"Destino"),s.a.createElement("input",{type:"text",value:e.item.destiny,disabled:!0})),s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".type")},"Tipo"),s.a.createElement("input",{type:"text",value:e.item.type,disabled:!0})),s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".required")},"Requerido"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".required"),type:"checkbox",disabled:!0})),s.a.createElement(l.a,{className:t.subItem},s.a.createElement("label",{htmlFor:"fields.".concat(e.index,".setAccess")},"Niveles de acceso"),s.a.createElement(E.a,{name:"fields.".concat(e.index,".setAccess"),type:"checkbox",disabled:!0})))),s.a.createElement(l.a,{sx:{width:"50px",display:"flex",justifyContent:"center",flexDirection:"column",padding:"5px",alignContent:"flex-start",alignItems:"flex-start"}},s.a.createElement(p.a,{onClick:function(){return e.remove(e.index)}},s.a.createElement(S.a,null)),e.index>0&&s.a.createElement(p.a,{onClick:function(){return e.moveUp(e.index)}},s.a.createElement(T.a,null)),e.index<e.fieldsLen-1&&s.a.createElement(p.a,{onClick:function(){return e.moveDown(e.index)}},s.a.createElement(O.a,null)))))},K=function(e){var t=z(),n=function(t){e.remove(t)},r=function(t){e.move(t,t-1)},a=function(t){e.move(t,t+1)};return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":"")},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(l.a,{className:t.arrayContainer},e.value.map((function(t,i){return s.a.createElement(Y,{key:i,item:t,editing:e.editing,index:i,remove:n,moveUp:r,moveDown:a,fieldsLen:e.value.length,accessRights:e.accessRights})})),!e.editing&&s.a.createElement(l.a,{sx:{display:"flex",justifyContent:"center"}},s.a.createElement(p.a,{onClick:function(){e.push({type:"text",destiny:"",required:!1})}},s.a.createElement(x.a,null)))))},Z=function(e){var t=z();return s.a.createElement(f.a,{className:t.card},s.a.createElement(l.a,{sx:{width:"100%",padding:0}},s.a.createElement(l.a,{className:"".concat(t.subItemOpts," ots")},s.a.createElement(E.a,{name:"options.".concat(e.index,".term"),type:"text",placeholder:"T\xe9rmino",value:e.item.term}),s.a.createElement(l.a,{sx:{width:"50px",display:"flex",justifyContent:"center",flexDirection:"column",padding:"5px",alignContent:"flex-start",alignItems:"flex-start"}},s.a.createElement(p.a,{onClick:function(){return e.remove()},size:"small"},s.a.createElement(S.a,null))))))},J=function(e){var t=z(),n=function(t){e.move(t,t-1)},r=function(t){e.move(t,t+1)};return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":"")},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(l.a,{className:t.arrayContainer},e.value.map((function(t,a){return s.a.createElement(Z,{key:a,item:t,editing:e.editing,index:a,remove:function(){console.log(e.value),function(t){e.remove(t)}(a)},moveUp:n,moveDown:r,fieldsLen:e.value.length})})),s.a.createElement(l.a,{sx:{display:"flex",justifyContent:"center"}},s.a.createElement(p.a,{onClick:function(){e.push({term:""})}},s.a.createElement(x.a,null)))))},Q=function(e){var t=s.a.useState([]),n=Object(r.a)(t,2),a=n[0],i=n[1];s.a.useEffect((function(){var t;(null===e||void 0===e||null===(t=e.field)||void 0===t?void 0:t.list)?L.d(e.field.list).then((function(e){e.options&&i(e.options)})).catch((function(e){console.log(e)})):e.options&&i(e.options)}),[e.field]);var o=z();return s.a.createElement(l.a,{className:"".concat(o.item," ").concat(e.errors?"error":""),key:e.id},e.name&&s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(m.a,{multiple:!0,id:e.id,name:e.name,options:a,isOptionEqualToValue:function(e,t){return e.id===t.id},onChange:function(t,n){e.handleChange(n)},value:e.value,getOptionLabel:function(e){return e.term},style:{width:"100%"},renderInput:function(e){return s.a.createElement(v.a,Object.assign({},e,{variant:"standard"}))}}))},$=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.labelAlign?"label-"+e.labelAlign:"")},s.a.createElement("label",{className:"".concat(e.labelAlign?e.labelAlign:""),htmlFor:e.id},e.label),s.a.createElement(l.a,{className:"insideContent ".concat(e.labelAlign?e.labelAlign:"")},"text"===e.type&&s.a.createElement(l.a,null,e.value),"simple-date"===e.type&&s.a.createElement(s.a.Fragment,null,s.a.createElement(l.a,null,e.value)),"text-area"===e.type&&s.a.createElement(l.a,null,s.a.createElement(R.a,null,e.value)),("select"===e.type||"author"===e.type)&&s.a.createElement(l.a,null,e.value.map((function(e,t){return s.a.createElement(g.a,{key:t,label:e,style:{margin:5}})}))),"relation"===e.type&&s.a.createElement(l.a,null,e.value.map((function(t,n){return s.a.createElement(g.a,{key:n,label:t.name,style:{margin:5},icon:U.d.filter((function(e){return e.value===t.icon}))?U.d.filter((function(e){return e.value===t.icon}))[0].iconlight:s.a.createElement(s.a.Fragment,null),onClick:function(){e.redirect("/detail/".concat(t.id))}})})))))},ee=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item)},s.a.createElement("label",{htmlFor:e.id},e.label),s.a.createElement(l.a,{style:{maxHeight:400,overflow:"auto"}},s.a.createElement(D.a,{src:e.data,collapsed:!0})))},te=function(e){var t=z(),n=function(t){e.value.includes(t.target.value)?e.handleChange(e.value.filter((function(e){return e!==t.target.value}))):e.handleChange([].concat(Object(i.a)(e.value),[t.target.value]))};return s.a.createElement(l.a,{className:"".concat(t.item)},s.a.createElement("label",{htmlFor:e.id},e.label),s.a.createElement(l.a,null,e.options.map((function(t,r){return s.a.createElement(l.a,{key:r},s.a.createElement("label",{className:"simple inline",htmlFor:"".concat(e.id,"_").concat(t.value)},t.label),s.a.createElement("input",{type:"checkbox",id:"".concat(e.id,"_").concat(t.value),onChange:n,onBlur:function(){},checked:e.value.includes(t.value),value:t.value}))}))))},ne=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item)},s.a.createElement(l.a,{style:{marginRight:10}},s.a.createElement("label",{htmlFor:e.id},e.label),e.instructions&&s.a.createElement(l.a,{className:"instructions"},e.instructions)),s.a.createElement(l.a,null,s.a.createElement(y.a,{variant:"outlined",onClick:function(){F.a.fire({title:"\xbfEst\xe1s seguro?",text:"\xbfEst\xe1s seguro de que deseas realizar la acci\xf3n?",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed",cancelButtonText:"No"}).then((function(t){t.isConfirmed&&Object(I.q)(e.value).then((function(e){F.a.fire({title:"\xa1Hecho!",text:e.msg,icon:"success",confirmButtonText:"Aceptar"})})).catch((function(e){console.log(e)}))}))}},e.btn_label)))},re=function(e){var t=z();return s.a.createElement(l.a,{className:"".concat(t.item)},s.a.createElement("label",{htmlFor:e.id},e.label),s.a.createElement(l.a,null,e.data.map((function(t,n){return s.a.createElement(s.a.Fragment,null,"select"===t.type&&s.a.createElement(W,{name:t.label,id:n,value:e.values[t.id],options:e.options.map((function(e){return{value:e.slug,label:e.name}})),handleChange:function(n,r){e.setFieldValue(t.id,n.target.value)},handleBlur:function(){},instructions:t.instructions}),"checkbox"===t.type&&s.a.createElement(te,{label:t.label,id:n,value:e.values[t.id],options:e.options.map((function(e){return{value:e.slug,label:e.name}})),handleChange:function(n){e.setFieldValue(t.id,n)},handleBlur:function(){}}),"checkbox_single"===t.type&&s.a.createElement(q,{name:t.label,id:n,value:e.values[t.id],handleChange:function(n){e.setFieldValue(t.id,n)},instructions:t.instructions}),"button_single"===t.type&&s.a.createElement(ne,{label:t.label,id:n,instructions:t.instructions,btn_label:t.btn_label,value:t.value}))}))))},ae=function(e){var t=z(),n=s.a.useState(e.value),a=Object(r.a)(n,2),i=a[0],o=a[1],c=s.a.useState(!1),u=Object(r.a)(c,2),d=u[0],h=u[1],m=s.a.useState(["",""]),v=Object(r.a)(m,2),g=v[0],y=v[1];return s.a.useEffect((function(){if(e.value){var t=e.value.split("|");t.length>1?(h(!0),y(t)):(t=e.value.split(",")).length>1&&(h(!1),y(t))}}),[]),s.a.useEffect((function(){e.setFieldValue(i)}),[i]),s.a.useEffect((function(){o("".concat(g[0]).concat(d?"|":",").concat(g[1]))}),[d,g]),s.a.createElement(s.a.Fragment,null,2===g.length&&s.a.createElement(f.a,{className:t.card},s.a.createElement(l.a,{sx:{width:"100%",padding:0}},s.a.createElement(l.a,{className:"".concat(t.subItemOpts," ots")},s.a.createElement(b.a,{checked:d,onClick:function(){h(!d)},size:"small"}),s.a.createElement(E.a,{type:"text",placeholder:"".concat(d?"Organizaci\xf3n":"Nombre(s)"),value:g[0],onChange:function(e){y([e.target.value.replace(",","").replace("|",""),g[1]]),o("".concat(e.target.value.replace(",","").replace("|","")).concat(d?"|":",").concat(g[0]))}}),s.a.createElement(E.a,{type:"text",placeholder:"".concat(d?"Siglas":"Apellidos"),value:g[1],onChange:function(e){y([g[0],e.target.value.replace(",","").replace("|","")]),o("".concat(g[0]).concat(d?"|":",").concat(e.target.value.replace(",","").replace("|","")))}}),s.a.createElement(l.a,{sx:{width:"50px",display:"flex",justifyContent:"center",flexDirection:"column",padding:"5px",alignContent:"flex-start",alignItems:"flex-start"}},s.a.createElement(p.a,{onClick:function(){return e.remove()},size:"small"},s.a.createElement(S.a,null)))))))},ie=function(e){var t=z(),n=s.a.useState([]),a=Object(r.a)(n,2),o=(a[0],a[1]);return s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":"")},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(l.a,{className:t.arrayContainer},e.value.length>0&&s.a.createElement(s.a.Fragment,null,e.value.map((function(t,n){return s.a.createElement(ae,{key:n,value:t,remove:function(){return function(t){e.remove(t)}(n)},setFieldValue:function(t){return function(t,n){var r=Object(i.a)(e.value);r[t]=n,o(r),e.setFieldValue(r)}(n,t)}})}))),!e.editing&&s.a.createElement(l.a,{sx:{display:"flex",justifyContent:"center"}},s.a.createElement(p.a,{onClick:function(){e.push("")}},s.a.createElement(x.a,null)))))},oe=function(e){var t=z(),n=s.a.useState(null),a=Object(r.a)(n,2),o=a[0],c=a[1];return s.a.useEffect((function(){c(e.value)}),[e.value]),s.a.createElement(s.a.Fragment,null,o&&s.a.createElement(l.a,{key:e.key,className:"".concat(t.item," ").concat(e.errors?"error":"")},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(l.a,{className:t.arrayContainer},e.value.length>0&&s.a.createElement(s.a.Fragment,null,e.value.map((function(t,n){return s.a.createElement(se,{value:t,key:n,index:n,fields:e.fields,remove:function(){return function(t){e.remove(t)}(n)},setFieldValue:function(t){return function(t,n){var r=Object(i.a)(o);r[t]=n,c(r),e.setFieldValue(r)}(n,t)}})}))),s.a.createElement(l.a,{sx:{display:"flex",justifyContent:"center"}},s.a.createElement(p.a,{onClick:function(){var t={};e.fields.map((function(e){t[e.id]=""})),e.push(t)}},s.a.createElement(x.a,null))))))},se=function(e){var t=z(),n=s.a.useState(null),i=Object(r.a)(n,2),o=i[0],c=i[1];return s.a.useEffect((function(){o&&e.setFieldValue(o)}),[o]),s.a.createElement(s.a.Fragment,null,e.value&&s.a.createElement(f.a,{key:e.key,className:t.card},s.a.createElement(l.a,{sx:{width:"100%",padding:0}},s.a.createElement(l.a,{className:"".concat(t.subItemOpts," ots")},e.fields.map((function(t,n){return s.a.createElement(s.a.Fragment,null,"select"===t.type&&s.a.createElement(d.a,{name:t.id,onChange:function(e){var n=Object(a.a)({},o);n[t.id]=e.target.value,c(n)},value:e.value[t.id]?e.value[t.id]:"",style:{width:"100%"}},t.options.map((function(e,t){return s.a.createElement(h.a,{key:t,value:e.value},e.label)}))),"number"===t.type&&s.a.createElement(E.a,{name:t.id,type:"number",onChange:function(e){var n=Object(a.a)({},o);n[t.id]=e.target.value,c(n)},min:0,value:e.value[t.id]?parseInt(e.value[t.id]):0,style:{width:"100%"}}))})),s.a.createElement(l.a,{sx:{width:"50px",display:"flex",justifyContent:"center",flexDirection:"column",padding:"5px",alignContent:"flex-start",alignItems:"flex-start"}},s.a.createElement(p.a,{onClick:function(){return e.remove()},size:"small"},s.a.createElement(S.a,null)))))))},le=function(e){var t=z(),n=s.a.useState([null,null,null]),a=Object(r.a)(n,2),i=a[0],o=a[1];return s.a.useEffect((function(){if(e.value){var t=new Date(e.value);o([t.getFullYear(),t.getMonth()+1,t.getDate()])}}),[]),s.a.useEffect((function(){if(i[0]){var t=0,n=1;i[1]&&(t=i[1]-1),i[2]&&(n=i[2]);var r=new Date(i[0],t,n);e.setFieldValue(r)}else e.setFieldValue(null)}),[i]),s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":""),key:e.id},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(l.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center"}},s.a.createElement(E.a,{type:"number",step:"1",min:"1900",max:"3000",placeholder:"A\xf1o",value:i[0],onChange:function(e){o([e.target.value,i[1],i[2]])}}),s.a.createElement(E.a,{type:"number",placeholder:"Mes",min:"1",max:"12",value:i[1],onChange:function(e){o([i[0],e.target.value,i[2]])}}),s.a.createElement(E.a,{type:"number",placeholder:"Dia",min:"1",max:"31",value:i[2],onChange:function(e){o([i[0],i[1],e.target.value])}})))},ce=function(e){var t=z(),n=s.a.useState([]),a=Object(r.a)(n,2),o=a[0],c=a[1],u=s.a.useState(null),d=Object(r.a)(u,2),h=d[0],f=d[1],p=s.a.useState([]),m=Object(r.a)(p,2),v=m[0];m[1];return s.a.useEffect((function(){e.value&&c(e.value),e.postType&&P.c(e.postType.relation_type).then((function(e){e.parentsTypes.length>0?f([].concat(Object(i.a)(e.parentsTypes),[{id:e.id,name:e.name,slug:e.slug,direct:!0}])):f([{id:e.id,name:e.name,slug:e.slug,direct:!0}])})).catch((function(e){console.log(e)}))}),[]),s.a.useEffect((function(){e.setFieldValue(o)}),[o]),s.a.createElement(s.a.Fragment,null,o&&h&&s.a.createElement(l.a,{className:"".concat(t.item," ").concat(e.errors?"error":""),key:e.id},s.a.createElement("label",{htmlFor:e.id},e.name,e.required?s.a.createElement("span",null,"*"):""),s.a.createElement(l.a,{sx:{display:"flex",justifyContent:"flex-start",maxHeight:300,overflow:"auto",width:"100%"}},s.a.createElement(k.a,{parents:h,setFondo:function(e,t){o.length>0?0===o.filter((function(t){return t.id===e.id})).length?c([].concat(Object(i.a)(o),[e])):c(o.filter((function(t){return t.id!==e.id}))):c([].concat(Object(i.a)(o),[e]))},activeTypes:h.map((function(t){return t.direct=!1,t.slug===e.postType.relation_type&&(t.direct=!0),t})),childrenEditing:!0,selected:o||[],path:v}))))},ue=function(e){var t=s.a.useState(null),n=Object(r.a)(t,2),a=n[0],i=n[1];return s.a.useEffect((function(){if(e.condition){e.change(e.id,null);var t=e.options.filter((function(t){return t.value===e.conditionValue}));t.length>0?i(t[0].fields):i(null)}}),[e.condition,e.conditionValue]),s.a.createElement(s.a.Fragment,null,a&&s.a.createElement(s.a.Fragment,null,a.map((function(t,n){return s.a.createElement(s.a.Fragment,null,"multiple-checkbox"===t.type&&s.a.createElement(te,{label:e.label,key:n,value:e.value?e.value:[],options:t.options,handleChange:function(t){e.change(e.id,t)}}))}))))}},940:function(e,t,n){"use strict";var r=n(2),a=n.n(r);t.a=function(e){var t=e.children;return a.a.createElement(a.a.Fragment,null,a.a.createElement("section",{style:{marginLeft:"70px",marginTop:"10px",marginRight:"10px",position:"relative",width:"calc(100% - 70px)"}},t))}},941:function(e,t,n){"use strict";var r=n(16),a=n(2),i=n.n(a),o=n(843),s=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("svg",{viewBox:"0 0 53.2 53.2",xmlns:"http://www.w3.org/2000/svg"},i.a.createElement("path",{fill:"#a3d4ff",d:"M33.3 7.7v8.4h8.4z"}),i.a.createElement("path",{fill:"#2a5082",d:"M39.8 46.9h-27c-1.5 0-2.8-1.3-2.8-2.8V9.6c0-1.5 1.3-2.8 2.8-2.8h21.8l8 8v29.3c0 1.5-1.2 2.8-2.8 2.8zm-27-38.2c-.5 0-.9.4-.9.9v34.5c0 .5.4.9.9.9h27c.5 0 .9-.4.9-.9V15.6l-6.9-6.9h-21z"}),i.a.createElement("path",{fill:"#2a5082",d:"M38.9 17.1h-6.5v-6.6h1.9v4.7h4.6zM47.3 30.1h1.9V32h-1.9zM47.3 33.8h1.9v1.9h-1.9zM43.6 53.4H32.4v-1.9h11.2c2.1 0 3.7-1.7 3.7-3.7V37.6h1.9v10.2c0 3.1-2.5 5.6-5.6 5.6zM24.9 51.5h1.9v1.9h-1.9zM21.2 51.5h1.9v1.9h-1.9zM28.7 51.5h1.9v1.9h-1.9zM9.1 51.5c-2.1 0-3.7-1.7-3.7-3.7V31.4l2.1 2.1 1.3-1.3-4.4-4.4L0 32.2l1.3 1.3 2.1-2.1v16.4c0 3.1 2.5 5.6 5.6 5.6h10.2v-1.9H9.1zM3.5 24.5h1.9v1.9H3.5zM3.5 20.8h1.9v1.9H3.5zM51.3 22.9L49.2 25V5.9c0-3.1-2.5-5.6-5.6-5.6H32.4v1.9h11.2c2.1 0 3.7 1.7 3.7 3.7v19.2L45.2 23l-1.3 1.3 4.4 4.4 4.4-4.4-1.4-1.4zM5.4 18.9H3.5v-13C3.5 2.8 6 .3 9.1.3h10.2v1.9H9.1C7 2.2 5.4 3.8 5.4 5.9v13zM24.9.3h1.9v1.9h-1.9zM21.2.3h1.9v1.9h-1.9zM28.7.3h1.9v1.9h-1.9z"})))},l=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",id:"Layer_1",x:"0",y:"0",version:"1.1",viewBox:"0 0 53.2 53.2"},i.a.createElement("defs",null),i.a.createElement("path",{d:"M33.3 50.2h-3.6l-3-4.6c-.6-.9-1.6-1.4-2.6-1.4h-9.9c-1.1 0-2.1.6-2.7 1.5l-2.8 4.6H5.1v2.4l28.4-.2-.2-2.3zm-19.9-3.3c.1-.2.4-.4.7-.4H24c.3 0 .5.1.7.4l2.1 3.3-15.7.1 2.3-3.4z",class:"st0"}),i.a.createElement("path",{fill:"#a3d4ff",d:"M20.1 17.1L32.8 6.4l6.4 7.5L26 24.8z"}),i.a.createElement("path",{d:"M52.2 37.2L36.1 17.5l3-2.4.1.1 4.8-2c.9-.4 1.6-1.2 1.8-2.1.2-1 0-2-.6-2.7l-5.8-7C38.8.7 37.9.3 36.9.3s-1.8.5-2.4 1.3l-3.1 4.1.2.2-11.4 9.5-.3-.4-4.7 2c-.9.4-1.5 1.1-1.8 2.1-.2.9-.1 1.9.5 2.7l5.5 7.3c.6.8 1.5 1.2 2.5 1.2s1.9-.5 2.5-1.3l3-4.2-.2-.2 2.7-2.1 16.3 19.7c.6.7 1.4 1.1 2.2 1.1h.2c.8 0 1.6-.3 2.2-.8l.9-.8c1.4-1.2 1.5-3.1.5-4.5zM36.4 2.9c.2-.3.4-.3.6-.3.2 0 .4 0 .6.3l5.8 7c.2.3.2.5.1.7s-.1.4-.4.5l-3.2 1.3-5.5-6.8 2-2.7zM22.5 27.6c-.1.2-.4.3-.6.3-.2 0-.4 0-.6-.3l-5.5-7.3c-.2-.3-.2-.5-.1-.6 0-.1.1-.4.4-.5l3-1.3 5.4 6.9-2 2.8zM32.6 8.1l4.6 5.5-11.2 9-4.3-5.4 10.9-9.1zm17.6 31.8l-.9.8c-.2.2-.4.2-.6.2-.2 0-.4-.1-.6-.3L32.6 21.9 35 20l15.3 18.8c.3.3.3.8-.1 1.1z",class:"st0"})))},c=function(){return i.a.createElement(i.a.Fragment,null,i.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",id:"Layer_1",x:"0",y:"0",version:"1.1",viewBox:"0 0 53.2 53.2"},i.a.createElement("defs",null),i.a.createElement("path",{className:"back",d:"M11.3,46.4c0,2.4,1.9,4.3,4.3,4.3h23.3c-2.4,0-4.3-1.9-4.3-4.3H11.3z"}),i.a.createElement("path",{className:"back",d:"M8.7,41.6l-2.5,7.7l-2.6-7.8v-31c0-1,0.8-1.7,1.7-1.7H7c1,0,1.7,0.8,1.7,1.7V41.6z"}),i.a.createElement("line",{className:"front",fill:"currentColor",x1:"3.6",y1:"40.7",x2:"8.7",y2:"40.7"}),i.a.createElement("path",{className:"front",fill:"currentColor",d:"M11.3,9.7v2.6H9.6v-1.7c0-0.7-0.3-1.4-0.8-1.8V6.2c0-1.4-1.2-2.6-2.6-2.6c-1.4,0-2.6,1.2-2.6,2.6v2.5 c-0.5,0.5-0.9,1.2-0.9,1.9v31L6.2,52l3.4-10.2V14h1.7v8.6H13V9.7H11.3z M4.4,10.5c0-0.4,0.2-0.7,0.5-0.8h2.4 c0.3,0.1,0.5,0.4,0.5,0.8v1.8H4.4V10.5z M5.3,6.2c0-0.5,0.3-0.9,0.8-0.9S7,5.7,7,6.2v1.7H5.3V6.2z M6.1,46.6l-1.7-5.1h3.3L6.1,46.6z M7.8,39.8H4.4V14h3.4V39.8z"}),i.a.createElement("g",null,i.a.createElement("g",null,i.a.createElement("g",null,i.a.createElement("rect",{x:"21.7",y:"19.1",className:"front",fill:"currentColor",width:"15.5",height:"1.7"})),i.a.createElement("g",null,i.a.createElement("rect",{x:"21.7",y:"22.6",className:"front",fill:"currentColor",width:"15.5",height:"1.7"})),i.a.createElement("g",null,i.a.createElement("rect",{x:"21.7",y:"26",className:"front",fill:"currentColor",width:"15.5",height:"1.7"})),i.a.createElement("g",null,i.a.createElement("rect",{x:"21.7",y:"29.5",className:"front",fill:"currentColor",width:"9.5",height:"1.7"}))),i.a.createElement("path",{className:"front",fill:"currentColor",d:"M47.6,10.6L47.6,10.6l-0.1-0.1H20.8c-2.9,0-5.2,2.3-5.2,5.2v30.1h-5.2v0.9c0,2.9,2.3,5.2,5.2,5.2h23.2h0.1 c2.9,0,5.2-2.3,5.2-5.2v-31c0-1.9,1.5-3.4,3.4-3.4h0.1c1.9,0,3.4,1.5,3.4,3.4h-5.2v1.7h6.9h0.1v-1.6C52.8,12.9,50.5,10.6,47.6,10.6 z M17.7,50.2h-2.1c-1.6,0-2.9-1.1-3.3-2.6h21.5c0.1,1,0.6,1.9,1.2,2.6H17.7z M42.4,15.8v31c0,1.9-1.5,3.4-3.4,3.4h-0.2v-0.1 c-1.9,0-3.4-1.5-3.4-3.4v-0.9h-18v-30c0-1.9,1.5-3.4,3.4-3.4h22.9C42.9,13.3,42.4,14.5,42.4,15.8z"}))))},u=function(e){var t=e.className;return i.a.createElement(i.a.Fragment,null,i.a.createElement("div",{key:e.index,className:t,onClick:function(){return e.onClick(e.title)}},i.a.createElement("div",{className:"icon"},e.children),i.a.createElement("div",{className:"tooltipUi"},e.title)))},d=Object(o.a)((function(e){return{root:{position:"fixed",width:"54px",background:"rgba(42, 80, 130, 0.8)",borderRadius:"10px",top:"50%",transform:"translateY(-50%)",left:"10px",zIndex:15},item:{cursor:"pointer",position:"relative",margin:2,"& .tooltipUi":{position:"absolute",top:"50%",transform:"translate(calc(50px + 5px), -50%)",background:"rgba(20, 20, 20, 0.9)",padding:"1em",color:"white",borderRadius:"10px",opacity:0,zIndex:-1,visibility:"hidden",transition:"all 0.25s ease"},"& .icon":Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)(Object(r.a)({width:"50px",height:"50px",position:"relative",borderRadius:"10px",background:"rgba(255, 255, 255, 0.1)"},"background","rgba(42, 80, 130, 1)"),"display","flex"),"justifyContent","center"),"alignItems","center"),"&::before",{content:'""',position:"absolute",top:"5%",left:"5%",width:"90%",height:"90%",background:"rgba(255, 255, 255, 0.2)",borderRadius:"10px",transform:"scale(0.8)",opacity:0,transition:"all 0.25s ease"}),"& svg",{position:"relative",width:"20px","& path, & circle, & rect":{fill:"rgba(255, 255, 255, 0.8)"}}),"&:hover":{"& .icon":{"&::before":{transform:"scale(1)",opacity:1}},"& .tooltipUi":{transform:"translate(calc(50px + 10px), -50%)",opacity:1,zIndex:20,visibility:"visible"}},"&.edit .icon":{background:"#ed9f31"},"&.new .icon":{background:"#59b359"},"&.delete .icon":{background:"#d34a46"}}}})),h=[{name:"Patrones de texto",icon:i.a.createElement(s,null)},{name:"Informaci\xf3n de fichas",icon:i.a.createElement(c,null)},{name:"Resultados",icon:i.a.createElement(l,null)}];t.a=function(e){var t=d(),n=e.list?e.list:h;return i.a.createElement(i.a.Fragment,null,i.a.createElement("nav",{className:t.root},n.map((function(e,n){return i.a.createElement(u,{className:"".concat(t.item," ").concat(e.action?e.action:""),title:e.name,key:n,onClick:e.callback?e.callback:function(){}},e.icon)}))))}},943:function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"a",(function(){return c})),n.d(t,"d",(function(){return u}));var r=n(204),a=n(46);function i(){var e={method:"GET",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+"/types",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function o(e){var t={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(a.e+"/types",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function s(e){var t="/types/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function l(e,t){var n="/types/"+e,i={method:"PUT",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:t};return fetch(a.e+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function c(e){var t="/types/"+e,n={method:"DELETE",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){if(204!==e.status)return Promise.reject(e)}))}function u(e){var t="/types/info/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}},944:function(e,t,n){"use strict";n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return f}));var r=n(2),a=n.n(r),i=n(488),o=n(1404),s=n(201),l=n(1061),c=n(926),u=n(945),d=n.n(u),h=Object(i.a)(o.a)((function(e){var t=e.theme;return{backgroundColor:"light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[200],height:t.spacing(3),color:t.palette.text.primary,fontWeight:t.typography.fontWeightRegular,border:"1px solid #dcdcdc",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:300,"& svg":{width:15,marginLeft:10,marginRight:5}}})),f=Object(i.a)(o.a)((function(e){var t=e.theme;return{backgroundColor:"rgb(85 116 154)",height:t.spacing(3),color:"white",fontWeight:t.typography.fontWeightRegular,border:"1px solid #dcdcdc",whiteSpace:"nowrap",textOverflow:"ellipsis",maxWidth:300,"& svg":{width:15,marginLeft:10,marginRight:5},"& path":{fill:"#fff"}}}));t.c=function(e){return a.a.createElement(a.a.Fragment,null,a.a.createElement(s.a,{variant:"body2"},e.selectedType.description),a.a.createElement(l.a,{separator:a.a.createElement(d.a,{fontSize:"small",style:{margin:0}})},e.selectedType.parentsTypes.reverse().map((function(e,t){return a.a.createElement(h,{key:t,label:e.name})})),a.a.createElement(s.a,{variant:"body2",color:"text.primary"},e.selectedType.name)),e.selectedType.hierarchical&&a.a.createElement(c.a,null,a.a.createElement(s.a,{variant:"body2",color:"text.primary"},"Este tipo de contenido puede ser jer\xe1rquico entre si")),e.selectedType.metadata&&a.a.createElement(c.a,null,a.a.createElement(s.a,{variant:"body2",color:"text.primary"},"La estructura de metadatos es: ",e.selectedType.metadata.name)))}},946:function(e,t,n){"use strict";n.d(t,"a",(function(){return N}));var r=n(35),a=n(2),i=n.n(a),o=n(926),s=n(843),l=n(849),c=n(202),u=n(845),d=n(1387),h=n(848),f=n(847),p=n(846),m=n(340),v=n.n(m),g=n(1024),y=n.n(g),b=n(341),_=n.n(b),x=n(1025),E=n.n(x),S=n(937),M=n(1023),T=n.n(M),w=n(46),O=n(263),A=Object(s.a)((function(e){return{check:{padding:0},icon:{marginLeft:e.spacing(2),marginRight:e.spacing(1),minWidth:"auto","& path":{fill:"#56749a"}},text:{"& span":{display:"inline-block",padding:"0 10px",fontSize:"14px",transition:"all 0.3s ease-in-out"},"&.selected span":{background:"#c5cfdc",borderRadius:"5px",color:"#375374"}}}})),R=function(e){var t=Object(a.useState)(!1),n=Object(r.a)(t,2),o=n[0],s=n[1],l=A(),c=Object(a.useState)(!1),h=Object(r.a)(c,2),m=h[0],v=h[1];Object(a.useEffect)((function(){if(Object(O.isArray)(e.path)){var t=e.path.find((function(t){return!!t&&t.id===e.id}));v(!!t)}}),[e.path]),Object(a.useEffect)((function(){if(e.selected)if(e.selected.length>0){var t=e.selected.find((function(t){return!!t&&t.id===e.id}));s(!!t)}else s(!1);else s(!1)}),[e.selected]);var g=function(){e.setFondo(e.original,e.parent)};return i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{className:e.class},e.activeTypes.filter((function(t){return t.slug===e.original.post_type}))[0].direct&&i.a.createElement(d.a,{checked:o,className:l.check,edge:"start",color:"primary",onClick:function(){g()}}),i.a.createElement(p.a,{className:l.icon},w.d.filter((function(t){return t.value===e.original.icon}))?w.d.filter((function(t){return t.value===e.original.icon}))[0].iconlight:i.a.createElement(T.a,null)),i.a.createElement(f.a,{style:{cursor:"pointer"},onClick:function(){g()},primary:e.original.name,className:"".concat(l.text," ").concat(m||o?"selected":"")})))},C=Object(s.a)((function(e){return{root:{flexGrow:1,display:"flex",paddingTop:e.spacing(4)},check:{padding:0},accordeons:{flexGrow:1,paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},listado:{flexGrow:1,paddingLeft:e.spacing(2),paddingRight:e.spacing(2),maxWidth:600},nested:{paddingLeft:e.spacing(3)+"px !important",marginLeft:e.spacing(1),borderLeft:"1px solid #dcdcdc"},icon:{marginLeft:e.spacing(2),marginRight:e.spacing(1),minWidth:"auto","&.loading":{"-webkit-animation":"rotate-center 1s linear infinite both",animation:"rotate-center 1s linear infinite both"},"& path":{fill:"#56749a"}},iconExpand:{marginRight:e.spacing(1),minWidth:"auto","& path":{fill:"#999"}},text:{"& span":{display:"inline-block",padding:"0 10px",transition:"all 0.3s ease-in-out",fontSize:"14px"},"&.selected span":{background:"#c5cfdc",borderRadius:"5px",color:"#375374"}}}})),k=function e(t){var n=C(),o=Object(a.useState)(!1),s=Object(r.a)(o,2),m=s[0],g=s[1],b=Object(a.useState)(!1),x=Object(r.a)(b,2),M=x[0],T=x[1],A=Object(a.useState)(!1),k=Object(r.a)(A,2),P=k[0],L=k[1],I=Object(a.useState)(!1),N=Object(r.a)(I,2),D=N[0],U=N[1],j=Object(a.useState)([]),F=Object(r.a)(j,2),z=F[0],B=F[1],H=function(){g(!m)},V=function(){return[].concat(Object(c.a)(t.parent),[{id:t.id,name:t.name}])};return Object(a.useEffect)((function(){0===z.length&&m&&(U(!0),S.g(JSON.stringify({root:t.id,tree:t.activeTypes})).then((function(e){B(e),U(!1)})))}),[m]),Object(a.useEffect)((function(){if(U(!1),Object(O.isArray)(t.path)){var e=t.path.find((function(e){return!!e&&e.id===t.id}));L(!!e),g(!!e)}}),[t.path]),Object(a.useEffect)((function(){t.selected?t.selected.length>0&&t.selected.filter((function(e){return e.id===t.original.id})).length>0?T(!0):T(!1):T(!1)}),[t.selected]),i.a.createElement(i.a.Fragment,null,i.a.createElement(u.a,{className:t.class},t.activeTypes.filter((function(e){return e.slug===t.original.post_type}))[0].direct&&i.a.createElement(d.a,{checked:M,color:"primary",edge:"start",className:n.check,onClick:function(){t.setFondo(t.original,t.parent)}}),D?i.a.createElement(p.a,{className:"loading ".concat(n.icon)},i.a.createElement(E.a,null)):i.a.createElement(i.a.Fragment,null,i.a.createElement(p.a,{className:n.icon},w.d.filter((function(e){return e.value===t.original.icon}))?w.d.filter((function(e){return e.value===t.original.icon}))[0].icon:i.a.createElement(y.a,null))),m&&!D?i.a.createElement(v.a,{style:{cursor:"pointer"},onClick:H,className:n.iconExpand}):i.a.createElement(i.a.Fragment,null,D?i.a.createElement(_.a,{className:n.iconExpand}):i.a.createElement(_.a,{style:{cursor:"pointer"},onClick:H,className:n.iconExpand})),i.a.createElement(f.a,{style:{cursor:"pointer"},className:"".concat(n.text," ").concat(P||M?"selected":""),primary:t.original.name,onClick:function(){t.setFondo(t.original,t.parent)}})),i.a.createElement(h.a,{in:m,timeout:"auto",unmountOnExit:!0},i.a.createElement(l.a,{component:"div",disablePadding:!0,className:t.class},z.map((function(r){return!0!==r.children?i.a.createElement(i.a.Fragment,null,i.a.createElement(R,{name:r.text,original:r,class:"".concat(t.class," ").concat(n.nested),setFondo:t.setFondo,fondo:t.fondo,id:r.id,parent:null!==t.parent?V():[{id:t.id,name:t.name}],path:t.path,selected:t.selected,activeTypes:t.activeTypes})):i.a.createElement(i.a.Fragment,null,i.a.createElement(e,{name:r.text,class:"".concat(n.nested," ").concat(t.class),children:r.children,original:r,id:r.id,path:t.path,setFondo:t.setFondo,fondo:t.fondo,parent:null!==t.parent?V():[{id:t.id,name:t.name}],activeTypes:t.activeTypes,selected:t.selected}))})))))},P=Object(s.a)((function(e){return{root:{flexGrow:1,display:"flex",paddingTop:e.spacing(4)},tabs:{},accordeons:{flexGrow:1,paddingLeft:e.spacing(2),paddingRight:e.spacing(2)},listado:{flexGrow:1,paddingLeft:e.spacing(2),paddingRight:e.spacing(2),maxWidth:600},nested:{paddingLeft:e.spacing(3),marginLeft:e.spacing(3),borderLeft:"1px solid #dcdcdc"},item:{padding:1}}})),L=function(e){var t=P();return i.a.createElement(o.a,{className:t.listado},i.a.createElement(l.a,{disablePadding:!0,component:"nav","aria-labelledby":"nested-list-subheader"},e.root.map((function(n){return!0===n.children?i.a.createElement(i.a.Fragment,null,i.a.createElement(k,{name:"".concat(n.text),children:n.children,id:n.id,original:n,setFondo:e.setFondo,setLoading:e.setLoading,fondo:e.fondo,class:t.item,parent:null,path:e.path,activeTypes:e.activeTypes,selected:e.selected})):i.a.createElement(i.a.Fragment,null,i.a.createElement(R,{id:n.id,name:n.text,original:n,setFondo:e.setFondo,fondo:e.fondo,parent:null,path:e.path,class:t.item,selected:e.selected,activeTypes:e.activeTypes}))}))))},I=n(951),N=function(e){var t=Object(a.useState)(0),n=Object(r.a)(t,2),o=(n[0],n[1],Object(a.useState)([])),s=Object(r.a)(o,2),l=s[0],c=s[1];return Object(a.useEffect)((function(){var t,n,r={root:e.root?e.root:"all",tree:e.parents};e.parents.length>0&&((null===(t=e.filters)||void 0===t?void 0:t.treeKeyword)&&""!==(null===(n=e.filters)||void 0===n?void 0:n.treeKeyword)?(r.keyword=e.filters.treeKeyword,Object(I.b)(JSON.stringify(r)).then((function(e){c(e)}))):Object(S.g)(JSON.stringify(r)).then((function(e){c(e)})))}),[e.parents,e.filters]),i.a.createElement("div",{style:{marginTop:10}},i.a.createElement(L,{root:l,path:e.path,selected:e.selected,setFondo:e.setFondo,activeTypes:e.activeTypes,childrenEditing:e.childrenEditing,setPath:e.setPath}))};t.b=N},947:function(e,t,n){"use strict";var r=n(35),a=n(16),i=n(2),o=n.n(i),s=n(843),l=n(930),c=n(1084),u=n(1402),d=n(1392),h=n(450),f=n(1009),p=n.n(f),m=n(1007),v=n.n(m),g=n(1008),y=n.n(g),b=Object(s.a)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"},searchContainer:Object(a.a)(Object(a.a)({backgroundColor:"rgba(25,68,124,0.6)",backdropFilter:"blur(10px)",borderBottom:"1px solid rgba(255,255,255,0.1)",padding:e.spacing(1),display:"flex",position:"relative",alignItems:"center",minWidth:350,borderRadius:5},e.breakpoints.down("md"),{minWidth:"auto"}),"& input",{color:"#fff"}),searchContainerLight:Object(a.a)(Object(a.a)({backgroundColor:"rgb(115 141 175 / 23%)",backdropFilter:"blur(20px)",borderBottom:"1px solid rgba(255,255,255,0.1)",padding:e.spacing(1),display:"flex",position:"relative",alignItems:"center",minWidth:350,color:"#rgba(25,68,124,0.6)",borderRadius:5},e.breakpoints.down("md"),{minWidth:"auto"}),"& input",{color:"rgba(25,68,124,1)"}),searchInput:Object(a.a)({width:"100%",color:"white",fontWeight:"bold"},e.breakpoints.down("md"),{padding:0}),SearchIcon:{marginRight:"2%",color:"#fff","& path":{fill:"#fff"}},SearchIconLight:{marginRight:"2%",color:"#rgba(25,68,124,0.6)","& path":{fill:"#rgba(25,68,124,0.6)"}},tableRow:{width:"100%",display:"flex",alignItems:"center",alignContent:"stretch","&:nth-child(even)":{backgroundColor:"#ececec"}},tableCell:{width:"25%",padding:10,borderRight:"1px solid #ccc"},accessLevel:{width:30,height:30,textAlign:"center",lineHeight:"30px",borderRadius:"50%",display:"inline-block",backgroundColor:"#a7b7cb",color:"#fff","&.level_3":{backgroundColor:"#f7b500"},"&.level_2":{backgroundColor:"#eda73e"},"&.level_1":{backgroundColor:"#ed6e3e"}},help:{position:"absolute",top:85,right:40,maxWidth:700,width:"calc(100% - 440px)",height:"calc(100% - 100px)",backgroundColor:"rgb(114 141 174 / 82%)",zIndex:1,borderRadius:15,backdropFilter:"blur(10px)",display:"flex",alignItems:"center",justifyContent:"center",color:"#fff","& .txt":{maxWidth:650,padding:20,"& p":{borderLeft:"3px solid #fff",borderTop:"1px dashed #fff",paddingTop:10,paddingLeft:10}},"& .box":{backgroundColor:"rgba(255,255,255,0.65)",paddingLeft:20,paddingRight:20,borderRadius:15,marginRight:5,marginLeft:5,color:"#333"},"& .bold":{fontWeight:"bold",color:"#2c3e50",marginRight:5,marginLeft:5}}}}));t.a=function(e){var t=b(),n=(e.onSearchSubmit,Object(i.useRef)(null)),a=o.a.useState(""),s=Object(r.a)(a,2),f=s[0],m=s[1];return o.a.createElement(l.a,{style:{position:"sticky",top:45,zIndex:1}},o.a.createElement("form",{className:"".concat("light"===e.variant?t.searchContainerLight:t.searchContainer),onSubmit:function(t){t.preventDefault(),e.onSearchSubmit(f)}},o.a.createElement(h.a,{className:"".concat("light"!==e.variant?t.SearchIcon:t.SearchIconLight)}),o.a.createElement(c.c,{className:t.searchInput,placeholder:"Buscar palabra clave",ref:n,inputProps:{maxLength:140},value:f,onChange:function(t){m(t.target.value),""===t.target.value&&e.onSearchSubmit("")}}),""!==f&&o.a.createElement(u.a,{onClick:function(){m(""),e.onSearchSubmit("")}},o.a.createElement(v.a,{className:"".concat("light"!==e.variant?t.SearchIcon:t.SearchIconLight)})),"light"!==e.variant&&o.a.createElement(o.a.Fragment,null,o.a.createElement(d.a,{size:"small",sx:{backgroundColor:"#f5f5f5",color:"light"===e.variant?"#333":"#2a5082",fontWeight:"bold"},label:e.total>=1?"".concat(e.total," resultados"):"No hay resultados"}),o.a.createElement(u.a,null,o.a.createElement(y.a,{className:"".concat("light"!==e.variant?t.SearchIcon:t.SearchIconLight)})),o.a.createElement(u.a,null,o.a.createElement(p.a,{className:"".concat("light"!==e.variant?t.SearchIcon:t.SearchIconLight)})))))}},951:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var r=n(46),a=n(204);function i(e){var t={method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:Object(a.a)()}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/search",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function o(e){var t={method:"POST",headers:new Headers({"Content-Type":"application/json",Authorization:Object(a.a)()}),mode:"cors",cache:"default",body:e};return fetch(r.e+"/search/tree",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}},953:function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"l",(function(){return o})),n.d(t,"b",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"g",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"d",(function(){return d})),n.d(t,"e",(function(){return h})),n.d(t,"a",(function(){return f})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return m})),n.d(t,"j",(function(){return v}));n(996);var r=n(46),a=n(204);function i(e){var t={method:"PUT",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(r.e+"/users/update",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function o(e){var t={method:"PUT",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(r.e+"/users/update-me",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function s(e){var t={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(r.e+"/users/register",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function l(e){var t="/users/"+e,n={method:"GET",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(r.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function c(e){var t={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(r.e+"/users",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function u(e){var t={method:"POST",headers:{Authorization:Object(a.a)(),"Content-Type":"application/json"},mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/users/token",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function d(e){var t={method:"POST",headers:{Authorization:Object(a.a)(),"Content-Type":"application/json"},mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/users/admin-token",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function h(e){var t={method:"POST",headers:{Authorization:Object(a.a)(),"Content-Type":"application/json"},mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/users/node-token",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function f(e){var t={method:"POST",headers:{Authorization:Object(a.a)(),"Content-Type":"application/json"},mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/users/favorites",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function p(e){var t={method:"DELETE",headers:{Authorization:Object(a.a)(),"Content-Type":"application/json"},mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/users/favorites",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function m(e){var t={method:"POST",headers:{Authorization:Object(a.a)(),"Content-Type":"application/json"},mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/users/favorites_list",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}function v(){var e={method:"GET",headers:{Authorization:Object(a.a)(),"Content-Type":"application/json"},mode:"cors",cache:"default"};return fetch(r.e+"/users/requests",e).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))}},954:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(35),a=n(2),i=function(e,t){var n,i=a.useState(null!==(n=JSON.parse(localStorage.getItem(e)))&&void 0!==n?n:t),o=Object(r.a)(i,2),s=o[0],l=o[1];return a.useEffect((function(){localStorage.setItem(e,JSON.stringify(s))}),[s,e]),[s,l]}},956:function(e,t,n){"use strict";var r=n(18),a=n(35),i=n(2),o=n.n(i),s=n(852),l=n(962),c=n(1392),u=n(1400),d=n(937),h=n(951),f=n(203),p=n.n(f),m=n(36),v=n(955),g=n.n(v),y=n(942),b=n.n(y),_=n(978),x=n.n(_),E=n(960),S=n.n(E),M=n(957),T=n(958),w=n(1360),O=n(967),A=n(959),R=n(338),C=n.n(R),k=n(339),P=Object(s.a)((function(e){return{btn_color:{color:"#869bb7 !important",padding:"5px !important",width:"30px !important",height:"30px !important",margin:"0 2px !important",borderRadius:"50%",border:"1px solid #c6d0dd !important","&:hover":{color:"#fff !important",backgroundColor:"#56749a !important"},"& .MuiSvgIcon-root":{width:"14px !important"}},chip_style:{margin:"1px 2px !important",backgroundColor:"rgb(115 141 175 / 10%) !important",color:"rgba(42, 80, 130, .6) !important",transition:"all .3s ease-in-out !important","& svg":{width:"15px !important",marginLeft:"10px !important"},"& path":{fill:"rgba(42, 80, 130, .6) !important",transition:"all .3s ease-in-out !important"},"&:hover":{backgroundColor:"rgba(42, 80, 130, .6) !important",color:"#fff !important","& path":{fill:"#fff !important"}}},access_chip:{backgroundColor:"rgba(42, 80, 130, .15) !important",border:"1px solid rgba(42, 80, 130, .5) !important",color:"rgba(42, 80, 130, .9) !important"}}}));t.a=function(e){var t=P(),n=Object(i.useState)([]),s=Object(a.a)(n,2),f=s[0],v=s[1],y=Object(i.useState)(0),_=Object(a.a)(y,2),E=_[0],R=_[1],L=Object(i.useState)(0),I=Object(a.a)(L,2),N=I[0],D=I[1],U=Object(m.k)(),j=Object(i.useState)(!1),F=Object(a.a)(j,2),z=F[0],B=F[1],H=Object(i.useState)(!1),V=Object(a.a)(H,2),G=V[0],W=V[1];Object(i.useEffect)((function(){var t=Object(r.a)({},e.filters);t.page=E,e.parent&&(t.parents||(t.parents={id:e.parent._id,post_type:e.parent.post_type})),e.viewDrafts?t.status="draft":t.status="published",t.post_type=e.selectedType.slug,v([]),B(!0),t.keyword?h.a(t).then((function(t){v(t.resources),B(!1),t.resources.length>0?(D(t.total),e.parentTotal(t.total)):(D(0),e.parentTotal&&e.parentTotal(0))})):d.b(e.selectedType.slug,JSON.stringify(t)).then((function(t){v(t.resources),B(!1),t.resources.length>0&&(D(t.total),e.parentTotal&&e.parentTotal(t.total))}))}),[e.selectedType,e.filters,E,e.viewDrafts]),Object(i.useEffect)((function(){R(0)}),[e.selectedType,e.filters]);return o.a.createElement(w.a,{backend:O.a},o.a.createElement(M.a,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")}},z&&o.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}},o.a.createElement(C.a,{options:{loop:!0,autoplay:!0,animationData:k,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},height:100,width:100})),0===f.length&&!z&&o.a.createElement("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100%"}},o.a.createElement("h3",null,"No se encontraron resultados")),f.length>0&&!z&&o.a.createElement(l.a,{pagination:!0,resources:f,page:E,setPage:R,total:N,type:e.type,selectedResources:e.selectedResources,perpage:20,handleClick:e.handleClick,setSelected:e.setSelected,style:{position:"absolute"},columns:[{destiny:"",label:""},{destiny:"metadata.firstLevel.title",label:"T\xedtulo"},{destiny:"accessRights",label:"Derechos de acceso"}],columnSolver:function(n,r){return o.a.createElement(o.a.Fragment,null,"metadata.firstLevel.title"===r.destiny&&o.a.createElement("span",null,n.metadata.firstLevel.title),"accessRights"===r.destiny&&o.a.createElement(o.a.Fragment,null,n.accessRights&&o.a.createElement(c.a,{size:"small",label:n.accessRights,className:t.access_chip})),""===r.destiny&&o.a.createElement(u.a,{disableGutters:!0,variant:"dense",style:{minHeight:"auto",display:"flex",justifyContent:"center",flexFlow:"wrap"}},o.a.createElement(c.a,{label:"",size:"small",icon:o.a.createElement(b.a,null),onClick:function(){return t=n.id,void("users"===e.selectedType?U.push("/admin/users/edit/".concat(t)):U.push("/cataloging/".concat(e.selectedType.slug,"/edit/").concat(t)));var t},className:t.chip_style}),o.a.createElement(c.a,{label:"",size:"small",icon:o.a.createElement(g.a,null),onClick:function(){return e=n.id,void p.a.fire({title:"\xbfEst\xe1s seguro?",text:"No podr\xe1s revertir esta acci\xf3n",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"}).then((function(t){t.isConfirmed&&d.a(e).then((function(e){p.a.fire({title:"Eliminado",text:"El recurso ha sido eliminado",icon:"success",confirmButtonText:"Aceptar"}).then((function(){window.location.reload()}))})).catch((function(e){e.json().then((function(e){p.a.fire({title:"Error",text:e.msg,icon:"error",confirmButtonText:"Aceptar"})}))}))}));var e},className:t.chip_style}),o.a.createElement(c.a,{label:"Ver metadatos",size:"small",icon:o.a.createElement(S.a,null),onClick:function(){var e;e=n.id,W({id:e})},className:t.chip_style}),o.a.createElement(c.a,{label:"Ver recurso",size:"small",icon:o.a.createElement(x.a,null),onClick:function(){return e.handleClick(n)},className:t.chip_style})))}}),o.a.createElement(T.a,{id:"metadata-info",initialPosition:{x:0,y:0},style:{display:G?"block":"none"},offsetOrigin:e.offsetOrigin?e.offsetOrigin:{x:0,y:-157}},o.a.createElement(A.a,{resource:G,setMetadata:W}))))}},957:function(e,t,n){"use strict";n.d(t,"a",(function(){return l}));var r=n(18),a=n(35),i=n(2),o=n.n(i),s=n(1380),l=function(e){var t=e.onDrop,n=e.children,l=Object(i.useRef)(null),c=Object(i.useState)({x:0,y:0}),u=Object(a.a)(c,2),d=u[0],h=u[1],f=Object(s.a)((function(){return{accept:"box",drop:function(e,n){var a=n.getClientOffset(),i=l.current.getBoundingClientRect();if(a){var o={x:a.x-i.left,y:a.y-i.top,mousePosition:Object(r.a)({},d)};return t(Object(r.a)(Object(r.a)({},e),{},{newPosition:o})),{newPosition:o}}}}}),[t]),p=Object(a.a)(f,2);p[0];return(0,p[1])(l),o.a.createElement("div",{ref:l,id:"droppable-area",style:{width:"100%",height:"100%",position:"relative",overflow:"visible"},onMouseDown:function(e){h({x:e.pageX,y:e.pageY})}},n)}},958:function(e,t,n){"use strict";n.d(t,"a",(function(){return h}));var r=n(18),a=n(35),i=n(2),o=n.n(i),s=n(1381),l=n(1144),c=n(843),u=n(954),d=Object(c.a)((function(e){return{}})),h=function(e){var t=e.offsetOrigin,n=e.id,c=e.children,h=e.initialPosition,f=e.style,p=(d(),Object(i.useState)(h)),m=Object(a.a)(p,2),v=m[0],g=m[1],y=Object(i.useState)({x:0,y:0}),b=Object(a.a)(y,2),_=b[0],x=(b[1],Object(i.useState)({x:0,y:0})),E=Object(a.a)(x,2),S=E[0],M=E[1],T=Object(i.useState)(!0),w=Object(a.a)(T,2),O=(w[0],w[1],Object(i.useRef)(null)),A=document.getElementById("droppable-area"),R=Object(u.a)("position-".concat(n),{x:0,y:0}),C=Object(a.a)(R,2),k=C[0],P=C[1],L=Object(s.a)((function(e){return{type:"box",item:{id:n,position:v},collect:function(e){return{isDragging:!!e.isDragging(),item:e.getItem(),initialClientOffset:e.getInitialClientOffset(),differenceFromInitialOffset:e.getDifferenceFromInitialOffset(),clientOffset:e.getClientOffset()}},end:function(e,t){if(t.getDropResult()){var n=t.getDropResult().newPosition;n.x=n.x+S.x,n.y=n.y+S.y}}}})),I=Object(a.a)(L,3),N=I[0].isDragging,D=I[1],U=I[2];Object(i.useEffect)((function(){U&&U(Object(l.a)(),{captureDraggingState:!0})}),[U]);Object(i.useEffect)((function(){if(O&&k)if(0===k.x&&0===k.y){var e=document.getElementById("droppable-area").getBoundingClientRect(),t=O.current.getBoundingClientRect(),n=e.height/2-t.height/2;g({x:0,y:n}),P({x:0,y:j().y})}else g({x:k.x,y:k.y})}),[O]);var j=function(){var e=v.x-500,n=v.y-77;return t&&(e+=t.x,n+=t.y),e<0&&(e=0),n<0&&(n=0),A&&(e+O.current.offsetWidth>A.offsetWidth&&(e=A.offsetWidth-O.current.offsetWidth),n+O.current.offsetHeight>A.offsetHeight&&(n=A.offsetHeight-O.current.offsetHeight)),{x:e,y:n}};return D(O),o.a.createElement("div",{ref:O,style:Object(r.a)(Object(r.a)({},f),{},{position:"absolute",translate:"".concat(j().x,"px ").concat(j().y,"px"),scale:"".concat(N?1.01:1),boxShadow:N?"0 0 10px 0 rgba(150,150,150,0.5)":"0 0 5px 0 rgba(150,150,150,0.6)"}),onMouseDown:function(e){var t=O.current.getBoundingClientRect(),n=e.pageX-t.left,r=e.pageY-t.top;M({x:n,y:r})},onDrag:function(e){O.current.getBoundingClientRect();g({x:e.clientX-_.x-S.x,y:e.clientY-_.y-S.y,mousePosition:v.mousePosition}),P({x:e.clientX-_.x-S.x,y:e.clientY-_.y-S.y})},draggable:!0},c)}},959:function(e,t,n){"use strict";var r=n(35),a=n(2),i=n.n(a),o=n(937),s=n(969),l=n(843),c=n(1404),u=n(995),d=n.n(u),h=n(1001),f=n.n(h),p=Object(l.a)((function(e){return{scrollbar:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},close:{"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"}},noborder:{border:"none"}}}));t.a=function(e){var t=p(),n=Object(a.useState)(!1),l=Object(r.a)(n,2),u=(l[0],l[1]),h=Object(a.useState)(null),m=Object(r.a)(h,2),v=m[0],g=m[1],y=Object(a.useState)(null),b=Object(r.a)(y,2),_=b[0],x=b[1];return Object(a.useEffect)((function(){if(u(!0),e.resource){if(_===e.resource.id)return void u(!1);o.e(e.resource.id).then((function(t){g(t),u(!1),x(e.resource.id)})).catch((function(e){console.log(e)}))}}),[e.resource]),i.a.createElement(i.a.Fragment,null,v&&i.a.createElement("div",{style:{background:"white"}},i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between"}},i.a.createElement("div",null,e.history&&i.a.createElement(c.a,{label:"Ir al recurso",size:"small",onClick:function(){e.history.push("/detail/".concat(e.resource.id))},icon:i.a.createElement(f.a,null),style:{margin:3},variant:"outlined",className:"".concat(t.noborder)})),i.a.createElement(c.a,{label:"Cerrar",size:"small",onClick:function(){e.setMetadata(null)},variant:"outlined",icon:i.a.createElement(d.a,null),style:{margin:3,width:24,height:24},className:"".concat(t.close," ").concat(t.noborder)})),i.a.createElement(s.a,{data:v,className:t.scrollbar,resource:e.resource,labelAlign:"top",style:{width:370,height:300,overflowY:"auto"}})))}},962:function(e,t,n){"use strict";var r=n(202),a=n(35),i=n(2),o=n.n(i),s=n(843),l=n(930),c=n(1395),u=n(1396),d=n(1398),h=n(1394),f=n(1399),p=n(1385),m=n(1397),v=n(1391),g=n(1387);Object(s.a)((function(e){return{btn_color:{color:"#869bb7 !important",padding:"5px !important",width:"30px !important",height:"30px !important",margin:"0 2px !important",border:"1px solid #c6d0dd !important","&:hover":{color:"#fff !important",backgroundColor:"#56749a !important"},"& .MuiSvgIcon-root":{width:"14px !important"}}}}));function y(e){e.onSelectAllClick;var t=e.order,n=e.orderBy,r=(e.numSelected,e.rowCount,e.onRequestSort,e.headCells);return o.a.createElement(f.a,null,o.a.createElement(m.a,null,r.map((function(e){return o.a.createElement(d.a,{key:e.id,align:e.numeric?"right":"left",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&t},e.label)}))))}function b(e){e.numSelected;return o.a.createElement(p.a,{rowsPerPage:e.perpage,rowsPerPageOptions:[],count:e.total,page:e.page,onPageChange:function(t,n){e.setPage(n)}})}t.a=function(e){var t=e.style,n=e.resources,s=e.pagination,f=e.columns,p=e.columnSolver,_=e.page,x=e.setPage,E=e.total,S=e.handleClick,M=e.perpage,T=e.type,w=e.selectedResources,O=o.a.useState(!1),A=Object(a.a)(O,2),R=A[0],C=(A[1],Object(i.useState)([])),k=Object(a.a)(C,2),P=k[0];k[1];return Object(i.useEffect)((function(){console.log(n)}),[]),o.a.createElement(o.a.Fragment,null,n.length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(l.a,{sx:{width:"100%"},style:t||null},o.a.createElement(v.a,{sx:{width:"100%",mb:2}},o.a.createElement(h.a,null,o.a.createElement(c.a,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:R?"small":"medium",padding:"none"},o.a.createElement(y,{numSelected:P.length,headCells:"checkbox"===T?[{id:"checkbox",numeric:!1,disablePadding:!0,label:""}].concat(Object(r.a)(f)):f}),o.a.createElement(u.a,null,n.map((function(e){return o.a.createElement(o.a.Fragment,null,o.a.createElement(m.a,{hover:!0,role:"checkbox",tabIndex:-1,key:e.id,style:S?{cursor:"pointer"}:{}},"checkbox"===T&&o.a.createElement(d.a,{component:"th",id:"checkbox",scope:"row",sx:{padding:"10px 10px"}},o.a.createElement(g.a,{color:"primary",checked:!!w&&w.includes(e.id)})),f.map((function(t){return o.a.createElement(d.a,{component:"th",id:t.destiny,scope:"row",onClick:S&&""!==t.destiny?function(){return S(e)}:null,key:t.destiny,sx:{padding:"10px 10px"}},p(e,t))}))),e.snap&&o.a.createElement(m.a,null,o.a.createElement(d.a,{component:"th",scope:"row",sx:{padding:"10px 10px"}},o.a.createElement(v.a,null,e.snap))))}))),s&&o.a.createElement(b,{page:_,setPage:x,total:E,perpage:M})))))))}},963:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"e",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return c}));var r=n(204),a=n(46);function i(){var e={method:"GET",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+"/lists",e).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function o(e){var t="/lists/"+e,n={method:"GET",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function s(e,t){var n=new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),i="/lists/"+e;console.log(t);var o={method:"PUT",headers:n,mode:"cors",cache:"default",body:t};return fetch(a.e+i,o).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function l(e){var t={method:"POST",headers:new Headers({Authorization:Object(r.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(a.e+"/lists",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function c(e){var t="/lists/"+e,n={method:"DELETE",headers:new Headers({Authorization:Object(r.a)()}),mode:"cors",cache:"default"};return fetch(a.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e}))}},965:function(e,t,n){"use strict";n.r(t),n.d(t,"BloqueContenido",(function(){return ye})),n.d(t,"Main",(function(){return be}));var r=n(35),a=n(2),i=n.n(a),o=n(50),s=n(138),l=n(941),c=n(940),u=n(843),d=n(926),h=n(201),f=n(943),p=n(938),m=n(1400),v=n(1388),g=n(1378),y=n(1386),b=n(1389),_=n(973),x=n.n(_),E=n(979),S=n.n(E),M=n(949),T=n.n(M),w=n(950),O=n.n(w),A=n(944),R=n(968),C=n(202),k=n(36),P=n(925),L=n(939),I=n(948),N=n(937),D=n(1006),U=n.n(D),j=n(946),F=n(947),z=n(18),B=n(1030),H=n(1038),V=n(1404),G=n(848),W=n(1136),X=n(852),q=n(1402),Y=n(955),K=n.n(Y),Z=n(448),J=n(1385),Q=n(964),$=Q.c(Q.e),ee=Object(X.a)((function(e){return{card:{margin:5,"&.deleted":{backgroundColor:"#f44336",color:"#fff",textDecoration:"line-through"}}}})),te=function(e){var t=ee(),n=Object(a.useState)([]),o=Object(r.a)(n,2),s=o[0],l=o[1],c=Object(a.useState)(!1),u=Object(r.a)(c,2),d=u[0],h=u[1],f=Object(a.useState)(null),m=Object(r.a)(f,2),v=m[0],g=m[1];Object(a.useEffect)((function(){if(console.log(e.file),null!==e.file){var t=Object(z.a)({},e.file);"displayName"in t||(t.displayName=t.name),"accessRights"in t||(t.accessRight="public"),g(t)}}),[]),Object(a.useEffect)((function(){p.b().then((function(e){l([{id:"public",term:"P\xfablica"}].concat(Object(C.a)(e.options)))}))}),[e.file]);var y=function(t){e.onUpdate(t)};return i.a.createElement(B.a,{className:"".concat(t.card," ").concat(e.file.deleted?"deleted":""),key:e.key},i.a.createElement(H.a,{title:i.a.createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},i.a.createElement("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"calc(100% - 200px)"}},e.file.displayName),i.a.createElement("div",null,i.a.createElement(V.a,{label:e.file.tag,style:{marginLeft:5,marginRight:15,backgroundColor:$(e.file.tag),color:"#fff"},size:"small"}),i.a.createElement(q.a,{onClick:function(){e.onDeleted(e.file)},size:"small"},i.a.createElement(K.a,null)))),style:{padding:5},disableTypography:!0,action:i.a.createElement(i.a.Fragment,null,i.a.createElement(q.a,{onClick:function(){h(!d)}},i.a.createElement(Z.a,null)))}),i.a.createElement(G.a,{in:d},v&&i.a.createElement(W.a,{style:{padding:5}},i.a.createElement(L.o,{name:"Nombre del archivo",value:v.displayName,handleChange:function(e){var t=Object(z.a)({},v);t.displayName=e.target.value,g(t),y(t)}}),i.a.createElement(L.l,{name:"Derechos de acceso",options:s.map((function(e){return{value:e.id,label:e.term}})),value:v.accessRights?v.accessRights:"public",handleChange:function(e){var t=Object(z.a)({},v);t.accessRights=e.target.value,g(t),y(t)}}))))},ne=function(e){ee();var t=Object(a.useState)([]),n=Object(r.a)(t,2),o=n[0],s=n[1],l=Object(a.useState)(0),c=Object(r.a)(l,2),u=c[0],d=c[1],h=Object(a.useState)(0),f=Object(r.a)(h,2),p=f[0],m=f[1];return Object(a.useEffect)((function(){N.f(e.resourceId).then((function(e){s(e.data),m(e.total)})).catch((function(e){console.log(e)}))}),[e.resourceId]),i.a.createElement(i.a.Fragment,null,o.map((function(t,n){return i.a.createElement(i.a.Fragment,null,i.a.createElement(te,{file:t,key:n,onDeleted:function(){e.deleteFile(t)},onUpdate:function(t){e.updateFile(t)}}))})),i.a.createElement(J.a,{rowsPerPage:10,rowsPerPageOptions:[],count:p,page:u,onPageChange:function(e,t){d(t)},sx:{padding:0,display:"block"}}))},re=n(1013),ae=n.n(re),ie=n(1012),oe=n.n(ie),se=n(1011),le=n.n(se),ce=n(1010),ue=n.n(ce),de=n(203),he=n.n(de),fe=Object(u.a)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 170px)"},alert_detail:{fontSize:13,background:"#f27474",color:"white",padding:"2px",borderRadius:"5px",margin:"2px"}}})),pe=Object(k.o)((function(e){var t=fe(),n=i.a.useState(null),o=Object(r.a)(n,2),s=o[0],l=o[1],c=i.a.useState(!1),u=Object(r.a)(c,2),f=u[0],p=u[1],m=i.a.useState({}),v=Object(r.a)(m,2),g=v[0],y=v[1],b=i.a.useState([]),_=Object(r.a)(b,2),x=_[0],E=_[1],S=i.a.useState({}),M=Object(r.a)(S,2),T=M[0],w=M[1],O=i.a.useState([]),A=Object(r.a)(O,2),k=A[0],D=A[1],z=i.a.useState([]),B=Object(r.a)(z,2),H=B[0],V=B[1],G=i.a.useState(1),W=Object(r.a)(G,2),X=W[0],q=W[1];Object(a.useEffect)((function(){e.match.params.id?(p(!0),N.e(e.match.params.id).then((function(t){t&&(t.msg?he.a.fire({title:"Error",text:t.msg,icon:"error",confirmButtonText:"Aceptar"}).then((function(){Z("/cataloging/".concat(e.selectedType.slug))})):(p(!0),t.files=[],y(t),D([]),t.parents&&l(t.parents[0]),E(t.parents)))})).catch((function(t){t.json().then((function(t){he.a.fire({title:"Error!",text:t.msg,icon:"error",confirmButtonText:"Aceptar"}).then((function(){Z("/cataloging/".concat(e.selectedType.slug))}))}))}))):(p(!1),K())}),[e.match.params]),Object(a.useEffect)((function(){if(e.selectedType){var t=e.selectedType.metadata.fields,n=Y(t);V(n)}}),[e.selectedType]);var Y=function(e){var t=[],n=[];return e.forEach((function(e,r){"separator"===e.type?(t.push(n),(n=[]).push(e)):n.push(e)})),t.push(n),t},K=function(){var t={files:[]};t.post_type=e.selectedType.slug,t.parents=[s],y(t)},Z=function(t){e.history.push("".concat(t))},J=function(e,t){var n,r=t.split("."),a=e,i=Object(R.a)(r);try{for(i.s();!(n=i.n()).done;){if(void 0===(a=a[n.value]))return}}catch(o){i.e(o)}finally{i.f()}return a},Q=function(e,t,n){var r,a=t.split("."),i=0,o=Object(R.a)(a);try{for(o.s();!(r=o.n()).done;){var s=r.value;++i===a.length?e[s]=n:e=e[s]}}catch(l){o.e(l)}finally{o.f()}};return i.a.createElement(i.a.Fragment,null,Object.keys(g).length>0&&i.a.createElement(d.a,{className:t.columnas},e.selectedType.parentsTypes.length>0||e.selectedType.hierarchical?i.a.createElement(i.a.Fragment,null,i.a.createElement(ye,{style:{width:"calc(440px)",height:"calc(100vh - 170px)",overflow:"auto"},title:"Estructura de carpetas para: ".concat(e.selectedType.name),topBar:i.a.createElement(F.a,{variant:"light"})},i.a.createElement(j.a,{parents:e.selectedType.parentsTypes,setFondo:function(e,t){s&&t?s.id===e.id?(l(null),E([])):(l(e),E([].concat(Object(C.a)(t),[e]))):t?(l(e),E([].concat(Object(C.a)(t),[e]))):s?s.id===e.id&&(l(null),E([])):(l(e),E([e]))},activeTypes:Object(C.a)(e.selectedType.parentsTypes),childrenEditing:!0,selected:s?[s]:[],path:x}))):i.a.createElement(i.a.Fragment,null),i.a.createElement(ye,{style:{width:"calc(100% - 470px)",maxHeight:"calc(100vh - 170px)",overflow:"auto",maxWidth:"750px",position:"relative"},title:"Nuevo recurso para: ".concat(e.selectedType.name)},k&&i.a.createElement(ne,{files:k,resourceId:e.match.params.id,deleteFile:function(e){var t=k.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=Object(C.a)(k);n[t].deleted=!n[t].deleted,D(Object(C.a)(n))}else{var r=k;e.deleted=!0,r.push(e),D(Object(C.a)(r))}},updateFile:function(e){var t=k.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=Object(C.a)(k);n[t]=e,D(Object(C.a)(n))}else{var r=k;r.push(e),D(Object(C.a)(r))}}}),i.a.createElement(I.c,{initialValues:g,onSubmit:function(n,r){var a=r.setSubmitting;f?(a(!1),he.a.fire({title:"\xbfEst\xe1s seguro?",text:"Se modificar\xe1 el recurso",icon:"warning",showCancelButton:!0}).then((function(r){if(r.isConfirmed){n.parents=s?[{id:s.id,post_type:s.post_type}]:null,n.parent=s?[{id:s.id,post_type:s.post_type}]:null,(void 0===n.accessRights||"none"===n.accessRights)&&(n.accessRights="public");var a=new FormData,o=[],l=[],c=[];n.files?(n.filesIds=[],n.files.forEach((function(e,t){"string"!==typeof e.file&&e.file&&(a.append("files",e.file),n.filesIds.push({file:t,filetag:e.id}))})),k.forEach((function(e){e.deleted?l.push(e.id):(o.push(e.id),c.push(e))})),n.files=o,n.deletedFiles=l,n.updatedFiles=c):n.files=[],a.append("data",JSON.stringify(n)),N.i(e.match.params.id,a).then((function(t){Z("/cataloging/".concat(e.selectedType.slug))})).catch((function(e){e.json().then((function(e){e.errors&&w(e.errors);var n=Object.keys(e.errors).map((function(n){return U.a.renderToString(i.a.createElement("div",{className:t.alert_detail},"".concat(n,": ").concat(e.errors[n])))}));n=n.join(""),he.a.fire({title:"Error!",html:"".concat(e.msg," ").concat(n),icon:"error",confirmButtonText:"Ok"})}))}))}}))):(a(!1),he.a.fire({title:"\xbfEst\xe1s seguro?",text:"Se crear\xe1 un nuevo recurso",icon:"warning",showCancelButton:!0}).then((function(t){if(t.isConfirmed){n.parents=s?[{id:s.id,post_type:s.post_type}]:null,n.parent=s?[{id:s.id,post_type:s.post_type}]:null,(void 0===n.accessRights||"none"===n.accessRights)&&(n.accessRights="public");var r=new FormData;n.filesIds=[],n.files.forEach((function(e,t){r.append("files",e.file),n.filesIds.push({file:t,filetag:e.id})})),n.files=[],r.append("data",JSON.stringify(n)),N.h(r).then((function(t){Z("/cataloging/".concat(e.selectedType.slug))})).catch((function(e){e.json().then((function(e){e.errors&&w(e.errors),he.a.fire({title:"Error!",text:e.msg,icon:"error",confirmButtonText:"Ok"})}))}))}})))}},(function(t){var n=t.values,r=(t.errors,t.touched,t.handleChange),a=t.handleBlur,o=t.handleSubmit,s=(t.isSubmitting,t.setFieldValue);return i.a.createElement("form",{onSubmit:o},e.selectedType.metadata&&i.a.createElement(i.a.Fragment,null,H[X-1].map((function(e,t){return i.a.createElement(i.a.Fragment,null,"file"===e.type&&i.a.createElement(L.h,{name:e.label,key:e.filetag,id:e.filetag,values:n,required:e.required,change:s}),"text"===e.type&&i.a.createElement(L.o,{name:e.label,id:e.destiny,handleChange:r,handleBlur:a,value:J(n,e.destiny),required:e.required,errors:T[e.destiny]}),"text-area"===e.type&&i.a.createElement(L.n,{name:e.label,id:e.destiny,handleChange:r,handleBlur:a,value:J(n,e.destiny),required:e.required,errors:T[e.destiny]}),"select"===e.type&&i.a.createElement(L.i,{name:e.label,id:e.destiny,handleChange:r,handleBlur:a,value:J(n,e.destiny)?J(n,e.destiny):"none",required:e.required,options:e.list,errors:T[e.destiny],destiny:e.destiny}),"select-multiple2"===e.type&&i.a.createElement(L.f,{handleChange:function(t){s(e.destiny,t)},id:e.destiny,name:e.label,field:e,required:e.required,value:J(n,e.destiny),errors:T[e.destiny]}),"author"===e.type&&i.a.createElement(I.b,{name:e.destiny},(function(t){var r=t.insert,a=t.remove,o=t.push,l=t.move;return i.a.createElement(L.d,{name:e.label,id:e.destiny,insert:r,remove:a,push:o,setFieldValue:function(t){s(e.destiny,t)},move:l,value:J(n,e.destiny)?J(n,e.destiny):[],required:e.required,errors:T[e.destiny]})})),"simple-date"===e.type&&i.a.createElement(L.m,{name:e.label,id:e.destiny,setFieldValue:function(t){s(e.destiny,t)},handleBlur:a,value:J(n,e.destiny),required:e.required,errors:T[e.destiny]}),"relation"===e.type&&i.a.createElement(L.k,{name:e.label,id:e.destiny,value:J(n,e.destiny),required:e.required,errors:T[e.destiny],postType:e,setFieldValue:function(t){s(e.destiny,t)}}),"checkbox"===e.type&&i.a.createElement(L.g,{name:e.label,id:e.destiny,handleChange:function(t){s(e.destiny,t)},handleBlur:a,value:J(n,e.destiny),required:e.required,errors:T[e.destiny]}),"number"===e.type&&i.a.createElement(L.j,{name:e.label,id:e.destiny,handleChange:r,handleBlur:a,value:J(n,e.destiny),required:e.required,errors:T[e.destiny]}),"separator"===e.type&&i.a.createElement(h.a,{variant:"h6",style:{marginTop:10,marginBottom:10}},e.label))})),i.a.createElement(d.a,{style:{display:"flex",justifyContent:"space-between",gap:10,marginTop:10,position:"sticky",bottom:0,backgroundColor:"white"}},i.a.createElement(d.a,null,i.a.createElement(P.a,{type:"button",variant:"contained",onClick:function(){return Z("/cataloging/"+e.selectedType.slug)},style:{margin:5}},"Cancelar"),i.a.createElement(P.a,{variant:"contained",type:"button",onClick:function(){Q(n,"status","draft"),o()},style:{margin:5},startIcon:i.a.createElement(ue.a,null)},"Guardar"),(e.user.roles.includes("publisher")||e.user.roles.includes("admin"))&&i.a.createElement(P.a,{variant:"contained",type:"button",onClick:function(){Q(n,"status","published"),o()},style:{margin:5},startIcon:i.a.createElement(le.a,null)},"Publicar")),H.length>1&&i.a.createElement(d.a,null,i.a.createElement(P.a,{variant:"contained",onClick:function(){q(1===X?1:X-1)},disabled:1===X,style:{margin:5},startIcon:i.a.createElement(oe.a,null)},"Anterior"),i.a.createElement(P.a,{variant:"contained",onClick:function(){X===H.length?q(H.length):q(X+1)},disabled:X===H.length,style:{margin:5},endIcon:i.a.createElement(ae.a,null)},"Siguiente")))))})))))})),me=n(977),ve=(n(263),n(954)),ge=Object(u.a)((function(e){return{bloque:{padding:"10px",backgroundColor:"rgba(255,255,255,.9)",margin:5,width:"100%",height:"100%",overflow:"auto",position:"relative",borderRadius:10,border:"3px solid #fff","&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},tituloBloque:{top:0,fontSize:15,fontWeight:"bold",padding:"10px 15px",position:"sticky",zIndex:10,width:"100%",left:0,background:"#e6e6e6",borderTopLeftRadius:10,borderTopRightRadius:10,color:"#56749a",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},breadcrumbs:{padding:"5px 15px",background:"#56749a",position:"sticky",color:"#fff",borderBottomLeftRadius:10,borderBottomRightRadius:10,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},linkBreadcrumb:{color:"#fff",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:200,display:"inline-block","&:hover":{color:"#fff"}},selectedBread:{color:"#fff !important",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:150,backgroundColor:"rgba(255,255,255,.2)",display:"inline-block",padding:"0 5px",borderRadius:2},columnas:{display:"flex",height:"calc(100vh - 150px)"}}})),ye=function(e){var t=ge();return i.a.createElement(d.a,{className:t.bloque,style:e.style},e.title&&i.a.createElement(d.a,{className:t.tituloBloque},e.title),e.topBar&&i.a.createElement(i.a.Fragment,null,e.topBar),e.children)},be=function(e){var t=Object(a.useState)([]),n=Object(r.a)(t,2),o=n[0],s=n[1],u=Object(a.useState)(null),d=Object(r.a)(u,2),_=d[0],E=d[1],M=Object(a.useState)(!1),w=Object(r.a)(M,2),R=w[0],C=w[1],k=Object(a.useState)(!1),P=Object(r.a)(k,2),L=P[0],I=P[1],N=Object(a.useState)(null),D=Object(r.a)(N,2),U=D[0],j=D[1],F=Object(a.useState)(null),z=Object(r.a)(F,2),B=z[0],H=z[1],V=Object(ve.a)("viewDrafts",!1),G=Object(r.a)(V,2),W=G[0],X=G[1];Object(a.useEffect)((function(){q()}),[e.match]);var q=function(){var t=e.match.path.split("/").filter((function(e){return""!==e}));t.length>2&&"new"===t[2]?(I(!0),j(null)):t.length>2&&"edit"===t[2]?(I(!0),j(t[3])):(I(!1),j(null))};Object(a.useEffect)((function(){e.match.params.slug?f.c(e.match.params.slug).then((function(e){E(e)})):p.d().then((function(t){e.history.push("/cataloging/"+t.value)}))}),[e.match]),Object(a.useEffect)((function(){f.b().then((function(e){s(e)})),q()}),[]);return i.a.createElement(c.a,null,i.a.createElement(l.a,{userRoles:e.user.roles,list:function(){var t=[];return(e.user.roles.includes("admin")||e.user.roles.includes("editor"))&&!L&&_&&t.push({name:"Agregar recursos",icon:i.a.createElement(T.a,null),action:"new",callback:function(){e.history.push("/cataloging/".concat(_.slug,"/new")),I(!0)}}),(e.user.roles.includes("admin")||e.user.roles.includes("editor"))&&!L&&_&&t.push({name:"Descargar inventario",icon:i.a.createElement(i.a.Fragment,null,i.a.createElement(x.a,null),i.a.createElement(S.a,null)),callback:function(){he.a.fire({title:"\xbfEst\xe1s seguro?",text:"Se generar\xe1 un archivo con el inventario de la categor\xeda seleccionada",icon:"warning",showCancelButton:!0}).then((function(e){e.isConfirmed&&p.a("inventoryMaker",JSON.stringify({post_type:_.slug,parent:B,status:W?"draft":"published"})).then((function(e){he.a.fire({title:"Procesamiento iniciado",text:e.msg,icon:"success",confirmButtonText:"Aceptar"})})).catch((function(e){e.json().then((function(e){he.a.fire({title:"Error",text:e.msg,icon:"error",confirmButtonText:"Aceptar"})}))}))}))}}),(e.user.roles.includes("admin")||e.user.roles.includes("editor"))&&L&&_&&t.push({name:"Volver",icon:i.a.createElement(O.a,null),callback:function(){e.history.push("/cataloging/".concat(_.slug)),I(!1)}}),t}()}),i.a.createElement(ye,{style:{width:"calc(100% - 20px)",padding:"2px"}},i.a.createElement(m.a,{style:{minHeight:"auto"}},i.a.createElement(v.a,{variant:"outlined",style:{marginRight:15,borderRadius:50},onClick:function(){return C(!R)}},"Ver informaci\xf3n"),i.a.createElement(g.a,{size:"small",onChange:function(t){E(null),C(!1),L?e.history.push("/cataloging/"+t.target.value+"/new"):e.history.push("/cataloging/"+t.target.value)},value:_?_.slug:"",style:{borderRadius:50,height:32,textTransform:"uppercase",fontSize:11}},o.map((function(e){return i.a.createElement(y.a,{value:e.slug},e.name)}))),i.a.createElement(h.a,{style:{marginLeft:15}},"Ver borradores:"),i.a.createElement(b.a,{checked:W,onChange:function(){return X(!W)}}))),R&&_&&i.a.createElement(ye,{style:{width:"calc(100% - 20px)",maxWidth:500},title:"Acerca de ".concat(_.name)},i.a.createElement(A.c,{selectedType:_})),L&&_&&!R&&!U&&i.a.createElement(pe,{user:e.user,selectedType:_}),L&&_&&!R&&U&&i.a.createElement(pe,{user:e.user,selectedType:_,selectedResource:U}),!L&&_&&!R&&i.a.createElement(me.a,{viewDrafts:W,history:e.history,selectedType:_,setSelected:H}))};t.default=Object(o.b)((function(e){return{user:e.auth.user}}),s.a)(be)},969:function(e,t,n){"use strict";var r=n(18),a=n(2),i=n.n(a),o=n(1403),s=n(939);t.a=function(e){return i.a.createElement(o.a,{style:Object(r.a)({padding:"10px",width:"100%",maxWidth:"750px"},e.style),className:e.className},e.data.fields.map((function(t,n){return i.a.createElement(s.b,{label:t.label,value:t.value,labelAlign:e.labelAlign,type:t.type,redirect:e.redirect})})))}},970:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M14.67 5v6.5H9.33V5zm1 6.5H21V5h-5.33zm-1 7.5v-6.5H9.33V19zm1-6.5V19H21v-6.5zm-7.34 0H3V19h5.33zm0-1V5H3v6.5z"}),"ViewModule")},972:function(e,t,n){"use strict";n.d(t,"c",(function(){return i})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return s})),n.d(t,"d",(function(){return l})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"b",(function(){return d})),n.d(t,"i",(function(){return h})),n.d(t,"j",(function(){return f})),n.d(t,"a",(function(){return p}));var r=n(46),a=n(204);function i(e){var t="/records/"+e,n={method:"GET",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(r.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function o(e){var t="/records/"+e+"/stream",n={method:"GET",headers:new Headers({Authorization:Object(a.a)()}),mode:"cors",cache:"default"};return fetch(r.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.blob()}))}function s(e,t){var n="/records/"+e+"/transcription",i={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify({slug:t})};return fetch(r.e+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function l(e){var t="/records/"+e+"/document",n={method:"GET",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch(r.e+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function c(e){var t={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/records/galleryinfo",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function u(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),s="/records/"+e+"/pages",l={method:"POST",headers:o,mode:"cors",cache:"default",body:JSON.stringify({pages:t,size:n,gallery:!i})};return fetch(r.e+s,l).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function d(e,t,n,i){var o="/records/"+e+"/blocks",s={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify({page:t,block:i,slug:n})};return fetch(r.e+o,s).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function h(e){var t={method:"POST",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/records/setBlock",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function f(e){var t={method:"PUT",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/records/setBlock",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function p(e){var t={method:"DELETE",headers:new Headers({Authorization:Object(a.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch(r.e+"/records/setBlock",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}},974:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M7 3H4v3H2V1h5zm15 3V1h-5v2h3v3zM7 21H4v-3H2v5h5zm13-3v3h-3v2h5v-5zm-1 0c0 1.1-.9 2-2 2H7c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2zM15 8H9v2h6zm0 3H9v2h6zm0 3H9v2h6z"}),"DocumentScanner")},977:function(e,t,n){"use strict";var r=n(16),a=n(18),i=n(202),o=n(35),s=n(2),l=n.n(s),c=n(50),u=n(138),d=n(965),h=n(947),f=n(956),p=n(946),m=n(843),v=n(926),g=Object(m.a)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"}}}));t.a=Object(c.b)((function(e){return{user:e.auth.user}}),u.a)((function(e){var t=g(),n=Object(s.useState)(null),c=Object(o.a)(n,2),u=c[0],m=c[1],y=Object(s.useState)(null),b=Object(o.a)(y,2),_=b[0],x=b[1],E=Object(s.useState)([]),S=Object(o.a)(E,2),M=S[0],T=S[1],w=Object(s.useState)({}),O=Object(o.a)(w,2),A=O[0],R=O[1],C=Object(s.useState)(0),k=Object(o.a)(C,2),P=k[0],L=k[1],I=Object(s.useState)([]),N=Object(o.a)(I,2),D=(N[0],N[1],Object(s.useState)("")),U=Object(o.a)(D,2),j=U[0],F=U[1],z=Object(s.useState)(""),B=Object(o.a)(z,2),H=B[0],V=B[1];Object(s.useEffect)((function(){e.selectedType.parentsTypes?e.selectedType.parentsTypes.length>0?m("multiple"):e.selectedType.hierarchical?m("tree"):m("single"):m(null)}),[e.selectedType]),Object(s.useEffect)((function(){e.setSelected&&_?e.setSelected(_.id):e.setSelected&&e.setSelected(null)}),[_]),Object(s.useEffect)((function(){G("keyword",j)}),[j]),Object(s.useEffect)((function(){x(null),T([]),G("parents",null),G("treeKeyword",H)}),[H]),Object(s.useEffect)((function(){G("status",e.viewDrafts?"draft":"published")}),[e.viewDrafts]);var G=function(e,t){R(Object(a.a)(Object(a.a)({},A),{},Object(r.a)({},e,t)))};return l.a.createElement(l.a.Fragment,null,u&&l.a.createElement(l.a.Fragment,null,"single"===u&&l.a.createElement(d.BloqueContenido,{style:{width:"calc(100% - 20px)",height:"calc(100vh - 170px)",overflow:"auto"},title:"Buscar recursos para: ".concat(e.selectedType.name),topBar:l.a.createElement(h.a,{total:P,onSearchSubmit:function(e){F(e)}})},l.a.createElement(f.a,{selectedType:e.selectedType,type:e.type,filters:A,viewDrafts:e.viewDrafts,parentTotal:L,handleClick:function(t){e.history?e.history.push("/detail/".concat(t.id)):"checkbox"===e.type&&e.setSelectedResources(t.id)},selectedResources:e.selectedResources})),"multiple"===u&&l.a.createElement(v.a,{className:t.columnas},l.a.createElement(d.BloqueContenido,{style:{width:"calc(440px)",height:"calc(100vh - 170px)",overflow:"auto"},title:"Estructura de carpetas para: ".concat(e.selectedType.name),topBar:l.a.createElement(h.a,{variant:"light",onSearchSubmit:function(e){V(e)}})},l.a.createElement(p.a,{parents:e.selectedType.parentsTypes,setFondo:function(e,t){_&&t?_.id===e.id?(x(null),T([]),G("parents",null)):(x(e),T([].concat(Object(i.a)(t),[e])),G("parents",e)):t?(x(e),T([].concat(Object(i.a)(t),[e])),G("parents",e)):_&&_.id===e.id?(x(null),T([]),G("parents",null)):(x(e),T([e]),G("parents",e))},activeTypes:Object(i.a)(e.selectedType.parentsTypes),childrenEditing:!1,selected:_?[_]:[],path:M,filters:A})),l.a.createElement(d.BloqueContenido,{style:{minWidth:800,width:"calc(100% - 470px)",height:"calc(100vh - 170px)",overflow:"auto"},title:"Buscar recursos para: ".concat(e.selectedType.name),topBar:l.a.createElement(h.a,{total:P,onSearchSubmit:function(e){F(e)}})},l.a.createElement(f.a,{selectedType:e.selectedType,filters:A,type:e.type,parentTotal:L,viewDrafts:e.viewDrafts,handleClick:function(t){e.history?e.history.push("/detail/".concat(t.id)):"checkbox"===e.type&&e.setSelectedResources(t.id)},selectedResources:e.selectedResources})))))}))},980:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School")},981:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},988:function(e,t,n){"use strict";var r=n(18),a=n(202),i=n(35),o=n(2),s=n.n(o),l=n(953),c=n(937),u=n(46),d=n(204);var h=n(938),f=n(968),p=function(e,t){var n,r=t.split("."),a=e,i=Object(f.a)(r);try{for(i.s();!(n=i.n()).done;){a=a[n.value]}}catch(o){i.e(o)}finally{i.f()}return a},m=n(843),v=n(930),g=n(1395),y=n(1396),b=n(1398),_=n(1394),x=n(1399),E=n(1385),S=n(1397),M=n(1400),T=n(1391),w=n(1402),O=n(1388),A=n(1389),R=n(955),C=n.n(R),k=n(942),P=n.n(k),L=n(978),I=n.n(L),N=n(960),D=n.n(N),U=n(203),j=n.n(U),F=n(36),z=n(1392),B=(n(951),Object(m.a)((function(e){return{btn_color:{color:"#869bb7 !important",padding:"5px !important",width:"30px !important",height:"30px !important",margin:"0 2px !important",border:"1px solid #c6d0dd !important","&:hover":{color:"#fff !important",backgroundColor:"#56749a !important"},"& .MuiSvgIcon-root":{width:"14px !important"}}}})));function H(e){e.onSelectAllClick;var t=e.order,n=e.orderBy,r=(e.numSelected,e.rowCount,e.onRequestSort,e.headCells);return s.a.createElement(x.a,null,s.a.createElement(S.a,null,r.map((function(e){return s.a.createElement(b.a,{key:e.id,align:e.numeric?"right":"left",padding:e.disablePadding?"none":"normal",sortDirection:n===e.id&&t},e.label)}))))}function V(e){e.numSelected;return s.a.createElement(E.a,{rowsPerPage:20,rowsPerPageOptions:[],count:e.total,page:e.page,onPageChange:function(t,n){e.setPage(n)}})}t.a=function(e){var t=Object(F.k)(),n=B(),f=Object(o.useState)([]),m=Object(i.a)(f,2),x=m[0],E=m[1],R=Object(o.useState)([]),k=Object(i.a)(R,2),L=k[0],N=k[1],U=s.a.useState(!1),G=Object(i.a)(U,2),W=G[0],X=(G[1],Object(o.useState)([])),q=Object(i.a)(X,2),Y=q[0],K=(q[1],Object(o.useState)(0)),Z=Object(i.a)(K,2),J=Z[0],Q=Z[1],$=Object(o.useState)(0),ee=Object(i.a)($,2),te=ee[0],ne=ee[1];Object(o.useEffect)((function(){if(E([]),N([]),e.selectedType&&"string"!==typeof e.selectedType){e.filters.page=te,c.b(e.selectedType.slug,JSON.stringify(e.filters)).then((function(e){E(e),e.length>0&&Q(e[0].total)}));var t=e.selectedType.metadata.fields.map((function(e){return{destiny:e.destiny,label:e.label}}));t=[{destiny:"",label:""}].concat(Object(a.a)(t)),N(t=[{destiny:"",label:""},{destiny:"metadata.firstLevel.title",label:"T\xedtulo"},{destiny:"accessRights",label:"Derechos de acceso"}])}else if(e.selectedType&&"string"===typeof e.selectedType)if("users"===e.selectedType)l.g(JSON.stringify({page:te,filters:e.filters})).then((function(e){E(e.map((function(e){return Object(r.a)({},e)}))),e.length>0&&Q(e[0].total);N([{destiny:"",label:""},{destiny:"name",label:"Nombre"},{destiny:"username",label:"Usuario"},{destiny:"roles",label:"Roles"},{destiny:"accessRights",label:"Niveles de acceso"}])}));else if("logs"===e.selectedType)(function(e){var t={method:"POST",headers:new Headers({Authorization:Object(d.a)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:e};return fetch(u.e+"/logs",t).then((function(e){return 200!==e.status?Promise.reject(e.status):e.json()}))})(JSON.stringify({page:te,filters:e.filters})).then((function(e){E(e.map((function(e){return Object(r.a)({},e)}))),e.length>0&&Q(e[0].total);N([{destiny:"username",label:"Usuario"},{destiny:"action",label:"Evento"}])}));else if("plugins"===e.selectedType)h.g().then((function(e){E(e.plugins);N([{destiny:"name",label:"Nombre"},{destiny:"description",label:"Descripci\xf3n"},{destiny:"active",label:"Activo"}])})).catch((function(e){console.log(e)}));else if("tasks"===e.selectedType)h.j("beta").then((function(e){E(e);N([{destiny:"name",label:"Nombre"},{destiny:"status",label:"Estado"},{destiny:"",label:"Acciones"}])}));else if("files"!==e.selectedType){c.b(e.selectedType,JSON.stringify(e.filters)).then((function(e){E(e.resources)}));N([{destiny:"",label:""},{destiny:"metadata.firstLevel.title",label:"T\xedtulo"}])}else e.resourceId||c.c(JSON.stringify({page:te,filters:e.filters})).then((function(e){e.length>0&&Q(e[0].total),E(e.map((function(e){return Object(r.a)({},e)})));N([{destiny:"name",label:"T\xedtulo"},{destiny:"size",label:"Tama\xf1o"},{destiny:"parent",label:"Carpeta"}])}))}),[e.selectedType,e.filters,te]);var re=function(e){t.push("/detail/".concat(e))};return x.length>0&&console.log(p(x[0],"accessRights")),s.a.createElement(s.a.Fragment,null,x.length>0&&s.a.createElement(s.a.Fragment,null,s.a.createElement(v.a,{sx:{width:"100%"}},s.a.createElement(T.a,{sx:{width:"100%",mb:2}},s.a.createElement(_.a,null,s.a.createElement(g.a,{sx:{minWidth:750},"aria-labelledby":"tableTitle",size:W?"small":"medium",padding:"none"},s.a.createElement(H,{numSelected:Y.length,headCells:L}),s.a.createElement(y.a,null,x.map((function(r){return s.a.createElement(S.a,{hover:!0,role:"checkbox",tabIndex:-1,key:r.id,onClick:function(){}},L.map((function(a){return s.a.createElement(b.a,{component:"th",id:a.destiny,scope:"row",key:a.destiny,sx:{padding:"6px 2px",fontSize:"1rem",minHeight:"auto"}},""!==a.label&&"active"!==a.destiny&&"accessRights"!==a.destiny&&s.a.createElement(s.a.Fragment,null,("string"===typeof p(r,a.destiny)||"number"===typeof p(r,a.destiny))&&s.a.createElement(s.a.Fragment,null,p(r,a.destiny)),Array.isArray(p(r,a.destiny))&&s.a.createElement(s.a.Fragment,null,p(r,a.destiny).map((function(t,n){return s.a.createElement(s.a.Fragment,null,"users"===e.selectedType&&s.a.createElement(z.a,{size:"small",label:t,style:{margin:"2px"}}),"files"===e.selectedType&&s.a.createElement(O.a,{onClick:function(){re(t.id)}},n))})))),""===a.label&&s.a.createElement(M.a,{disableGutters:!0,variant:"dense",style:{minHeight:"auto",display:"flex",justifyContent:"center"}},"tasks"!==e.selectedType&&s.a.createElement(w.a,{className:n.btn_color,size:"small",variant:"contained",onClick:function(){return n=r.id,void("users"===e.selectedType?t.push("/admin/users/edit/".concat(n)):t.push("/cataloging/".concat(e.selectedType.slug,"/edit/").concat(n)));var n}},s.a.createElement(P.a,null)),"users"!==e.selectedType&&s.a.createElement(s.a.Fragment,null,s.a.createElement(w.a,{className:n.btn_color,size:"small",variant:"contained",onClick:function(){return re(r.id)}},s.a.createElement(I.a,null)),s.a.createElement(w.a,{className:n.btn_color,size:"small",variant:"contained"},s.a.createElement(D.a,null)),s.a.createElement(w.a,{className:n.btn_color,size:"small",variant:"contained",onClick:function(){return e=r.id,void j.a.fire({title:"\xbfEst\xe1s seguro?",text:"No podr\xe1s revertir esta acci\xf3n",icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"}).then((function(t){t.isConfirmed&&c.a(e).then((function(e){j.a.fire({title:"Eliminado",text:"El recurso ha sido eliminado",icon:"success",confirmButtonText:"Aceptar"}).then((function(){window.location.reload()}))})).catch((function(e){e.json().then((function(e){j.a.fire({title:"Error",text:e.msg,icon:"error",confirmButtonText:"Aceptar"})}))}))}));var e}},s.a.createElement(C.a,null)))),"active"===a.destiny&&s.a.createElement(M.a,{disableGutters:!0,variant:"dense"},s.a.createElement(A.a,{checked:r.active,onChange:function(t){e.onPluginChange(r.slug,t.target.checked).then((function(){j.a.fire({title:"Actualizado",text:"El plugin ha sido actualizado. Para que los cambios surtan efecto, es necesario reiniciar el servidor.",icon:"success",confirmButtonText:"Aceptar"}),h.g().then((function(e){E(e.plugins)})).catch((function(e){console.log(e)}))}))}})),"accessRights"===a.destiny&&p(r,a.destiny)&&s.a.createElement(s.a.Fragment,null,Array.isArray(p(r,a.destiny))&&s.a.createElement(s.a.Fragment,null,p(r,a.destiny).map((function(e,t){return s.a.createElement(s.a.Fragment,null,s.a.createElement(z.a,{size:"small",label:e,style:{margin:"2px"}}))})))))})))}))),"plugins"!==e.selectedType&&s.a.createElement(V,{page:te,setPage:ne,total:J})))))))}},993:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2"}),"Bookmark")},998:function(e,t,n){"use strict";var r=n(40);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=r(n(67)),i=n(0);t.default=(0,a.default)((0,i.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"}),"BookmarkBorder")},999:function(e,t,n){"use strict";n.r(t),n.d(t,"BloqueContenido",(function(){return ee})),n.d(t,"TreeViewColumnContainer",(function(){return te})),n.d(t,"Main",(function(){return ne}));n(202);var r=n(35),a=n(2),i=n.n(a),o=n(50),s=n(119),l=n(941),c=n(940),u=n(843),d=n(926),h=n(1061),f=n(201),p=n(937),m=n(953),v=n(1400),g=n(1402),y=n(945),b=n.n(y),_=n(974),x=n.n(_),E=n(943),S=n(950),M=n.n(S),T=n(942),w=n.n(T),O=n(944),A=n(981),R=n.n(A),C=n(980),k=n.n(C),P=n(970),L=n.n(P),I=n(969),N=n(46),D=(n(988),n(956),n(852)),U=n(962),j=n(1392),F=n(964),z=F.c(F.e),B=Object(D.a)((function(e){return{btn_color:{color:"#869bb7 !important",padding:"5px !important",width:"30px !important",height:"30px !important",margin:"0 2px !important",borderRadius:"50%",border:"1px solid #c6d0dd !important","&:hover":{color:"#fff !important",backgroundColor:"#56749a !important"},"& .MuiSvgIcon-root":{width:"14px !important"}}}})),H=function(e){B();var t=Object(a.useState)([]),n=Object(r.a)(t,2),o=n[0],s=n[1],l=Object(a.useState)(0),c=Object(r.a)(l,2),u=c[0],d=c[1],h=Object(a.useState)(0),f=Object(r.a)(h,2),m=f[0],v=f[1];Object(a.useEffect)((function(){}),[]),Object(a.useEffect)((function(){p.f(e.records,u,!0).then((function(e){s(e.data),v(e.total)})).catch((function(e){console.log(e)}))}),[e.records]);return i.a.createElement(U.a,{pagination:!0,resources:o,page:u,setPage:d,total:m,perpage:10,handleClick:e.handleClick,columns:[{destiny:"displayName",label:"Nombre"},{destiny:"type",label:"Tipo"},{destiny:"tag",label:"Etiqueta"},{destiny:"hash",label:"Hash"}],columnSolver:function(e,t){var n,r,a,o;return i.a.createElement(i.a.Fragment,null,"displayName"===t.destiny&&i.a.createElement("span",null,e.displayName),"hash"===t.destiny&&i.a.createElement("span",null,e.hash),"type"===t.destiny&&(null===e||void 0===e||null===(n=e.processing)||void 0===n||null===(r=n.fileProcessing)||void 0===r?void 0:r.type)&&i.a.createElement(j.a,{size:"small",label:e.processing.fileProcessing.type}),"tag"===t.destiny&&i.a.createElement(j.a,{size:"small",label:e.tag,style:{backgroundColor:z(e.tag),color:"#fff"}}),"type"===t.destiny&&!(null===e||void 0===e||null===(a=e.processing)||void 0===a||null===(o=a.fileProcessing)||void 0===o?void 0:o.type)&&i.a.createElement(j.a,{size:"small",label:"Sin procesar"}))}})},V=n(1014),G=(n(947),n(263),n(203)),W=n.n(G),X=n(946),q=n(998),Y=n.n(q),K=n(993),Z=n.n(K),J=n(1031),Q=n.n(J),$=Object(u.a)((function(e){return{bloque:{padding:"10px",backgroundColor:"rgba(255,255,255,.9)",margin:5,width:"100%",height:"100%",overflow:"auto",position:"relative",borderRadius:10,border:"3px solid #fff","&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},tituloBloque:{top:0,fontSize:15,fontWeight:"bold",padding:"10px 15px",position:"sticky",zIndex:10,width:"100%",left:0,background:"#e6e6e6",borderTopLeftRadius:10,borderTopRightRadius:10,color:"#56749a",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},breadcrumbs:{padding:"5px 15px",color:"#fff",borderBottomLeftRadius:10,borderBottomRightRadius:10,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},linkBreadcrumb:{color:"#fff",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:200,display:"inline-block","&:hover":{color:"#fff"}},selectedBread:{color:"#fff !important",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:150,backgroundColor:"rgba(255,255,255,.2)",display:"inline-block",padding:"0 5px",borderRadius:2},columnas:{display:"flex",height:"calc(100vh - 150px)"},separador:{borderBottom:"1px solid #dcdcdc",paddingTop:25,paddingBottom:10,fontWeight:"bold",color:"#56749a",paddingLeft:"15px","& svg":{marginRight:10,marginLeft:5,width:20,height:20,padding:3,backgroundColor:"#56749a",borderRadius:50,"& path":{fill:"#fff"}}},toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",backgroundColor:"#56749a",color:"#fff",borderTopLeftRadius:10,overflow:"hidden",alignItems:"center","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}},bookmarkIcon:{"& path":{fill:"#fff"}},itemMenu:{display:"flex",alignItems:"center",padding:15,paddingLeft:"10px",borderBottom:"1px solid #dcdcdc","& svg":{"& path":{fill:"#9fb0c6"}},"&:hover":{backgroundColor:e.palette.grey[100],cursor:"pointer"},"&.selected":{backgroundColor:"#9fb0c6",color:"#fff","& path":{fill:"#fff"}}}}})),ee=function(e){var t=$();return i.a.createElement(d.a,{className:t.bloque,style:e.style},e.title&&i.a.createElement(d.a,{className:t.tituloBloque},e.title),e.topBar&&i.a.createElement(i.a.Fragment,null,e.topBar),e.children)},te=function(e){$();var t=Object(a.useState)(null),n=Object(r.a)(t,2),o=n[0],s=n[1];return Object(a.useEffect)((function(){e.slug&&E.c(e.slug).then((function(e){e.parentsTypes.length>0?s(e.parentsTypes):s([{id:e.id,name:e.name,slug:e.slug,direct:!0}])})).catch((function(e){console.log(e)}))}),[]),i.a.createElement(i.a.Fragment,null,o&&i.a.createElement(X.b,{parents:o,activeTypes:o,childrenEditing:!0,root:e.selectedResource?e.selectedResource._id:null,setFondo:e.setFondo,selected:e.selected,path:e.path}))},ne=function(e){var t,n,o,s=$(),u=Object(a.useState)("metadata"),f=Object(r.a)(u,2),y=f[0],_=f[1],E=Object(a.useState)(null),S=Object(r.a)(E,2),T=S[0],A=S[1],C=Object(a.useState)(null),P=Object(r.a)(C,2),D=(P[0],P[1],Object(a.useState)(null)),U=Object(r.a)(D,2),j=(U[0],U[1],Object(a.useState)(!1)),F=Object(r.a)(j,2),z=F[0],B=F[1];Object(a.useEffect)((function(){G()}),[e.match]),Object(a.useEffect)((function(){e.user.favorites&&(e.user.favorites.find((function(t){return t.id===e.match.params.id}))?B(!0):B(!1))}),[e.user.favorites,e.match]);var G=function(){e.match.params.id&&(_("metadata"),A(null),p.e(e.match.params.id).then((function(e){e.parents&&(e.parents=e.parents.reverse()),A(e)})).catch((function(t){W.a.fire({icon:"error",title:"Oops...",text:"No se pudo obtener el recurso"}).then((function(){e.history.push("/dashboard")}))})))};Object(a.useEffect)((function(){T&&T.children.length>0&&_(T.children[0])}),[T]);return i.a.createElement(c.a,null,i.a.createElement(l.a,{userRoles:e.user.roles,list:function(){var t=[];return t.push({name:"Ir al archivo",icon:i.a.createElement(i.a.Fragment,null,i.a.createElement(M.a,null),i.a.createElement(L.a,null)),callback:function(){e.history.push("/cataloging/".concat(T.post_type))}}),(e.user.roles.includes("admin")||e.user.roles.includes("editor"))&&t.push({name:"Editar recurso",icon:i.a.createElement(w.a,null),action:"edit",callback:function(){e.history.push("/cataloging/".concat(T.post_type,"/edit/").concat(e.match.params.id))}}),t}()}),T&&i.a.createElement(i.a.Fragment,null,i.a.createElement(ee,{style:{width:"calc(100% - 20px)",padding:"2px"}},i.a.createElement(v.a,{style:{minHeight:"auto"}},T.parents?i.a.createElement(h.a,{"aria-label":"breadcrumb",separator:i.a.createElement(b.a,{fontSize:"small",style:{margin:0}})},i.a.createElement(O.a,{label:"Inicio",key:-1,icon:i.a.createElement(Q.a,null),clickable:!0,onClick:function(){e.history.push("/homedetail/".concat(T.post_type))}}),T.parents.map((function(t,n){return i.a.createElement(O.a,{key:n,label:t.name,icon:N.d.find((function(e){return e.value===t.icon})).icon,clickable:!0,onClick:function(){e.history.push("/detail/".concat(t.id))}})})),i.a.createElement(O.b,{label:T.metadata.firstLevel.title,key:T.id,icon:null===(t=N.d.find((function(e){return e.value===(null===T||void 0===T?void 0:T.icon)})))||void 0===t?void 0:t.icon})):i.a.createElement(O.b,{label:null===T||void 0===T||null===(n=T.metadata)||void 0===n||null===(o=n.firstLevel)||void 0===o?void 0:o.title,key:T.id,icon:N.d.find((function(e){return e.value===T.icon})).icon}))),i.a.createElement(ee,{style:{width:"calc(100% - 20px)",height:"calc(100vh - 170px)",padding:"2px",background:"rgb(255 255 255 / 34%)",border:"none",backdropFilter:"blur(10px)",display:"flex"}},i.a.createElement(d.a,{style:{width:"400px",height:"100%",background:"white",borderTopLeftRadius:10,borderBottomLeftRadius:10,marginRight:10}},i.a.createElement(v.a,{className:s.toolbar},i.a.createElement(g.a,{sx:{marginRight:"10px"},className:s.bookmarkIcon,size:"large",onClick:function(){var t={type:"resources",id:T._id};z?m.c(t).then((function(t){W.a.fire({icon:"success",title:"Eliminado de favoritos"}),e.requestUser()})).catch((function(e){W.a.fire({icon:"error",title:"Oops...",text:"No se pudo eliminar de favoritos"})})):m.a(t).then((function(t){W.a.fire({icon:"success",title:"Agregado a favoritos"}),e.requestUser()})).catch((function(e){W.a.fire({icon:"error",title:"Oops...",text:"No se pudo agregar a favoritos"})}))}},z?i.a.createElement(Z.a,null):i.a.createElement(Y.a,null)),i.a.createElement("h6",{style:{flexGrow:1}},T.metadata.firstLevel.title)),i.a.createElement(d.a,null,i.a.createElement(re,{icon:i.a.createElement(k.a,null),title:"Conoce"}),i.a.createElement(ae,{icon:i.a.createElement(x.a,null),name:"Metadatos",onClick:function(){_("metadata")},className:"metadata"===y?"selected":""}),T.children&&T.children.length>0&&i.a.createElement(i.a.Fragment,null,i.a.createElement(re,{icon:i.a.createElement(R.a,null),title:"Explora"}),T.children.map((function(e,t){return i.a.createElement(ae,{key:t,icon:N.d.find((function(t){return t.value===e.icon})).icon,name:e.name,className:(null===y||void 0===y?void 0:y.slug)===e.slug?"selected":"",onClick:function(){_(e)}})}))))),"metadata"===y&&i.a.createElement(d.a,{style:{display:"flex",alignItems:"flex-start",justifyContent:"center",width:"calc(100% - 400px)"}},i.a.createElement(ee,{style:{height:"calc(100vh - 200px)",display:"flex",alignItems:"flex-start",justifyContent:"center",background:"transparent",border:"none"}},i.a.createElement(I.a,{data:T,redirect:function(t){e.history.push(t)}}))),(null===y||void 0===y?void 0:y.slug)&&"files"!==(null===y||void 0===y?void 0:y.slug)&&i.a.createElement(V.a,{type:y,history:e.history,selectedResource:T}),(null===y||void 0===y?void 0:y.slug)&&"files"===(null===y||void 0===y?void 0:y.slug)&&i.a.createElement(H,{selectedType:y.slug,resourceId:T._id,records:T._id,parents:{parents:{id:T._id}},handleClick:function(t){var n,r,a,i,o,s;(null===t||void 0===t||null===(n=t.processing)||void 0===n||null===(r=n.fileProcessing)||void 0===r?void 0:r.type)&&"image gallery"!==(null===t||void 0===t||null===(a=t.processing)||void 0===a||null===(i=a.fileProcessing)||void 0===i?void 0:i.type)?e.history.push("/file/".concat(t.id)):"image gallery"===(null===t||void 0===t||null===(o=t.processing)||void 0===o||null===(s=o.fileProcessing)||void 0===s?void 0:s.type)&&e.history.push("/gallery/".concat(T._id))}}))))},re=function(e){var t=$();return i.a.createElement(d.a,{className:t.separador},e.icon,e.title)},ae=function(e){var t=$();return i.a.createElement(d.a,{className:"".concat(t.itemMenu," ").concat(e.className),onClick:e.onClick},e.icon,i.a.createElement(f.a,{variant:"p",component:"div",style:{flexGrow:1,marginLeft:15}},e.name),i.a.createElement(b.a,null))};t.default=Object(o.b)((function(e){return{user:e.auth.user}}),s.a)(ne)}}]);
//# sourceMappingURL=9.9eff428b.chunk.js.map