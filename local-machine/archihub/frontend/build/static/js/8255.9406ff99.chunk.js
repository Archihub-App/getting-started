"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[8255],{8255:function(e,n,t){t.r(n);var i=t(64467),a=t(89379),o=t(5544),r=t(65043),c=t(78717),l=t(9920),s=t(5670),d=t(48210),u=t(42588),f=t(26240),h=t(43845),g=t(15316),p=t(17392),x=t(99070),v=t(55263),m=t(85865),y=t(92530),A=t(93012),j=t(36795),b=t(31269),k=t(6512),w=t(4319),C=t(76370),S=t(90151),_=t(10765),R=t(68641),D=t(42497),E=t(79175),M=t(74802),L=t(94329),z=t(5374),I=t(94495),N=t(95501),V=t(83003),$=t(88455),P=t(73216),H=t(81551),B=t(72378),T=t(50264),F=t(48084),G=t(85211),W=t(58140),O=t(18751),U=t(11238),Z=t(70579),q=(0,H.A)((function(e){return{close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"},"& path":{fill:"white"}}}})),J=function(e){var n=q(),t=(0,f.A)(),i=(0,W.M)().showAlert;return(0,Z.jsx)("div",{style:{background:t.palette.grey[700],borderRadius:5,marginTop:5},children:(0,Z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(h.A,{label:"Guardar",size:"small",onClick:function(){d.vt({type:"image",record_id:e.record,data:{bbox:e.block.bbox}}).then((function(n){e.setSelectedBlock(null),i("success","Recorte creado correctamente")}))},icon:(0,Z.jsx)(L.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:n.close})}),(0,Z.jsx)(h.A,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:(0,Z.jsx)(M.A,{}),style:{margin:3,width:24,height:24,border:"none"},className:n.close})]})})},Q=(0,H.A)((function(e){return{toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}}}})),K=function(e){var n=(0,r.useState)(null),t=(0,o.A)(n,2),i=t[0],a=t[1];return(0,r.useEffect)((function(){l.vv(e.record,e.slug).then((function(e){a(e)})).catch((function(e){a(null)}))}),[]),(0,Z.jsx)(k.V,{id:"extra",initialPosition:{x:0,y:0},style:{display:i?"block":"none"},children:i&&(0,Z.jsx)("div",{style:{padding:"10px",background:"white",maxWidth:350},children:i.caption.value})})};n.default=function(e){var n=(0,r.useState)(!1),t=(0,o.A)(n,2),d=t[0],M=t[1],L=(0,r.useState)(null),H=(0,o.A)(L,2),q=H[0],X=H[1],Y=(0,r.useState)(null),ee=(0,o.A)(Y,2),ne=ee[0],te=ee[1],ie=(0,r.useState)(!1),ae=(0,o.A)(ie,2),oe=ae[0],re=ae[1],ce=(0,r.useState)([]),le=(0,o.A)(ce,2),se=le[0],de=le[1],ue=(0,r.useState)("carrousel"),fe=(0,o.A)(ue,2),he=fe[0],ge=(fe[1],(0,r.useState)(null)),pe=(0,o.A)(ge,2),xe=pe[0],ve=pe[1],me=(0,r.useRef)(null),ye=(0,r.useRef)(null),Ae=(0,r.useState)(0),je=(0,o.A)(Ae,2),be=je[0],ke=je[1],we=(0,r.useState)(1),Ce=(0,o.A)(we,2),Se=Ce[0],_e=Ce[1],Re=(0,r.useState)(null),De=(0,o.A)(Re,2),Ee=De[0],Me=De[1],Le=(0,V.d4)((function(e){return e.user})),ze=(0,V.d4)((function(e){return e.app.adjustements})),Ie=(0,P.g)().id,Ne=(0,f.A)(),Ve=(0,V.d4)((function(e){return e.app.isDarkMode})),$e=Q(),Pe=(0,V.wA)(),He=(0,W.M)().showAlert,Be=function(e){return(0,Z.jsxs)(g.A,{style:{display:"flex",width:"calc(100% - 20px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",backgroundColor:"dark"===e.variant?Ne.palette.grey[900]:"white",borderRadius:"50px"},children:[(0,Z.jsx)(p.A,{color:"primary",onClick:function(){Te(Se-1)},children:(0,Z.jsx)(R.A,{})}),(0,Z.jsx)(_.Z6,{name:null,value:Se,handleChange:function(e){Te(parseInt(e.target.value),!1)},min:1,max:be,style:{width:"100px",padding:"0px",backgroundColor:"dark"===e.variant?Ne.palette.grey[700]:"white",marginRight:"10px",borderBottom:"none"}}),(0,Z.jsx)(x.Ay,{ref:ye,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:Se,step:1,marks:!0,min:1,max:be,style:{width:"80%"},onChangeCommitted:function(e,n){Te(n,!1)}}),(0,Z.jsx)(p.A,{color:"primary",onClick:function(){Te(Se+1)},children:(0,Z.jsx)(D.A,{})})]})};(0,r.useEffect)((function(){return c.$R(Ie).then((function(e){ke(e.pages)})).catch((function(e){e.json().then((function(e){He("error",e.msg)}))})),Pe((0,G.n_)({contrast:1,brightness:1,saturation:1,invert:0,rotation:0})),function(){(0,S.vs)()}}),[]),(0,r.useEffect)((function(){be>0&&((0,S.Ts)(be,me.current,1,Ie,1,!1),(0,S.Zv)(_e),(0,S.i0)())}),[be]),(0,r.useEffect)((function(){Ee&&"img_analyze"===Ee.view&&l.FZ(Ie,Se-1,Ee.slug,"blocks").then((function(e){(0,S.P4)(e,Se,1,(function(){}))})).catch((function(e){console.log(e)}));var e=(0,a.A)({},ze);e.rotation=0,Pe((0,G.n_)(e))}),[Ee,Se]),(0,r.useEffect)((function(){l.de({id:Ie,index:Se-1}).then((function(e){X(e)})).catch((function(e){console.log(e)}))}),[Se]),(0,r.useEffect)((function(){ze&&(0,S.RI)(ze)}),[ze]);var Te=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e>be&&(e=be),e<1&&(e=1),(0,S.qV)(e,1,Ie,n),_e(e)};(0,r.useEffect)((function(){Le.favorites&&q&&(Le.favorites.find((function(e){return e.id===q._id.$oid}))?M(!0):M(!1))}),[Le.favorites,q]),(0,r.useEffect)((function(){null===ne?("carrousel"===he&&(0,S.D8)(null),oe&&"carrousel"===he&&(0,S.a7)(Se),Fe(Se)):(oe&&"carrousel"===he&&(0,S.a7)(Se),"carrousel"===he&&(0,S.D8)(ne),"carrousel"===he&&(0,S.P4)(se,Se,1,te))}),[ne]);var Fe=function(e){de([]),oe&&"carrousel"===he&&(0,S.a7)(e)};return(0,Z.jsx)(B.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:be>0&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(B.EL,{style:(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({width:"calc(100% - 40px)",marginBottom:0,height:"calc(100% - 20px)",padding:0},"width","400px"),"maxWidth","400px"),"border","none"),"display","block"),"placeContent","flex-start"),"overflow","auto"),"minWidth","300px"),"flexGrow",.5),"margin",10),children:q&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(v.A,{style:{background:Ne.palette.primary.light},className:$e.toolbar,children:[Le.access_token&&"null"!==Le.access_token&&(0,Z.jsx)(p.A,{sx:{marginLeft:"12px",color:Ne.palette.primary.main},size:"large",onClick:function(){var e={type:"records",id:q._id.$oid};d?s.C5(e).then((function(e){Pe((0,$.me)(Le.access_token)),He("success","Eliminado de favoritos")})).catch((function(e){He("error","No se pudo eliminar de favoritos")})):s.Gm(e).then((function(e){Pe((0,$.me)(Le.access_token)),He("success","Agregado a favoritos")})).catch((function(e){He("error","No se pudo agregar a favoritos")}))},children:d?(0,Z.jsx)(A.A,{}):(0,Z.jsx)(y.A,{})}),(0,Z.jsx)(m.A,{variant:"h6",style:{flexGrow:1,marginLeft:0,color:Ne.palette.primary.main},children:q.displayName?q.displayName:q.name})]}),(0,Z.jsxs)(g.A,{children:[(0,Z.jsx)(U.nA,{startIcon:(0,Z.jsx)(O.A,{}),style:{borderRadius:5,backgroundColor:Ve?Ne.palette.grey[800]:Ne.palette.grey[200],color:Ne.palette.grey[500],margin:10,width:"calc(100% - 20px)"},label:"Descargar archivo",onClick:function(){He("askUserDownloadType","Escoge el tipo de descarga").then((function(e){"original"===e?(He("loading","Descargando archivo..."),l.U3({id:q._id.$oid,type:"original"},(function(e){He("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){He("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),He("error","Error al descargar el archivo")}))):"small"===e&&(He("loading","Descargando archivo..."),l.U3({id:q._id.$oid,type:"small"},(function(e){He("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){He("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),He("error","Error al descargar el archivo")})))}))}}),(0,Z.jsx)(u.M2,{record:q,setMetadata:ve,metadata:xe}),Object.keys(q.processing).length>1&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(T.Separator,{icon:(0,Z.jsx)(z.A,{}),title:"Procesamientos"}),Object.keys(q.processing).map((function(e,n){var t=q.processing[e].type,i=I.vJ.find((function(e){return e.value===t})),a=t;if("audio"!==t&&"video"!==t&&i)return(0,Z.jsx)(T.ItemMenu,{icon:(0,Z.jsx)(N.A,{}),name:i.label,onClick:function(){(null===Ee||void 0===Ee?void 0:Ee.view)===a?Me(null):Me({view:a,slug:e}),(0,S.oS)(null)},className:(null===Ee||void 0===Ee?void 0:Ee.view)===a?"selected":""},n)}))]})]})]})}),(0,Z.jsx)(B.EL,{style:{width:"calc(100% - 400px)",height:"calc(100% - 25px)",position:"relative",margin:10,marginLeft:0,backgroundColor:Ne.palette.grey[900],padding:0},children:(0,Z.jsx)(j.Q,{backend:b.t2,children:(0,Z.jsxs)(w.M,{onDrop:function(e,n){return console.log(e,n)},onDragStart:function(){console.log("start")},children:[(0,Z.jsx)(g.A,{ref:me,style:{position:"absolute",width:"100%",height:"calc(100%)",overflow:"hidden",cursor:"move"}}),(0,Z.jsx)(k.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:xe?"block":"none"},children:(0,Z.jsx)(C.A,{resource:xe,setMetadata:ve,history:e.history})}),(0,Z.jsxs)(k.V,{id:"processing",initialPosition:{x:0,y:0},style:{padding:0,borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,Z.jsxs)("div",{style:{padding:5,background:Ne.palette.grey[700],borderRadius:5},children:[(0,Z.jsx)(Be,{variant:"dark"}),(0,Z.jsx)(F.A,{children:Le.roles.includes("user")&&(0,Z.jsx)(h.A,{label:"Agregar un recorte",size:"small",onClick:function(){te({index:se.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:"default",new:!0}),re(!0)},style:{border:"none",color:"white",backgroundColor:Ne.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,Z.jsx)(g.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,Z.jsx)(E.A,{})}),variant:"outlined"})})]}),ne&&(0,Z.jsx)(J,{block:ne,labels:["default"],setSelectedBlock:te,record:q._id.$oid})]}),"img_analyze"===(null===Ee||void 0===Ee?void 0:Ee.view)&&(0,Z.jsx)(K,{record:q._id.$oid,slug:Ee.slug},q._id.$oid)]})})})]})})}},5374:function(e,n,t){var i=t(24994);n.A=void 0;var a=i(t(40039)),o=t(70579);n.A=(0,a.default)((0,o.jsx)("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PrecisionManufacturing")},94329:function(e,n,t){var i=t(24994);n.A=void 0;var a=i(t(40039)),o=t(70579);n.A=(0,a.default)((0,o.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")}}]);
//# sourceMappingURL=8255.9406ff99.chunk.js.map