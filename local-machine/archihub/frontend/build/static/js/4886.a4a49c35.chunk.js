"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[4886],{24886:function(e,t,r){r.r(t);var n=r(89379),a=r(5544),i=r(65043),o=r(73216),l=r(26240),s=r(83003),c=r(85211),d=r(46020),u=(r(85742),r(69389)),p=r(81551),f=r(66187),g=r(94495),h=r(43288),m=r(55003),v=r(72378),y=r(42588),x=r(55263),b=r(29464),w=r(70579),A=(0,p.A)((function(e){return{toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}},bloque:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}}}}));t.default=function(e){var t=A(),r=(0,l.A)(),p=(0,i.useState)(null),j=(0,a.A)(p,2),k=j[0],C=j[1],M=(0,i.useState)(null),B=(0,a.A)(M,2),_=B[0],R=B[1],S=(0,i.useState)(null),D=(0,a.A)(S,2),T=D[0],N=D[1],z=(0,i.useState)(null),L=(0,a.A)(z,2),F=L[0],E=L[1],I=(0,i.useState)(null),G=(0,a.A)(I,2),P=G[0],H=G[1],O=(0,i.useState)([]),Y=(0,a.A)(O,2),Z=Y[0],q=Y[1],J=(0,i.useState)(null),K=(0,a.A)(J,2),Q=K[0],V=K[1],$=((0,s.d4)((function(e){return e.user})),(0,s.d4)((function(e){return e.app.filters}))),U=(0,o.g)().slug,W=(0,i.useState)(!0),X=(0,a.A)(W,2),ee=X[0],te=X[1],re=(0,s.wA)(),ne={page:0,sortBy:"createdAt",sortOrder:"desc",activeColumns:[{destiny:"",label:""},{destiny:"createdAt",label:"Fecha de creaci\xf3n",sortBy:"createdAt"},{destiny:"ident",label:"Identificador"},{destiny:"metadata.firstLevel.title",label:"T\xedtulo",sortBy:"metadata.firstLevel.title"},{destiny:"files",label:"Archivos"},{destiny:"accessRights",label:"Derechos de acceso"}]};(0,i.useEffect)((function(){if($[U]){if($[U].post_type?N($[U].post_type):N(null),$[U].parents?q($[U].parents):q([]),!$[U].status){var e=(0,c.e)($,U,"status","published");re((0,c.vm)(e))}}else{var t=(0,c.e)($,U,"status","published");re((0,c.vm)(t))}}),[$]),(0,i.useEffect)((function(){U&&d.hE(U).then((function(e){if(te(!1),V(e.forms),C(e.types.sort((function(e,t){return e.count-t.count})).reverse()),E(e.files),R({name:e.name,icon:e.icon,description:e.description,slug:e.slug}),e.parent&&""!==e.parent){H(e.parent);var t=(0,n.A)({},$);t[U]&&t[U].activeColumns&&0!==t[U].activeColumns.length||(t[U]=ne),t[U].root={id:e.parent},re((0,c.vm)(t))}})).catch((function(e){console.log(e)}))}),[U]);return(0,w.jsxs)(v.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:ee?"center":"flex-start"},children:[ee&&(0,w.jsx)(h.A,{}),k&&F&&_&&Q&&$[U]&&(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(m.ResizableBox,{onResize:function(){console.log("resize")},draggableOpts:{grid:[25,25]},handle:(0,w.jsx)("div",{style:{width:"10px",height:"100%",background:r.palette.primary.light,cursor:"col-resize"}}),children:(0,w.jsxs)(v.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"400px",display:"block",overflow:"auto",placeContent:"flex-start"},children:[(0,w.jsxs)(x.A,{className:t.toolbar,style:{background:r.palette.primary.light,marginBottom:10},children:[(0,w.jsx)("div",{style:{marginLeft:"24px",color:r.palette.primary.main},children:g.dR.find((function(e){return e.value===_.icon})).icon}),(0,w.jsx)(f.A,{variant:"h6",style:{flexGrow:1,marginLeft:15,color:r.palette.primary.main},children:_.name})]}),(0,w.jsx)(y.AD,{type:_,parents:k,files:F,view:U,root:P}),$[U].status&&(0,w.jsx)(u.A,{root:P||null,activeTypes:k,postType:T?T.slug:null,view:"list",mainView:U,checkboxTypes:k.map((function(e){return e.slug})),multiple:!1,selected:[Z],childrenSelect:!1,setSelected:function(e){if(0===e.length){var t=(0,c.e)($,U,"parents",{id:P});re((0,c.vm)(t))}else{var r=(0,c.e)($,U,"parents",e[0]);re((0,c.vm)(r))}}},T?[T.slug]:k)]})}),(0,w.jsx)(b.M,{types:k,selectedType:T,history:e.history,view:U,selectedResource:P?{_id:P}:null,mainType:_,forms:Q},P)]})]})}},42588:function(e,t,r){r.d(t,{AD:function(){return S},M2:function(){return R},oF:function(){return D}});var n=r(60436),a=r(65043),i=r(96446),o=r(85865),l=r(17392),s=r(43845),c=r(81551),d=r(94495),u=r(39244),p=r(26240),f=r(11238),g=r(83003),h=r(85211),m=r(98344),v=r(5983),y=r(58140),x=r(18751),b=r(92429),w=r(78717),A=r(99246),j=r(16485),k=r(73216),C=r(70579),M=(0,c.A)((function(e){return{container:{display:"flex",flexDirection:"column",width:"calc(100% - 20px)",overflowY:"auto",marginLeft:"10px",marginTop:"10px"},item:{overflow:"hidden",color:"#777",fontSize:14,position:"relative",marginBottom:10,paddingBottom:10},itemName:{fontSize:15},chip:{margin:2,padding:2,"& .MuiChip-avatar":{backgroundColor:"transparent !important"}}}})),B=function(e){var t=M(),r=(0,p.A)(),n=(0,y.M)().showAlert,a=(0,g.d4)((function(e){return e.app.isDarkMode}));return(0,C.jsxs)(i.A,{className:t.item,style:e.style?e.style:{borderBottom:"1px solid ".concat(a?r.palette.grey[800]:r.palette.grey[200])},children:[(0,C.jsxs)(i.A,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,C.jsx)(o.A,{className:t.itemName,style:{color:a?r.palette.primary.light:r.palette.primary.main},children:e.title}),e.help&&(0,C.jsx)(l.A,{onClick:function(){n("video-info",e.help)},children:(0,C.jsx)(v.A,{style:{color:a?r.palette.grey[400]:r.palette.grey[700]}})})]}),e.item?e.item:e.children]})},_=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var r=t<0?0:t,n=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,n)).toFixed(r))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][n]},R=function(e){var t,r,n=M(),c=(0,g.d4)((function(e){return e.app.isDarkMode})),f=(0,p.A)(),h=((0,A.A)(),(0,k.Zp)());return(0,a.useEffect)((function(){0===e.record.parent.length?e.setMetadata(null):e.metadata&&e.setMetadata(e.record.parent[0])}),[e.record]),(0,C.jsxs)(i.A,{className:n.container,children:[(0,C.jsx)(B,{title:"Nombre del archivo",item:null!==e&&void 0!==e&&null!==(t=e.record)&&void 0!==t&&t.displayName?null===e||void 0===e||null===(r=e.record)||void 0===r?void 0:r.displayName:e.record.name}),(0,C.jsx)(B,{title:"HASH",item:e.record.hash}),(0,C.jsx)(B,{title:"Tama\xf1o",item:_(e.record.size)}),e.record.parent.length>0&&(0,C.jsx)(B,{title:"Contenido relacionado",children:e.record.parent.map((function(t,r){return(0,C.jsx)(s.A,{avatar:d.dR.filter((function(e){return e.value===t.icon}))?d.dR.filter((function(e){return e.value===t.icon}))[0].iconlight:(0,C.jsx)(u.A,{}),label:(0,C.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between",width:"100%"},children:[(0,C.jsx)(o.A,{variant:"body2",component:"span",sx:{marginRight:1,flexGrow:1,textAlign:"left"},children:t.name}),(0,C.jsx)(l.A,{size:"small",onClick:function(e){e.stopPropagation(),h("/detail/".concat(t.id))},onAuxClick:function(e){e.stopPropagation(),1===e.button&&window.open("/detail/".concat(t.id),"_blank")},"aria-label":"go to details for ".concat(t.name),sx:{padding:"4px",color:"inherit","&:hover":{backgroundColor:c?f.palette.grey[700]:f.palette.grey[300]}},children:(0,C.jsx)(j.A,{fontSize:"inherit"})})]}),className:n.chip,onClick:function(){e.setMetadata(t)},sx:{background:c?f.palette.grey[800]:f.palette.grey[200],color:c?f.palette.grey[300]:f.palette.grey[600],paddingLeft:1,paddingRight:1,margin:"2px","& svg":{width:"20px !important"},"& path":{fill:c?f.palette.grey[300]:f.palette.grey[600]}}},r)}))})]})},S=function(e){var t=M(),r=((0,g.wA)(),(0,g.d4)((function(e){return e.app.filters}))),n=(0,g.d4)((function(e){return e.app.isDarkMode})),a=(0,p.A)(),l=(0,y.M)().showAlert;return(0,C.jsx)(C.Fragment,{children:(0,C.jsxs)(i.A,{className:t.container,children:[(0,C.jsx)(f.nA,{startIcon:(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(x.A,{}),(0,C.jsx)(b.A,{})]}),label:"Descargar inventario",style:{borderRadius:5,backgroundColor:n?a.palette.grey[800]:a.palette.grey[200],color:a.palette.grey[500]},onClick:function(){l("confirm","\xbfDesea descargar el inventario de los tipos de contenido?").then((function(t){if(t){l("loading","Generando archivo...");var n=r[e.view]&&r[e.view].post_type?r[e.view].post_type.slug:"*";w._Q({post_type:n,view:e.view},(function(e){l("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){l("success","Archivo descargado correctamente")})).catch((function(e){e.msg?l("error","Error al descargar el archivo: "+e.msg):l("error","Error al descargar el archivo")}))}}))}}),(0,C.jsx)(B,{title:"Descripci\xf3n",item:(0,C.jsx)(o.A,{children:e.type.description})}),e.files.total>0&&(0,C.jsx)(B,{title:"Balance general de los documentos",item:(0,C.jsx)(m.RJ,{data:e.files.data,legend:!0,style:{height:250,width:250,margin:"0 auto"}})}),(0,C.jsx)(D,{view:e.view,parents:e.parents,root:e.root})]})})},D=function(e){var t,r=(0,g.wA)(),a=(0,g.d4)((function(e){return e.app.filters})),i=M(),o=(0,g.d4)((function(e){return e.app.isDarkMode})),l=(0,p.A)(),c=(0,A.A)();return(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)(B,{title:c.formatMessage({id:"cataloging.folderStructure"}),item:(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(f.$k,{label:c.formatMessage({id:"menuList.postTypes"}),style:{color:o?"white":"black",backgroundColor:o?"#333":"#f5f5f5",borderColor:o?"#333":"#f5f5f5"},showLabel:!1,value:a[e.view]?!e.single&&a[e.view].post_type?a[e.view].post_type.slug:e.single&&!Array.isArray(a[e.view].post_type_single)&&a[e.view].post_type_single?a[e.view].post_type_single.slug:"*":"*",onChange:function(t){if(e.onChange)e.onChange(t);else{var n=e.single?"post_type_single":"post_type";if("*"===t.target.value){var i=(0,h.e)(a,e.view,n,null);r((0,h.vm)(i))}else{var o=(0,h.e)(a,e.view,n,{slug:t.target.value});r((0,h.vm)(o))}}},options:function(){var t=(0,n.A)(e.parents.map((function(e){return{value:e.slug,label:e.name}})));return"cataloging"!==e.view&&(t=[{value:"*",label:c.formatMessage({id:"cataloging.allPostTypes"})}].concat((0,n.A)(t))),t}()})}),help:"folder-structure"}),a[e.view]&&(null===(t=a[e.view].parents)||void 0===t?void 0:t.name)&&(0,C.jsx)("div",{style:{marginBottom:10},children:(0,C.jsx)(s.A,{avatar:d.dR.filter((function(t){return t.value===a[e.view].parents.icon}))?d.dR.filter((function(t){return t.value===a[e.view].parents.icon}))[0].iconlight:(0,C.jsx)(u.A,{}),label:a[e.view].parents.name,className:i.chip,onDelete:function(){var t=(0,h.e)(a,e.view,"parents",{id:e.root});r((0,h.vm)(t))},size:"small",color:"primary",sx:{backgroundColor:l.palette.primary.light,color:l.palette.primary.main,"& path":{fill:l.palette.primary.main}}})})]})}}}]);
//# sourceMappingURL=4886.a4a49c35.chunk.js.map