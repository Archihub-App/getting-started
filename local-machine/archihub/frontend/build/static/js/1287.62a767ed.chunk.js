"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[1287],{82094:function(e,t,n){var i=n(89379),a=n(5544),r=n(65043),o=n(83003),l=n(86279),c=n(11238),s=n(99562),u=n(26240),d=n(58140),g=n(43288),h=n(72378),p=n(99246),b=n(70579);t.A=function(e){var t=(0,r.useState)(null),n=(0,a.A)(t,2),f=n[0],x=n[1],m=(0,r.useState)(!0),w=(0,a.A)(m,2),v=w[0],k=w[1],y=(0,u.A)(),A=(0,d.M)().showAlert,j=(0,o.d4)((function(e){return e.user})),S=(0,o.d4)((function(e){return e.app.isDarkMode})),B=(0,p.A)();return(0,r.useEffect)((function(){e.record?l.Tk(e.id).then((function(e){k(!1),x(e)})).catch((function(e){k(!1),x(null)})):l.Qs(e.id).then((function(e){k(!1),x(e)})).catch((function(e){k(!1),x(null)}))}),[]),(0,r.useEffect)((function(){}),[j,f]),(0,b.jsxs)(b.Fragment,{children:[v&&(0,b.jsx)(g.A,{}),!f&&!v&&j.roles.includes("team_lead")&&(0,b.jsx)(c.nA,{style:{borderRadius:5},customColor:{background:S?y.palette.grey[800]:y.palette.grey[200],color:S?y.palette.primary.light:y.palette.primary.main},startIcon:(0,b.jsx)(s.A,{}),onClick:function(){A("taskForm","create").then((function(t){if(t){k(!0),x(null);var n=(0,i.A)({},t);e.record?n.recordId=e.id:n.resourceId=e.id,l.UT(JSON.stringify(n)).then((function(e){k(!1),x(e)})).catch((function(e){console.log(e)}))}}))},label:B.formatMessage({id:"usertask.create"})}),f&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(c.nA,{style:{borderRadius:5},customColor:{background:y.palette.grey[200],color:y.palette.primary.main},startIcon:(0,b.jsx)(s.A,{}),label:"".concat(B.formatMessage({id:"usertask.asignedTo"})," ").concat(f.user)}),(0,b.jsx)(h.WB,{children:(0,b.jsx)("div",{dangerouslySetInnerHTML:{__html:f.comment.replace(/\n/g,"<br />")}})}),("pending"===f.status||"rejected"===f.status)&&f.user===j.name&&(0,b.jsx)(c.nA,{style:{marginTop:10,borderRadius:5},customColor:{background:y.palette.grey[200],color:y.palette.grey[600]},onClick:function(){A("taskForm","update").then((function(e){e?(k(!0),x(null),l.lC(f._id,JSON.stringify((0,i.A)((0,i.A)({},e),{},{status:"review"}))).then((function(e){k(!1),x(e)})).catch((function(e){console.log(e)}))):k(!1)}))},label:B.formatMessage({id:"usertask.sendToReview"})}),"review"===f.status&&j.roles.includes("team_lead")&&(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:10,width:"100%"},children:[(0,b.jsx)(c.nA,{style:{borderRadius:5,margin:2},customColor:{background:y.palette.grey[200],color:y.palette.grey[600]},onClick:function(){A("taskForm","update").then((function(e){e&&(k(!0),x(null),l.lC(f._id,JSON.stringify((0,i.A)((0,i.A)({},e),{},{status:"rejected"}))).then((function(e){k(!1),x(e)})).catch((function(e){console.log(e)})))}))},label:B.formatMessage({id:"usertask.reject"})}),(0,b.jsx)(c.nA,{style:{borderRadius:5,margin:2},customColor:{background:y.palette.grey[200],color:y.palette.grey[600]},onClick:function(){A("taskForm","update").then((function(e){e&&(k(!0),x(null),l.lC(f._id,JSON.stringify((0,i.A)((0,i.A)({},e),{},{status:"approved"}))).then((function(e){k(!1),x(null)})).catch((function(e){k(!1),x(null)})))}))},label:B.formatMessage({id:"usertask.approve"})})]})]})]})}},63573:function(e,t,n){n.d(t,{A:function(){return $}});var i=n(89379),a=n(5544),r=n(65043),o=n(83003),l=n(85211),c=n(9920),s=n(19853),u=n(48210),d=n(4598),g=n(43845),h=n(96446),p=n(17392),b=n(99070),f=n(55263),x=n(90151),m=n(68641),w=n(42497),v=n(83903),k=n(34535),y=n(6512),A=n(4319),j=n(76370),S=n(81551),B=n(11906),C=n(41905),R=n(24394),M=n(30064),V=n.n(M),E=n(26240),I=n(15089),T=n(70579),z=((0,C.A)((function(e){return{segment:{fontSize:"20px",opacity:.25,transition:"all .5s",textAlign:"center",cursor:"pointer","&:hover":{opacity:.55},"&.selected":{opacity:1}},paragraph:{fontSize:"15px",maxWidth:"750px",margin:"0 auto",marginBottom:"20px"}}})),function(e){var t=(0,r.useState)(0),n=(0,a.A)(t,2),l=n[0],c=(n[1],(0,r.useState)(null)),u=(0,a.A)(c,2),d=u[0],g=u[1],p=(0,r.useState)(null),b=(0,a.A)(p,2),f=b[0],x=b[1],m=(0,E.A)();(0,o.d4)((function(e){return e.app.isDarkMode}));(0,r.useEffect)((function(){e.view&&(e.setTabView("document"),s.DJ(e.view.slug,"detail").then((function(e){e.forEach((function(e){"multicheckbox"===e.type&&w(e.id,e.default)})),g(e)})).catch((function(e){})))}),[]);var w=function(e,t){var n=(0,i.A)({},f);n[e]=t,x(n)};return(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(h.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",margin:0,marginBottom:"5px"},children:(0,T.jsx)(I.A,{value:l,style:{background:m.palette.grey[700]},list:[{value:"document",label:"Documento"},{value:"blocks",label:"Bloques"},{value:"words",label:"Palabras"}],onChange:function(t){e.setTabView(t.value)}})}),d&&(0,T.jsx)(h.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",marginRight:"20px",marginTop:"20px",backgroundColor:"#fff",borderRadius:"25px",boxShadow:"0px 3px 1px -2px rgba(0,0,0,0.2), 0px 2px 2px 0px rgba(0,0,0,0.14), 0px 1px 5px 0px rgba(0,0,0,0.12)"},children:d.map((function(t,n){return(0,T.jsxs)(T.Fragment,{children:["multicheckbox"===t.type&&(0,T.jsx)(R.lH,{options:t.options.map((function(e){return{id:e.value,term:e.label}})),value:f[t.id],handleChange:function(e){w(t.id,e)}}),"button"===t.type&&(0,T.jsx)(B.A,{variant:"contained",onClick:function(){var n;e.view.slug,n=t.callback,s.Gj(e.view.slug,JSON.stringify((0,i.A)((0,i.A)({},f),{},{id:e.id})),n).then((function(e){V().fire({title:"\xc9xito",text:"Se ha ejecutado la acci\xf3n correctamente",icon:"success",confirmButtonText:"Ok"})}))},sx:{margin:"10px"},children:t.label})]})}))})]})}),_=n(74054),F=n(6456),D=n(48084),P=n(70141),O=n(64904),H=n(90675),L=n(10467),N=n(2936),q=n.n(N),G=n(49658),J=n(43288),Z=function(e){var t=(0,r.useRef)(),n=(0,r.useRef)(),o=(0,r.useRef)(),l=(0,r.useRef)(!1),s=(0,r.useState)(0),u=(0,a.A)(s,2),d=u[0],g=u[1],h=(0,r.useMemo)((function(){return G.UMr(G.t55)}),[]),p=(0,r.useState)({width:100,height:100}),b=(0,a.A)(p,2),f=b[0],x=b[1],m=(0,r.useState)(!0),w=(0,a.A)(m,2),v=w[0],k=w[1],y=(0,r.useCallback)(function(){var t=(0,L.A)((0,H.A)().mark((function t(n){var i,a,r,o,l;return(0,H.A)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=document.getElementById("page-".concat(n))){t.next=4;break}return n+1===e.page&&k(!1),t.abrupt("return");case 4:if(a=i.querySelector("svg")){t.next=8;break}return n+1===e.page&&k(!1),t.abrupt("return");case 8:return n+1===e.page&&k(!0),t.prev=9,t.next=12,c.f2(e.id,[n],"big");case 12:if((r=t.sent)&&r[0]&&r[0].data){t.next=17;break}return console.error("Image data not found for page",n),n+1===e.page&&k(!1),t.abrupt("return");case 17:o=new Image,l="data:image/jpg;base64,"+r[0].data,i.style.backgroundImage="url(".concat(l,")"),o.onload=function(){var t=o.width,r=o.height,l=i.getBoundingClientRect();if(0===l.width||0===l.height)return console.warn("Page div for index ".concat(n," has zero/incorrect dimensions when image loaded. Width: ").concat(l.width,", Height: ").concat(l.height,". SVG setup might be incorrect. Retrying might be needed or check CSS.")),void(n+1===e.page&&k(!1));var c,s,u=l.width,d=l.height,g=t/r;g>u/d?(c=u,s=u/g):t/u>r/d?(c=u,s=r*(u/t)):(s=d,c=t*(d/r));var h=(u-(c=Math.max(1,c)))/2,p=(d-(s=Math.max(1,s)))/2;a.setAttribute("viewBox","0 0 ".concat(c," ").concat(s)),a.setAttribute("preserveAspectRatio","none"),a.style.position="absolute",a.style.left="".concat(h,"px"),a.style.top="".concat(p,"px"),a.style.width="".concat(c,"px"),a.style.height="".concat(s,"px"),n+1===e.page&&(x({width:c,height:s}),k(!1))},o.onerror=function(){console.error("Failed to load image for page",n),n+1===e.page&&k(!1)},o.src=l,t.next=29;break;case 25:t.prev=25,t.t0=t.catch(9),console.error("Error fetching image for page",n,t.t0),n+1===e.page&&k(!1);case 29:case"end":return t.stop()}}),t,null,[[9,25]])})));return function(e){return t.apply(this,arguments)}}(),[e.id,e.page,k,x]);(0,r.useEffect)((function(){var t=e.page-1,i=setTimeout((function(){var e=document.getElementById("page-".concat(t));e&&e.scrollIntoView({duration:0})}),200),a=null;n.current=new IntersectionObserver((function(t){return t.forEach((function(t){if(t.isIntersecting){var n=parseInt(t.target.dataset.index);a&&clearTimeout(a),a=setTimeout((function(){e.setPage(n+1)}),150)}}))}),{threshold:.25});var r=n.current;e.pages>0&&document.querySelectorAll(".page").forEach((function(e){return r.observe(e)}));var o=setTimeout((function(){e.pages>0&&t>=0&&t<e.pages?y(t):(e.pages,k(!1))}),250);return function(){r&&r.disconnect(),clearTimeout(i),a&&clearTimeout(a),clearTimeout(o)}}),[e.id,e.page,e.pages,e.setPage,y]),(0,r.useEffect)((function(){var t=n.current;t&&e.pages>0&&(t.disconnect(),document.querySelectorAll(".page").forEach((function(e){return t.observe(e)})))}),[e.pages]),(0,r.useEffect)((function(){if(!l.current){if(d!==e.page&&e.page>0&&e.page<=e.pages){var t=Math.abs(e.page-d),n=document.getElementById("page-".concat(e.page-1));n&&n.scrollIntoView({behavior:"smooth",duration:Math.max(100,50*t)})}g(e.page)}}),[e.page,e.pages,d]);var A=null,j=(0,r.useCallback)((function(){l.current=!0,A&&clearTimeout(A),A=setTimeout((function(){l.current=!1}),150)}),[]);(0,r.useEffect)((function(){var e=t.current;return e&&e.addEventListener("wheel",j,{passive:!0}),function(){e&&e.removeEventListener("wheel",j),A&&clearTimeout(A)}}),[j]);var S=function(e){return Array.isArray(e.label)?e.label.length>0?"O"===e.label[0]?"transparent":h(e.label[0]):void 0:e.type?(console.log("Block type:",e.type,"Color:",h(e.type)),h(e.type)):"transparent"};(0,r.useEffect)((function(){return t.current&&t.current.addEventListener("wheel",j),function(){t.current&&t.current.removeEventListener("wheel",j)}}),[t]),(0,r.useEffect)((function(){o.current&&q()(o.current).resizable({edges:{left:!1,right:!0,bottom:!0,top:!1},listeners:{move:function(t){var n=t.target.ownerSVGElement;if(n){var a=n.getBoundingClientRect();if(0!==f.width&&0!==f.height){var r=parseFloat(t.target.getAttribute("x")),o=parseFloat(t.target.getAttribute("y")),l=t.client.x-a.left,c=t.client.y-a.top,s=l/a.width*f.width-r,u=c/a.height*f.height-o;s=Math.max(1,s),u=Math.max(1,u),t.target.setAttribute("width","".concat(s)),t.target.setAttribute("height","".concat(u));var d=s/f.width,g=u/f.height;d=Math.max(0,Math.min(d,1-e.selectedBlock.bbox.x)),g=Math.max(0,Math.min(g,1-e.selectedBlock.bbox.y));var h={x:e.selectedBlock.bbox.x,y:e.selectedBlock.bbox.y,width:d,height:g},p=(0,i.A)({},e.selectedBlock);p.bbox=h,e.setSelectedBlock(p)}}}}}).draggable({listeners:{move:function(t){var n=t.target.ownerSVGElement;if(n){var a=n.getBoundingClientRect();if(0!==f.width&&0!==f.height){var r=parseFloat(t.target.getAttribute("x")),o=parseFloat(t.target.getAttribute("y")),l=t.delta.x/a.width*f.width,c=o+t.delta.y/a.height*f.height,s=(r+l)/f.width,u=c/f.height;s=Math.max(0,Math.min(s,1-e.selectedBlock.bbox.width)),u=Math.max(0,Math.min(u,1-e.selectedBlock.bbox.height));var d=s*f.width,g=u*f.height;t.target.setAttribute("x","".concat(d)),t.target.setAttribute("y","".concat(g));var h={x:s,y:u,width:e.selectedBlock.bbox.width,height:e.selectedBlock.bbox.height},p=(0,i.A)((0,i.A)({},e.selectedBlock),{},{bbox:h});e.setSelectedBlock(p)}}}}})}),[o,e.selectedBlock,f]);return console.log(e.selectedBlock,"selected block in DocumentViewerScroll"),(0,T.jsx)("div",{ref:t,style:{height:"100%",width:"100%",overflowY:"auto",position:"absolute",top:0,left:0},children:Array.from({length:e.pages},(function(t,n){return(0,T.jsxs)("div",{id:"page-".concat(n),className:"page","data-index":n,style:{marginBottom:30,backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center",display:"flex",justifyContent:"center",alignItems:"center",position:"relative",width:"100%",aspectRatio:"1/1"},children:[v&&(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center",width:"100%"},children:(0,T.jsx)(J.A,{})}),(0,T.jsxs)("svg",{children:[e.selectedBlock&&e.selectedBlock.new&&e.page-1===n&&!v&&(0,T.jsx)("rect",{x:e.selectedBlock.bbox.x*f.width,y:e.selectedBlock.bbox.y*f.height,width:e.selectedBlock.bbox.width*f.width,height:e.selectedBlock.bbox.height*f.height,fill:S(e.selectedBlock,o.current),fillOpacity:.3,ref:o}),e.selectedBlock&&e.blocks&&e.page-1===n&&!v&&(0,T.jsx)("rect",{x:e.selectedBlock.bbox.x*f.width,y:e.selectedBlock.bbox.y*f.height,width:e.selectedBlock.bbox.width*f.width,height:e.selectedBlock.bbox.height*f.height,fill:S(e.selectedBlock),fillOpacity:.3,ref:o}),!e.selectedBlock&&e.blocks&&!v&&e.blocks.map((function(t,a){return e.page!==n+1?null:(console.log("Rendering block",t,"on page",n+1),(0,T.jsx)("rect",{x:t.bbox.x*f.width,y:t.bbox.y*f.height,width:t.bbox.width*f.width,height:t.bbox.height*f.height,fill:S(t,t.type),fillOpacity:.3,onClick:function(){var n=(0,i.A)((0,i.A)({},t),{},{index:a});e.setSelectedBlock(n)},style:{cursor:"pointer",stroke:e.selectedBlock&&e.selectedBlock.id===t.id?"black":"none",strokeWidth:e.selectedBlock&&e.selectedBlock.id===t.id?2:0}},a))}))]})]},n)}))})},W=n(61413),Q=n(79175),U=n(58140),X=(0,S.A)((function(e){return{scrollbar:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}},close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"},"& path":{fill:"white"}}}})),Y=(0,k.Ay)(d.A)((function(e){var t=e.theme;return{width:62,height:26,padding:8,"& .MuiSwitch-switchBase":{margin:1,padding:0,transform:"translateX(6px)","&.Mui-checked":{color:"#fff",transform:"translateX(30px)","& .MuiSwitch-thumb:before":{backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24"><path fill="white" d="M2 7h4v10H2V7zm5 12h10V5H7v14zM18 7h4v10h-4V7z"></path></svg>\')'},"& + .MuiSwitch-track":{opacity:1,backgroundColor:(t.palette.mode,t.palette.grey[800])}}},"& .MuiSwitch-thumb":{backgroundColor:(t.palette.mode,t.palette.primary.main),width:23,height:23,"&::before":{content:"''",position:"absolute",width:"100%",height:"100%",left:0,top:0,backgroundRepeat:"no-repeat",backgroundPosition:"center",backgroundImage:'url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" height="20" width="20" viewBox="0 0 24 24"><path fill="white" d="M2 21h19v-3H2v3zM20 8H3c-.55 0-1 .45-1 1v6c0 .55.45 1 1 1h17c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1zM2 3v3h19V3H2z"></path></svg>\')',backgroundSize:"60%"}},"& .MuiSwitch-track":{opacity:1,backgroundColor:(t.palette.mode,t.palette.grey[800]),borderRadius:10,border:"1px solid "+t.palette.grey[800],height:10}}})),K=function(e){var t=X(),n=(0,r.useState)({}),o=(0,a.A)(n,2),l=o[0],d=o[1],h=(0,r.useState)({}),p=(0,a.A)(h,2),b=p[0],f=p[1],x=(0,E.A)(),m=(0,U.M)().showAlert;(0,r.useEffect)((function(){l[e.subView]||e.slug&&e.subView&&s.DJ(e.slug,e.subView).then((function(t){var n=(0,i.A)({},l);n[e.subView]?n[e.subView]=n[e.subView].concat(t):n[e.subView]=t;var a=(0,i.A)({},b);t.forEach((function(t){a[t.id]=e.block[t.id]})),f(a),d(n)})).catch((function(e){}))}),[e.subView]);var w=function(t,n){var a=(0,i.A)({},b);a[n.id]=t.target.value,f(a);var r=(0,i.A)({},e.block);r[n.id]=t.target.value,e.setSelectedBlock(r)};return(0,T.jsxs)("div",{style:{background:x.palette.grey[700],borderRadius:5,marginTop:5},children:[(0,T.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[(0,T.jsxs)("div",{children:[(0,T.jsx)(g.A,{label:"Guardar",size:"small",onClick:function(){!function(){var t={data:b,id_doc:e.recordId,type_block:e.subView,index:e.block.index,page:e.page,slug:e.slug,bbox:e.block.bbox};if(e.slug&&e.subView)e.block.new?c.Rm(t).then((function(t){e.setSelectedBlock(null)})).catch((function(e){console.error(e),m("error","Error al guardar el bloque")})):c.ao(t).then((function(t){e.setSelectedBlock(null)})).catch((function(e){console.error(e),m("error","Error al actualizar el bloque")}));else if(e.block.new){var n={x:e.block.bbox.x,y:e.block.bbox.y,width:e.block.bbox.width,height:e.block.bbox.height};u.vt({type:"document",record_id:e.recordId,data:{bbox:n,page:e.page}}).then((function(t){e.setSelectedBlock(null),m("success","Recorte creado correctamente")}))}}()},icon:(0,T.jsx)(_.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close}),!e.block.new&&(0,T.jsx)(g.A,{label:"Eliminar",size:"small",onClick:function(){!function(){var t={id_doc:e.recordId,type_block:e.subView,index:e.block.index,page:e.page,slug:e.slug};c.S7(t).then((function(t){e.setSelectedBlock(null)}))}()},icon:(0,T.jsx)(F.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close})]}),(0,T.jsx)(g.A,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:(0,T.jsx)(v.A,{}),style:{margin:3,width:24,height:24,border:"none"},className:t.close})]}),l[e.subView]&&l[e.subView].map((function(t,n){return(0,T.jsxs)("div",{children:["text"===t.type&&(0,T.jsx)(R.BR,{name:t.id,value:b[t.id],handleChange:function(e){return w(e,t)},style:{width:"100%",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"}}),"text-area"===t.type&&(0,T.jsx)(R.QA,{name:t.id,value:b[t.id],handleChange:function(e){return w(e,t)},style:{width:"350px",height:"400px",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"},rootStyle:{width:"100%",margin:"0px",padding:"5px"}}),"select"===t.type&&(0,T.jsx)(R.Q5,{name:t.label,id:t.id,value:b[t.id],options:e.labels.map((function(e){return{value:e,label:e}})),handleChange:function(e){return w(e,t)},style:{width:"100%",padding:"0px",marginRight:"5px",backgroundColor:"white",borderBottom:"none"},rootStyle:{width:"100%",margin:"0px",padding:"5px"}})]},n)}))]})},$=function(e){var t,n,s,u=(0,r.useState)(0),d=(0,a.A)(u,2),v=d[0],k=d[1],S=(0,r.useState)(0),B=(0,a.A)(S,2),C=B[0],M=B[1],V=(0,r.useState)(1),I=(0,a.A)(V,2),_=I[0],F=I[1],H=(0,r.useState)([]),L=(0,a.A)(H,2),N=L[0],q=L[1],G=(0,r.useState)([]),J=(0,a.A)(G,2),U=J[0],X=J[1],$=(0,r.useState)(null),ee=(0,a.A)($,2),te=ee[0],ne=ee[1],ie=(0,r.useRef)(null),ae=(0,r.useRef)(null),re=(0,r.useState)(!1),oe=(0,a.A)(re,2),le=oe[0],ce=oe[1],se=(0,O.M)("docViewType","carrousel"),ue=(0,a.A)(se,2),de=ue[0],ge=ue[1],he=(0,r.useState)("document"),pe=(0,a.A)(he,2),be=pe[0],fe=pe[1],xe=(0,E.A)(),me=(0,r.useState)("documentView"),we=(0,a.A)(me,2),ve=we[0],ke=we[1],ye=(0,o.d4)((function(e){return e.app.adjustements})),Ae=(0,o.wA)(),je=function(e){return(0,T.jsxs)(h.A,{style:{display:"flex",width:"calc(100% - 0px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",backgroundColor:"dark"===e.variant?xe.palette.grey[900]:"white",borderRadius:"50px"},children:[(0,T.jsx)(p.A,{color:"primary",onClick:function(){Ce(_-1)},children:(0,T.jsx)(m.A,{})}),(0,T.jsx)(R.Z6,{name:null,value:_,handleChange:function(e){Ce(parseInt(e.target.value))},min:1,max:v,style:{width:"100px",padding:"0px",backgroundColor:"dark"===e.variant?xe.palette.grey[700]:"white",marginRight:"10px",borderBottom:"none"}}),(0,T.jsx)(b.Ay,{ref:ae,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:_,step:1,marks:!0,min:1,max:v,style:{width:"80%"},onChangeCommitted:function(e,t){Ce(t)}}),(0,T.jsx)(p.A,{color:"primary",onClick:function(){Ce(_+1)},children:(0,T.jsx)(w.A,{})})]})},Se=function(t){"carrousel"===de?(0,x.vs)():"scroll"===de&&(k(v),M(C),(0,x.Ts)(v,ie.current,C,e.id,_),(0,x.Zv)(F),te&&((0,x.D8)(te),(0,x.P4)(N,_,C,ne)),(0,x.i0)()),ge(t)};(0,r.useEffect)((function(){return c.wp(e.id).then((function(t){k(t.pages),M(1),"carrousel"===de&&((0,x.Ts)(t.pages,ie.current,1,e.id),(0,x.Zv)(F),(0,x.i0)())})),Ae((0,l.n_)({contrast:1,brightness:1,saturation:1,invert:0,rotation:0})),function(){"carrousel"===de&&(0,x.vs)()}}),[]);var Be=function(t){"blocks"===be?c.FZ(e.id,t,e.view.slug,be).then((function(e){q(e.blocks),X(e.labels),ce(!0)})):"words"===be?c.FZ(e.id,t,e.view.slug,be).then((function(e){q(e.words),X(e.labels),ce(!0)})):(q([]),le&&"carrousel"===de&&(0,x.a7)(t))};(0,r.useEffect)((function(){ye&&(0,x.RI)(ye)}),[ye]),(0,r.useEffect)((function(){null===te?("carrousel"===de&&(0,x.D8)(null),le&&"carrousel"===de&&(0,x.a7)(_),Be(_)):(le&&"carrousel"===de&&(0,x.a7)(_),"carrousel"===de&&(0,x.D8)(te),"carrousel"===de&&(0,x.P4)(N,_,C,ne))}),[te]),(0,r.useEffect)((function(){Be(_),ne(null)}),[be,_]),(0,r.useEffect)((function(){(0,x.kx)(e.view.slug)}),[e.view]),(0,r.useEffect)((function(){N&&N.length>0&&"carrousel"===de&&(0,x.P4)(N,_,C,Re)}),[N]);var Ce=function(t){t>v&&(t=v),t<1&&(t=1),"carrousel"===de&&(0,x.qV)(t,C,e.id),F(t)},Re=function(e,t){var n=(0,i.A)({},e);n.index=t,ne(n),"carrousel"===de&&((0,x.a7)(_),(0,x.D8)(n),(0,x.P4)(N,_,C,ne))};return(0,r.useEffect)((function(){var t=(0,i.A)({},ye);t.rotation=0,Ae((0,l.n_)(t)),e.setOpts({page:_})}),[_]),(0,T.jsxs)(A.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(e,t){ke(e.id)},children:[(0,T.jsx)(h.A,{ref:ie,style:{position:"absolute",width:"100%",height:"100%",cursor:"move"}}),"scroll"===de&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(Z,{pages:v,aspectRatio:C,page:_,id:e.id,setPage:F,selectedBlock:te,setSelectedBlock:ne,setBlocks:q,blocks:N})}),(0,T.jsx)(y.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none",zIndex:"metadata"===ve?1:0},children:(0,T.jsx)(j.A,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})}),(0,T.jsxs)(y.V,{id:"processing",initialPosition:{x:0,y:0},style:{borderRadius:5,boxShadow:"none",zIndex:"processing"===ve?1:0},children:["viz"===e.view&&(0,T.jsxs)("div",{style:{padding:"5px",background:xe.palette.grey[700],borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,T.jsx)(je,{variant:"dark"}),(0,T.jsxs)(D.A,{children:[(0,T.jsx)(g.A,{label:"Agregar un recorte",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:U[0]?U[0]:"default",new:!0}),ce(!0)},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,T.jsx)(h.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,T.jsx)(Q.A,{})}),variant:"outlined"}),(0,T.jsx)(f.A,{disableGutters:!0,variant:"dense",style:{minHeight:"auto"},children:(0,T.jsx)(Y,{size:"small",checked:"carrousel"===de,onChange:function(e){return Se(e.target.checked?"carrousel":"scroll")},color:"primary"})})]})]}),"lt_extraction"===(null===(t=e.view)||void 0===t?void 0:t.view)&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(z,{setTabView:fe,view:e.view,setSelectedBlock:ne}),(0,T.jsxs)("div",{style:{padding:"5px",background:xe.palette.grey[700],borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,T.jsx)(je,{variant:"dark"}),(0,T.jsxs)(D.A,{children:[!e.subView.split(",").includes("blocks")&&!e.subView.split(",").includes("words")&&null===te&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(g.A,{label:"Agregar un recorte",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:U[0]?U[0]:"default",new:!0})},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,T.jsx)(h.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,T.jsx)(Q.A,{})}),variant:"outlined"})}),e.subView.split(",").includes("blocks")&&null===te&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(g.A,{label:"Agregar un nuevo bloque",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:U[0],new:!0})},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,T.jsx)(h.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,T.jsx)(P.A,{})}),variant:"outlined"})}),"words"===e.subView&&null===te&&(0,T.jsx)(T.Fragment,{children:(0,T.jsx)(g.A,{label:"Agregar una palabra",size:"small",onClick:function(){ne({index:N.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:U[0],new:!0})},style:{margin:3,border:"none",color:"white",backgroundColor:xe.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,T.jsx)(h.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,T.jsx)(P.A,{})}),variant:"outlined"})}),(0,T.jsx)(f.A,{disableGutters:!0,variant:"dense",style:{minHeight:"auto"},children:(0,T.jsx)(Y,{size:"small",checked:"carrousel"===de,onChange:function(e){return Se(e.target.checked?"carrousel":"scroll")},color:"primary"})})]})]})]}),"ner_extraction"===(null===(n=e.view)||void 0===n?void 0:n.view)&&(0,T.jsx)(z,{setTabView:fe,view:e.view,setSelectedBlock:ne,id:e.match.params.id}),"docseg_extraction"===(null===(s=e.view)||void 0===s?void 0:s.view)&&(0,T.jsx)(z,{setTabView:fe,view:e.view,setSelectedBlock:ne,id:e.match.params.id}),te&&(0,T.jsx)(K,{block:te,labels:U,subView:e.subView,setSelectedBlock:ne,slug:e.view.slug,recordId:e.id,page:_})]}),(0,T.jsx)(y.V,{id:"aiasistent_msgs",initialPosition:{x:0,y:0},style:{display:e.subView.split(",").includes("aiasistent_msgs")?"block":"none",zIndex:"aiasistent_msgs"===ve?1:0},children:e.subView.split(",").includes("aiasistent_msgs")&&(0,T.jsx)(W.A,{id:e.id,slug:e.slug,type:"document",opts:e.opts})})]})}},92392:function(e,t,n){var i=n(5544),a=n(65043),r=n(9920),o=n(96446),l=n(90151),c=n(4319),s=n(6512),u=n(76370),d=(n(24394),n(70579));t.A=function(e){var t=(0,a.useState)(0),n=(0,i.A)(t,2),g=(n[0],n[1]),h=(0,a.useState)(0),p=(0,i.A)(h,2),b=(p[0],p[1]),f=(0,a.useState)(1),x=(0,i.A)(f,2),m=(x[0],x[1]),w=(0,a.useRef)(null);(0,a.useRef)(null);(0,a.useEffect)((function(){return r.wp(e.id).then((function(t){g(t.pages),b(t.aspect_ratio),(0,l.Ts)(t.pages,w.current,t.aspect_ratio,e.id),(0,l.Zv)(m),(0,l.i0)()})),function(){(0,l.vs)()}}),[]);return(0,d.jsxs)(c.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")},children:[(0,d.jsx)(o.A,{ref:w,style:{position:"absolute",width:"100%",height:"100%"}}),(0,d.jsx)(s.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"},children:(0,d.jsx)(u.A,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})})]})}}}]);
//# sourceMappingURL=1287.62a767ed.chunk.js.map