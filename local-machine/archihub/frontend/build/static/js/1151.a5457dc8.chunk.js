"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[1151],{14533:function(e,t,n){var i=n(89379),l=n(5544),a=n(65043),s=n(83003),r=n(73216),o=n(85211),c=n(72378),u=n(91181),d=n(76445),f=n(29464),p=n(81551),h=n(70579),m=(0,p.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"}}}));t.A=function(e){m();var t=(0,a.useState)(null),n=(0,l.A)(t,2),p=n[0],v=n[1],g=(0,a.useState)(null),x=(0,l.A)(g,2),y=x[0],A=x[1],j=(0,a.useState)([]),w=(0,l.A)(j,2),b=(w[0],w[1]),S=(0,a.useState)(0),k=(0,l.A)(S,2),C=k[0],B=k[1],F=(0,a.useState)([]),T=(0,l.A)(F,2),_=T[0],E=T[1],N=(0,a.useState)(!1),M=(0,l.A)(N,2),R=M[0],D=M[1],q=(0,a.useState)(""),z=(0,l.A)(q,2),L=z[0],P=(z[1],(0,a.useState)("")),I=(0,l.A)(P,2),J=I[0],O=(I[1],(0,r.Zp)()),V=(0,s.wA)(),H=(0,s.d4)((function(e){return e.app.filters}));return(0,a.useEffect)((function(){e.selectedType.parentsTypes?e.selectedType.parentsTypes.length>0?v("multiple"):e.selectedType.hierarchical?v("tree"):v("single"):v(null)}),[e.selectedType]),(0,a.useEffect)((function(){e.setSelected&&y?e.setSelected(y.id):e.setSelected&&e.setSelected(null)}),[y]),(0,a.useEffect)((function(){var e=(0,i.A)({},H);V((0,o.vm)((0,o.e)(e,"cataloging","keyword",L)))}),[L]),(0,a.useEffect)((function(){A(null),b([]);var e=(0,i.A)({},H);e=(0,o.e)(e,"cataloging","parents",null),e=(0,o.e)(e,"cataloging","treeKeyword",J),V((0,o.vm)(e))}),[J]),(0,a.useEffect)((function(){var t=(0,i.A)({},H);t=(0,o.e)(t,"cataloging","status",e.viewDrafts?"draft":"published")}),[e.viewDrafts]),(0,h.jsx)("div",{style:(0,i.A)({display:"flex",height:"100%",width:"100%",flexDirection:"column"},e.style),children:p&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.EL,{style:{width:"calc(100% - 40px)",height:"55px",overflowX:"hidden",marginLeft:0,marginBottom:0},children:(0,h.jsx)(u.A,{total:C,showFilters:R,setShowFilters:D,activeFilters:_,setActiveFilters:e.forms?E:null,view:e.view})}),(0,h.jsxs)(c.EL,{id:"dropzone_scroll",onScroll:function(e){},style:{width:"calc(100% - 40px)",height:"calc(100% - 40px)",overflowX:"hidden",marginLeft:0,placeContent:"flex-start"},children:[!R&&(0,h.jsx)(d.A,{selectedType:e.selectedType,filters:H,type:e.type,editBtns:!0,parentTotal:B,handleClick:function(t){"checkbox"===e.type?e.setSelectedResources(t.id):O("/detail/".concat(t.id))},selectedResources:e.selectedResources,view:e.view}),R&&(0,h.jsx)(f.n,{forms:e.forms,activeFilters:_,setActiveFilters:E,view:e.view})]})]})})}},42588:function(e,t,n){n.d(t,{AD:function(){return S},M2:function(){return b},oF:function(){return k}});var i=n(60436),l=n(65043),a=n(15316),s=n(17392),r=n(43845),o=n(81551),c=n(66187),u=n(88120),d=n(39244),f=n(26240),p=n(11238),h=n(83003),m=n(85211),v=n(98344),g=n(5983),x=n(58140),y=n(70579),A=(0,o.A)((function(e){return{container:{display:"flex",flexDirection:"column",width:"calc(100% - 20px)",overflowY:"auto",marginLeft:"10px"},item:{borderBottom:"1px solid #dcdcdc",overflow:"hidden",color:"#777",fontSize:14,position:"relative",marginBottom:10,paddingBottom:10},itemName:{fontSize:15},chip:{margin:2,padding:2,"& .MuiChip-avatar":{backgroundColor:"transparent !important"}}}})),j=function(e){var t=A(),n=(0,f.A)(),i=(0,x.M)().showAlert;return(0,y.jsxs)(a.A,{className:t.item,style:e.style?e.style:{},children:[(0,y.jsxs)(a.A,{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,y.jsx)(c.A,{className:t.itemName,style:{color:n.palette.primary.main},children:e.title}),e.help&&(0,y.jsx)(s.A,{onClick:function(){i("video-info",e.help)},children:(0,y.jsx)(g.A,{})})]}),e.item?e.item:e.children]})},w=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;if(0===e)return"0 Bytes";var n=t<0?0:t,i=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,i)).toFixed(n))+" "+["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"][i]},b=function(e){var t,n,i=A();return(0,l.useEffect)((function(){0===e.record.parent.length?e.setMetadata(null):e.metadata&&e.setMetadata(e.record.parent[0])}),[e.record]),(0,y.jsxs)(a.A,{className:i.container,children:[(0,y.jsx)(j,{title:"Nombre del archivo",item:null!==e&&void 0!==e&&null!==(t=e.record)&&void 0!==t&&t.displayName?null===e||void 0===e||null===(n=e.record)||void 0===n?void 0:n.displayName:e.record.name}),(0,y.jsx)(j,{title:"HASH",item:e.record.hash}),(0,y.jsx)(j,{title:"Tama\xf1o",item:w(e.record.size)}),e.record.parent.length>0&&(0,y.jsx)(j,{title:"Contenido relacionado",children:e.record.parent.map((function(t,n){return(0,y.jsx)(r.A,{avatar:u.dR.filter((function(e){return e.value===t.icon}))?u.dR.filter((function(e){return e.value===t.icon}))[0].iconlight:(0,y.jsx)(d.A,{}),label:t.name,className:i.chip,onClick:function(){e.setMetadata(t)}},n)}))})]})},S=function(e){var t=A();(0,h.wA)(),(0,h.d4)((function(e){return e.app.filters}));return(0,y.jsx)(y.Fragment,{children:(0,y.jsxs)(a.A,{className:t.container,children:[(0,y.jsx)(j,{title:"Descripci\xf3n",item:(0,y.jsx)(c.A,{children:e.type.description})}),e.files.total>0&&(0,y.jsx)(j,{title:"Balance general de los documentos",item:(0,y.jsx)(v.RJ,{data:e.files.data,legend:!0})}),(0,y.jsx)(k,{view:e.view,parents:e.parents,root:e.root})]})})},k=function(e){var t,n=(0,h.wA)(),l=(0,h.d4)((function(e){return e.app.filters})),a=A();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(j,{title:"Estructura de carpetas para",item:(0,y.jsx)(y.Fragment,{children:(0,y.jsx)(p.$k,{label:"Tipo de recurso",showLabel:!1,value:l[e.view]?!e.single&&l[e.view].post_type?l[e.view].post_type.slug:e.single&&!Array.isArray(l[e.view].post_type_single)&&l[e.view].post_type_single?l[e.view].post_type_single.slug:"*":"*",onChange:function(t){if(e.onChange)e.onChange(t);else{var i=e.single?"post_type_single":"post_type";if("*"===t.target.value){var a=(0,m.e)(l,e.view,i,null);n((0,m.vm)(a))}else{var s=(0,m.e)(l,e.view,i,{slug:t.target.value});n((0,m.vm)(s))}}},options:function(){var t=(0,i.A)(e.parents.map((function(e){return{value:e.slug,label:e.name}})));return"cataloging"!==e.view&&(t=[{value:"*",label:"Todos los tipos"}].concat((0,i.A)(t))),t}()})}),help:"folder-structure"}),l[e.view]&&(null===(t=l[e.view].parents)||void 0===t?void 0:t.name)&&(0,y.jsx)("div",{style:{marginBottom:10},children:(0,y.jsx)(r.A,{avatar:u.dR.filter((function(t){return t.value===l[e.view].parents.icon}))?u.dR.filter((function(t){return t.value===l[e.view].parents.icon}))[0].iconlight:(0,y.jsx)(d.A,{}),label:l[e.view].parents.name,className:a.chip,onDelete:function(){var t=(0,m.e)(l,e.view,"parents",{id:e.root});n((0,m.vm)(t))},size:"small",color:"primary"})})]})}},61151:function(e,t,n){n.r(t);var i=n(60436),l=n(89379),a=n(5544),s=n(65043),r=n(73216),o=n(72378),c=n(83003),u=n(85211),d=n(19853),f=n(55263),p=n(85865),h=n(4598),m=n(11906),v=n(15316),g=n(31445),x=n(14533),y=n(30064),A=n.n(y),j=n(42588),w=n(69389),b=n(43288),S=n(26240),k=n(10765),C=n(63516),B=n(11238),F=n(58140),T=n(70579);t.default=function(e){var t=(0,s.useState)([]),n=(0,a.A)(t,2),y=n[0],_=n[1],E=(0,s.useState)(null),N=(0,a.A)(E,2),M=N[0],R=N[1],D=(0,s.useState)(null),q=(0,a.A)(D,2),z=q[0],L=q[1],P=(0,s.useState)(null),I=(0,a.A)(P,2),J=I[0],O=I[1],V=(0,s.useState)(null),H=(0,a.A)(V,2),Z=H[0],G=H[1],K=(0,s.useState)(null),X=(0,a.A)(K,2),Y=X[0],Q=X[1],U=(0,s.useState)([]),$=(0,a.A)(U,2),W=$[0],ee=$[1],te=(0,s.useState)([]),ne=(0,a.A)(te,2),ie=ne[0],le=(ne[1],(0,s.useState)(!1)),ae=(0,a.A)(le,2),se=ae[0],re=ae[1],oe=(0,s.useState)(!1),ce=(0,a.A)(oe,2),ue=ce[0],de=ce[1],fe=(0,r.g)().slug,pe=((0,r.Zp)(),(0,c.d4)((function(e){return e.app.filters}))),he=(0,c.wA)(),me=(0,S.A)(),ve=(0,F.M)().showAlert;(0,s.useEffect)((function(){ge()}),[e.match]);var ge=function(){};(0,s.useEffect)((function(){var e,t;null!==(e=pe.bulk)&&void 0!==e&&e.post_type?g.Pw(null===(t=pe.bulk)||void 0===t?void 0:t.post_type.slug).then((function(e){R(e),G({fields:[e.metadata.fields],forms:[{name:e.metadata.name,slug:e.metadata.slug}]})})):d.gD().then((function(e){g.Pw(e.value).then((function(e){R(e),G({fields:[e.metadata.fields],forms:[{name:e.metadata.name,slug:e.metadata.slug}]});var t=(0,l.A)({},pe);he((0,u.vm)((0,u.e)(t,"bulk","post_type",{slug:e.slug})))}))}))}),[fe]),(0,s.useEffect)((function(){g.DI().then((function(e){_(e)})),ge()}),[]);return(0,s.useEffect)((function(){console.log(W)}),[W]),(0,s.useEffect)((function(){fe&&d.DJ(fe,"bulk").then((function(e){L(e);var t={};e.map((function(e){"instructions"!==e.type&&"file"!==e.type&&((t=(0,l.A)({},t))[e.id]=e.default)})),t.files=[],O(t)}))}),[]),(0,T.jsxs)(o.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:[M&&W&&y&&Z&&(0,T.jsxs)(T.Fragment,{children:[(0,T.jsx)(o.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"40%",display:"block",overflow:"auto",placeContent:"flex-start"},children:(0,T.jsxs)("div",{style:{padding:10},children:[(0,T.jsxs)(f.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:20},children:[(0,T.jsx)(p.A,{style:{color:me.palette.primary.main,fontSize:15},children:"Ver borradores"}),(0,T.jsx)(h.A,{checked:ue,onChange:function(){de(!ue);var e=(0,l.A)({},pe);he((0,u.vm)((0,u.e)(e,"bulk","status",ue?"published":"draft")))}})]}),(0,T.jsx)(j.oF,{parents:y,view:"bulk",onChange:function(e){R(null),g.Pw(e.target.value).then((function(t){R(t),G({fields:[t.metadata.fields],forms:[{name:t.metadata.name,slug:t.metadata.slug}]});var n=(0,l.A)({},pe);he((0,u.vm)((0,u.e)(n,"bulk","post_type",{slug:e.target.value})))}))}}),(0,T.jsx)(w.A,{root:null,activeTypes:[{slug:M.slug}],postType:M.slug,view:"list",checkboxTypes:y.map((function(e){return e.slug})),multiple:!1,selected:[ie],childrenSelect:!1,setSelected:function(e){if(0===e.length){var t=(0,u.e)(pe,"bulk","parents",null);he((0,u.vm)(t))}else{var n=(0,u.e)(pe,"bulk","parents",e[0]);he((0,u.vm)(n))}}},M?[M.slug]:y),z&&J&&(0,T.jsx)("div",{style:{marginTop:20},children:(0,T.jsx)(C.l1,{initialValues:J,onSubmit:function(e,t){var n=t.setSubmitting;e.post_type=M.slug,e.parent=Y,e.resources=W,n(!0),re(!0),d.eP(fe,JSON.stringify(e)).then((function(e){n(!1),re(!1),ve("success",e.msg).then((function(){}))})).catch((function(e){n(!1),re(!1),e.json().then((function(e){ve("error",e.msg)}))}))},children:function(e){var t=e.values,n=e.errors,i=(e.touched,e.handleChange),l=e.handleBlur,a=e.handleSubmit,s=e.isSubmitting,r=e.setFieldValue;return(0,T.jsxs)("form",{onSubmit:a,children:[z.map((function(e,a){return(0,T.jsxs)(T.Fragment,{children:["file"===e.type&&(0,T.jsx)(k.U0,{name:e.label,id:e.name,values:t,required:e.required,change:r,limit:e.limit,acceptedFiles:e.acceptedFiles},a),"instructions"===e.type&&(0,T.jsx)(p.A,{variant:"body1",sx:{padding:"10px",backgroundColor:"#f5f5f5",marginBottom:"10px",borderRadius:"5px",background:me.palette.primary.light,color:me.palette.primary.main},children:e.text},a),"checkbox"===e.type&&(0,T.jsx)(k.FO,{id:e.id,name:e.label,instructions:e.instructions,value:t[e.id],handleChange:function(t){r(e.id,t)},handleBlur:l,error:n[e.id],required:e.required},a),"select"===e.type&&(0,T.jsx)(k.Q5,{id:e.id,name:e.label,value:t[e.id],handleChange:i,handleBlur:l,error:n[e.id],options:e.options,required:e.required},a),"text"===e.type&&(0,T.jsx)(k.BR,{id:e.id,name:e.label,value:t[e.id],handleChange:i,handleBlur:l,error:n[e.id],required:e.required},a),"button"===e.type&&(0,T.jsx)(m.A,{variant:"contained",onClick:function(){!function(e,t){d.Gj(e,JSON.stringify({parent:Y,post_type:M.slug}),t).then((function(e){A().fire({title:"\xc9xito",text:"Se ha ejecutado la acci\xf3n correctamente",icon:"success",confirmButtonText:"Ok"})}))}(fe,e.callback)},sx:{margin:"10px"},children:e.label}),"condition"===e.type&&(0,T.jsx)(k.e7,{id:e.id,label:e.label,value:t[e.id],condition:e.condition,options:e.options,conditionValue:t[e.id_condition],change:r},"".concat(a,"-").concat(t[e.id_condition]))]})})),(0,T.jsx)(v.A,{style:{display:"flex",justifyContent:"center",marginTop:25},children:(0,T.jsx)(B.nA,{variant:"outlined",type:"submit",disabled:s,style:{margin:5,width:"auto"},label:"Procesar"})})]})}})})]})}),(0,T.jsx)(x.A,{style:{width:"60%"},forms:Z,view:"bulk",type:"checkbox",selectedType:M,setSelected:Q,setSelectedResources:function(e){W.includes(e)?ee(W.filter((function(t){return t!==e}))):ee([].concat((0,i.A)(W),[e]))},selectedResources:W})]}),se&&(0,T.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",position:"fixed",top:0,left:0,background:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(5px) saturate(0%)",zIndex:9999},children:(0,T.jsx)(b.A,{})})]})}}}]);
//# sourceMappingURL=1151.a5457dc8.chunk.js.map