"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[5661,4299],{8255:function(e,t,n){n.r(t);var a=n(64467),r=n(89379),i=n(5544),o=n(65043),l=n(78717),s=n(9920),c=n(5670),d=n(48210),u=n(19853),f=n(42588),h=n(26240),p=n(43845),g=n(96446),m=n(17392),x=n(99070),v=n(55263),A=n(85865),y=n(92530),j=n(93012),b=n(36795),k=n(31269),w=n(6512),C=n(4319),S=n(76370),z=n(90151),L=n(24394),_=n(68641),M=n(42497),E=n(79175),V=n(74802),R=n(94329),N=n(5374),H=n(94495),I=n(95501),B=n(83003),D=n(88455),P=n(73216),T=n(81551),$=n(72378),F=n(33745),W=n(48084),G=n(85211),O=n(58140),U=n(18751),Z=n(11238),q=n(61413),J=n(88120),Q=n(53536),K=n.n(Q),X=n(93440),Y=n(70579),ee=(0,T.A)((function(e){return{close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"},"& path":{fill:"white"}}}})),te=function(e){var t=ee(),n=(0,h.A)(),a=(0,O.M)().showAlert;return(0,Y.jsx)("div",{style:{background:n.palette.grey[700],borderRadius:5,marginTop:5},children:(0,Y.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[(0,Y.jsx)("div",{children:(0,Y.jsx)(p.A,{label:"Guardar",size:"small",onClick:function(){d.vt({type:"image",record_id:e.record,data:{bbox:e.block.bbox}}).then((function(t){e.setSelectedBlock(null),a("success","Recorte creado correctamente")}))},icon:(0,Y.jsx)(R.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close})}),(0,Y.jsx)(p.A,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:(0,Y.jsx)(V.A,{}),style:{margin:3,width:24,height:24,border:"none"},className:t.close})]})})},ne=(0,T.A)((function(e){return{toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}}}})),ae=function(e){var t=(0,o.useState)(null),n=(0,i.A)(t,2),a=n[0],r=n[1];return(0,o.useEffect)((function(){s.vv(e.record,e.slug).then((function(e){r(e)})).catch((function(e){r(null)}))}),[]),(0,Y.jsx)(w.V,{id:"extra",initialPosition:{x:0,y:0},style:{display:a?"block":"none"},children:a&&(0,Y.jsx)("div",{style:{padding:"10px",background:"white",maxWidth:350},children:a.caption.value})})};t.default=function(e){var t=(0,o.useState)(!1),n=(0,i.A)(t,2),d=n[0],V=n[1],R=(0,o.useState)(null),T=(0,i.A)(R,2),Q=T[0],ee=T[1],re=(0,o.useState)(null),ie=(0,i.A)(re,2),oe=ie[0],le=ie[1],se=(0,o.useState)(!1),ce=(0,i.A)(se,2),de=ce[0],ue=ce[1],fe=(0,o.useState)([]),he=(0,i.A)(fe,2),pe=he[0],ge=he[1],me=(0,o.useState)("carrousel"),xe=(0,i.A)(me,2),ve=xe[0],Ae=(xe[1],(0,o.useState)("metadata")),ye=(0,i.A)(Ae,2),je=ye[0],be=ye[1],ke=(0,o.useState)([]),we=(0,i.A)(ke,2),Ce=(we[0],we[1]),Se=(0,o.useState)(null),ze=(0,i.A)(Se,2),Le=ze[0],_e=ze[1],Me=(0,o.useRef)(null),Ee=(0,o.useRef)(null),Ve=(0,o.useState)(0),Re=(0,i.A)(Ve,2),Ne=Re[0],He=Re[1],Ie=(0,o.useState)(1),Be=(0,i.A)(Ie,2),De=Be[0],Pe=Be[1],Te=(0,o.useState)(null),$e=(0,i.A)(Te,2),Fe=$e[0],We=$e[1],Ge=(0,B.d4)((function(e){return e.user})),Oe=(0,B.d4)((function(e){return e.app.adjustements})),Ue=(0,P.g)().id,Ze=(0,h.A)(),qe=(0,B.d4)((function(e){return e.app.isDarkMode})),Je=ne(),Qe=(0,B.wA)(),Ke=(0,O.M)().showAlert,Xe=(0,J.Fu)(),Ye=(0,o.useState)(""),et=(0,i.A)(Ye,2),tt=et[0],nt=et[1],at=(0,o.useState)({}),rt=(0,i.A)(at,2),it=rt[0],ot=rt[1],lt=function(e){return(0,Y.jsxs)(g.A,{style:{display:"flex",width:"calc(100% - 20px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",backgroundColor:"dark"===e.variant?Ze.palette.grey[900]:"white",borderRadius:"50px"},children:[(0,Y.jsx)(m.A,{color:"primary",onClick:function(){st(De-1)},children:(0,Y.jsx)(_.A,{})}),(0,Y.jsx)(L.Z6,{name:null,value:De,handleChange:function(e){st(parseInt(e.target.value),!1)},min:1,max:Ne,style:{width:"100px",padding:"0px",backgroundColor:"dark"===e.variant?Ze.palette.grey[700]:"white",marginRight:"10px",borderBottom:"none"}}),(0,Y.jsx)(x.Ay,{ref:Ee,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:De,step:1,marks:!0,min:1,max:Ne,style:{width:"80%"},onChangeCommitted:function(e,t){st(t,!1)}}),(0,Y.jsx)(m.A,{color:"primary",onClick:function(){st(De+1)},children:(0,Y.jsx)(M.A,{})})]})};(0,o.useEffect)((function(){return l.$R(Ue).then((function(e){He(e.pages)})).catch((function(e){e.json().then((function(e){Ke("error",e.msg)}))})),Qe((0,G.n_)({contrast:1,brightness:1,saturation:1,invert:0,rotation:0})),function(){(0,z.vs)()}}),[]),(0,o.useEffect)((function(){Ne>0&&((0,z.Ts)(Ne,Me.current,1,Ue,1,!1),(0,z.Zv)(Pe),(0,z.i0)(),u.ko("detail_record").then((function(e){e.actions.length>0&&Ce(e.actions.filter((function(e){return e.record_type.includes("image")})))})).catch((function(e){console.error(e)})))}),[Ne]),(0,o.useEffect)((function(){Fe&&"img_analyze"===Fe.view&&s.FZ(Ue,De-1,Fe.slug,"blocks").then((function(e){(0,z.P4)(e,De,1,(function(){}))})).catch((function(e){console.log(e)}));var e=(0,r.A)({},Oe);e.rotation=0,Qe((0,G.n_)(e))}),[Fe,De]),(0,o.useEffect)((function(){ot({page:De-1}),s.de({id:Ue,index:De-1}).then((function(e){ee(e)})).catch((function(e){console.log(e)}))}),[De]),(0,o.useEffect)((function(){Oe&&(0,z.RI)(Oe)}),[Oe]);var st=function(e){var t=parseInt(e);t>Ne&&(t=Ne),t<1&&(t=1),e>=1&&e<=Ne&&(0,z.qV)(t,1,Ue,!1),Pe(t)};(0,o.useEffect)((function(){Ge.favorites&&Q&&(Ge.favorites.find((function(e){return e.id===Q._id.$oid}))?V(!0):V(!1))}),[Ge.favorites,Q]),(0,o.useEffect)((function(){null===oe?("carrousel"===ve&&(0,z.D8)(null),de&&"carrousel"===ve&&(0,z.a7)(De),ct(De)):(de&&"carrousel"===ve&&(0,z.a7)(De),"carrousel"===ve&&(0,z.D8)(oe),"carrousel"===ve&&(0,z.P4)(pe,De,1,le))}),[oe]);var ct=function(e){ge([]),de&&"carrousel"===ve&&(0,z.a7)(e)};return(0,Y.jsx)($.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:Ne>0&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)($.EL,{style:(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({width:"calc(100% - 40px)",marginBottom:0,height:"calc(100% - 20px)",padding:0},"width","400px"),"maxWidth","400px"),"border","none"),"display","block"),"placeContent","flex-start"),"overflow","auto"),"minWidth","300px"),"flexGrow",.5),"margin",10),children:Q&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsxs)(v.A,{style:{background:Ze.palette.primary.light},className:Je.toolbar,children:[Ge.access_token&&"null"!==Ge.access_token&&(0,Y.jsx)(m.A,{sx:{marginLeft:"12px",color:Ze.palette.primary.main},size:"large",onClick:function(){var e={type:"records",id:Q._id.$oid};d?c.C5(e).then((function(e){Qe((0,D.me)(Ge.access_token)),Ke("success","Eliminado de favoritos")})).catch((function(e){Ke("error","No se pudo eliminar de favoritos")})):c.Gm(e).then((function(e){Qe((0,D.me)(Ge.access_token)),Ke("success","Agregado a favoritos")})).catch((function(e){Ke("error","No se pudo agregar a favoritos")}))},children:d?(0,Y.jsx)(j.A,{}):(0,Y.jsx)(y.A,{})}),(0,Y.jsx)(A.A,{variant:"h6",style:{flexGrow:1,marginLeft:0,color:Ze.palette.primary.main},children:Q.displayName?Q.displayName:Q.name})]}),(0,Y.jsxs)(g.A,{children:[Xe.includes("files_download")&&(0,Y.jsx)(Z.nA,{startIcon:(0,Y.jsx)(U.A,{}),style:{borderRadius:5,backgroundColor:qe?Ze.palette.grey[800]:Ze.palette.grey[200],color:Ze.palette.grey[500],margin:10,width:"calc(100% - 20px)"},label:"Descargar archivo",onClick:function(){Ke("askUserDownloadType","Escoge el tipo de descarga").then((function(e){"original"===e?(Ke("loading","Descargando archivo..."),s.U3({id:Q._id.$oid,type:"original"},(function(e){Ke("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){Ke("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),Ke("error","Error al descargar el archivo")}))):"small"===e&&(Ke("loading","Descargando archivo..."),s.U3({id:Q._id.$oid,type:"small"},(function(e){Ke("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){Ke("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),Ke("error","Error al descargar el archivo")})))}))}}),(0,Y.jsx)(f.M2,{record:Q,setMetadata:_e,metadata:Le}),K().intersection(Ge.roles,["editor","admin"]).length>0&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(F.Separator,{title:"Acciones"}),(0,Y.jsx)("div",{style:{display:"flex",flexWrap:"wrap",padding:10},children:K().intersection(Ge.roles,["editor","admin","llm"]).length>0&&Xe.includes("llm")&&(0,Y.jsx)(X.A,{children:"ChatBubble,SmartToy",title:"Preg\xfantale a la IA",onClick:function(){var e=function(e,t){e||(e="");var n=e.split(",").map((function(e){return e.trim()})).filter(Boolean);return n.includes(t)?n=n.filter((function(e){return e!==t})):n.push(t),n.join(",")}(tt,"aiasistent_msgs");nt(e)},selected:tt.split(",").includes("aiasistent_msgs")})})]}),Object.keys(Q.processing).length>1&&(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(F.Separator,{icon:(0,Y.jsx)(N.A,{}),title:"Procesamientos"}),Object.keys(Q.processing).map((function(e,t){var n=Q.processing[e].type,a=H.vJ.find((function(e){return e.value===n})),r=n;if("audio"!==n&&"video"!==n&&a)return(0,Y.jsx)(F.ItemMenu,{icon:(0,Y.jsx)(I.A,{}),name:a.label,onClick:function(){(null===Fe||void 0===Fe?void 0:Fe.view)===r?We(null):We({view:r,slug:e}),nt(null)},className:(null===Fe||void 0===Fe?void 0:Fe.view)===r?"selected":""},t)}))]})]})]})}),(0,Y.jsx)($.EL,{style:{width:"calc(100% - 400px)",height:"calc(100% - 25px)",position:"relative",margin:10,marginLeft:0,backgroundColor:Ze.palette.grey[900],padding:0},children:(0,Y.jsx)(b.Q,{backend:k.t2,children:(0,Y.jsxs)(C.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(e,t){be(e.id)},children:[(0,Y.jsx)(g.A,{ref:Me,style:{position:"absolute",width:"100%",height:"calc(100%)",overflow:"hidden",cursor:"move"}}),(0,Y.jsx)(w.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:Le?"block":"none",zIndex:"metadata"===je?1:0},children:(0,Y.jsx)(S.A,{resource:Le,setMetadata:_e,history:e.history})}),(0,Y.jsxs)(w.V,{id:"processing",initialPosition:{x:0,y:0},style:{padding:0,borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)",zIndex:"processing"===je?1:0},children:[(0,Y.jsxs)("div",{style:{padding:5,background:Ze.palette.grey[700],borderRadius:5},children:[(0,Y.jsx)(lt,{variant:"dark"}),(0,Y.jsx)(W.A,{children:Ge.roles.includes("user")&&(0,Y.jsx)(p.A,{label:"Agregar un recorte",size:"small",onClick:function(){le({index:pe.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:"default",new:!0}),ue(!0)},style:{border:"none",color:"white",backgroundColor:Ze.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,Y.jsx)(g.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,Y.jsx)(E.A,{})}),variant:"outlined"})})]}),oe&&(0,Y.jsx)(te,{block:oe,labels:["default"],setSelectedBlock:le,record:Q._id.$oid})]}),(0,Y.jsx)(w.V,{id:"aiasistent_msgs",initialPosition:{x:0,y:0},style:{display:tt.split(",").includes("aiasistent_msgs")?"block":"none",zIndex:"aiasistent_msgs"===je?1:0},children:tt.split(",").includes("aiasistent_msgs")&&(0,Y.jsx)(q.A,{id:Ue,type:"image_gallery",opts:it})}),"img_analyze"===(null===Fe||void 0===Fe?void 0:Fe.view)&&(0,Y.jsx)(ae,{record:Q._id.$oid,slug:Fe.slug},Q._id.$oid)]})})})]})})}},396:function(e,t,n){n.d(t,{A:function(){return g}});var a=n(58168),r=n(60436),i=n(80045),o=n(65043),l=(n(2086),n(43024)),s=n(47573),c=n(66187),d=n(82454),u=(0,n(24794).A)(o.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz"),f=n(75992);var h=(0,s.A)((function(e){return{root:{display:"flex",marginLeft:e.spacing(.5),marginRight:e.spacing(.5),backgroundColor:e.palette.grey[100],color:e.palette.grey[700],borderRadius:2,cursor:"pointer","&:hover, &:focus":{backgroundColor:e.palette.grey[200]},"&:active":{boxShadow:e.shadows[0],backgroundColor:(0,d.tL)(e.palette.grey[200],.12)}},icon:{width:24,height:16}}}),{name:"PrivateBreadcrumbCollapsed"})((function(e){var t=e.classes,n=(0,i.A)(e,["classes"]);return o.createElement(f.A,(0,a.A)({component:"li",className:t.root,focusRipple:!0},n),o.createElement(u,{className:t.icon}))}));var p=o.forwardRef((function(e,t){var n=e.children,s=e.classes,d=e.className,u=e.component,f=void 0===u?"nav":u,p=e.expandText,g=void 0===p?"Show path":p,m=e.itemsAfterCollapse,x=void 0===m?1:m,v=e.itemsBeforeCollapse,A=void 0===v?1:v,y=e.maxItems,j=void 0===y?8:y,b=e.separator,k=void 0===b?"/":b,w=(0,i.A)(e,["children","classes","className","component","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"]),C=o.useState(!1),S=C[0],z=C[1],L=o.Children.toArray(n).filter((function(e){return o.isValidElement(e)})).map((function(e,t){return o.createElement("li",{className:s.li,key:"child-".concat(t)},e)}));return o.createElement(c.A,(0,a.A)({ref:t,component:f,color:"textSecondary",className:(0,l.default)(s.root,d)},w),o.createElement("ol",{className:s.ol},function(e,t,n){return e.reduce((function(a,r,i){return i<e.length-1?a=a.concat(r,o.createElement("li",{"aria-hidden":!0,key:"separator-".concat(i),className:t},n)):a.push(r),a}),[])}(S||j&&L.length<=j?L:function(e){return A+x>=e.length?e:[].concat((0,r.A)(e.slice(0,A)),[o.createElement(h,{"aria-label":g,key:"ellipsis",onClick:function(e){z(!0);var t=e.currentTarget.parentNode.querySelector("a[href],button,[tabindex]");t&&t.focus()}})],(0,r.A)(e.slice(e.length-x,e.length)))}(L),s.separator,k)))})),g=(0,s.A)({root:{},ol:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"},li:{},separator:{display:"flex",userSelect:"none",marginLeft:8,marginRight:8}},{name:"MuiBreadcrumbs"})(p)},34305:function(e,t,n){var a=n(24994),r=n(6305);t.A=void 0;var i=r(n(65043)),o=(0,a(n(59846)).default)(i.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");t.A=o},6502:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward")},93012:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2"}),"Bookmark")},92530:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"}),"BookmarkBorder")},5374:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PrecisionManufacturing")},94329:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},76300:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School")},66360:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},95501:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),i=n(70579);t.A=(0,r.default)((0,i.jsx)("path",{d:"M14.67 5v6.5H9.33V5zm1 6.5H21V5h-5.33zm-1 7.5v-6.5H9.33V19zm1-6.5V19H21v-6.5zm-7.34 0H3V19h5.33zm0-1V5H3v6.5z"}),"ViewModule")}}]);
//# sourceMappingURL=5661.2e311a5f.chunk.js.map