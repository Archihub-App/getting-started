"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[159],{20159:function(e,t,n){n.r(t),n.d(t,{default:function(){return ne}});var i=n(64467),a=n(5544),o=n(65043),r=n(78717),s=n(9920),l=n(5670),c=n(48210),d=n(42588),u=n(26240),h=n(43845),f=n(15316),g=n(17392),p=n(99070),x=n(55263),m=n(85865),v=n(92530),y=n(93012),A=n(36795),j=n(31269),b=n(6512),w=n(4319),k=n(76370),C=n(90151),L=n(10765),S=n(68641),z=n(42497),R=n(79175),M=n(74802),D=n(94329),_=n(5374),E=n(94495),H=n(95501),V=n(83003),B=n(88455),I=n(73216),N=n(81551),$=n(72378),P=n(50264),T=n(85211),F=n(30279),O=n(30492),G=n(54536),W=n(64621),U=n(64846),Z=n(70579),q=function(e){var t=(0,V.wA)(),n=(0,V.d4)((function(e){return e.app.adjustements})),i=(0,o.useState)(!1),r=(0,a.A)(i,2),s=r[0],l=r[1],c=(0,o.useState)(n.contrast),d=(0,a.A)(c,2),h=d[0],f=d[1],m=(0,o.useState)(n.brightness),v=(0,a.A)(m,2),y=v[0],A=v[1],j=(0,u.A)();return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(x.A,{style:{minHeight:"auto",padding:0,justifyContent:"space-between",alignContent:"center"},children:[e.children?e.children:(0,Z.jsx)("div",{}),(0,Z.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:10},children:[(0,Z.jsx)(O.A,{style:{color:"white",opacity:s?1:.5,fontSize:20,transition:"opacity 0.3s"}}),(0,Z.jsx)(g.A,{onClick:function(){return l(!s)},children:(0,Z.jsx)(G.A,{style:{color:"white",opacity:.5,fontSize:20,transform:s?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s"}})})]})]}),(0,Z.jsxs)(F.A,{in:s,children:[(0,Z.jsxs)(x.A,{style:{minHeight:"auto",padding:0,justifyContent:"center",alignContent:"center",backgroundColor:j.palette.grey[900],borderTopLeftRadius:10,borderTopRightRadius:10,color:"white"},children:[(0,Z.jsx)(p.Ay,{size:"small",min:0,max:3,step:.1,value:h,onChange:function(e,n){f(n),t((0,T.n_)({contrast:n,brightness:y}))},style:{width:"calc(100% - 20px)",margin:"10px"},valueLabelDisplay:"auto"}),(0,Z.jsx)(U.A,{style:{color:"white",opacity:.5,fontSize:20,marginRight:10}})]}),(0,Z.jsxs)(x.A,{style:{minHeight:"auto",padding:0,justifyContent:"center",alignContent:"center",backgroundColor:j.palette.grey[900],borderBottomLeftRadius:10,borderBottomRightRadius:10,color:"white"},children:[(0,Z.jsx)(p.Ay,{size:"small",min:0,max:2,step:.1,value:y,onChange:function(e,n){A(n),t((0,T.n_)({contrast:h,brightness:n}))},style:{width:"calc(100% - 20px)",margin:"10px"},valueLabelDisplay:"auto"}),(0,Z.jsx)(W.A,{style:{color:"white",opacity:.5,fontSize:20,marginRight:10}})]})]})]})},J=n(58140),K=n(18751),Q=n(11238),X=(0,N.A)((function(e){return{close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"},"& path":{fill:"white"}}}})),Y=function(e){var t=X(),n=(0,u.A)(),i=(0,J.M)().showAlert;return(0,Z.jsx)("div",{style:{background:n.palette.grey[700],borderRadius:5,marginTop:5},children:(0,Z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(h.A,{label:"Guardar",size:"small",onClick:function(){c.vt({type:"image",record_id:e.record,data:{bbox:e.block.bbox}}).then((function(t){e.setSelectedBlock(null),i("success","Recorte creado correctamente")}))},icon:(0,Z.jsx)(D.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close})}),(0,Z.jsx)(h.A,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:(0,Z.jsx)(M.A,{}),style:{margin:3,width:24,height:24,border:"none"},className:t.close})]})})},ee=(0,N.A)((function(e){return{toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}}}})),te=function(e){var t=(0,o.useState)(null),n=(0,a.A)(t,2),i=n[0],r=n[1];return(0,o.useEffect)((function(){s.vv(e.record,e.slug).then((function(e){r(e)})).catch((function(e){r(null)}))}),[]),(0,Z.jsx)(b.V,{id:"extra",initialPosition:{x:0,y:0},style:{display:i?"block":"none"},children:i&&(0,Z.jsx)("div",{style:{padding:"10px",background:"white",maxWidth:350},children:i.caption.value})})},ne=function(e){var t=(0,o.useState)(!1),n=(0,a.A)(t,2),c=n[0],M=n[1],D=(0,o.useState)(null),N=(0,a.A)(D,2),F=N[0],O=N[1],G=(0,o.useState)(null),W=(0,a.A)(G,2),U=W[0],X=W[1],ne=(0,o.useState)(!1),ie=(0,a.A)(ne,2),ae=ie[0],oe=ie[1],re=(0,o.useState)([]),se=(0,a.A)(re,2),le=se[0],ce=se[1],de=(0,o.useState)("carrousel"),ue=(0,a.A)(de,2),he=ue[0],fe=(ue[1],(0,o.useState)(null)),ge=(0,a.A)(fe,2),pe=ge[0],xe=ge[1],me=(0,o.useRef)(null),ve=(0,o.useRef)(null),ye=(0,o.useState)(0),Ae=(0,a.A)(ye,2),je=Ae[0],be=Ae[1],we=(0,o.useState)(1),ke=(0,a.A)(we,2),Ce=ke[0],Le=ke[1],Se=(0,o.useState)(null),ze=(0,a.A)(Se,2),Re=ze[0],Me=ze[1],De=(0,V.d4)((function(e){return e.user})),_e=(0,V.d4)((function(e){return e.app.adjustements})),Ee=(0,I.g)().id,He=(0,u.A)(),Ve=(0,V.d4)((function(e){return e.app.isDarkMode})),Be=ee(),Ie=(0,V.wA)(),Ne=(0,J.M)().showAlert,$e=function(e){return(0,Z.jsxs)(f.A,{style:{display:"flex",width:"calc(100% - 20px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",backgroundColor:"dark"===e.variant?He.palette.grey[900]:"white",borderRadius:"50px"},children:[(0,Z.jsx)(g.A,{color:"primary",onClick:function(){Pe(Ce-1)},children:(0,Z.jsx)(S.A,{})}),(0,Z.jsx)(L.Z6,{name:null,value:Ce,handleChange:function(e){Pe(parseInt(e.target.value),!1)},min:1,max:je,style:{width:"100px",padding:"0px",backgroundColor:"dark"===e.variant?He.palette.grey[700]:"white",marginRight:"10px",borderBottom:"none"}}),(0,Z.jsx)(p.Ay,{ref:ve,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:Ce,step:1,marks:!0,min:1,max:je,style:{width:"80%"},onChangeCommitted:function(e,t){Pe(t,!1)}}),(0,Z.jsx)(g.A,{color:"primary",onClick:function(){Pe(Ce+1)},children:(0,Z.jsx)(z.A,{})})]})};(0,o.useEffect)((function(){return r.$R(Ee).then((function(e){be(e.pages)})).catch((function(e){e.json().then((function(e){Ne("error",e.msg)}))})),Ie((0,T.n_)({contrast:1,brightness:1})),function(){(0,C.vs)()}}),[]),(0,o.useEffect)((function(){je>0&&((0,C.Ts)(je,me.current,1,Ee,1,!1),(0,C.Zv)(Le),(0,C.i0)())}),[je]),(0,o.useEffect)((function(){Re&&"img_analyze"===Re.view&&s.FZ(Ee,Ce-1,Re.slug,"blocks").then((function(e){(0,C.P4)(e,Ce,1,(function(){}))})).catch((function(e){console.log(e)})),_e&&(_e.brightness&&(0,C.Ot)(_e.brightness),_e.contrast&&(0,C.zB)(_e.contrast))}),[Re,Ce]),(0,o.useEffect)((function(){s.de({id:Ee,index:Ce-1}).then((function(e){O(e)})).catch((function(e){console.log(e)}))}),[Ce]),(0,o.useEffect)((function(){_e&&(_e.brightness&&(0,C.Ot)(_e.brightness),_e.contrast&&(0,C.zB)(_e.contrast))}),[_e]);var Pe=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e>je&&(e=je),e<1&&(e=1),(0,C.qV)(e,1,Ee,t),Le(e)};(0,o.useEffect)((function(){De.favorites&&F&&(De.favorites.find((function(e){return e.id===F._id.$oid}))?M(!0):M(!1))}),[De.favorites,F]),(0,o.useEffect)((function(){null===U?("carrousel"===he&&(0,C.D8)(null),ae&&"carrousel"===he&&(0,C.a7)(Ce),Te(Ce)):(ae&&"carrousel"===he&&(0,C.a7)(Ce),"carrousel"===he&&(0,C.D8)(U),"carrousel"===he&&(0,C.P4)(le,Ce,1,X))}),[U]);var Te=function(e){ce([]),ae&&"carrousel"===he&&(0,C.a7)(e)};return(0,Z.jsx)($.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:je>0&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)($.EL,{style:(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({width:"calc(100% - 40px)",marginBottom:0,height:"calc(100% - 20px)",padding:0},"width","400px"),"maxWidth","400px"),"border","none"),"display","block"),"placeContent","flex-start"),"overflow","auto"),"minWidth","300px"),"flexGrow",.5),"margin",10),children:F&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(x.A,{style:{background:He.palette.primary.light},className:Be.toolbar,children:[De.access_token&&"null"!==De.access_token&&(0,Z.jsx)(g.A,{sx:{marginLeft:"12px",color:He.palette.primary.main},size:"large",onClick:function(){var e={type:"records",id:F._id.$oid};c?l.C5(e).then((function(e){Ie((0,B.me)(De.access_token)),Ne("success","Eliminado de favoritos")})).catch((function(e){Ne("error","No se pudo eliminar de favoritos")})):l.Gm(e).then((function(e){Ie((0,B.me)(De.access_token)),Ne("success","Agregado a favoritos")})).catch((function(e){Ne("error","No se pudo agregar a favoritos")}))},children:c?(0,Z.jsx)(y.A,{}):(0,Z.jsx)(v.A,{})}),(0,Z.jsx)(m.A,{variant:"h6",style:{flexGrow:1,marginLeft:0,color:He.palette.primary.main},children:F.displayName?F.displayName:F.name})]}),(0,Z.jsxs)(f.A,{children:[(0,Z.jsx)(Q.nA,{startIcon:(0,Z.jsx)(K.A,{}),style:{borderRadius:5,backgroundColor:Ve?He.palette.grey[800]:He.palette.grey[200],color:He.palette.grey[500],margin:10,width:"calc(100% - 20px)"},label:"Descargar archivo",onClick:function(){Ne("askUserDownloadType","Escoge el tipo de descarga").then((function(e){"original"===e?(Ne("loading","Descargando archivo..."),s.U3({id:F._id.$oid,type:"original"},(function(e){Ne("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){Ne("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),Ne("error","Error al descargar el archivo")}))):"small"===e&&(Ne("loading","Descargando archivo..."),s.U3({id:F._id.$oid,type:"small"},(function(e){Ne("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){Ne("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),Ne("error","Error al descargar el archivo")})))}))}}),(0,Z.jsx)(d.M2,{record:F,setMetadata:xe,metadata:pe}),Object.keys(F.processing).length>1&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(P.Separator,{icon:(0,Z.jsx)(_.A,{}),title:"Procesamientos"}),Object.keys(F.processing).map((function(e,t){var n=F.processing[e].type,i=E.vJ.find((function(e){return e.value===n})),a=n;if("audio"!==n&&"video"!==n&&i)return(0,Z.jsx)(P.ItemMenu,{icon:(0,Z.jsx)(H.A,{}),name:i.label,onClick:function(){(null===Re||void 0===Re?void 0:Re.view)===a?Me(null):Me({view:a,slug:e}),(0,C.oS)(null)},className:(null===Re||void 0===Re?void 0:Re.view)===a?"selected":""},t)}))]})]})]})}),(0,Z.jsx)($.EL,{style:{width:"calc(100% - 400px)",height:"calc(100% - 25px)",position:"relative",margin:10,marginLeft:0,backgroundColor:He.palette.grey[900],padding:0},children:(0,Z.jsx)(A.Q,{backend:j.t2,children:(0,Z.jsxs)(w.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")},children:[(0,Z.jsx)(f.A,{ref:me,style:{position:"absolute",width:"100%",height:"calc(100%)",overflow:"hidden",cursor:"move"}}),(0,Z.jsx)(b.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:pe?"block":"none"},children:(0,Z.jsx)(k.A,{resource:pe,setMetadata:xe,history:e.history})}),(0,Z.jsxs)(b.V,{id:"processing",initialPosition:{x:0,y:0},style:{padding:0,borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,Z.jsxs)("div",{style:{padding:5,background:He.palette.grey[700],borderRadius:5},children:[(0,Z.jsx)($e,{variant:"dark"}),(0,Z.jsx)(q,{children:De.roles.includes("user")&&(0,Z.jsx)(h.A,{label:"Agregar un recorte",size:"small",onClick:function(){X({index:le.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:"default",new:!0}),oe(!0)},style:{border:"none",color:"white",backgroundColor:He.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,Z.jsx)(f.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,Z.jsx)(R.A,{})}),variant:"outlined"})})]}),U&&(0,Z.jsx)(Y,{block:U,labels:["default"],setSelectedBlock:X,record:F._id.$oid})]}),"img_analyze"===(null===Re||void 0===Re?void 0:Re.view)&&(0,Z.jsx)(te,{record:F._id.$oid,slug:Re.slug},F._id.$oid)]})})})]})})}},30492:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M7.5 5.6 10 7 8.6 4.5 10 2 7.5 3.4 5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14zM22 2l-2.5 1.4L17 2l1.4 2.5L17 7l2.5-1.4L22 7l-1.4-2.5zm-7.63 5.29a.9959.9959 0 0 0-1.41 0L1.29 18.96c-.39.39-.39 1.02 0 1.41l2.34 2.34c.39.39 1.02.39 1.41 0L16.7 11.05c.39-.39.39-1.02 0-1.41zm-1.03 5.49-2.12-2.12 2.44-2.44 2.12 2.12z"}),"AutoFixHigh")},64621:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6"}),"Brightness6")},64846:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m1-17.93c3.94.49 7 3.85 7 7.93s-3.05 7.44-7 7.93z"}),"Contrast")},54536:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown")},5374:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PrecisionManufacturing")},94329:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")}}]);
//# sourceMappingURL=159.81768991.chunk.js.map