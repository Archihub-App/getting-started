"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[5661,4299],{8255:function(e,t,n){n.r(t);var a=n(64467),r=n(89379),o=n(5544),i=n(65043),l=n(78717),c=n(9920),s=n(5670),d=n(48210),u=n(42588),f=n(26240),h=n(43845),p=n(96446),g=n(17392),m=n(99070),v=n(55263),x=n(85865),A=n(92530),y=n(93012),b=n(36795),j=n(31269),k=n(6512),w=n(4319),C=n(76370),S=n(90151),z=n(24394),L=n(68641),M=n(42497),E=n(79175),V=n(74802),R=n(94329),N=n(5374),H=n(94495),_=n(95501),D=n(83003),B=n(88455),I=n(73216),P=n(81551),T=n(72378),$=n(33745),F=n(48084),W=n(85211),G=n(58140),O=n(18751),U=n(11238),Z=n(70579),q=(0,P.A)((function(e){return{close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"},"& path":{fill:"white"}}}})),J=function(e){var t=q(),n=(0,f.A)(),a=(0,G.M)().showAlert;return(0,Z.jsx)("div",{style:{background:n.palette.grey[700],borderRadius:5,marginTop:5},children:(0,Z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(h.A,{label:"Guardar",size:"small",onClick:function(){d.vt({type:"image",record_id:e.record,data:{bbox:e.block.bbox}}).then((function(t){e.setSelectedBlock(null),a("success","Recorte creado correctamente")}))},icon:(0,Z.jsx)(R.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close})}),(0,Z.jsx)(h.A,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:(0,Z.jsx)(V.A,{}),style:{margin:3,width:24,height:24,border:"none"},className:t.close})]})})},Q=(0,P.A)((function(e){return{toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}}}})),K=function(e){var t=(0,i.useState)(null),n=(0,o.A)(t,2),a=n[0],r=n[1];return(0,i.useEffect)((function(){c.vv(e.record,e.slug).then((function(e){r(e)})).catch((function(e){r(null)}))}),[]),(0,Z.jsx)(k.V,{id:"extra",initialPosition:{x:0,y:0},style:{display:a?"block":"none"},children:a&&(0,Z.jsx)("div",{style:{padding:"10px",background:"white",maxWidth:350},children:a.caption.value})})};t.default=function(e){var t=(0,i.useState)(!1),n=(0,o.A)(t,2),d=n[0],V=n[1],R=(0,i.useState)(null),P=(0,o.A)(R,2),q=P[0],X=P[1],Y=(0,i.useState)(null),ee=(0,o.A)(Y,2),te=ee[0],ne=ee[1],ae=(0,i.useState)(!1),re=(0,o.A)(ae,2),oe=re[0],ie=re[1],le=(0,i.useState)([]),ce=(0,o.A)(le,2),se=ce[0],de=ce[1],ue=(0,i.useState)("carrousel"),fe=(0,o.A)(ue,2),he=fe[0],pe=(fe[1],(0,i.useState)(null)),ge=(0,o.A)(pe,2),me=ge[0],ve=ge[1],xe=(0,i.useRef)(null),Ae=(0,i.useRef)(null),ye=(0,i.useState)(0),be=(0,o.A)(ye,2),je=be[0],ke=be[1],we=(0,i.useState)(1),Ce=(0,o.A)(we,2),Se=Ce[0],ze=Ce[1],Le=(0,i.useState)(null),Me=(0,o.A)(Le,2),Ee=Me[0],Ve=Me[1],Re=(0,D.d4)((function(e){return e.user})),Ne=(0,D.d4)((function(e){return e.app.adjustements})),He=(0,I.g)().id,_e=(0,f.A)(),De=(0,D.d4)((function(e){return e.app.isDarkMode})),Be=Q(),Ie=(0,D.wA)(),Pe=(0,G.M)().showAlert,Te=function(e){return(0,Z.jsxs)(p.A,{style:{display:"flex",width:"calc(100% - 20px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",backgroundColor:"dark"===e.variant?_e.palette.grey[900]:"white",borderRadius:"50px"},children:[(0,Z.jsx)(g.A,{color:"primary",onClick:function(){$e(Se-1)},children:(0,Z.jsx)(L.A,{})}),(0,Z.jsx)(z.Z6,{name:null,value:Se,handleChange:function(e){$e(parseInt(e.target.value),!1)},min:1,max:je,style:{width:"100px",padding:"0px",backgroundColor:"dark"===e.variant?_e.palette.grey[700]:"white",marginRight:"10px",borderBottom:"none"}}),(0,Z.jsx)(m.Ay,{ref:Ae,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:Se,step:1,marks:!0,min:1,max:je,style:{width:"80%"},onChangeCommitted:function(e,t){$e(t,!1)}}),(0,Z.jsx)(g.A,{color:"primary",onClick:function(){$e(Se+1)},children:(0,Z.jsx)(M.A,{})})]})};(0,i.useEffect)((function(){return l.$R(He).then((function(e){ke(e.pages)})).catch((function(e){e.json().then((function(e){Pe("error",e.msg)}))})),Ie((0,W.n_)({contrast:1,brightness:1,saturation:1,invert:0,rotation:0})),function(){(0,S.vs)()}}),[]),(0,i.useEffect)((function(){je>0&&((0,S.Ts)(je,xe.current,1,He,1,!1),(0,S.Zv)(ze),(0,S.i0)())}),[je]),(0,i.useEffect)((function(){Ee&&"img_analyze"===Ee.view&&c.FZ(He,Se-1,Ee.slug,"blocks").then((function(e){(0,S.P4)(e,Se,1,(function(){}))})).catch((function(e){console.log(e)}));var e=(0,r.A)({},Ne);e.rotation=0,Ie((0,W.n_)(e))}),[Ee,Se]),(0,i.useEffect)((function(){c.de({id:He,index:Se-1}).then((function(e){X(e)})).catch((function(e){console.log(e)}))}),[Se]),(0,i.useEffect)((function(){Ne&&(0,S.RI)(Ne)}),[Ne]);var $e=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e>je&&(e=je),e<1&&(e=1),(0,S.qV)(e,1,He,t),ze(e)};(0,i.useEffect)((function(){Re.favorites&&q&&(Re.favorites.find((function(e){return e.id===q._id.$oid}))?V(!0):V(!1))}),[Re.favorites,q]),(0,i.useEffect)((function(){null===te?("carrousel"===he&&(0,S.D8)(null),oe&&"carrousel"===he&&(0,S.a7)(Se),Fe(Se)):(oe&&"carrousel"===he&&(0,S.a7)(Se),"carrousel"===he&&(0,S.D8)(te),"carrousel"===he&&(0,S.P4)(se,Se,1,ne))}),[te]);var Fe=function(e){de([]),oe&&"carrousel"===he&&(0,S.a7)(e)};return(0,Z.jsx)(T.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:je>0&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(T.EL,{style:(0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)((0,a.A)({width:"calc(100% - 40px)",marginBottom:0,height:"calc(100% - 20px)",padding:0},"width","400px"),"maxWidth","400px"),"border","none"),"display","block"),"placeContent","flex-start"),"overflow","auto"),"minWidth","300px"),"flexGrow",.5),"margin",10),children:q&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(v.A,{style:{background:_e.palette.primary.light},className:Be.toolbar,children:[Re.access_token&&"null"!==Re.access_token&&(0,Z.jsx)(g.A,{sx:{marginLeft:"12px",color:_e.palette.primary.main},size:"large",onClick:function(){var e={type:"records",id:q._id.$oid};d?s.C5(e).then((function(e){Ie((0,B.me)(Re.access_token)),Pe("success","Eliminado de favoritos")})).catch((function(e){Pe("error","No se pudo eliminar de favoritos")})):s.Gm(e).then((function(e){Ie((0,B.me)(Re.access_token)),Pe("success","Agregado a favoritos")})).catch((function(e){Pe("error","No se pudo agregar a favoritos")}))},children:d?(0,Z.jsx)(y.A,{}):(0,Z.jsx)(A.A,{})}),(0,Z.jsx)(x.A,{variant:"h6",style:{flexGrow:1,marginLeft:0,color:_e.palette.primary.main},children:q.displayName?q.displayName:q.name})]}),(0,Z.jsxs)(p.A,{children:[(0,Z.jsx)(U.nA,{startIcon:(0,Z.jsx)(O.A,{}),style:{borderRadius:5,backgroundColor:De?_e.palette.grey[800]:_e.palette.grey[200],color:_e.palette.grey[500],margin:10,width:"calc(100% - 20px)"},label:"Descargar archivo",onClick:function(){Pe("askUserDownloadType","Escoge el tipo de descarga").then((function(e){"original"===e?(Pe("loading","Descargando archivo..."),c.U3({id:q._id.$oid,type:"original"},(function(e){Pe("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){Pe("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),Pe("error","Error al descargar el archivo")}))):"small"===e&&(Pe("loading","Descargando archivo..."),c.U3({id:q._id.$oid,type:"small"},(function(e){Pe("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){Pe("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),Pe("error","Error al descargar el archivo")})))}))}}),(0,Z.jsx)(u.M2,{record:q,setMetadata:ve,metadata:me}),Object.keys(q.processing).length>1&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)($.Separator,{icon:(0,Z.jsx)(N.A,{}),title:"Procesamientos"}),Object.keys(q.processing).map((function(e,t){var n=q.processing[e].type,a=H.vJ.find((function(e){return e.value===n})),r=n;if("audio"!==n&&"video"!==n&&a)return(0,Z.jsx)($.ItemMenu,{icon:(0,Z.jsx)(_.A,{}),name:a.label,onClick:function(){(null===Ee||void 0===Ee?void 0:Ee.view)===r?Ve(null):Ve({view:r,slug:e}),(0,S.oS)(null)},className:(null===Ee||void 0===Ee?void 0:Ee.view)===r?"selected":""},t)}))]})]})]})}),(0,Z.jsx)(T.EL,{style:{width:"calc(100% - 400px)",height:"calc(100% - 25px)",position:"relative",margin:10,marginLeft:0,backgroundColor:_e.palette.grey[900],padding:0},children:(0,Z.jsx)(b.Q,{backend:j.t2,children:(0,Z.jsxs)(w.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")},children:[(0,Z.jsx)(p.A,{ref:xe,style:{position:"absolute",width:"100%",height:"calc(100%)",overflow:"hidden",cursor:"move"}}),(0,Z.jsx)(k.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:me?"block":"none"},children:(0,Z.jsx)(C.A,{resource:me,setMetadata:ve,history:e.history})}),(0,Z.jsxs)(k.V,{id:"processing",initialPosition:{x:0,y:0},style:{padding:0,borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,Z.jsxs)("div",{style:{padding:5,background:_e.palette.grey[700],borderRadius:5},children:[(0,Z.jsx)(Te,{variant:"dark"}),(0,Z.jsx)(F.A,{children:Re.roles.includes("user")&&(0,Z.jsx)(h.A,{label:"Agregar un recorte",size:"small",onClick:function(){ne({index:se.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:"default",new:!0}),ie(!0)},style:{border:"none",color:"white",backgroundColor:_e.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,Z.jsx)(p.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,Z.jsx)(E.A,{})}),variant:"outlined"})})]}),te&&(0,Z.jsx)(J,{block:te,labels:["default"],setSelectedBlock:ne,record:q._id.$oid})]}),"img_analyze"===(null===Ee||void 0===Ee?void 0:Ee.view)&&(0,Z.jsx)(K,{record:q._id.$oid,slug:Ee.slug},q._id.$oid)]})})})]})})}},396:function(e,t,n){n.d(t,{A:function(){return g}});var a=n(58168),r=n(60436),o=n(80045),i=n(65043),l=(n(2086),n(43024)),c=n(47573),s=n(66187),d=n(82454),u=(0,n(24794).A)(i.createElement("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"}),"MoreHoriz"),f=n(75992);var h=(0,c.A)((function(e){return{root:{display:"flex",marginLeft:e.spacing(.5),marginRight:e.spacing(.5),backgroundColor:e.palette.grey[100],color:e.palette.grey[700],borderRadius:2,cursor:"pointer","&:hover, &:focus":{backgroundColor:e.palette.grey[200]},"&:active":{boxShadow:e.shadows[0],backgroundColor:(0,d.tL)(e.palette.grey[200],.12)}},icon:{width:24,height:16}}}),{name:"PrivateBreadcrumbCollapsed"})((function(e){var t=e.classes,n=(0,o.A)(e,["classes"]);return i.createElement(f.A,(0,a.A)({component:"li",className:t.root,focusRipple:!0},n),i.createElement(u,{className:t.icon}))}));var p=i.forwardRef((function(e,t){var n=e.children,c=e.classes,d=e.className,u=e.component,f=void 0===u?"nav":u,p=e.expandText,g=void 0===p?"Show path":p,m=e.itemsAfterCollapse,v=void 0===m?1:m,x=e.itemsBeforeCollapse,A=void 0===x?1:x,y=e.maxItems,b=void 0===y?8:y,j=e.separator,k=void 0===j?"/":j,w=(0,o.A)(e,["children","classes","className","component","expandText","itemsAfterCollapse","itemsBeforeCollapse","maxItems","separator"]),C=i.useState(!1),S=C[0],z=C[1],L=i.Children.toArray(n).filter((function(e){return i.isValidElement(e)})).map((function(e,t){return i.createElement("li",{className:c.li,key:"child-".concat(t)},e)}));return i.createElement(s.A,(0,a.A)({ref:t,component:f,color:"textSecondary",className:(0,l.default)(c.root,d)},w),i.createElement("ol",{className:c.ol},function(e,t,n){return e.reduce((function(a,r,o){return o<e.length-1?a=a.concat(r,i.createElement("li",{"aria-hidden":!0,key:"separator-".concat(o),className:t},n)):a.push(r),a}),[])}(S||b&&L.length<=b?L:function(e){return A+v>=e.length?e:[].concat((0,r.A)(e.slice(0,A)),[i.createElement(h,{"aria-label":g,key:"ellipsis",onClick:function(e){z(!0);var t=e.currentTarget.parentNode.querySelector("a[href],button,[tabindex]");t&&t.focus()}})],(0,r.A)(e.slice(e.length-v,e.length)))}(L),c.separator,k)))})),g=(0,c.A)({root:{},ol:{display:"flex",flexWrap:"wrap",alignItems:"center",padding:0,margin:0,listStyle:"none"},li:{},separator:{display:"flex",userSelect:"none",marginLeft:8,marginRight:8}},{name:"MuiBreadcrumbs"})(p)},34305:function(e,t,n){var a=n(24994),r=n(6305);t.A=void 0;var o=r(n(65043)),i=(0,a(n(59846)).default)(o.createElement("path",{d:"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext");t.A=i},6502:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"m12 4-1.41 1.41L16.17 11H4v2h12.17l-5.58 5.59L12 20l8-8z"}),"ArrowForward")},93012:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2"}),"Bookmark")},92530:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"M17 3H7c-1.1 0-1.99.9-1.99 2L5 21l7-3 7 3V5c0-1.1-.9-2-2-2m0 15-5-2.18L7 18V5h10z"}),"BookmarkBorder")},5374:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PrecisionManufacturing")},94329:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},76300:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School")},66360:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},95501:function(e,t,n){var a=n(24994);t.A=void 0;var r=a(n(40039)),o=n(70579);t.A=(0,r.default)((0,o.jsx)("path",{d:"M14.67 5v6.5H9.33V5zm1 6.5H21V5h-5.33zm-1 7.5v-6.5H9.33V19zm1-6.5V19H21v-6.5zm-7.34 0H3V19h5.33zm0-1V5H3v6.5z"}),"ViewModule")}}]);
//# sourceMappingURL=5661.529a00ca.chunk.js.map