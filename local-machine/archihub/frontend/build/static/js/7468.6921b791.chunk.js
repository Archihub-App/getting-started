"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[7468],{67468:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});var o=n(90675),r=n(60436),i=n(10467),a=n(5544),s=n(65043),c=n(73216),u=n(68817),d=n.n(u),f=n(9920),l=n(78717),h=n(43288),p=n(70579),m=function(){var e=(0,s.useState)(!0),t=(0,a.A)(e,2),n=t[0],u=t[1],m=(0,s.useState)([]),g=(0,a.A)(m,2),y=g[0],v=g[1],w=(0,s.useState)(0),j=(0,a.A)(w,2),b=j[0],H=j[1],T=(0,c.g)().id,S=function(){var e=(0,i.A)((0,o.A)().mark((function e(t){var n,i,a;return(0,o.A)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,f.f2(T,[t],"big",!1);case 4:n=e.sent,i="data:image/jpg;base64,"+n[0].data,a={original:i,thumbnail:i,lazyLoad:!0},v((function(e){var n=(0,r.A)(e);return n[t]=a,n})),u(!1),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log(e.t0);case 14:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}();return(0,s.useEffect)((function(){l.$R(T).then((function(e){var t=e.pages,n=Array.from({length:t},(function(){return{original:"",thumbnail:"",lazyLoad:!0}}));v(n),S(0),t>1&&S(1)})).catch((function(e){console.log(e)}))}),[T]),(0,p.jsxs)("div",{style:{backgroundColor:"black",position:"relative"},children:[(0,p.jsx)("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3},children:n&&(0,p.jsx)(h.A,{})}),(0,p.jsx)(d(),{items:y,onSlide:function(e){""===y[e].original&&(S(e),H(e))},showThumbnails:!1,startIndex:b,additionalClass:"gallery",showFullscreenButton:!1,showPlayButton:!1,showNav:!1,infinite:!1})]})}},9920:function(e,t,n){n.d(t,{FZ:function(){return l},Hc:function(){return i},RS:function(){return s},Rm:function(){return h},S7:function(){return m},U3:function(){return v},ao:function(){return p},bn:function(){return y},de:function(){return d},f2:function(){return f},v:function(){return g},vv:function(){return c},wp:function(){return u},xU:function(){return a}});var o=n(88120),r=n(91280);function i(e){var t="/records/"+e,n={method:"GET",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch((0,o.H6)()+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function a(e){var t="/records/"+e+"/stream",n={method:"GET",headers:new Headers({Authorization:(0,r.g)()}),mode:"cors",cache:"default"};return fetch((0,o.H6)()+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.blob()}))}function s(e,t){var n="/records/"+e+"/transcription",i={method:"POST",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify({slug:t})};return fetch((0,o.H6)()+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function c(e,t){var n="/records/"+e+"/metadata",i={method:"POST",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify({slug:t})};return fetch((0,o.H6)()+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function u(e){var t="/records/"+e+"/document",n={method:"GET",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default"};return fetch((0,o.H6)()+t,n).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function d(e){if((0,r.g)()){var t={method:"POST",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,o.H6)()+"/records/galleryinfo",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}t={method:"POST",headers:new Headers({"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,o.H6)()+"/records/public/galleryinfo",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function f(e,t,n){var i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if((0,r.g)()){var a="/records/"+e+"/pages",s={method:"POST",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify({pages:t,size:n,gallery:!i})};return fetch((0,o.H6)()+a,s).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}var c="/records/public/"+e+"/pages";s={method:"POST",headers:new Headers({"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify({pages:t,size:n,gallery:!i})};return fetch((0,o.H6)()+c,s).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function l(e,t,n,i){var a="/records/"+e+"/blocks",s={method:"POST",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify({page:t,block:i,slug:n})};return fetch((0,o.H6)()+a,s).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function h(e){var t={method:"POST",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,o.H6)()+"/records/setBlock",t).then((function(e){return 201!==e.status?Promise.reject(e):e.json()}))}function p(e){var t={method:"PUT",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,o.H6)()+"/records/setBlock",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function m(e){var t={method:"DELETE",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(e)};return fetch((0,o.H6)()+"/records/setBlock",t).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function g(e,t){var n="/records/"+e+"/edit-transcription",i={method:"PUT",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(t)};return fetch((0,o.H6)()+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function y(e,t){var n="/records/"+e+"/edit-transcription",i={method:"DELETE",headers:new Headers({Authorization:(0,r.g)(),"Content-Type":"application/json"}),mode:"cors",cache:"default",body:JSON.stringify(t)};return fetch((0,o.H6)()+n,i).then((function(e){return 200!==e.status?Promise.reject(e):e.json()}))}function v(e,t){var n=(0,r.g)();return new Promise(n?function(n,i){var a=new XMLHttpRequest;a.open("POST",o.FM+"/records/download",!0),a.responseType="blob",a.setRequestHeader("Authorization",(0,r.g)()),a.setRequestHeader("Content-Type","application/json"),a.addEventListener("progress",(function(e){if(e.lengthComputable&&t){var n=e.loaded/e.total*100;t(n)}})),a.addEventListener("load",(function(){if(200===a.status){var e,t=a.response,o=(null===(e=a.getResponseHeader("content-disposition"))||void 0===e?void 0:e.split("filename=")[1])||"download",r=window.URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download=o,document.body.appendChild(s),s.click(),setTimeout((function(){document.body.removeChild(s),window.URL.revokeObjectURL(r),n()}),100)}else i(new Error("Download failed with status ".concat(a.status)))})),a.addEventListener("error",(function(){i(new Error("Download failed"))})),a.timeout=6e4,a.addEventListener("timeout",(function(){i(new Error("Download timed out"))})),a.send(JSON.stringify(e))}:function(n,r){var i=new XMLHttpRequest;i.open("POST",o.FM+"/records/public/download",!0),i.responseType="blob",i.setRequestHeader("Content-Type","application/json"),i.addEventListener("progress",(function(e){if(e.lengthComputable&&t){var n=e.loaded/e.total*100;t(n)}})),i.addEventListener("load",(function(){if(200===i.status){var e,t=i.response,o=(null===(e=i.getResponseHeader("content-disposition"))||void 0===e?void 0:e.split("filename=")[1])||"download",a=window.URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=o,document.body.appendChild(s),s.click(),setTimeout((function(){document.body.removeChild(s),window.URL.revokeObjectURL(a),n()}),100)}else r(new Error("Download failed with status ".concat(i.status)))})),i.addEventListener("error",(function(){r(new Error("Download failed"))})),i.timeout=6e4,i.addEventListener("timeout",(function(){r(new Error("Download timed out"))})),i.send(JSON.stringify(e))})}}}]);
//# sourceMappingURL=7468.6921b791.chunk.js.map