"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[9117],{79117:function(e,t,n){n.r(t),n.d(t,{Main:function(){return ge},default:function(){return ye}});var a=n(89379),i=n(5544),s=n(65043),l=n(73216),r=n(83003),o=n(85211),c=n(81551),d=n(66187),u=n(31445),f=n(19853),p=n(55263),h=n(4598),g=n(26240),y=n(94495),m=n(18751),x=n(92429),v=n(22505),A=n(42588),b=n(19541),j=n(60436),w=n(24765),k=n(16702),S=n(10765),C=n(63516),T=n(78717),F=n(94072),R=n(749),E=n(96795),L=n(19227),I=n(97563),N=n(18219),q=n(41905),D=n(17392),_=n(63471),z=n(58293),B=n(19090),P=n(65892),M=n(47260),O=n(68641),V=n(36795),H=n(31269),W=n(92392),G=n(63573),J=n(70579),U=P.UMr(P.Ks0),Q=(0,q.A)((function(e){return{card:{margin:5,"&.deleted":{backgroundColor:"#f44336",color:"#fff",textDecoration:"line-through"}},gridCard:{margin:5,width:100,height:100}}})),Z=function(e){var t,n,l,r=Q(),o=(0,s.useState)([]),c=(0,i.A)(o,2),d=c[0],u=c[1],p=(0,s.useState)(!1),h=(0,i.A)(p,2),g=h[0],y=h[1],m=(0,s.useState)(null),x=(0,i.A)(m,2),v=x[0],A=x[1];(0,s.useEffect)((function(){if(null!==e.file){var t=(0,a.A)({},e.file);"displayName"in t||(t.displayName=t.name),"accessRights"in t||(t.accessRight="public"),A(t)}}),[]),(0,s.useEffect)((function(){f.WP().then((function(e){u([{id:"public",term:"P\xfablica"}].concat((0,j.A)(e.options)))}))}),[e.file]);var b=function(t){e.onUpdate(t)};return(0,J.jsxs)(R.A,{className:"".concat(r.card," ").concat(e.file.deleted?"deleted":""),children:[(0,J.jsx)(E.A,{title:(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,J.jsx)("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"calc(100% - 200px)"},children:e.file.displayName}),(0,J.jsxs)("div",{children:[(0,J.jsx)(L.A,{label:e.file.tag,style:{marginLeft:5,marginRight:15,backgroundColor:U(e.file.tag),color:"#fff"},size:"small"}),(0,J.jsx)(D.A,{onClick:function(){e.onDeleted(e.file)},size:"small",children:(0,J.jsx)(_.A,{})}),(null===(t=e.file)||void 0===t||null===(n=t.processing)||void 0===n||null===(l=n.fileProcessing)||void 0===l?void 0:l.type)&&(0,J.jsx)(D.A,{onClick:function(){e.setDetailView(v)},children:(0,J.jsx)(M.A,{})})]})]}),style:{padding:5},disableTypography:!0,action:(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(D.A,{onClick:function(){y(!g)},children:(0,J.jsx)(z.A,{})})})}),(0,J.jsx)(I.A,{in:g,children:v&&(0,J.jsxs)(N.A,{style:{padding:5},children:[(0,J.jsx)(S.BR,{name:"Nombre del archivo",value:v.displayName,handleChange:function(e){var t=(0,a.A)({},v);t.displayName=e.target.value,A(t),b(t)}}),(0,J.jsx)(S.Q5,{name:"Derechos de acceso",options:d.map((function(e){return{value:e.id,label:e.term}})),value:v.accessRights?v.accessRights:"public",handleChange:function(e){var t=(0,a.A)({},v);t.accessRights=e.target.value,A(t),b(t)}})]})})]},e.key)},K=function(e){var t=Q();return(0,J.jsx)(R.A,{className:t.gridCard,children:(0,J.jsx)(N.A,{})},e.key)},X=function(e){Q();var t,n,a,l,r=(0,s.useState)("list"),o=(0,i.A)(r,2),c=o[0],d=(o[1],(0,s.useState)(!1)),u=(0,i.A)(d,2),f=u[0],h=u[1],y=(0,s.useState)([]),m=(0,i.A)(y,2),x=m[0],v=m[1],A=(0,s.useState)(0),b=(0,i.A)(A,2),j=b[0],w=b[1],S=(0,s.useState)(0),C=(0,i.A)(S,2),F=C[0],R=C[1],E=(0,g.A)();return(0,s.useEffect)((function(){console.log(f)}),[f]),(0,s.useEffect)((function(){T.tB(e.resourceId,j).then((function(e){v(e.data),R(e.total)})).catch((function(e){console.log(e)}))}),[e.resourceId,j]),(0,J.jsxs)(J.Fragment,{children:[f&&(0,J.jsxs)(k.A,{style:{width:"100%"},children:[(0,J.jsx)(p.A,{children:(0,J.jsx)(D.A,{onClick:function(){h(!1)},children:(0,J.jsx)(O.A,{})})}),(0,J.jsxs)(k.A,{style:{height:"calc(100vh - 120px)",backgroundColor:E.palette.grey[900]},children:["image"===(null===f||void 0===f||null===(t=f.processing)||void 0===t||null===(n=t.fileProcessing)||void 0===n?void 0:n.type)&&(0,J.jsx)(V.Q,{backend:H.t2,children:(0,J.jsx)(W.A,{id:f.id})}),"document"===(null===f||void 0===f||null===(a=f.processing)||void 0===a||null===(l=a.fileProcessing)||void 0===l?void 0:l.type)&&(0,J.jsx)(V.Q,{backend:H.t2,children:(0,J.jsx)(G.A,{id:f.id,view:"viz"})})]})]}),"list"===c&&F>0&&!f&&(0,J.jsxs)(k.A,{style:{width:"100%"},children:[x.map((function(t,n){return(0,J.jsx)(Z,{file:t,onDeleted:function(){e.deleteFile(t)},onUpdate:function(t){e.updateFile(t)},setDetailView:h},n)})),(0,J.jsx)(B.A,{rowsPerPage:10,rowsPerPageOptions:[],count:F,page:j,onPageChange:function(e,t){w(t)},sx:{padding:0,display:"block"}})]}),"grid"===c&&F>0&&(0,J.jsxs)(k.A,{children:[(0,J.jsx)(k.A,{style:{width:"100%",display:"flex",flexWrap:"wrap"},children:x.map((function(t,n){return(0,J.jsx)(K,{file:t,onDeleted:function(){e.deleteFile(t)},onUpdate:function(t){e.updateFile(t)}},n)}))}),(0,J.jsx)(B.A,{rowsPerPage:10,rowsPerPageOptions:[],count:F,page:j,onPageChange:function(e,t){w(t)},sx:{padding:0,display:"block"}})]})]})},Y=n(56658),$=n(44448),ee=n(43485),te=n(94329),ne=(n(30064),n(72378)),ae=n(11238),ie=n(86279),se=n(99562),le=n(58140),re=n(43288),oe=function(e){var t=(0,s.useState)(null),n=(0,i.A)(t,2),l=n[0],o=n[1],c=(0,s.useState)(!0),d=(0,i.A)(c,2),u=d[0],f=d[1],p=(0,g.A)(),h=(0,le.M)().showAlert,y=(0,r.d4)((function(e){return e.user})),m=(0,r.d4)((function(e){return e.app.isDarkMode}));return(0,s.useEffect)((function(){ie.Qs(e.id).then((function(e){f(!1),o(e)})).catch((function(e){f(!1),o(null)}))}),[]),(0,s.useEffect)((function(){}),[y,l]),(0,J.jsxs)(J.Fragment,{children:[u&&(0,J.jsx)(re.A,{}),!l&&!u&&y.roles.includes("team_lead")&&(0,J.jsx)(ae.nA,{style:{borderRadius:5},customColor:{background:m?p.palette.grey[800]:p.palette.grey[200],color:m?p.palette.primary.light:p.palette.primary.main},startIcon:(0,J.jsx)(se.A,{}),onClick:function(){h("taskForm","create").then((function(t){t&&(f(!0),o(null),ie.UT(JSON.stringify((0,a.A)((0,a.A)({},t),{},{resourceId:e.id}))).then((function(e){f(!1),o(e)})).catch((function(e){console.log(e)})))}))},label:"Crear nueva tarea de catalogaci\xf3n"}),l&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(ae.nA,{style:{borderRadius:5},customColor:{background:p.palette.grey[200],color:p.palette.primary.main},startIcon:(0,J.jsx)(se.A,{}),label:"Tarea asignada a ".concat(l.user)}),(0,J.jsx)(ne.WB,{children:(0,J.jsx)("div",{dangerouslySetInnerHTML:{__html:l.comment.replace(/\n/g,"<br />")}})}),("pending"===l.status||"rejected"===l.status)&&l.user===y.name&&(0,J.jsx)(ae.nA,{style:{marginTop:10,borderRadius:5},customColor:{background:p.palette.grey[200],color:p.palette.grey[600]},onClick:function(){h("taskForm","update").then((function(e){e&&(f(!0),o(null),ie.lC(l._id,JSON.stringify((0,a.A)((0,a.A)({},e),{},{status:"review"}))).then((function(e){f(!1),o(e)})).catch((function(e){console.log(e)})))}))},label:"Enviar tarea a revisi\xf3n"}),"review"===l.status&&y.roles.includes("team_lead")&&(0,J.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:10,width:"100%"},children:[(0,J.jsx)(ae.nA,{style:{borderRadius:5,margin:2},customColor:{background:p.palette.grey[200],color:p.palette.grey[600]},onClick:function(){h("taskForm","update").then((function(e){e&&(f(!0),o(null),ie.lC(l._id,JSON.stringify((0,a.A)((0,a.A)({},e),{},{status:"rejected"}))).then((function(e){f(!1),o(e)})).catch((function(e){console.log(e)})))}))},label:"Rechazar tarea"}),(0,J.jsx)(ae.nA,{style:{borderRadius:5,margin:2},customColor:{background:p.palette.grey[200],color:p.palette.grey[600]},onClick:function(){h("taskForm","update").then((function(e){e&&(f(!0),o(null),ie.lC(l._id,JSON.stringify((0,a.A)((0,a.A)({},e),{},{status:"approved"}))).then((function(e){f(!1),o(null)})).catch((function(e){f(!1),o(null)})))}))},label:"Finalizar tarea"})]})]})]})},ce=(0,c.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 170px)"},alert_detail:{fontSize:13,background:"#f27474",color:"white",padding:"2px",borderRadius:"5px",margin:"2px"}}})),de=function(e){var t=e.metadata,n=e.children,a=e.values,l=e.fields,r=s.useState(null),o=(0,i.A)(r,2),c=o[0],d=o[1],u=s.useState(null),f=(0,i.A)(u,2),p=f[0],h=f[1];return(0,s.useEffect)((function(){if(t.conditionField){var e=parseInt(t.conditionField),n=l[e],i=n.destiny,s=n.type,r=function(e,t){var n,a=t.split("."),i=e,s=(0,w.A)(a);try{for(s.s();!(n=s.n()).done;)if(void 0===(i=i[n.value]))return}catch(l){s.e(l)}finally{s.f()}return i}(a,i);if(d(s),"checkbox"===s)h(r);else if("text"===s){var o=t.conditionType,c=t.conditionValueText;"equals"===o?h(r===c):"different"===o?h(r!==c):"contains"===o&&(r.includes(c)?h(!0):h(!1))}}else d("withoutCondition")}),[a]),(0,J.jsxs)(J.Fragment,{children:["checkbox"===c&&p&&(0,J.jsx)(J.Fragment,{children:n}),"text"===c&&p&&(0,J.jsx)(J.Fragment,{children:n}),"withoutCondition"===c&&(0,J.jsx)(J.Fragment,{children:n})]})},ue=function(e){ce();var t=s.useState(null),n=(0,i.A)(t,2),a=n[0],o=n[1],c=s.useState(!1),u=(0,i.A)(c,2),f=u[0],p=u[1],h=s.useState({}),y=(0,i.A)(h,2),m=y[0],x=y[1],v=s.useState([]),A=(0,i.A)(v,2),b=A[0],R=A[1],E=s.useState({}),L=(0,i.A)(E,2),I=L[0],N=L[1],q=s.useState([]),D=(0,i.A)(q,2),_=D[0],z=D[1],B=s.useState([]),P=(0,i.A)(B,2),M=P[0],O=P[1],V=s.useState(1),H=(0,i.A)(V,2),W=H[0],G=H[1],U=(0,l.Zp)(),Q=(0,l.g)(),Z=Q.id,K=Q.slug,ie=(0,r.d4)((function(e){return e.user})),se=(0,g.A)(),re=(0,le.M)().showAlert,ue=(0,r.d4)((function(e){return e.app.isDarkMode}));(0,s.useEffect)((function(){Z?(p(!0),T.HD(Z).then((function(t){t&&(t.msg?re("error",t.msg).then((function(){he("/cataloging/".concat(e.selectedType.slug))})):(p(!0),t.files=[],x(t),z(t.filesObj),t.parents&&o(t.parents[0]),R(t.parents)))})).catch((function(t){t.json().then((function(t){re("error",t.msg).then((function(){he("/cataloging/".concat(e.selectedType.slug))}))}))}))):(p(!1),pe())}),[Z,K]),(0,s.useEffect)((function(){if(e.selectedType){console.log(e.selectedType);var t=e.selectedType.metadata.fields,n=fe(t);O(n)}}),[e.selectedType]);var fe=function(e){var t=[],n=[];return e.forEach((function(e,a){"separator"===e.type?(t.push(n),(n=[]).push(e)):n.push(e)})),t.push(n),t},pe=function(){var t={files:[]};t.post_type=e.selectedType.slug,t.parents=[a],x(t)},he=function(e){U("".concat(e))},ge=function(e,t){var n,a=t.split("."),i=e,s=(0,w.A)(a);try{for(s.s();!(n=s.n()).done;){if(void 0===(i=i[n.value]))return}}catch(l){s.e(l)}finally{s.f()}return i},ye=function(e,t,n){var a,i=t.split("."),s=0,l=(0,w.A)(i);try{for(l.s();!(a=l.n()).done;){var r=a.value;++s===i.length?e[r]=n:e=e[r]}}catch(o){l.e(o)}finally{l.f()}};return(0,J.jsx)(J.Fragment,{children:Object.keys(m).length>0&&(0,J.jsxs)(J.Fragment,{children:[e.selectedType.parentsTypes.length>0||e.selectedType.hierarchical?(0,J.jsx)(J.Fragment,{children:(0,J.jsx)(ne.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"100%",display:"block",overflow:"auto",placeContent:"flex-start",flexGrow:5,maxWidth:"400px",background:"white"},children:(0,J.jsx)(F.G,{parents:e.selectedType.parentsTypes,setFondo:function(e,t){if(a&&t)if(a.id===e.id){var n=t.filter((function(t){return t.id!==e.id}));o(null),R((0,j.A)(n))}else o(e),R([].concat((0,j.A)(t),[e]));else t?(o(e),R([].concat((0,j.A)(t),[e]))):a?a.id===e.id&&(o(null),R([])):(o(e),R([e]))},activeTypes:(0,j.A)(e.selectedType.parentsTypes),childrenEditing:!0,selected:a?[a]:[],path:b})})}):(0,J.jsx)(J.Fragment,{}),(0,J.jsxs)(ne.EL,{style:{width:"100%",marginLeft:e.selectedType.parentsTypes.length>0||e.selectedType.hierarchical?0:"10px",marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start",maxWidth:"600px",overflow:"auto",flexGrow:1},children:[(ie.roles.includes("team_lead")||ie.roles.includes("editor"))&&(0,J.jsx)(oe,{id:Z}),(0,J.jsx)(C.l1,{initialValues:m,onSubmit:function(t,n){var i=n.setSubmitting;f?(i(!1),re("confirm","\xbfEst\xe1s seguro? Se modificar\xe1 el recurso").then((function(n){if(n){e.setLoading(!0),t.parents=a?[{id:a.id,post_type:a.post_type}]:null,t.parent=a?[{id:a.id,post_type:a.post_type}]:null,(void 0===t.accessRights||"none"===t.accessRights)&&(t.accessRights="public");var i=new FormData,s=[],l=[],r=[];t.files?(t.filesIds=[],t.files.forEach((function(e,n){"string"!==typeof e.file&&e.file&&(i.append("files",e.file),t.filesIds.push({file:n,filetag:e.id}))})),_.forEach((function(e){e.deleted?l.push(e.id):(s.push(e.id),r.push(e))})),t.files=s,t.deletedFiles=l,t.updatedFiles=r):t.files=[],i.append("data",JSON.stringify(t)),T.aH(Z,i).then((function(t){e.setLoading(!1),re("success","Recurso modificado correctamente")})).catch((function(t){e.setLoading(!1),t.json().then((function(e){e.errors&&N(e.errors),re("error",e.msg,"",e.errors)}))}))}}))):(i(!1),re("confirm","\xbfEst\xe1s seguro? Se crear\xe1 un nuevo recurso").then((function(n){if(n){e.setLoading(!0),t.parents=a?[{id:a.id,post_type:a.post_type}]:null,t.parent=a?[{id:a.id,post_type:a.post_type}]:null,(void 0===t.accessRights||"none"===t.accessRights)&&(t.accessRights="public");var i=new FormData;t.filesIds=[],t.files.forEach((function(e,n){i.append("files",e.file),t.filesIds.push({file:n,filetag:e.id})})),t.files=[],i.append("data",JSON.stringify(t)),T.ji(i).then((function(t){e.setLoading(!1),re("success","Recurso creado correctamente")})).catch((function(t){t.json().then((function(t){e.setLoading(!1),t.errors&&N(t.errors),re("error",t.msg)}))}))}})))},children:function(t){var n=t.values,a=(t.errors,t.touched,t.handleChange),i=t.handleBlur,s=t.handleSubmit,l=(t.isSubmitting,t.setFieldValue);return(0,J.jsx)("form",{onSubmit:s,children:e.selectedType.metadata&&(0,J.jsxs)(J.Fragment,{children:[M[W-1].map((function(t,s){return(0,J.jsxs)(J.Fragment,{children:["file"===t.type&&(0,J.jsx)(S.U0,{name:t.label,id:t.filetag,values:n,required:t.required,change:l},t.filetag),"text"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.BR,{field:t,name:t.label,id:t.destiny,handleChange:a,handleBlur:i,value:ge(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"text-area"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.QA,{field:t,name:t.label,id:t.destiny,handleChange:a,handleBlur:i,value:ge(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"select"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.wd,{field:t,name:t.label,id:t.destiny,handleChange:a,handleBlur:i,value:ge(n,t.destiny)?ge(n,t.destiny):"none",required:t.required,options:t.list,errors:I[t.destiny],destiny:t.destiny})}),"select-multiple2"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.lH,{field:t,handleChange:function(e){l(t.destiny,e)},id:t.destiny,name:t.label,required:t.required,value:ge(n,t.destiny),errors:I[t.destiny]})}),"author"===t.type&&(0,J.jsx)(C.ED,{name:t.destiny,children:function(e){var a=e.insert,i=e.remove,s=e.push,r=e.move;return(0,J.jsx)(S.tF,{name:t.label,id:t.destiny,insert:a,remove:i,push:s,setFieldValue:function(e){l(t.destiny,e)},move:r,value:ge(n,t.destiny)?ge(n,t.destiny):[],required:t.required,errors:I[t.destiny]})}}),"simple-date"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.Lf,{field:t,name:t.label,id:t.destiny,setFieldValue:function(e){l(t.destiny,e)},handleBlur:i,value:ge(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"relation"===t.type&&(0,J.jsx)(S.HU,{name:t.label,id:t.destiny,value:ge(n,t.destiny),required:t.required,errors:I[t.destiny],postType:t,setFieldValue:function(e){l(t.destiny,e)}}),"checkbox"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.FO,{name:t.label,id:t.destiny,handleChange:function(e){l(t.destiny,e)},handleBlur:i,value:ge(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"number"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.Z6,{name:t.label,id:t.destiny,handleChange:a,handleBlur:i,value:ge(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"separator"===t.type&&(0,J.jsx)(d.A,{variant:"h6",style:{marginTop:10,marginBottom:10,color:se.palette.primary.main,marginLeft:10},children:t.label}),"location"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(S.aG,{name:t.label,id:t.destiny,handleChange:a,handleBlur:i,value:ge(n,t.destiny),required:t.required,errors:I[t.destiny],setFieldValue:function(e){l(t.destiny,e)}})}),"repeater"===t.type&&(0,J.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,J.jsx)(C.ED,{name:t.destiny,children:function(e){var a=e.insert,i=e.remove,s=e.push,r=e.move;return(0,J.jsx)(S._g,{subfields:t.subfields,name:t.label,id:t.destiny,insert:a,remove:i,push:s,setFieldValue:function(e){l(t.destiny,e)},move:r,value:ge(n,t.destiny)?ge(n,t.destiny):[],required:t.required,errors:I[t.destiny]})}})})]})})),(0,J.jsxs)(k.A,{style:{display:"flex",justifyContent:"space-between",gap:10,marginTop:10,position:"sticky",bottom:0,backgroundColor:ue?se.palette.grey[900]:se.palette.grey[100]},children:[(0,J.jsxs)(k.A,{children:[(0,J.jsx)(ae.nA,{type:"button",variant:"contained",onClick:function(){return he("/cataloging/"+e.selectedType.slug)},style:{margin:5,width:"auto"},customColor:{background:se.palette.grey[200],color:se.palette.grey[600]},label:"Cancelar"}),(0,J.jsx)(ae.nA,{type:"button",variant:"contained",style:{margin:5,width:"auto"},onClick:function(){ye(n,"status","draft"),s()},customColor:{background:se.palette.grey[200],color:se.palette.grey[600]},startIcon:(0,J.jsx)(te.A,{}),label:"Guardar"}),(ie.roles.includes("publisher")||ie.roles.includes("admin"))&&(0,J.jsx)(ae.nA,{type:"button",style:{margin:5,width:"auto"},onClick:function(){ye(n,"status","published"),s()},startIcon:(0,J.jsx)(ee.A,{}),label:"Publicar"})]}),M.length>1&&(0,J.jsxs)(k.A,{children:[1!==W&&(0,J.jsx)(ae.nA,{variant:"contained",onClick:function(){G(1===W?1:W-1)},style:{margin:5,width:"auto"},startIcon:(0,J.jsx)($.A,{})}),W!==M.length&&(0,J.jsx)(ae.nA,{variant:"contained",onClick:function(){W===M.length?G(M.length):G(W+1)},style:{margin:5,width:"auto"},startIcon:(0,J.jsx)(Y.A,{})})]})]})]})})}})]}),_.length>0&&(0,J.jsx)(ne.EL,{style:{width:"100%",marginLeft:0,marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start",overflow:"auto",flexGrow:1},children:(0,J.jsx)(X,{files:_,resourceId:Z,deleteFile:function(e){var t=_.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=(0,j.A)(_);n[t].deleted=!n[t].deleted,z((0,j.A)(n))}else{var a=_;e.deleted=!0,a.push(e),z((0,j.A)(a))}},updateFile:function(e){var t=_.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=(0,j.A)(_);n[t]=e,z((0,j.A)(n))}else{var a=_;a.push(e),z((0,j.A)(a))}}})})]})})},fe=n(14533),pe=n(69389),he=(0,c.A)((function(e){return{tituloBloque:{top:0,fontSize:15,fontWeight:"bold",padding:"10px 15px",position:"sticky",zIndex:10,width:"100%",left:0,background:"#e6e6e6",borderTopLeftRadius:10,borderTopRightRadius:10,color:"#56749a",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},breadcrumbs:{padding:"5px 15px",background:"#56749a",position:"sticky",color:"#fff",borderBottomLeftRadius:10,borderBottomRightRadius:10,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},linkBreadcrumb:{color:"#fff",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:200,display:"inline-block","&:hover":{color:"#fff"}},selectedBread:{color:"#fff !important",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:150,backgroundColor:"rgba(255,255,255,.2)",display:"inline-block",padding:"0 5px",borderRadius:2},columnas:{display:"flex",height:"calc(100vh - 150px)"},toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}},bloque:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}}}})),ge=function(e){var t,n=(0,s.useState)([]),c=(0,i.A)(n,2),j=c[0],w=c[1],k=(0,s.useState)(null),S=(0,i.A)(k,2),C=S[0],T=S[1],F=(0,s.useState)(!1),R=(0,i.A)(F,2),E=R[0],L=R[1],I=(0,s.useState)(!1),N=(0,i.A)(I,2),q=N[0],D=N[1],_=(0,s.useState)(null),z=(0,i.A)(_,2),B=z[0],P=z[1],M=(0,s.useState)(null),O=(0,i.A)(M,2),V=O[0],H=O[1],W=(0,s.useState)(null),G=(0,i.A)(W,2),U=G[0],Q=G[1],Z=(0,s.useState)([]),K=(0,i.A)(Z,2),X=K[0],Y=K[1],$=(0,s.useState)(!1),ee=(0,i.A)($,2),te=ee[0],ie=ee[1],se=(0,l.zy)(),oe=(0,l.g)().slug,ce=(0,l.Zp)(),de=he(),ge=(0,g.A)(),ye=(0,r.d4)((function(e){return e.app.filters})),me=(0,s.useState)(!(null===(t=ye.cataloging)||void 0===t||!t.status)&&"draft"===ye.cataloging.status),xe=(0,i.A)(me,2),ve=xe[0],Ae=xe[1],be=(0,le.M)().showAlert,je=(0,r.d4)((function(e){return e.app.isDarkMode})),we=(0,r.wA)();(0,s.useEffect)((function(){ke()}),[se.pathname]),(0,s.useEffect)((function(){ye.cataloging&&(ye.cataloging.parents?Y(ye.cataloging.parents):Y([]))}),[ye]);var ke=function(){var e=se.pathname.split("/").filter((function(e){return""!==e}));e.length>2&&"new"===e[2]?(D(!0),H(null)):e.length>2&&"edit"===e[2]?(D(!0),H(e[3])):(D(!1),H(null))};(0,s.useEffect)((function(){var e;oe?u.Pw(oe).then((function(e){T(e),P({fields:[e.metadata.fields],forms:[{name:e.metadata.name,slug:e.metadata.slug}]});var t=(0,a.A)({},ye);we((0,o.vm)((0,o.e)(t,"cataloging","post_type",{slug:oe})))})).catch((function(e){be("Error","No se encontr\xf3 el tipo de contenido seleccionado").then((function(){ce("/cataloging")}))})):null!==(e=ye.cataloging)&&void 0!==e&&e.post_type?ce("/cataloging/"+ye.cataloging.post_type.slug):f.gD().then((function(e){ce("/cataloging/"+e.value)})).catch((function(e){be("Error","No se encontr\xf3 el tipo de contenido por defecto").then((function(){ce("/cataloging")}))}))}),[se.pathname]),(0,s.useEffect)((function(){u.DI().then((function(e){w(e)})),ke()}),[]);return(0,J.jsxs)(ne.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:te?"center":"flex-start"},children:[!q&&C&&(0,J.jsxs)(ne.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"600px",display:"block",overflow:"auto",placeContent:"flex-start"},children:[(0,J.jsx)(p.A,{className:de.toolbar,style:{background:ge.palette.primary.light},children:C&&(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)("div",{style:{marginLeft:"24px",color:ge.palette.primary.main},children:y.dR.find((function(e){return e.value===C.icon})).icon}),(0,J.jsx)(d.A,{variant:"h6",style:{flexGrow:1,marginLeft:15,color:ge.palette.primary.main},children:C.name})]})}),(0,J.jsxs)("div",{style:{padding:10},children:[(0,J.jsx)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0},children:(0,J.jsx)(ae.nA,{startIcon:(0,J.jsx)(v.A,{}),label:"Crear nuevo",style:{borderRadius:5,backgroundColor:ge.palette.success.light,color:ge.palette.success.main},onClick:function(){return ce("/cataloging/"+oe+"/new")}})}),(0,J.jsx)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0},children:(0,J.jsx)(ae.nA,{startIcon:(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(m.A,{}),(0,J.jsx)(x.A,{})]}),label:"Descargar inventario",style:{borderRadius:5,backgroundColor:je?ge.palette.grey[800]:ge.palette.grey[200],color:ge.palette.grey[500]},onClick:function(){be("confirm","\xbfDesea descargar el inventario de este tipo de contenido?").then((function(e){e&&f.eP("inventoryMaker",JSON.stringify({post_type:C.slug,parent:U,status:ve?"draft":"published"})).then((function(e){be("info",e.msg)})).catch((function(e){e.json().then((function(e){be("error",e.msg)}))}))}))}})}),(0,J.jsxs)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:E?20:0},children:[(0,J.jsx)(d.A,{style:{color:je?ge.palette.primary.light:ge.palette.primary.main,fontSize:15},children:"Ver informaci\xf3n"}),(0,J.jsx)(h.A,{checked:E,onChange:function(){return L(!E)}})]}),!E&&(0,J.jsxs)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:20},children:[(0,J.jsx)(d.A,{style:{color:je?ge.palette.primary.light:ge.palette.primary.main,fontSize:15},children:"Ver borradores"}),(0,J.jsx)(h.A,{checked:ve,onChange:function(){Ae(!ve);var e=(0,a.A)({},ye);we((0,o.vm)((0,o.e)(e,"cataloging","status",ve?"published":"draft")))}})]}),(0,J.jsx)(A.oF,{parents:j,view:"cataloging",onChange:function(e){T(null),L(!1),q||"*"===e.target.value?q||"*"===e.target.value||ce("/cataloging/"+e.target.value+"/new"):ce("/cataloging/"+e.target.value)}}),(0,J.jsx)(pe.A,{root:null,activeTypes:[{slug:oe}],postType:oe,view:"list",checkboxTypes:j.map((function(e){return e.slug})),multiple:!1,selected:[X],childrenSelect:!1,setSelected:function(e){if(0===e.length){var t=(0,o.e)(ye,"cataloging","parents",null);we((0,o.vm)(t))}else{var n=(0,o.e)(ye,"cataloging","parents",e[0]);we((0,o.vm)(n))}}},C?[C.slug]:j)]})]}),!C&&(0,J.jsx)(re.A,{}),E&&C&&(0,J.jsx)(ne.EL,{style:{width:"calc(100% - 35px)",marginLeft:0,marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start"},children:(0,J.jsx)(b.Ay,{selectedType:C})}),q&&C&&!E&&!V&&(0,J.jsx)(ue,{user:e.user,selectedType:C,setLoading:ie}),q&&C&&!E&&V&&(0,J.jsx)(ue,{user:e.user,selectedType:C,selectedResource:V,setLoading:ie}),!q&&C&&!E&&(0,J.jsx)(fe.A,{forms:B,view:"cataloging",viewDrafts:ve,history:e.history,selectedType:C,setSelected:Q},oe),te&&(0,J.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",position:"fixed",top:0,left:0,background:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(5px) saturate(0%)",zIndex:9999},children:(0,J.jsx)(re.A,{})})]})},ye=ge},14533:function(e,t,n){var a=n(89379),i=n(5544),s=n(65043),l=n(83003),r=n(73216),o=n(85211),c=n(72378),d=n(91181),u=n(76445),f=n(29464),p=n(81551),h=n(70579),g=(0,p.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"}}}));t.A=function(e){g();var t=(0,s.useState)(null),n=(0,i.A)(t,2),p=n[0],y=n[1],m=(0,s.useState)(null),x=(0,i.A)(m,2),v=x[0],A=x[1],b=(0,s.useState)([]),j=(0,i.A)(b,2),w=(j[0],j[1]),k=(0,s.useState)(0),S=(0,i.A)(k,2),C=S[0],T=S[1],F=(0,s.useState)([]),R=(0,i.A)(F,2),E=R[0],L=R[1],I=(0,s.useState)(!1),N=(0,i.A)(I,2),q=N[0],D=N[1],_=(0,s.useState)(""),z=(0,i.A)(_,2),B=z[0],P=(z[1],(0,s.useState)("")),M=(0,i.A)(P,2),O=M[0],V=(M[1],(0,r.Zp)()),H=(0,l.wA)(),W=(0,l.d4)((function(e){return e.app.filters}));return(0,s.useEffect)((function(){e.selectedType.parentsTypes?e.selectedType.parentsTypes.length>0?y("multiple"):e.selectedType.hierarchical?y("tree"):y("single"):y(null)}),[e.selectedType]),(0,s.useEffect)((function(){e.setSelected&&v?e.setSelected(v.id):e.setSelected&&e.setSelected(null)}),[v]),(0,s.useEffect)((function(){var e=(0,a.A)({},W);H((0,o.vm)((0,o.e)(e,"cataloging","keyword",B)))}),[B]),(0,s.useEffect)((function(){A(null),w([]);var e=(0,a.A)({},W);e=(0,o.e)(e,"cataloging","parents",null),e=(0,o.e)(e,"cataloging","treeKeyword",O),H((0,o.vm)(e))}),[O]),(0,s.useEffect)((function(){var t=(0,a.A)({},W);t=(0,o.e)(t,"cataloging","status",e.viewDrafts?"draft":"published")}),[e.viewDrafts]),(0,h.jsx)("div",{style:(0,a.A)({display:"flex",height:"100%",width:"100%",flexDirection:"column"},e.style),children:p&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.EL,{style:{width:"calc(100% - 40px)",height:"55px",overflowX:"hidden",marginLeft:0,marginBottom:0},children:(0,h.jsx)(d.A,{total:C,showFilters:q,setShowFilters:D,activeFilters:E,setActiveFilters:e.forms?L:null,view:e.view})}),(0,h.jsxs)(c.EL,{id:"dropzone_scroll",onScroll:function(e){},style:{width:"calc(100% - 40px)",height:"calc(100% - 40px)",overflowX:"hidden",marginLeft:0,placeContent:"flex-start"},children:[!q&&(0,h.jsx)(u.A,{selectedType:e.selectedType,filters:W,type:e.type,editBtns:!0,parentTotal:T,handleClick:function(t){"checkbox"===e.type?e.setSelectedResources(t.id):V("/detail/".concat(t.id))},selectedResources:e.selectedResources,view:e.view}),q&&(0,h.jsx)(f.n,{forms:e.forms,activeFilters:E,setActiveFilters:L,view:e.view})]})]})})}},96795:function(e,t,n){var a=n(58168),i=n(80045),s=n(65043),l=n(43024),r=n(47573),o=n(66187),c=s.forwardRef((function(e,t){var n=e.action,r=e.avatar,c=e.classes,d=e.className,u=e.component,f=void 0===u?"div":u,p=e.disableTypography,h=void 0!==p&&p,g=e.subheader,y=e.subheaderTypographyProps,m=e.title,x=e.titleTypographyProps,v=(0,i.A)(e,["action","avatar","classes","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"]),A=m;null==A||A.type===o.A||h||(A=s.createElement(o.A,(0,a.A)({variant:r?"body2":"h5",className:c.title,component:"span",display:"block"},x),A));var b=g;return null==b||b.type===o.A||h||(b=s.createElement(o.A,(0,a.A)({variant:r?"body2":"body1",className:c.subheader,color:"textSecondary",component:"span",display:"block"},y),b)),s.createElement(f,(0,a.A)({className:(0,l.default)(c.root,d),ref:t},v),r&&s.createElement("div",{className:c.avatar},r),s.createElement("div",{className:c.content},A,b),n&&s.createElement("div",{className:c.action},n))}));t.A=(0,r.A)({root:{display:"flex",alignItems:"center",padding:16},avatar:{flex:"0 0 auto",marginRight:16},action:{flex:"0 0 auto",alignSelf:"flex-start",marginTop:-8,marginRight:-8},content:{flex:"1 1 auto"},title:{},subheader:{}},{name:"MuiCardHeader"})(c)},22505:function(e,t,n){var a=n(24994);t.A=void 0;var i=a(n(40039)),s=n(70579);t.A=(0,i.default)((0,s.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},44448:function(e,t,n){var a=n(24994);t.A=void 0;var i=a(n(40039)),s=n(70579);t.A=(0,i.default)((0,s.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore")},56658:function(e,t,n){var a=n(24994);t.A=void 0;var i=a(n(40039)),s=n(70579);t.A=(0,i.default)((0,s.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext")},43485:function(e,t,n){var a=n(24994);t.A=void 0;var i=a(n(40039)),s=n(70579);t.A=(0,i.default)((0,s.jsx)("path",{d:"M5 4v2h14V4zm0 10h4v6h6v-6h4l-7-7z"}),"Publish")},94329:function(e,t,n){var a=n(24994);t.A=void 0;var i=a(n(40039)),s=n(70579);t.A=(0,i.default)((0,s.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},99562:function(e,t,n){var a=n(24994);t.A=void 0;var i=a(n(40039)),s=n(70579);t.A=(0,i.default)((0,s.jsx)("path",{d:"M22 5.18 10.59 16.6l-4.24-4.24 1.41-1.41 2.83 2.83 10-10zm-2.21 5.04c.13.57.21 1.17.21 1.78 0 4.42-3.58 8-8 8s-8-3.58-8-8 3.58-8 8-8c1.58 0 3.04.46 4.28 1.25l1.44-1.44C16.1 2.67 14.13 2 12 2 6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10c0-1.19-.22-2.33-.6-3.39z"}),"TaskAlt")},47260:function(e,t,n){var a=n(24994);t.A=void 0;var i=a(n(40039)),s=n(70579);t.A=(0,i.default)((0,s.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")}}]);
//# sourceMappingURL=9117.249dac9d.chunk.js.map