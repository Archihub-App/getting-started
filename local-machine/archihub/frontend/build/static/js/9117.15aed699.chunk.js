"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[9117],{79117:function(e,t,n){n.r(t),n.d(t,{Main:function(){return me},default:function(){return ve}});var i=n(89379),a=n(5544),l=n(65043),r=n(73216),s=n(83003),o=n(85211),c=n(81551),d=n(66187),u=n(31445),f=n(19853),p=n(55263),h=n(4598),g=n(26240),y=n(88120),x=n(18751),m=n(92429),v=n(22505),A=n(42588),b=n(19541),j=n(24765),w=n(60436),k=n(16702),C=n(30105),S=n(10765),T=n(63516),F=n(78717),R=n(66885),E=n(94072),B=(n(91181),n(749)),I=n(96795),O=n(19227),q=n(97563),L=n(18219),_=n(65240),D=n(17392),N=n(63471),P=n(58293),z=n(19090),H=n(65892),G=n(47260),V=n(68641),W=n(36795),J=n(31269),U=n(92392),M=n(63573),Q=n(70579),Z=H.UMr(H.Ks0),K=(0,_.A)((function(e){return{card:{margin:5,"&.deleted":{backgroundColor:"#f44336",color:"#fff",textDecoration:"line-through"}},gridCard:{margin:5,width:100,height:100}}})),X=function(e){var t,n,r,s=K(),o=(0,l.useState)([]),c=(0,a.A)(o,2),d=c[0],u=c[1],p=(0,l.useState)(!1),h=(0,a.A)(p,2),g=h[0],y=h[1],x=(0,l.useState)(null),m=(0,a.A)(x,2),v=m[0],A=m[1];(0,l.useEffect)((function(){if(null!==e.file){var t=(0,i.A)({},e.file);"displayName"in t||(t.displayName=t.name),"accessRights"in t||(t.accessRight="public"),A(t)}}),[]),(0,l.useEffect)((function(){f.WP().then((function(e){u([{id:"public",term:"P\xfablica"}].concat((0,w.A)(e.options)))}))}),[e.file]);var b=function(t){e.onUpdate(t)};return(0,Q.jsxs)(B.A,{className:"".concat(s.card," ").concat(e.file.deleted?"deleted":""),children:[(0,Q.jsx)(I.A,{title:(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Q.jsx)("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"calc(100% - 200px)"},children:e.file.displayName}),(0,Q.jsxs)("div",{children:[(0,Q.jsx)(O.A,{label:e.file.tag,style:{marginLeft:5,marginRight:15,backgroundColor:Z(e.file.tag),color:"#fff"},size:"small"}),(0,Q.jsx)(D.A,{onClick:function(){e.onDeleted(e.file)},size:"small",children:(0,Q.jsx)(N.A,{})}),(null===(t=e.file)||void 0===t||null===(n=t.processing)||void 0===n||null===(r=n.fileProcessing)||void 0===r?void 0:r.type)&&(0,Q.jsx)(D.A,{onClick:function(){e.setDetailView(v)},children:(0,Q.jsx)(G.A,{})})]})]}),style:{padding:5},disableTypography:!0,action:(0,Q.jsx)(Q.Fragment,{children:(0,Q.jsx)(D.A,{onClick:function(){y(!g)},children:(0,Q.jsx)(P.A,{})})})}),(0,Q.jsx)(q.A,{in:g,children:v&&(0,Q.jsxs)(L.A,{style:{padding:5},children:[(0,Q.jsx)(S.BR,{name:"Nombre del archivo",value:v.displayName,handleChange:function(e){var t=(0,i.A)({},v);t.displayName=e.target.value,A(t),b(t)}}),(0,Q.jsx)(S.Q5,{name:"Derechos de acceso",options:d.map((function(e){return{value:e.id,label:e.term}})),value:v.accessRights?v.accessRights:"public",handleChange:function(e){var t=(0,i.A)({},v);t.accessRights=e.target.value,A(t),b(t)}})]})})]},e.key)},Y=function(e){var t=K();return(0,Q.jsx)(B.A,{className:t.gridCard,children:(0,Q.jsx)(L.A,{})},e.key)},$=function(e){K();var t,n,i,r,s=(0,l.useState)("list"),o=(0,a.A)(s,2),c=o[0],d=(o[1],(0,l.useState)(!1)),u=(0,a.A)(d,2),f=u[0],h=u[1],y=(0,l.useState)([]),x=(0,a.A)(y,2),m=x[0],v=x[1],A=(0,l.useState)(0),b=(0,a.A)(A,2),j=b[0],w=b[1],C=(0,l.useState)(0),S=(0,a.A)(C,2),T=S[0],R=S[1],E=(0,g.A)();return(0,l.useEffect)((function(){console.log(f)}),[f]),(0,l.useEffect)((function(){F.tB(e.resourceId,j).then((function(e){v(e.data),R(e.total)})).catch((function(e){console.log(e)}))}),[e.resourceId,j]),(0,Q.jsxs)(Q.Fragment,{children:[f&&(0,Q.jsxs)(k.A,{style:{width:"100%"},children:[(0,Q.jsx)(p.A,{children:(0,Q.jsx)(D.A,{onClick:function(){h(!1)},children:(0,Q.jsx)(V.A,{})})}),(0,Q.jsxs)(k.A,{style:{height:"calc(100vh - 120px)",backgroundColor:E.palette.grey[900]},children:["image"===(null===f||void 0===f||null===(t=f.processing)||void 0===t||null===(n=t.fileProcessing)||void 0===n?void 0:n.type)&&(0,Q.jsx)(W.Q,{backend:J.t2,children:(0,Q.jsx)(U.A,{id:f.id})}),"document"===(null===f||void 0===f||null===(i=f.processing)||void 0===i||null===(r=i.fileProcessing)||void 0===r?void 0:r.type)&&(0,Q.jsx)(W.Q,{backend:J.t2,children:(0,Q.jsx)(M.A,{id:f.id,view:"viz"})})]})]}),"list"===c&&T>0&&!f&&(0,Q.jsxs)(k.A,{style:{width:"100%"},children:[m.map((function(t,n){return(0,Q.jsx)(X,{file:t,onDeleted:function(){e.deleteFile(t)},onUpdate:function(t){e.updateFile(t)},setDetailView:h},n)})),(0,Q.jsx)(z.A,{rowsPerPage:10,rowsPerPageOptions:[],count:T,page:j,onPageChange:function(e,t){w(t)},sx:{padding:0,display:"block"}})]}),"grid"===c&&T>0&&(0,Q.jsxs)(k.A,{children:[(0,Q.jsx)(k.A,{style:{width:"100%",display:"flex",flexWrap:"wrap"},children:m.map((function(t,n){return(0,Q.jsx)(Y,{file:t,onDeleted:function(){e.deleteFile(t)},onUpdate:function(t){e.updateFile(t)}},n)}))}),(0,Q.jsx)(z.A,{rowsPerPage:10,rowsPerPageOptions:[],count:T,page:j,onPageChange:function(e,t){w(t)},sx:{padding:0,display:"block"}})]})]})},ee=n(56658),te=n(44448),ne=n(43485),ie=n(94329),ae=n(30064),le=n.n(ae),re=n(72378),se=n(11238),oe=n(86279),ce=n(99562),de=n(58140),ue=n(43288),fe=function(e){var t=(0,l.useState)(null),n=(0,a.A)(t,2),r=n[0],o=n[1],c=(0,l.useState)(!0),d=(0,a.A)(c,2),u=d[0],f=d[1],p=(0,g.A)(),h=(0,de.M)().showAlert,y=(0,s.d4)((function(e){return e.user}));return(0,l.useEffect)((function(){oe.Qs(e.id).then((function(e){f(!1),o(e),console.log(e)})).catch((function(e){f(!1),o(null)}))}),[]),(0,l.useEffect)((function(){console.log(y,r)}),[y,r]),(0,Q.jsxs)(Q.Fragment,{children:[u&&(0,Q.jsx)(ue.A,{}),!r&&!u&&(0,Q.jsx)(se.nA,{style:{borderRadius:5},customColor:{background:p.palette.grey[200],color:p.palette.primary.main},startIcon:(0,Q.jsx)(ce.A,{}),onClick:function(){h("taskForm","create").then((function(t){t&&(f(!0),o(null),oe.UT(JSON.stringify((0,i.A)((0,i.A)({},t),{},{resourceId:e.id}))).then((function(e){f(!1),o(e)})).catch((function(e){console.log(e)})))}))},label:"Crear nueva tarea de catalogaci\xf3n"}),r&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(se.nA,{style:{borderRadius:5},customColor:{background:p.palette.grey[200],color:p.palette.primary.main},startIcon:(0,Q.jsx)(ce.A,{}),label:"Tarea asignada a ".concat(r.user)}),(0,Q.jsx)(re.WB,{children:(0,Q.jsx)("div",{dangerouslySetInnerHTML:{__html:r.comment.replace(/\n/g,"<br />")}})}),("pending"===r.status||"rejected"===r.status)&&r.user===y.name&&(0,Q.jsx)(se.nA,{style:{marginTop:10,borderRadius:5},customColor:{background:p.palette.grey[200],color:p.palette.grey[600]},onClick:function(){h("taskForm","update").then((function(e){e&&(f(!0),o(null),oe.lC(r._id,JSON.stringify((0,i.A)((0,i.A)({},e),{},{status:"review"}))).then((function(e){f(!1),o(e)})).catch((function(e){console.log(e)})))}))},label:"Enviar tarea a revisi\xf3n"}),"review"===r.status&&y.roles.includes("team_lead")&&(0,Q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginTop:10,width:"100%"},children:[(0,Q.jsx)(se.nA,{style:{borderRadius:5,margin:2},customColor:{background:p.palette.grey[200],color:p.palette.grey[600]},onClick:function(){h("taskForm","update").then((function(e){e&&(f(!0),o(null),oe.lC(r._id,JSON.stringify((0,i.A)((0,i.A)({},e),{},{status:"rejected"}))).then((function(e){f(!1),o(e)})).catch((function(e){console.log(e)})))}))},label:"Rechazar tarea"}),(0,Q.jsx)(se.nA,{style:{borderRadius:5,margin:2},customColor:{background:p.palette.grey[200],color:p.palette.grey[600]},onClick:function(){h("taskForm","update").then((function(e){e&&(f(!0),o(null),oe.lC(r._id,JSON.stringify((0,i.A)((0,i.A)({},e),{},{status:"approved"}))).then((function(e){f(!1),o(null)})).catch((function(e){f(!1),o(null)})))}))},label:"Finalizar tarea"})]})]})]})},pe=(0,c.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 170px)"},alert_detail:{fontSize:13,background:"#f27474",color:"white",padding:"2px",borderRadius:"5px",margin:"2px"}}})),he=function(e){var t=pe(),n=l.useState(null),i=(0,a.A)(n,2),o=i[0],c=i[1],u=l.useState(!1),f=(0,a.A)(u,2),p=f[0],h=f[1],y=l.useState({}),x=(0,a.A)(y,2),m=x[0],v=x[1],A=l.useState([]),b=(0,a.A)(A,2),B=b[0],I=b[1],O=l.useState({}),q=(0,a.A)(O,2),L=q[0],_=q[1],D=l.useState([]),N=(0,a.A)(D,2),P=N[0],z=N[1],H=l.useState([]),G=(0,a.A)(H,2),V=G[0],W=G[1],J=l.useState(1),U=(0,a.A)(J,2),M=U[0],Z=U[1],K=(0,r.Zp)(),X=(0,r.g)(),Y=X.id,ae=X.slug,oe=(0,s.d4)((function(e){return e.user})),ce=(0,g.A)();(0,l.useEffect)((function(){Y?(h(!0),F.HD(Y).then((function(t){t&&(t.msg?le().fire({title:"Error",text:t.msg,icon:"error",confirmButtonText:"Aceptar"}).then((function(){he("/cataloging/".concat(e.selectedType.slug))})):(h(!0),t.files=[],v(t),z(t.filesObj),t.parents&&c(t.parents[0]),I(t.parents)))})).catch((function(t){t.json().then((function(t){le().fire({title:"Error!",text:t.msg,icon:"error",confirmButtonText:"Aceptar"}).then((function(){he("/cataloging/".concat(e.selectedType.slug))}))}))}))):(h(!1),ue())}),[Y,ae]),(0,l.useEffect)((function(){if(e.selectedType){var t=e.selectedType.metadata.fields,n=de(t);W(n)}}),[e.selectedType]);var de=function(e){var t=[],n=[];return e.forEach((function(e,i){"separator"===e.type?(t.push(n),(n=[]).push(e)):n.push(e)})),t.push(n),t},ue=function(){var t={files:[]};t.post_type=e.selectedType.slug,t.parents=[o],v(t)},he=function(e){K("".concat(e))},ge=function(e,t){var n,i=t.split("."),a=e,l=(0,j.A)(i);try{for(l.s();!(n=l.n()).done;){if(void 0===(a=a[n.value]))return}}catch(r){l.e(r)}finally{l.f()}return a},ye=function(e,t,n){var i,a=t.split("."),l=0,r=(0,j.A)(a);try{for(r.s();!(i=r.n()).done;){var s=i.value;++l===a.length?e[s]=n:e=e[s]}}catch(o){r.e(o)}finally{r.f()}};return(0,Q.jsx)(Q.Fragment,{children:Object.keys(m).length>0&&(0,Q.jsxs)(Q.Fragment,{children:[e.selectedType.parentsTypes.length>0||e.selectedType.hierarchical?(0,Q.jsx)(Q.Fragment,{children:(0,Q.jsx)(re.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"100%",display:"block",overflow:"auto",placeContent:"flex-start",flexGrow:5,maxWidth:"400px"},children:(0,Q.jsx)(E.G,{parents:e.selectedType.parentsTypes,setFondo:function(e,t){if(o&&t)if(o.id===e.id){var n=t.filter((function(t){return t.id!==e.id}));c(null),I((0,w.A)(n))}else c(e),I([].concat((0,w.A)(t),[e]));else t?(c(e),I([].concat((0,w.A)(t),[e]))):o?o.id===e.id&&(c(null),I([])):(c(e),I([e]))},activeTypes:(0,w.A)(e.selectedType.parentsTypes),childrenEditing:!0,selected:o?[o]:[],path:B})})}):(0,Q.jsx)(Q.Fragment,{}),(0,Q.jsxs)(re.EL,{style:{width:"100%",marginLeft:e.selectedType.parentsTypes.length>0||e.selectedType.hierarchical?0:"10px",marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start",maxWidth:"600px",overflow:"auto",flexGrow:1},children:[oe.roles.includes("team_lead")&&(0,Q.jsx)(fe,{id:Y}),(0,Q.jsx)(T.l1,{initialValues:m,onSubmit:function(n,i){var a=i.setSubmitting;p?(a(!1),le().fire({title:"\xbfEst\xe1s seguro?",text:"Se modificar\xe1 el recurso",icon:"warning",showCancelButton:!0}).then((function(i){if(i.isConfirmed){le().fire({text:"Guardando recurso...",allowOutsideClick:!1,showConfirmButton:!1,willOpen:function(){le().showLoading()}}),n.parents=o?[{id:o.id,post_type:o.post_type}]:null,n.parent=o?[{id:o.id,post_type:o.post_type}]:null,(void 0===n.accessRights||"none"===n.accessRights)&&(n.accessRights="public");var a=new FormData,l=[],r=[],s=[];n.files?(n.filesIds=[],n.files.forEach((function(e,t){"string"!==typeof e.file&&e.file&&(a.append("files",e.file),n.filesIds.push({file:t,filetag:e.id}))})),P.forEach((function(e){e.deleted?r.push(e.id):(l.push(e.id),s.push(e))})),n.files=l,n.deletedFiles=r,n.updatedFiles=s):n.files=[],a.append("data",JSON.stringify(n)),F.aH(Y,a).then((function(t){le().close(),he("/cataloging/".concat(e.selectedType.slug))})).catch((function(e){e.json().then((function(e){e.errors&&_(e.errors);var n=Object.keys(e.errors).map((function(n){return R.renderToString((0,Q.jsx)("div",{className:t.alert_detail,children:"".concat(n,": ").concat(e.errors[n])}))}));n=n.join(""),le().fire({title:"Error!",html:"".concat(e.msg," ").concat(n),icon:"error",confirmButtonText:"Ok"})}))}))}}))):(a(!1),le().fire({title:"\xbfEst\xe1s seguro?",text:"Se crear\xe1 un nuevo recurso",icon:"warning",showCancelButton:!0}).then((function(e){if(e.isConfirmed){le().fire({text:"Guardando recurso...",allowOutsideClick:!1,showConfirmButton:!1,willOpen:function(){le().showLoading()}}),n.parents=o?[{id:o.id,post_type:o.post_type}]:null,n.parent=o?[{id:o.id,post_type:o.post_type}]:null,(void 0===n.accessRights||"none"===n.accessRights)&&(n.accessRights="public");var t=new FormData;n.filesIds=[],n.files.forEach((function(e,i){t.append("files",e.file),n.filesIds.push({file:i,filetag:e.id})})),n.files=[],t.append("data",JSON.stringify(n)),F.ji(t).then((function(e){le().close()})).catch((function(e){e.json().then((function(e){e.errors&&_(e.errors),le().fire({title:"Error!",text:e.msg,icon:"error",confirmButtonText:"Ok"})}))}))}})))},children:function(t){var n=t.values,i=(t.errors,t.touched,t.handleChange),a=t.handleBlur,l=t.handleSubmit,r=(t.isSubmitting,t.setFieldValue);return(0,Q.jsx)("form",{onSubmit:l,children:e.selectedType.metadata&&(0,Q.jsxs)(Q.Fragment,{children:[V[M-1].map((function(e,t){return(0,Q.jsxs)(Q.Fragment,{children:["file"===e.type&&(0,Q.jsx)(S.U0,{name:e.label,id:e.filetag,values:n,required:e.required,change:r},e.filetag),"text"===e.type&&(0,Q.jsx)(S.BR,{name:e.label,id:e.destiny,handleChange:i,handleBlur:a,value:ge(n,e.destiny),required:e.required,errors:L[e.destiny]}),"text-area"===e.type&&(0,Q.jsx)(S.QA,{name:e.label,id:e.destiny,handleChange:i,handleBlur:a,value:ge(n,e.destiny),required:e.required,errors:L[e.destiny]}),"select"===e.type&&(0,Q.jsx)(S.wd,{name:e.label,id:e.destiny,handleChange:i,handleBlur:a,value:ge(n,e.destiny)?ge(n,e.destiny):"none",required:e.required,options:e.list,errors:L[e.destiny],destiny:e.destiny}),"select-multiple2"===e.type&&(0,Q.jsx)(S.lH,{handleChange:function(t){r(e.destiny,t)},id:e.destiny,name:e.label,field:e,required:e.required,value:ge(n,e.destiny),errors:L[e.destiny]}),"author"===e.type&&(0,Q.jsx)(T.ED,{name:e.destiny,children:function(t){var i=t.insert,a=t.remove,l=t.push,s=t.move;return(0,Q.jsx)(S.tF,{name:e.label,id:e.destiny,insert:i,remove:a,push:l,setFieldValue:function(t){r(e.destiny,t)},move:s,value:ge(n,e.destiny)?ge(n,e.destiny):[],required:e.required,errors:L[e.destiny]})}}),"simple-date"===e.type&&(0,Q.jsx)(S.Lf,{name:e.label,id:e.destiny,setFieldValue:function(t){r(e.destiny,t)},handleBlur:a,value:ge(n,e.destiny),required:e.required,errors:L[e.destiny]}),"relation"===e.type&&(0,Q.jsx)(S.HU,{name:e.label,id:e.destiny,value:ge(n,e.destiny),required:e.required,errors:L[e.destiny],postType:e,setFieldValue:function(t){r(e.destiny,t)}}),"checkbox"===e.type&&(0,Q.jsx)(S.FO,{name:e.label,id:e.destiny,handleChange:function(t){r(e.destiny,t)},handleBlur:a,value:ge(n,e.destiny),required:e.required,errors:L[e.destiny]}),"number"===e.type&&(0,Q.jsx)(S.Z6,{name:e.label,id:e.destiny,handleChange:i,handleBlur:a,value:ge(n,e.destiny),required:e.required,errors:L[e.destiny]}),"separator"===e.type&&(0,Q.jsx)(d.A,{variant:"h6",style:{marginTop:10,marginBottom:10},children:e.label}),"location"===e.type&&(0,Q.jsx)(S.aG,{name:e.label,id:e.destiny,handleChange:i,handleBlur:a,value:ge(n,e.destiny),required:e.required,errors:L[e.destiny]})]})})),(0,Q.jsxs)(k.A,{style:{display:"flex",justifyContent:"space-between",gap:10,marginTop:10,position:"sticky",bottom:0,backgroundColor:"white"},children:[(0,Q.jsxs)(k.A,{children:[(0,Q.jsx)(se.nA,{type:"button",variant:"contained",onClick:function(){return he("/cataloging/"+e.selectedType.slug)},style:{margin:5,width:"auto"},customColor:{background:ce.palette.grey[200],color:ce.palette.grey[600]},label:"Cancelar"}),(0,Q.jsx)(se.nA,{type:"button",variant:"contained",style:{margin:5,width:"auto"},onClick:function(){ye(n,"status","draft"),l()},customColor:{background:ce.palette.grey[200],color:ce.palette.grey[600]},startIcon:(0,Q.jsx)(ie.A,{}),label:"Guardar"}),(oe.roles.includes("publisher")||oe.roles.includes("admin"))&&(0,Q.jsx)(se.nA,{type:"button",style:{margin:5,width:"auto"},onClick:function(){ye(n,"status","published"),l()},startIcon:(0,Q.jsx)(ne.A,{}),label:"Publicar"})]}),V.length>1&&(0,Q.jsxs)(k.A,{children:[(0,Q.jsx)(C.A,{variant:"contained",onClick:function(){Z(1===M?1:M-1)},disabled:1===M,style:{margin:5},startIcon:(0,Q.jsx)(te.A,{}),children:"Anterior"}),(0,Q.jsx)(C.A,{variant:"contained",onClick:function(){M===V.length?Z(V.length):Z(M+1)},disabled:M===V.length,style:{margin:5},endIcon:(0,Q.jsx)(ee.A,{}),children:"Siguiente"})]})]})]})})}})]}),P.length>0&&(0,Q.jsx)(re.EL,{style:{width:"100%",marginLeft:0,marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start",overflow:"auto",flexGrow:1},children:(0,Q.jsx)($,{files:P,resourceId:Y,deleteFile:function(e){var t=P.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=(0,w.A)(P);n[t].deleted=!n[t].deleted,z((0,w.A)(n))}else{var i=P;e.deleted=!0,i.push(e),z((0,w.A)(i))}},updateFile:function(e){var t=P.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=(0,w.A)(P);n[t]=e,z((0,w.A)(n))}else{var i=P;i.push(e),z((0,w.A)(i))}}})})]})})},ge=n(14533),ye=n(69389),xe=(0,c.A)((function(e){return{tituloBloque:{top:0,fontSize:15,fontWeight:"bold",padding:"10px 15px",position:"sticky",zIndex:10,width:"100%",left:0,background:"#e6e6e6",borderTopLeftRadius:10,borderTopRightRadius:10,color:"#56749a",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},breadcrumbs:{padding:"5px 15px",background:"#56749a",position:"sticky",color:"#fff",borderBottomLeftRadius:10,borderBottomRightRadius:10,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},linkBreadcrumb:{color:"#fff",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:200,display:"inline-block","&:hover":{color:"#fff"}},selectedBread:{color:"#fff !important",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:150,backgroundColor:"rgba(255,255,255,.2)",display:"inline-block",padding:"0 5px",borderRadius:2},columnas:{display:"flex",height:"calc(100vh - 150px)"},toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}},bloque:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}}}})),me=function(e){var t,n=(0,l.useState)([]),c=(0,a.A)(n,2),j=c[0],w=c[1],k=(0,l.useState)(null),C=(0,a.A)(k,2),S=C[0],T=C[1],F=(0,l.useState)(!1),R=(0,a.A)(F,2),E=R[0],B=R[1],I=(0,l.useState)(!1),O=(0,a.A)(I,2),q=O[0],L=O[1],_=(0,l.useState)(null),D=(0,a.A)(_,2),N=D[0],P=D[1],z=(0,l.useState)(null),H=(0,a.A)(z,2),G=H[0],V=H[1],W=(0,l.useState)(null),J=(0,a.A)(W,2),U=J[0],M=J[1],Z=(0,l.useState)([]),K=(0,a.A)(Z,2),X=K[0],Y=K[1],$=(0,l.useState)(!1),ee=(0,a.A)($,2),te=ee[0],ne=(ee[1],(0,r.zy)()),ie=(0,r.g)().slug,ae=(0,r.Zp)(),le=xe(),oe=(0,g.A)(),ce=(0,s.d4)((function(e){return e.app.filters})),fe=(0,l.useState)(!(null===(t=ce.cataloging)||void 0===t||!t.status)&&"draft"===ce.cataloging.status),pe=(0,a.A)(fe,2),me=pe[0],ve=pe[1],Ae=(0,de.M)().showAlert,be=(0,s.wA)();(0,l.useEffect)((function(){je()}),[ne.pathname]),(0,l.useEffect)((function(){ce.cataloging&&(ce.cataloging.parents?Y(ce.cataloging.parents):Y([]))}),[ce]);var je=function(){var e=ne.pathname.split("/").filter((function(e){return""!==e}));e.length>2&&"new"===e[2]?(L(!0),V(null)):e.length>2&&"edit"===e[2]?(L(!0),V(e[3])):(L(!1),V(null))};(0,l.useEffect)((function(){var e;ie?u.Pw(ie).then((function(e){T(e),P({fields:[e.metadata.fields],forms:[{name:e.metadata.name,slug:e.metadata.slug}]});var t=(0,i.A)({},ce);be((0,o.vm)((0,o.e)(t,"cataloging","post_type",{slug:ie})))})).catch((function(e){Ae("Error","No se encontr\xf3 el tipo de contenido seleccionado").then((function(){ae("/cataloging")}))})):null!==(e=ce.cataloging)&&void 0!==e&&e.post_type?ae("/cataloging/"+ce.cataloging.post_type.slug):f.gD().then((function(e){ae("/cataloging/"+e.value)})).catch((function(e){Ae("Error","No se encontr\xf3 el tipo de contenido por defecto").then((function(){ae("/cataloging")}))}))}),[ne.pathname]),(0,l.useEffect)((function(){u.DI().then((function(e){w(e)})),je()}),[]);return(0,Q.jsxs)(re.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:te?"center":"flex-start"},children:[!q&&S&&(0,Q.jsxs)(re.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"400px",display:"block",overflow:"auto",placeContent:"flex-start"},children:[(0,Q.jsx)(p.A,{className:le.toolbar,style:{background:oe.palette.primary.light},children:S&&(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)("div",{style:{marginLeft:"24px",color:oe.palette.primary.main},children:y.dR.find((function(e){return e.value===S.icon})).icon}),(0,Q.jsx)(d.A,{variant:"h6",style:{flexGrow:1,marginLeft:15,color:oe.palette.primary.main},children:S.name})]})}),(0,Q.jsxs)("div",{style:{padding:10},children:[(0,Q.jsx)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0},children:(0,Q.jsx)(se.nA,{startIcon:(0,Q.jsx)(v.A,{}),label:"Crear nuevo",style:{borderRadius:5,backgroundColor:oe.palette.success.light,color:oe.palette.success.main},onClick:function(){return ae("/cataloging/"+ie+"/new")}})}),(0,Q.jsx)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0},children:(0,Q.jsx)(se.nA,{startIcon:(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(x.A,{}),(0,Q.jsx)(m.A,{})]}),label:"Descargar inventario",style:{borderRadius:5,backgroundColor:oe.palette.grey[200],color:oe.palette.grey[500]},onClick:function(){Ae("confirm","\xbfDesea descargar el inventario de este tipo de contenido?").then((function(e){e&&f.eP("inventoryMaker",JSON.stringify({post_type:S.slug,parent:U,status:me?"draft":"published"})).then((function(e){Ae("info",e.msg)})).catch((function(e){e.json().then((function(e){Ae("error",e.msg)}))}))}))}})}),(0,Q.jsxs)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:E?20:0},children:[(0,Q.jsx)(d.A,{style:{color:oe.palette.primary.main,fontSize:15},children:"Ver informaci\xf3n"}),(0,Q.jsx)(h.A,{checked:E,onChange:function(){return B(!E)}})]}),!E&&(0,Q.jsxs)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:20},children:[(0,Q.jsx)(d.A,{style:{color:oe.palette.primary.main,fontSize:15},children:"Ver borradores"}),(0,Q.jsx)(h.A,{checked:me,onChange:function(){ve(!me);var e=(0,i.A)({},ce);be((0,o.vm)((0,o.e)(e,"cataloging","status",me?"published":"draft")))}})]}),(0,Q.jsx)(A.oF,{parents:j,view:"cataloging",onChange:function(e){T(null),B(!1),q||"*"===e.target.value?q||"*"===e.target.value||ae("/cataloging/"+e.target.value+"/new"):ae("/cataloging/"+e.target.value)}}),(0,Q.jsx)(ye.A,{root:null,activeTypes:[{slug:ie}],postType:ie,view:"list",checkboxTypes:j.map((function(e){return e.slug})),multiple:!1,selected:[X],childrenSelect:!1,setSelected:function(e){if(0===e.length){var t=(0,o.e)(ce,"cataloging","parents",null);be((0,o.vm)(t))}else{var n=(0,o.e)(ce,"cataloging","parents",e[0]);be((0,o.vm)(n))}}},S?[S.slug]:j)]})]}),!S&&(0,Q.jsx)(ue.A,{}),E&&S&&(0,Q.jsx)(re.EL,{style:{width:"calc(100% - 35px)",marginLeft:0,marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start"},children:(0,Q.jsx)(b.Ay,{selectedType:S})}),q&&S&&!E&&!G&&(0,Q.jsx)(he,{user:e.user,selectedType:S}),q&&S&&!E&&G&&(0,Q.jsx)(he,{user:e.user,selectedType:S,selectedResource:G}),!q&&S&&!E&&(0,Q.jsx)(ge.A,{forms:N,view:"cataloging",viewDrafts:me,history:e.history,selectedType:S,setSelected:M},ie)]})},ve=me},14533:function(e,t,n){var i=n(89379),a=n(5544),l=n(65043),r=n(83003),s=n(73216),o=n(85211),c=n(72378),d=n(91181),u=n(76445),f=n(29464),p=n(81551),h=n(70579),g=(0,p.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"}}}));t.A=function(e){g();var t=(0,l.useState)(null),n=(0,a.A)(t,2),p=n[0],y=n[1],x=(0,l.useState)(null),m=(0,a.A)(x,2),v=m[0],A=m[1],b=(0,l.useState)([]),j=(0,a.A)(b,2),w=(j[0],j[1]),k=(0,l.useState)(0),C=(0,a.A)(k,2),S=C[0],T=C[1],F=(0,l.useState)([]),R=(0,a.A)(F,2),E=R[0],B=R[1],I=(0,l.useState)(!1),O=(0,a.A)(I,2),q=O[0],L=O[1],_=(0,l.useState)(""),D=(0,a.A)(_,2),N=D[0],P=(D[1],(0,l.useState)("")),z=(0,a.A)(P,2),H=z[0],G=(z[1],(0,s.Zp)()),V=(0,r.wA)(),W=(0,r.d4)((function(e){return e.app.filters}));return(0,l.useEffect)((function(){e.selectedType.parentsTypes?e.selectedType.parentsTypes.length>0?y("multiple"):e.selectedType.hierarchical?y("tree"):y("single"):y(null)}),[e.selectedType]),(0,l.useEffect)((function(){e.setSelected&&v?e.setSelected(v.id):e.setSelected&&e.setSelected(null)}),[v]),(0,l.useEffect)((function(){var e=(0,i.A)({},W);V((0,o.vm)((0,o.e)(e,"cataloging","keyword",N)))}),[N]),(0,l.useEffect)((function(){A(null),w([]);var e=(0,i.A)({},W);e=(0,o.e)(e,"cataloging","parents",null),e=(0,o.e)(e,"cataloging","treeKeyword",H),V((0,o.vm)(e))}),[H]),(0,l.useEffect)((function(){var t=(0,i.A)({},W);t=(0,o.e)(t,"cataloging","status",e.viewDrafts?"draft":"published")}),[e.viewDrafts]),(0,h.jsx)("div",{style:(0,i.A)({display:"flex",height:"100%",width:"100%",flexDirection:"column"},e.style),children:p&&(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(c.EL,{style:{width:"calc(100% - 40px)",height:"55px",overflowX:"hidden",marginLeft:0,marginBottom:0},children:(0,h.jsx)(d.A,{total:S,showFilters:q,setShowFilters:L,activeFilters:E,setActiveFilters:e.forms?B:null,view:e.view})}),(0,h.jsxs)(c.EL,{id:"dropzone_scroll",onScroll:function(e){},style:{width:"calc(100% - 40px)",height:"calc(100% - 40px)",overflowX:"hidden",marginLeft:0,placeContent:"flex-start"},children:[!q&&(0,h.jsx)(u.A,{selectedType:e.selectedType,filters:W,type:e.type,editBtns:!0,parentTotal:T,handleClick:function(t){"checkbox"===e.type?e.setSelectedResources(t.id):G("/detail/".concat(t.id))},selectedResources:e.selectedResources,view:e.view}),q&&(0,h.jsx)(f.n,{forms:e.forms,activeFilters:E,setActiveFilters:B,view:e.view})]})]})})}}}]);
//# sourceMappingURL=9117.15aed699.chunk.js.map