"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[9430],{9430:function(e,t,n){n.r(t),n.d(t,{Main:function(){return ge},default:function(){return ye}});var i=n(89379),a=n(5544),s=n(65043),l=n(73216),r=n(83003),o=n(85211),d=n(81551),c=n(66187),u=n(31445),f=n(19853),p=n(55263),h=n(4598),g=n(26240),y=n(94495),m=n(18751),v=n(92429),x=n(22505),A=n(42588),b=n(19541),j=n(60436),w=n(24765),k=n(16702),S=n(24394),C=n(63516),T=n(78717),R=n(94072),F=n(99246),M=n(12110),L=n(79958),E=n(43845),I=n(30279),q=n(26494),D=n(96446),B=n(41905),N=n(17392),P=n(63471),z=n(58293),H=n(19090),_=n(49658),V=n(47260),O=n(68641),W=n(36795),G=n(31269),U=n(92392),Q=n(63573),Z=n(70579),J=_.UMr(_.Ks0),X=(0,B.A)((function(e){return{card:{margin:5,"&.deleted":{backgroundColor:"#f44336",color:"#fff",textDecoration:"line-through"}},gridCard:{margin:5,width:100,height:100}}})),K=function(e){var t,n,l,o=X(),d=(0,s.useState)([]),c=(0,a.A)(d,2),u=c[0],p=c[1],h=(0,s.useState)(!1),y=(0,a.A)(h,2),m=y[0],v=y[1],x=(0,s.useState)(null),A=(0,a.A)(x,2),b=A[0],w=A[1],k=(0,g.A)(),C=(0,r.d4)((function(e){return e.app.isDarkMode}));(0,s.useEffect)((function(){if(null!==e.file){var t=(0,i.A)({},e.file);"displayName"in t||(t.displayName=t.name),"accessRights"in t||(t.accessRight="public"),w(t)}}),[]),(0,s.useEffect)((function(){f.WP().then((function(e){p([{id:"public",term:"P\xfablica"}].concat((0,j.A)(e.options)))}))}),[e.file]);var T=function(t){e.onUpdate(t)};return(0,Z.jsxs)(M.A,{className:"".concat(o.card," ").concat(e.file.deleted?"deleted":""),style:{background:C?k.palette.grey[800]:"white"},children:[(0,Z.jsx)(L.A,{title:(0,Z.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,Z.jsx)("div",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"calc(100% - 200px)",color:C?"white":"inherit"},children:e.file.displayName}),(0,Z.jsxs)("div",{children:[(0,Z.jsx)(E.A,{label:e.file.tag,style:{marginLeft:5,marginRight:15,backgroundColor:J(e.file.tag),color:"#fff"},size:"small"}),(0,Z.jsx)(N.A,{onClick:function(){e.onDeleted(e.file)},size:"small",style:{color:C?"white":"inherit"},children:(0,Z.jsx)(P.A,{})}),(null===(t=e.file)||void 0===t||null===(n=t.processing)||void 0===n||null===(l=n.fileProcessing)||void 0===l?void 0:l.type)&&(0,Z.jsx)(N.A,{onClick:function(){e.setDetailView(b)},style:{color:C?"white":"inherit"},children:(0,Z.jsx)(V.A,{})})]})]}),style:{padding:5},disableTypography:!0,action:(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(N.A,{onClick:function(){v(!m)},children:(0,Z.jsx)(z.A,{})})})}),(0,Z.jsx)(I.A,{in:m,children:b&&(0,Z.jsxs)(q.A,{style:{padding:5},children:[(0,Z.jsx)(S.BR,{name:"Nombre del archivo",value:b.displayName,handleChange:function(e){var t=(0,i.A)({},b);t.displayName=e.target.value,w(t),T(t)}}),(0,Z.jsx)(S.Q5,{name:"Derechos de acceso",options:u.map((function(e){return{value:e.id,label:e.term}})),value:b.accessRights?b.accessRights:"public",handleChange:function(e){var t=(0,i.A)({},b);t.accessRights=e.target.value,w(t),T(t)}})]})})]},e.key)},Y=function(e){var t=X();return(0,Z.jsx)(M.A,{className:t.gridCard,children:(0,Z.jsx)(q.A,{})},e.key)},$=function(e){X();var t,n,i,l,o=(0,s.useState)("list"),d=(0,a.A)(o,2),c=d[0],u=(d[1],(0,s.useState)(!1)),f=(0,a.A)(u,2),h=f[0],y=f[1],m=(0,s.useState)([]),v=(0,a.A)(m,2),x=v[0],A=v[1],b=(0,s.useState)(0),j=(0,a.A)(b,2),w=j[0],k=j[1],S=(0,s.useState)(0),C=(0,a.A)(S,2),R=C[0],F=C[1],M=(0,g.A)();(0,r.d4)((function(e){return e.app.isDarkMode}));return(0,s.useEffect)((function(){console.log(h)}),[h]),(0,s.useEffect)((function(){T.tB(e.resourceId,w).then((function(e){A(e.data),F(e.total)})).catch((function(e){console.log(e)}))}),[e.resourceId,w]),(0,Z.jsxs)(Z.Fragment,{children:[h&&(0,Z.jsxs)(D.A,{style:{width:"100%"},children:[(0,Z.jsx)(p.A,{children:(0,Z.jsx)(N.A,{onClick:function(){y(!1)},children:(0,Z.jsx)(O.A,{})})}),(0,Z.jsxs)(D.A,{style:{height:"calc(100vh - 120px)",backgroundColor:M.palette.grey[900]},children:["image"===(null===h||void 0===h||null===(t=h.processing)||void 0===t||null===(n=t.fileProcessing)||void 0===n?void 0:n.type)&&(0,Z.jsx)(W.Q,{backend:G.t2,children:(0,Z.jsx)(U.A,{id:h.id})}),"document"===(null===h||void 0===h||null===(i=h.processing)||void 0===i||null===(l=i.fileProcessing)||void 0===l?void 0:l.type)&&(0,Z.jsx)(W.Q,{backend:G.t2,children:(0,Z.jsx)(Q.A,{id:h.id,view:"viz"})})]})]}),"list"===c&&R>0&&!h&&(0,Z.jsxs)(D.A,{style:{width:"100%"},children:[x.map((function(t,n){return(0,Z.jsx)(K,{file:t,onDeleted:function(){e.deleteFile(t)},onUpdate:function(t){e.updateFile(t)},setDetailView:y},n)})),(0,Z.jsx)(H.A,{rowsPerPage:10,rowsPerPageOptions:[],count:R,page:w,onPageChange:function(e,t){k(t)},sx:{padding:0,display:"block"}})]}),"grid"===c&&R>0&&(0,Z.jsxs)(D.A,{children:[(0,Z.jsx)(D.A,{style:{width:"100%",display:"flex",flexWrap:"wrap"},children:x.map((function(t,n){return(0,Z.jsx)(Y,{file:t,onDeleted:function(){e.deleteFile(t)},onUpdate:function(t){e.updateFile(t)}},n)}))}),(0,Z.jsx)(H.A,{rowsPerPage:10,rowsPerPageOptions:[],count:R,page:w,onPageChange:function(e,t){k(t)},sx:{padding:0,display:"block"}})]})]})},ee=n(56658),te=n(44448),ne=n(43485),ie=n(94329),ae=n(72378),se=n(11238),le=n(82094),re=n(58140),oe=(0,d.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 170px)"},alert_detail:{fontSize:13,background:"#f27474",color:"white",padding:"2px",borderRadius:"5px",margin:"2px"}}})),de=function(e){var t=e.metadata,n=e.children,i=e.values,l=e.fields,r=s.useState(null),o=(0,a.A)(r,2),d=o[0],c=o[1],u=s.useState(null),f=(0,a.A)(u,2),p=f[0],h=f[1];return(0,s.useEffect)((function(){if(t.conditionField){var e=parseInt(t.conditionField),n=l[e],a=n.destiny,s=n.type,r=function(e,t){var n,i=t.split("."),a=e,s=(0,w.A)(i);try{for(s.s();!(n=s.n()).done;)if(void 0===(a=a[n.value]))return}catch(l){s.e(l)}finally{s.f()}return a}(i,a);if(c(s),"checkbox"===s)h(r);else if("text"===s){var o=t.conditionType,d=t.conditionValueText;"equals"===o?h(r===d):"different"===o?h(r!==d):"contains"===o&&(r.includes(d)?h(!0):h(!1))}}else c("withoutCondition")}),[i]),(0,Z.jsxs)(Z.Fragment,{children:["checkbox"===d&&p&&(0,Z.jsx)(Z.Fragment,{children:n}),"text"===d&&p&&(0,Z.jsx)(Z.Fragment,{children:n}),"withoutCondition"===d&&(0,Z.jsx)(Z.Fragment,{children:n})]})},ce=function(e){oe();var t=s.useState(null),n=(0,a.A)(t,2),i=n[0],o=n[1],d=s.useState(!1),u=(0,a.A)(d,2),f=u[0],p=u[1],h=s.useState({}),y=(0,a.A)(h,2),m=y[0],v=y[1],x=s.useState([]),A=(0,a.A)(x,2),b=A[0],M=A[1],L=s.useState({}),E=(0,a.A)(L,2),I=E[0],q=E[1],D=s.useState([]),B=(0,a.A)(D,2),N=B[0],P=B[1],z=s.useState([]),H=(0,a.A)(z,2),_=H[0],V=H[1],O=s.useState(1),W=(0,a.A)(O,2),G=W[0],U=W[1],Q=(0,l.Zp)(),J=(0,l.g)(),X=J.id,K=J.slug,Y=(0,r.d4)((function(e){return e.user})),ce=(0,g.A)(),ue=(0,re.M)().showAlert,fe=(0,r.d4)((function(e){return e.app.isDarkMode})),pe=(0,F.A)();(0,s.useEffect)((function(){X?(p(!0),T.HD(X).then((function(t){t&&(t.msg?ue("error",t.msg).then((function(){ye("/cataloging/".concat(e.selectedType.slug))})):(p(!0),t.files=[],v(t),P(t.filesObj),t.parents&&o(t.parents[0]),M(t.parents)))})).catch((function(t){t.json().then((function(t){ue("error",t.msg).then((function(){ye("/cataloging/".concat(e.selectedType.slug))}))}))}))):(p(!1),ge())}),[X,K]),(0,s.useEffect)((function(){if(e.selectedType){console.log(e.selectedType);var t=e.selectedType.metadata.fields,n=he(t);V(n)}}),[e.selectedType]);var he=function(e){var t=[],n=[];return e.forEach((function(e,i){"separator"===e.type?(t.push(n),(n=[]).push(e)):n.push(e)})),t.push(n),t},ge=function(){var t={files:[]};t.post_type=e.selectedType.slug,t.parents=[i],v(t)},ye=function(e){Q("".concat(e))},me=function(e,t){var n,i=t.split("."),a=e,s=(0,w.A)(i);try{for(s.s();!(n=s.n()).done;){if(void 0===(a=a[n.value]))return}}catch(l){s.e(l)}finally{s.f()}return a},ve=function(e,t,n){var i,a=t.split("."),s=0,l=(0,w.A)(a);try{for(l.s();!(i=l.n()).done;){var r=i.value;++s===a.length?e[r]=n:e=e[r]}}catch(o){l.e(o)}finally{l.f()}};return(0,Z.jsx)(Z.Fragment,{children:Object.keys(m).length>0&&(0,Z.jsxs)(Z.Fragment,{children:[e.selectedType.parentsTypes.length>0||e.selectedType.hierarchical?(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(ae.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"100%",display:"block",overflow:"auto",placeContent:"flex-start",flexGrow:5,maxWidth:"400px",background:"white"},children:(0,Z.jsx)(R.G,{parents:e.selectedType.parentsTypes,setFondo:function(e,t){if(i&&t)if(i.id===e.id){var n=t.filter((function(t){return t.id!==e.id}));o(null),M((0,j.A)(n))}else o(e),M([].concat((0,j.A)(t),[e]));else t?(o(e),M([].concat((0,j.A)(t),[e]))):i?i.id===e.id&&(o(null),M([])):(o(e),M([e]))},activeTypes:(0,j.A)(e.selectedType.parentsTypes),childrenEditing:!0,selected:i?[i]:[],path:b})})}):(0,Z.jsx)(Z.Fragment,{}),(0,Z.jsxs)(ae.EL,{style:{width:"100%",marginLeft:e.selectedType.parentsTypes.length>0||e.selectedType.hierarchical?0:"10px",marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start",maxWidth:"600px",overflow:"auto",flexGrow:1},children:[(Y.roles.includes("team_lead")||Y.roles.includes("editor"))&&(0,Z.jsx)(le.A,{id:X}),(0,Z.jsx)(C.l1,{initialValues:m,onSubmit:function(t,n){var a=n.setSubmitting;f?(a(!1),ue("confirm",pe.formatMessage({id:"cataloging.confirmEditResource"})).then((function(n){if(n){e.setLoading(!0),t.parents=i?[{id:i.id,post_type:i.post_type}]:null,t.parent=i?[{id:i.id,post_type:i.post_type}]:null,(void 0===t.accessRights||"none"===t.accessRights)&&(t.accessRights="public");var a=new FormData,s=[],l=[],r=[];t.files?(t.filesIds=[],t.files.forEach((function(e,n){"string"!==typeof e.file&&e.file&&(a.append("files",e.file),t.filesIds.push({file:n,filetag:e.id}))})),N.forEach((function(e){e.deleted?l.push(e.id):(s.push(e.id),r.push(e))})),t.files=s,t.deletedFiles=l,t.updatedFiles=r):t.files=[],a.append("data",JSON.stringify(t)),T.aH(X,a).then((function(t){e.setLoading(!1),ue("success",t.msg)})).catch((function(t){e.setLoading(!1),t.json().then((function(e){e.errors&&q(e.errors),ue("error",e.msg,"",e.errors)}))}))}}))):(a(!1),ue("confirm",pe.formatMessage({id:"cataloging.confirmNewResource"})).then((function(n){if(n){e.setLoading(!0),t.parents=i?[{id:i.id,post_type:i.post_type}]:null,t.parent=i?[{id:i.id,post_type:i.post_type}]:null,(void 0===t.accessRights||"none"===t.accessRights)&&(t.accessRights="public");var a=new FormData;t.filesIds=[],t.files.forEach((function(e,n){a.append("files",e.file),t.filesIds.push({file:n,filetag:e.id})})),t.files=[],a.append("data",JSON.stringify(t)),T.ji(a).then((function(t){e.setLoading(!1),ue("success",t.msg)})).catch((function(t){t.json().then((function(t){e.setLoading(!1),t.errors&&q(t.errors),ue("error",t.msg)}))}))}})))},children:function(t){var n=t.values,i=(t.errors,t.touched,t.handleChange),a=t.handleBlur,s=t.handleSubmit,l=(t.isSubmitting,t.setFieldValue);return(0,Z.jsx)("form",{onSubmit:s,children:e.selectedType.metadata&&(0,Z.jsxs)(Z.Fragment,{children:[_[G-1].map((function(t,s){return(0,Z.jsxs)(Z.Fragment,{children:["file"===t.type&&(0,Z.jsx)(S.U0,{name:t.label,id:t.filetag,values:n,required:t.required,change:l},t.filetag),"text"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.BR,{field:t,name:t.label,id:t.destiny,handleChange:i,handleBlur:a,value:me(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"text-area"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.QA,{field:t,name:t.label,id:t.destiny,handleChange:i,handleBlur:a,value:me(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"select"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.wd,{field:t,name:t.label,id:t.destiny,handleChange:i,handleBlur:a,value:me(n,t.destiny)?me(n,t.destiny):"none",required:t.required,options:t.list,errors:I[t.destiny],destiny:t.destiny})}),"select-multiple2"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.lH,{field:t,handleChange:function(e){l(t.destiny,e)},id:t.destiny,name:t.label,required:t.required,value:me(n,t.destiny),errors:I[t.destiny]})}),"author"===t.type&&(0,Z.jsx)(C.ED,{name:t.destiny,children:function(e){var i=e.insert,a=e.remove,s=e.push,r=e.move;return(0,Z.jsx)(S.tF,{name:t.label,id:t.destiny,insert:i,remove:a,push:s,setFieldValue:function(e){l(t.destiny,e)},move:r,value:me(n,t.destiny)?me(n,t.destiny):[],required:t.required,errors:I[t.destiny]})}}),"simple-date"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.Lf,{field:t,name:t.label,id:t.destiny,setFieldValue:function(e){l(t.destiny,e)},handleBlur:a,value:me(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"relation"===t.type&&(0,Z.jsx)(S.HU,{name:t.label,id:t.destiny,value:me(n,t.destiny),required:t.required,errors:I[t.destiny],postType:t,setFieldValue:function(e){l(t.destiny,e)}}),"checkbox"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.FO,{name:t.label,id:t.destiny,handleChange:function(e){l(t.destiny,e)},handleBlur:a,value:me(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"number"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.Z6,{name:t.label,id:t.destiny,handleChange:i,handleBlur:a,value:me(n,t.destiny),required:t.required,errors:I[t.destiny]})}),"separator"===t.type&&(0,Z.jsx)(c.A,{variant:"h6",style:{marginTop:10,marginBottom:10,color:ce.palette.primary.main,marginLeft:10},children:t.label}),"location"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(S.aG,{name:t.label,id:t.destiny,handleChange:i,handleBlur:a,value:me(n,t.destiny),required:t.required,errors:I[t.destiny],setFieldValue:function(e){l(t.destiny,e)}})}),"repeater"===t.type&&(0,Z.jsx)(de,{metadata:t,values:n,fields:e.selectedType.metadata.fields,children:(0,Z.jsx)(C.ED,{name:t.destiny,children:function(e){var i=e.insert,a=e.remove,s=e.push,r=e.move;return(0,Z.jsx)(S._g,{subfields:t.subfields,name:t.label,id:t.destiny,insert:i,remove:a,push:s,setFieldValue:function(e){l(t.destiny,e)},move:r,value:me(n,t.destiny)?me(n,t.destiny):[],required:t.required,errors:I[t.destiny]})}})})]})})),(0,Z.jsxs)(k.A,{style:{display:"flex",justifyContent:"center",gap:10,marginTop:10,position:"sticky",bottom:0,backgroundColor:fe?ce.palette.grey[500]:ce.palette.grey[800],padding:"5px",borderRadius:"50px",boxShadow:"0px 5px 5px rgba(0,0,0,0.1)"},children:[(0,Z.jsxs)(k.A,{children:[(0,Z.jsx)(se.nA,{type:"button",variant:"contained",onClick:function(){return ye("/cataloging/"+e.selectedType.slug)},style:{margin:5,width:"auto"},customColor:{background:ce.palette.grey[200],color:ce.palette.grey[600]},label:pe.formatMessage({id:"general.cancel"})}),(0,Z.jsx)(se.nA,{type:"button",variant:"contained",style:{margin:5,width:"auto"},onClick:function(){ve(n,"status","draft"),s()},customColor:{background:ce.palette.grey[200],color:ce.palette.grey[600]},startIcon:(0,Z.jsx)(ie.A,{}),label:pe.formatMessage({id:"general.save"})}),(Y.roles.includes("publisher")||Y.roles.includes("admin"))&&(0,Z.jsx)(se.nA,{type:"button",style:{margin:5,width:"auto"},onClick:function(){ve(n,"status","published"),s()},startIcon:(0,Z.jsx)(ne.A,{}),label:pe.formatMessage({id:"general.publish"})})]}),_.length>1&&(0,Z.jsxs)(k.A,{children:[1!==G&&(0,Z.jsx)(se.nA,{variant:"contained",onClick:function(){U(1===G?1:G-1)},style:{margin:5,width:"auto"},startIcon:(0,Z.jsx)(te.A,{})}),G!==_.length&&(0,Z.jsx)(se.nA,{variant:"contained",onClick:function(){G===_.length?U(_.length):U(G+1)},style:{margin:5,width:"auto"},startIcon:(0,Z.jsx)(ee.A,{})})]})]})]})})}})]}),N.length>0&&(0,Z.jsx)(ae.EL,{style:{width:"100%",marginLeft:0,marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start",overflow:"auto",flexGrow:1},children:(0,Z.jsx)($,{files:N,resourceId:X,deleteFile:function(e){var t=N.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=(0,j.A)(N);n[t].deleted=!n[t].deleted,P((0,j.A)(n))}else{var i=N;e.deleted=!0,i.push(e),P((0,j.A)(i))}},updateFile:function(e){var t=N.findIndex((function(t){return t.id===e.id}));if(-1!==t){var n=(0,j.A)(N);n[t]=e,P((0,j.A)(n))}else{var i=N;i.push(e),P((0,j.A)(i))}}})})]})})},ue=n(14533),fe=n(43288),pe=n(69389),he=(0,d.A)((function(e){return{tituloBloque:{top:0,fontSize:15,fontWeight:"bold",padding:"10px 15px",position:"sticky",zIndex:10,width:"100%",left:0,background:"#e6e6e6",borderTopLeftRadius:10,borderTopRightRadius:10,color:"#56749a",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},breadcrumbs:{padding:"5px 15px",background:"#56749a",position:"sticky",color:"#fff",borderBottomLeftRadius:10,borderBottomRightRadius:10,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},linkBreadcrumb:{color:"#fff",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:200,display:"inline-block","&:hover":{color:"#fff"}},selectedBread:{color:"#fff !important",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",maxWidth:150,backgroundColor:"rgba(255,255,255,.2)",display:"inline-block",padding:"0 5px",borderRadius:2},columnas:{display:"flex",height:"calc(100vh - 150px)"},toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}},bloque:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:"#56749a",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:"#56749a"},"&::-webkit-scrollbar-thumb:active":{background:"#56749a"},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}}}})),ge=function(e){var t,n=(0,s.useState)([]),d=(0,a.A)(n,2),j=d[0],w=d[1],k=(0,s.useState)(null),S=(0,a.A)(k,2),C=S[0],T=S[1],R=(0,s.useState)(!1),M=(0,a.A)(R,2),L=M[0],E=M[1],I=(0,s.useState)(!1),q=(0,a.A)(I,2),D=q[0],B=q[1],N=(0,s.useState)(null),P=(0,a.A)(N,2),z=P[0],H=P[1],_=(0,s.useState)(null),V=(0,a.A)(_,2),O=V[0],W=V[1],G=(0,s.useState)(null),U=(0,a.A)(G,2),Q=U[0],J=U[1],X=(0,s.useState)([]),K=(0,a.A)(X,2),Y=K[0],$=K[1],ee=(0,s.useState)(!1),te=(0,a.A)(ee,2),ne=te[0],ie=te[1],le=(0,l.zy)(),oe=(0,l.g)().slug,de=(0,l.Zp)(),ge=he(),ye=(0,g.A)(),me=(0,r.d4)((function(e){return e.app.filters})),ve=(0,s.useState)(!(null===(t=me.cataloging)||void 0===t||!t.status)&&"draft"===me.cataloging.status),xe=(0,a.A)(ve,2),Ae=xe[0],be=xe[1],je=(0,re.M)().showAlert,we=(0,r.d4)((function(e){return e.app.isDarkMode})),ke=(0,F.A)(),Se=(0,r.wA)(),Ce={page:0,sortBy:"createdAt",sortOrder:"desc",activeColumns:[{destiny:"",label:""},{destiny:"createdAt",label:"Fecha de creaci\xf3n",sortBy:"createdAt"},{destiny:"ident",label:"Identificador"},{destiny:"metadata.firstLevel.title",label:"T\xedtulo",sortBy:"metadata.firstLevel.title"},{destiny:"files",label:"Archivos"},{destiny:"accessRights",label:"Derechos de acceso"}]};(0,s.useEffect)((function(){Te()}),[le.pathname]),(0,s.useEffect)((function(){me.cataloging&&(me.cataloging.parents?$(me.cataloging.parents):$([]))}),[me]);var Te=function(){var e=le.pathname.split("/").filter((function(e){return""!==e}));e.length>2&&"new"===e[2]?(B(!0),W(null)):e.length>2&&"edit"===e[2]?(B(!0),W(e[3])):(B(!1),W(null))};(0,s.useEffect)((function(){var e;oe?u.Pw(oe).then((function(e){T(e),H({fields:[e.metadata.fields],forms:[{name:e.metadata.name,slug:e.metadata.slug}]});var t=(0,i.A)({},me);t.cataloging&&t.cataloging.activeColumns&&0!==t.cataloging.activeColumns.length||(t.cataloging=Ce),Se((0,o.vm)((0,o.e)(t,"cataloging","post_type",{slug:oe})))})).catch((function(e){je("Error",e.msg).then((function(){de("/cataloging")}))})):null!==(e=me.cataloging)&&void 0!==e&&e.post_type?de("/cataloging/"+me.cataloging.post_type.slug):f.gD().then((function(e){de("/cataloging/"+e.value)})).catch((function(e){je("Error",e.msg).then((function(){de("/cataloging")}))}))}),[le.pathname]),(0,s.useEffect)((function(){u.DI().then((function(e){w(e)})),Te()}),[]);return(0,Z.jsxs)(ae.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:ne?"center":"flex-start"},children:[!D&&C&&(0,Z.jsxs)(ae.EL,{style:{padding:0,height:"calc(100vh - 20px)",width:"600px",display:"block",overflow:"auto",placeContent:"flex-start"},children:[(0,Z.jsx)(p.A,{className:ge.toolbar,style:{background:ye.palette.primary.light},children:C&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{style:{marginLeft:"24px",color:ye.palette.primary.main},children:y.dR.find((function(e){return e.value===C.icon})).icon}),(0,Z.jsx)(c.A,{variant:"h6",style:{flexGrow:1,marginLeft:15,color:ye.palette.primary.main},children:C.name})]})}),(0,Z.jsxs)("div",{style:{padding:10},children:[(0,Z.jsx)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0},children:(0,Z.jsx)(se.nA,{id:"newResource",startIcon:(0,Z.jsx)(x.A,{}),label:ke.formatMessage({id:"cataloging.createNew"}),style:{borderRadius:5,backgroundColor:ye.palette.success.light,color:ye.palette.success.main},onClick:function(){return de("/cataloging/"+oe+"/new")}})}),(0,Z.jsx)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0},children:(0,Z.jsx)(se.nA,{startIcon:(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(m.A,{}),(0,Z.jsx)(v.A,{})]}),label:ke.formatMessage({id:"cataloging.downloadInventory"}),style:{borderRadius:5,backgroundColor:we?ye.palette.grey[800]:ye.palette.grey[200],color:ye.palette.grey[500]},onClick:function(){je("confirm",ke.formatMessage({id:"cataloging.confirmDownloadInventory"})).then((function(e){e&&f.eP("inventoryMaker",JSON.stringify({post_type:C.slug,parent:Q,status:Ae?"draft":"published"})).then((function(e){je("info",e.msg)})).catch((function(e){je("error",ke.formatMessage({id:"cataloging.errorDownloadInventory"}))}))}))}})}),(0,Z.jsxs)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:L?20:0},children:[(0,Z.jsx)(c.A,{style:{color:we?ye.palette.primary.light:ye.palette.primary.main,fontSize:15},children:ke.formatMessage({id:"cataloging.viewInfo"})}),(0,Z.jsx)(h.A,{checked:L,onChange:function(){return E(!L)}})]}),!L&&(0,Z.jsxs)(p.A,{style:{justifyContent:"space-between",minHeight:"auto",padding:0,marginBottom:20},children:[(0,Z.jsx)(c.A,{style:{color:we?ye.palette.primary.light:ye.palette.primary.main,fontSize:15},children:ke.formatMessage({id:"cataloging.viewDrafts"})}),(0,Z.jsx)(h.A,{checked:Ae,onChange:function(){be(!Ae);var e=(0,i.A)({},me);Se((0,o.vm)((0,o.e)(e,"cataloging","status",Ae?"published":"draft")))}})]}),(0,Z.jsx)(A.oF,{parents:j,view:"cataloging",onChange:function(e){T(null),E(!1),D||"*"===e.target.value?D||"*"===e.target.value||de("/cataloging/"+e.target.value+"/new"):de("/cataloging/"+e.target.value)}}),(0,Z.jsx)(pe.A,{root:null,activeTypes:[{slug:oe}],postType:oe,view:"list",mainView:"cataloging",checkboxTypes:j.map((function(e){return e.slug})),multiple:!1,selected:[Y],childrenSelect:!1,setSelected:function(e){if(0===e.length){var t=(0,o.e)(me,"cataloging","parents",null);Se((0,o.vm)(t))}else{var n=(0,o.e)(me,"cataloging","parents",e[0]);Se((0,o.vm)(n))}}},C?[C.slug]:j)]})]}),!C&&(0,Z.jsx)(fe.A,{}),L&&C&&(0,Z.jsx)(ae.EL,{style:{width:"calc(100% - 35px)",marginLeft:0,marginTop:"10px",height:"calc(100% - 40px)",alignItems:"flex-start",placeContent:"flex-start"},children:(0,Z.jsx)(b.Ay,{selectedType:C})}),D&&C&&!L&&!O&&(0,Z.jsx)(ce,{user:e.user,selectedType:C,setLoading:ie}),D&&C&&!L&&O&&(0,Z.jsx)(ce,{user:e.user,selectedType:C,selectedResource:O,setLoading:ie}),!D&&C&&!L&&(0,Z.jsx)(ue.A,{forms:z,view:"cataloging",viewDrafts:Ae,history:e.history,selectedType:C,setSelected:J},oe),ne&&(0,Z.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%",position:"fixed",top:0,left:0,background:"rgba(255, 255, 255, 0.5)",backdropFilter:"blur(5px) saturate(0%)",zIndex:9999},children:(0,Z.jsx)(fe.A,{})})]})},ye=ge},14533:function(e,t,n){var i=n(89379),a=n(5544),s=n(65043),l=n(83003),r=n(73216),o=n(85211),d=n(72378),c=n(91181),u=n(76445),f=n(29464),p=n(81551),h=n(99246),g=n(70579),y=(0,p.A)((function(e){return{columnas:{display:"flex",height:"calc(100vh - 150px)"}}}));t.A=function(e){y();var t=(0,s.useState)(null),n=(0,a.A)(t,2),p=(n[0],n[1]),m=(0,s.useState)(null),v=(0,a.A)(m,2),x=v[0],A=(v[1],(0,s.useState)([])),b=(0,a.A)(A,2),j=(b[0],b[1],(0,s.useState)(0)),w=(0,a.A)(j,2),k=w[0],S=w[1],C=(0,s.useState)([]),T=(0,a.A)(C,2),R=T[0],F=T[1],M=(0,s.useState)(!1),L=(0,a.A)(M,2),E=L[0],I=L[1],q=(0,s.useState)(""),D=(0,a.A)(q,2),B=D[0],N=(D[1],(0,s.useState)("")),P=(0,a.A)(N,2),z=(P[0],P[1],(0,r.Zp)()),H=(0,l.wA)(),_=(0,l.d4)((function(e){return e.app.filters}));(0,h.A)();return(0,s.useEffect)((function(){var t;null!==(t=e.selectedType)&&void 0!==t&&t.parentsTypes?e.selectedType.parentsTypes.length>0?p("multiple"):e.selectedType.hierarchical?p("tree"):p("single"):p(null)}),[e.selectedType]),(0,s.useEffect)((function(){e.setSelected&&x?e.setSelected(x.id):e.setSelected&&e.setSelected(null)}),[x]),(0,s.useEffect)((function(){var t=(0,i.A)({},_);H((0,o.vm)((0,o.e)(t,e.view,"keyword",B)))}),[B]),(0,s.useEffect)((function(){var t=(0,i.A)({},_);t=(0,o.e)(t,e.view,"status",e.viewDrafts?"draft":"published"),H((0,o.vm)(t))}),[e.viewDrafts]),(0,g.jsxs)("div",{style:(0,i.A)({display:"flex",height:"100%",width:"100%",flexDirection:"column"},e.style),children:[(0,g.jsx)(d.EL,{style:{width:"calc(100% - 40px)",height:"55px",overflowX:"hidden",marginLeft:0,marginBottom:0},children:(0,g.jsx)(c.A,{total:k,showFilters:E,setShowFilters:I,activeFilters:R,setActiveFilters:e.forms?F:null,view:e.view})}),(0,g.jsxs)(d.EL,{id:"dropzone_scroll",onScroll:function(e){},style:{width:"calc(100% - 40px)",height:"calc(100% - 40px)",overflowX:"hidden",marginLeft:0,placeContent:"flex-start"},children:[!E&&(0,g.jsx)(u.A,{selectedTypes:e.detail?e.type:e.types,selectedType:e.selectedType,filters:_,type:e.type,editBtns:!0,parentTotal:S,handleClick:function(t){"checkbox"===e.type?e.setSelectedResources(t.id):z("/detail/".concat(t.id))},selectedResources:e.selectedResources,view:e.view,form:e.forms,setColumns:function(){}}),E&&(0,g.jsx)(f.n,{forms:e.forms,activeFilters:R,setActiveFilters:F,view:e.view})]})]})}},22505:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),s=n(70579);t.A=(0,a.default)((0,s.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},44448:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),s=n(70579);t.A=(0,a.default)((0,s.jsx)("path",{d:"M15.41 7.41 14 6l-6 6 6 6 1.41-1.41L10.83 12z"}),"NavigateBefore")},56658:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),s=n(70579);t.A=(0,a.default)((0,s.jsx)("path",{d:"M10 6 8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"}),"NavigateNext")},43485:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),s=n(70579);t.A=(0,a.default)((0,s.jsx)("path",{d:"M5 4v2h14V4zm0 10h4v6h6v-6h4l-7-7z"}),"Publish")},94329:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),s=n(70579);t.A=(0,a.default)((0,s.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},47260:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),s=n(70579);t.A=(0,a.default)((0,s.jsx)("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility")},79958:function(e,t,n){n.d(t,{A:function(){return j}});var i=n(64467),a=n(98587),s=n(58168),l=n(65043),r=n(69292),o=n(98610),d=n(85865),c=n(98206),u=n(34535),f=n(92532),p=n(72372);function h(e){return(0,p.Ay)("MuiCardHeader",e)}var g=(0,f.A)("MuiCardHeader",["root","avatar","action","content","title","subheader"]),y=n(70579),m=["action","avatar","className","component","disableTypography","subheader","subheaderTypographyProps","title","titleTypographyProps"],v=(0,u.Ay)("div",{name:"MuiCardHeader",slot:"Root",overridesResolver:function(e,t){return(0,s.A)((0,i.A)((0,i.A)({},"& .".concat(g.title),t.title),"& .".concat(g.subheader),t.subheader),t.root)}})({display:"flex",alignItems:"center",padding:16}),x=(0,u.Ay)("div",{name:"MuiCardHeader",slot:"Avatar",overridesResolver:function(e,t){return t.avatar}})({display:"flex",flex:"0 0 auto",marginRight:16}),A=(0,u.Ay)("div",{name:"MuiCardHeader",slot:"Action",overridesResolver:function(e,t){return t.action}})({flex:"0 0 auto",alignSelf:"flex-start",marginTop:-4,marginRight:-8,marginBottom:-4}),b=(0,u.Ay)("div",{name:"MuiCardHeader",slot:"Content",overridesResolver:function(e,t){return t.content}})({flex:"1 1 auto"}),j=l.forwardRef((function(e,t){var n=(0,c.b)({props:e,name:"MuiCardHeader"}),i=n.action,l=n.avatar,u=n.className,f=n.component,p=void 0===f?"div":f,g=n.disableTypography,j=void 0!==g&&g,w=n.subheader,k=n.subheaderTypographyProps,S=n.title,C=n.titleTypographyProps,T=(0,a.A)(n,m),R=(0,s.A)({},n,{component:p,disableTypography:j}),F=function(e){var t=e.classes;return(0,o.A)({root:["root"],avatar:["avatar"],action:["action"],content:["content"],title:["title"],subheader:["subheader"]},h,t)}(R),M=S;null==M||M.type===d.A||j||(M=(0,y.jsx)(d.A,(0,s.A)({variant:l?"body2":"h5",className:F.title,component:"span",display:"block"},C,{children:M})));var L=w;return null==L||L.type===d.A||j||(L=(0,y.jsx)(d.A,(0,s.A)({variant:l?"body2":"body1",className:F.subheader,color:"text.secondary",component:"span",display:"block"},k,{children:L}))),(0,y.jsxs)(v,(0,s.A)({className:(0,r.A)(F.root,u),as:p,ref:t,ownerState:R},T,{children:[l&&(0,y.jsx)(x,{className:F.avatar,ownerState:R,children:l}),(0,y.jsxs)(b,{className:F.content,ownerState:R,children:[M,L]}),i&&(0,y.jsx)(A,{className:F.action,ownerState:R,children:i})]}))}))}}]);
//# sourceMappingURL=9430.5e80232c.chunk.js.map