"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[9017],{99017:function(e,t,r){r.r(t),r.d(t,{Main:function(){return fe},default:function(){return ge}});var n=r(89379),i=r(64467),a=r(5544),o=r(65043),s=r(72378),c=r(9920),l=r(19853),d=r(85865),u=r(15316),p=r(55263),f=r(17392),g=r(5670),h=r(42588),m=r(5374),x=r(95501),b=r(83003),v=r(41905),y=r(12110),k=r(63336),A=r(30064),j=r.n(A),w=r(54469),S=r(29704),_=r(6512),T=r(4319),C=r(76370),M=r(96479),E=r(26240),L=r(99246),R=r(70579),P=function(e){var t=(0,b.d4)((function(e){return e.app.isDarkMode})),r=(0,L.A)(),n=(0,E.A)(),a=(0,v.A)((function(e){return{bloque:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:n.palette.primary.main,border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:n.palette.primary.main},"&::-webkit-scrollbar-thumb:active":{background:n.palette.primary.main},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}}}}))();return(0,R.jsx)(u.A,{style:{padding:"5px",background:"transparent",maxHeight:"200px",overflow:"auto"},className:a.bloque,children:e.speakers.map((function(n,a){return(0,R.jsxs)(u.A,{style:{padding:"10px",border:"#444",marginBottom:"5px",borderRadius:"5px",display:"flex",maxWidth:"450px",background:t?"#333":"white",alignItems:"center"},children:[(0,R.jsx)("div",{style:{width:"150px",textAlign:"center",fontWeight:"bold",color:n.color},children:n.name.replace("SPEAKER",r.formatMessage({id:"general.speaker"}))}),(0,R.jsx)("div",{style:{position:"relative",width:"350px",marginLeft:"10px",background:t?"#555":"#f2f2f2",borderRadius:"3px",height:"10px"},children:n.segments.map((function(t,r){return(0,R.jsx)("div",{style:{position:"absolute",top:"0",height:"100%",left:"".concat(t.start/e.totalTime*100,"%"),width:"".concat((t.end-t.start)/e.totalTime*100,"%"),background:n.color,cursor:"pointer"},onClick:function(r){e.setVideoTime(t.start)}})}))}),(0,R.jsx)("div",{style:(0,i.A)({marginLeft:"10px",background:"transparent",color:"white",padding:"5px",fontSize:"10px",borderRadius:"5px",border:"2px solid "+n.color,fontWeight:"bold"},"color",n.color),children:e.totalTime&&(0,R.jsxs)(R.Fragment,{children:[Math.round(n.total/e.totalTime*100),"%"]})})]},a)}))})},V=function(e){var t=(0,E.A)(),r=(0,b.d4)((function(e){return e.app.isDarkMode})),n=(0,v.A)((function(e){return{segment:{transition:"all .35s",cursor:"pointer",color:r?t.palette.grey[400]:t.palette.grey[800],"&:hover":{background:t.palette.primary.light,color:t.palette.primary.main},"&.selected":{opacity:1,background:t.palette.primary.main,color:"white"}},speaker:{fontWeight:"bold",marginRight:"10px"},paragraph:{fontSize:"16px",maxWidth:"650px",margin:"0 auto",marginBottom:"20px"},selected:{background:t.palette.primary.main,color:"white",borderRadius:"3px"},bloque:{"&::-webkit-scrollbar":{width:6,height:2},"&::-webkit-scrollbar-button":{width:10,height:10},"&::-webkit-scrollbar-thumb":{background:t.palette.primary.main,border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-thumb:hover":{background:t.palette.primary.main},"&::-webkit-scrollbar-thumb:active":{background:t.palette.primary.main},"&::-webkit-scrollbar-track":{background:"rgba(0,0,0,0.1)",border:"0px none #ffffff",borderRadius:50},"&::-webkit-scrollbar-track:hover":{background:"rgba(0,0,0,0.1)"},"&::-webkit-scrollbar-track:active":{background:"rgba(0,0,0,0.1)"}}}}))(),i=(0,o.useState)(null),s=(0,a.A)(i,2),l=s[0],d=s[1],p=(0,o.useState)(1),f=(0,a.A)(p,2),g=f[0],h=(f[1],(0,o.useState)(null)),m=(0,a.A)(h,2),x=m[0],y=m[1],k=(0,o.useState)([]),A=(0,a.A)(k,2),j=A[0],w=A[1],S=(0,L.A)(),_=function(){c.RS(e.id,e.slug).then((function(t){var r=M.Ks0,n=!1;if(t.speakers&&(n=!0),n){var i=M.UMr(t.speakers.map((function(e){return e.name})),r);t.segments.forEach((function(e){e.color=i(e.speaker)})),d(t.segments),w(t.segments.map((function(){return o.createRef()}))),t.speakers.forEach((function(e){e.color=i(e.name)})),e.setSpeakers(t.speakers)}else d(t.segments),w(t.segments.map((function(){return o.createRef()})))}))};(0,o.useEffect)((function(){_()}),[]),(0,o.useEffect)((function(){e.updateTranscription&&(_(),e.setUpdateTranscription(!1))}),[e.updateTranscription]),(0,o.useEffect)((function(){if(l){l.forEach((function(t,r){if(t.index=r,t.start<=e.time&&t.end>=e.time&&x!==r){y(r),e.setCurrentLabel(t);var n=j[r].current;n&&n.scrollIntoView({behavior:"smooth",block:"center"})}}))}}),[e.time]);return(0,R.jsx)(R.Fragment,{children:(0,R.jsx)(u.A,{style:{position:"absolute",top:0,width:"100%",height:"100%",overflow:"auto"},className:n.bloque,children:1===g&&l&&(0,R.jsx)("div",{style:{float:"right",paddingTop:110},children:function(){var t=null,r=[],i=[];return l.map((function(a,o){var s=(0,R.jsx)("span",{ref:j[o],onClick:function(t){return e.setVideoTime(a.start)},className:"".concat(n.segment," segment_transcription seg_").concat(o," ").concat(o===x?"selected":""),children:a.text},o);s={container:s,speaker:a.speaker,color:a.color},a.speaker!==t&&(t=a.speaker,i.push(r),r=[]),r.push(s)})),i.push(r),(0,R.jsx)(R.Fragment,{children:i.map((function(e,t){return(0,R.jsx)("p",{className:n.paragraph,children:e.map((function(e,t){return t>0?e.container:e.speaker?(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)("span",{style:{color:e.color},className:n.speaker,children:e.speaker.replace("SPEAKER",S.formatMessage({id:"general.speaker"}))}),e.container]}):void 0}))},t)}))})}()})})})},N=r(43845),F=r(10765),D=r(93440),I=r(74054),U=r(6456),z=r(81551),B=(0,z.A)((function(e){return{close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"}}}})),W=function(e){var t=B(),r=(0,o.useState)(""),i=(0,a.A)(r,2),s=i[0],l=i[1],d=(0,o.useState)(""),p=(0,a.A)(d,2),f=p[0],g=p[1],h=(0,o.useState)(""),m=(0,a.A)(h,2),x=m[0],v=m[1],y=(0,o.useState)(""),k=(0,a.A)(y,2),A=k[0],j=k[1],w=(0,o.useState)(!1),S=(0,a.A)(w,2),_=(S[0],S[1]),T=(0,b.d4)((function(e){return e.app.isDarkMode})),C=(0,o.useState)("text"),M=(0,a.A)(C,2),P=M[0],V=M[1],z=(0,L.A)(),W=(0,E.A)();(0,o.useEffect)((function(){e.currentLabel&&(l(e.currentLabel.text),j(e.currentLabel.speaker))}),[e.currentLabel]);return(0,R.jsxs)(u.A,{style:{padding:"5px",background:"transparent",backdropFilter:"blur(10px)"},children:[(0,R.jsxs)(u.A,{style:{display:"flex",justifyContent:"center",border:"#444",background:T?"#333":"white",borderRadius:"5px",marginBottom:"5px"},children:[(0,R.jsx)(D.A,{title:z.formatMessage({id:"general.editTranscription"}),labelPos:"top",onClick:function(){V("text")},children:"TextFields",selected:"text"===P}),(0,R.jsx)(D.A,{title:z.formatMessage({id:"general.editSpeakers"}),labelPos:"top",onClick:function(){V("speaker")},children:"InterpreterMode",selected:"speaker"===P})]}),!e.currentLabel&&(0,R.jsx)(u.A,{style:{border:"#444",background:T?"#333":"white",borderRadius:"5px",padding:"15px",color:T?W.palette.grey[400]:W.palette.grey[800]},children:z.formatMessage({id:"general.noSegmentSelected"})}),e.currentLabel&&"text"===P&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(u.A,{style:{border:"#444",background:T?"#333":"white",borderRadius:"5px"},children:[(0,R.jsx)(F.QA,{value:s,handleChange:function(e){return l(e.target.value)},handleBlur:function(){},style:{padding:"5px",width:"450px"}}),A&&(0,R.jsx)(F.BR,{value:A,handleChange:function(e){return j(e.target.value)},style:{padding:"5px",width:"450px"}})]}),(0,R.jsxs)("div",{style:{display:"flex",justifyContent:"space-around",width:"100px",margin:"0 auto",marginTop:"10px",background:T?"#333":"white",borderRadius:"50px"},children:[(0,R.jsx)(N.A,{label:"Guardar",size:"small",onClick:function(){!function(){var t=(0,n.A)({},e.currentLabel);t.text=s,t.speaker=A,t.slug=e.slug,_(!0),c.v(e.id,t).then((function(t){e.setUpdateTranscription(!0),_(!1)})).catch((function(e){console.log(e)}))}()},icon:(0,R.jsx)(I.A,{}),style:{margin:10,border:"none"},variant:"outlined",className:t.close}),(0,R.jsx)(N.A,{label:"Eliminar",size:"small",onClick:function(){!function(){var t={slug:e.slug,index:e.currentLabel.index};c.bn(e.id,t).then((function(t){e.setUpdateTranscription(!0)})).catch((function(e){console.log(e)}))}()},icon:(0,R.jsx)(U.A,{}),style:{margin:10,border:"none"},variant:"outlined",className:t.close})]})]}),"speaker"===P&&(0,R.jsx)(u.A,{style:{border:"#444",background:T?"#333":"white",borderRadius:"5px"},children:(0,R.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,R.jsx)(F.Q5,{value:x,handleChange:function(e){g(e.target.value),v(e.target.value)},options:e.speakers.map((function(e){return{value:e.name,label:e.name}})),rootStyle:{padding:"5px",width:"50%",margin:"0"}}),(0,R.jsx)(F.BR,{value:f,handleChange:function(e){return g(e.target.value)},style:{padding:"5px",width:"50%"}}),(0,R.jsx)(N.A,{label:"Guardar",size:"small",onClick:function(){!function(){var t={oldSpeaker:x,speaker:f,slug:e.slug};_(!0),c.Z$(e.id,t).then((function(t){e.setUpdateTranscription(!0),_(!1)})).catch((function(e){console.log(e)}))}()},icon:(0,R.jsx)(I.A,{}),style:{margin:10,border:"none"},variant:"outlined",className:t.close})]})})]})},O=r(65226),q=r(72003),H=function(e){var t=(0,b.d4)((function(e){return e.app.isDarkMode})),r=(0,L.A)();(0,E.A)();return(0,R.jsx)(u.A,{style:{padding:"5px",background:"transparent",maxHeight:"200px",overflow:"auto"},children:(0,R.jsxs)(u.A,{style:{display:"flex",justifyContent:"center",border:"#444",background:t?"#333":"white",borderRadius:"5px",marginBottom:"5px"},children:[(0,R.jsx)(D.A,{title:r.formatMessage({id:"general.fastForward"}),labelPos:"top",onClick:function(){1===e.speed?e.setSpeed(1.5):1.5===e.speed?e.setSpeed(2):2===e.speed&&e.setSpeed(1)},children:1===e.speed||1.5===e.speed?"FastForward":"FastForward,FastForward",selected:1!==e.speed}),(0,R.jsx)(D.A,{title:r.formatMessage({id:"general.forward5"}),labelPos:"top",onClick:function(){e.handleForward(5)},children:"Forward5"}),(0,R.jsx)(D.A,{title:r.formatMessage({id:"general.forward10"}),labelPos:"top",onClick:function(){e.handleForward(10)},children:"Forward10"}),(0,R.jsx)(D.A,{title:r.formatMessage({id:"general.forward30"}),labelPos:"top",onClick:function(){e.handleForward(30)},children:"Forward30"})]})})},$=r(82094),G=function(e){var t,r,n,i,s,l,d,p,f=(0,E.A)(),g=(0,b.d4)((function(e){return e.app.isDarkMode})),h=(0,v.A)((function(e){return{bloqueReproduccion:{width:"calc(100% - 40px)",margin:"20px",display:"flex",alignItems:"center",position:"absolute",zIndex:1,"&:hover .num_currentTime":{opacity:1}},playPauseBtn:{width:"70px",height:"70px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer","& svg":{width:"50%",height:"50%","& path":{fill:g?f.palette.primary.light:f.palette.primary.main}}},progressContainer:{width:"calc(100% - 140px)",height:"5px",backgroundColor:g?f.palette.grey[900]:f.palette.grey[100],display:"flex",alignItems:"center",borderRadius:"5px",cursor:"pointer"},progress:{width:"0%",height:"100%",backgroundColor:g?f.palette.primary.light:f.palette.primary.main,borderRadius:"5px",position:"relative",transition:"all .3s"},currentTime:{position:"absolute",top:"-20px",right:"-56px",fontSize:"12px",fontWeight:"bold",color:g?f.palette.primary.light:f.palette.primary.main,opacity:0,transition:"all .3s"},duration:{width:"100px",height:"70px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",color:g?f.palette.primary.light:f.palette.grey[700],fontSize:"12px",fontWeight:"bold"}}}))(),m=(0,o.useRef)(null),x=(0,o.useRef)(null),A=(0,o.useRef)(null),M=(0,o.useState)(!1),L=(0,a.A)(M,2),V=L[0],N=L[1],F=(0,o.useState)(0),D=(0,a.A)(F,2),I=D[0],U=D[1],z=(0,o.useState)(null),B=(0,a.A)(z,2),G=B[0],Q=B[1],J=(0,o.useState)(null),K=(0,a.A)(J,2),Y=K[0],X=K[1],Z=(0,o.useState)(!1),ee=(0,a.A)(Z,2),te=ee[0],re=ee[1],ne=(0,o.useState)(1),ie=(0,a.A)(ne,2),ae=ie[0],oe=ie[1],se=function(e){var t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return"".concat(t.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))},ce=function(){N(!1)},le=function(){j().fire({title:"Error",text:"No se pudo cargar el archivo",icon:"error",confirmButtonText:"Ok"})},de=function(){var e=m.current.duration;U(se(e))},ue=function(){if(m.current){e.setPlayTime(m.current.currentTime);var t=m.current.currentTime/m.current.duration*100;x.current&&A.current&&(x.current.style.width="".concat(t,"%"),A.current.innerHTML=se(m.current.currentTime))}};(0,o.useEffect)((function(){return c.xU(e.id).then((function(e){console.log(e);var t=URL.createObjectURL(e);m.current.src=t,m.current.addEventListener("ended",ce),m.current.addEventListener("error",le),m.current.addEventListener("loadedmetadata",de),m.current.addEventListener("timeupdate",ue)})).catch((function(e){j().fire({title:"Error",text:"No se pudo cargar el archivo: "+e.message,icon:"error",confirmButtonText:"Ok"})})),function(){m.current&&(m.current.removeEventListener("ended",ce),m.current.removeEventListener("error",le),m.current.removeEventListener("loadedmetadata",de),m.current.removeEventListener("timeupdate",ue))}}),[]),(0,o.useEffect)((function(){e.time&&(m.current.currentTime=e.time)}),[e.time]);var pe=function(e){m.current.currentTime=e};return(0,R.jsxs)(T.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")},children:[(0,R.jsxs)(y.A,{className:h.bloqueReproduccion,style:{display:null!==m&&void 0!==m&&null!==(t=m.current)&&void 0!==t&&t.duration?"flex":"none",backgroundColor:g?f.palette.grey[800]:"white"},children:[(0,R.jsx)(u.A,{onClick:function(){m.current.paused?(m.current.play(),N(!0)):(m.current.pause(),N(!1))},className:h.playPauseBtn,children:V?(0,R.jsx)(S.A,{}):(0,R.jsx)(w.A,{})}),(0,R.jsx)(u.A,{className:h.progressContainer,onClick:function(e){var t=document.querySelector(".".concat(h.progressContainer)),r=e.nativeEvent.offsetX/t.offsetWidth*100;m.current.currentTime=m.current.duration*r/100},children:(0,R.jsx)(u.A,{className:h.progress,ref:x,children:(0,R.jsx)(u.A,{ref:A,className:"".concat(h.currentTime," num_currentTime")})})}),(0,R.jsx)(u.A,{className:h.duration,children:I})]}),o.Children.map(e.children,(function(e){return o.isValidElement(e)?o.cloneElement(e,{setVideoTime:pe,textAlign:"center",totalTime:m.current.duration,setSpeakers:Q,setCurrentLabel:X,updateTranscription:te,setUpdateTranscription:re}):e})),(0,R.jsx)(_.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"},children:(0,R.jsx)(C.A,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})}),(0,R.jsx)(_.V,{id:"speakers",initialPosition:{x:0,y:0},style:{display:null!==m&&void 0!==m&&null!==(r=m.current)&&void 0!==r&&r.duration&&G?"block":"none"},children:(null===m||void 0===m||null===(n=m.current)||void 0===n?void 0:n.duration)&&G&&"speakers_av_transcribe"===e.subView&&(0,R.jsx)(P,{speakers:G,totalTime:m.current.duration,setVideoTime:pe})}),(0,R.jsx)(_.V,{id:"player_settings",initialPosition:{x:0,y:0},style:{display:null!==m&&void 0!==m&&null!==(i=m.current)&&void 0!==i&&i.duration&&"player_settings"===e.subView?"block":"none"},children:(0,R.jsx)(H,{speed:ae,setSpeed:function(e){m.current&&(m.current.playbackRate=e,oe(e))},handleForward:function(e){m.current&&(m.current.currentTime+=e)}})}),(0,R.jsx)(_.V,{id:"user_record_tasks",initialPosition:{x:0,y:0},style:{display:null!==m&&void 0!==m&&null!==(s=m.current)&&void 0!==s&&s.duration&&"user_record_tasks"===e.subView?"block":"none"},children:(0,R.jsx)($.A,{id:e.id,record:!0})}),(0,R.jsx)(_.V,{id:"edit_av_transcribe",initialPosition:{x:0,y:0},style:{display:null!==m&&void 0!==m&&null!==(l=m.current)&&void 0!==l&&l.duration&&"edit_av_transcribe"===e.subView?"block":"none"},children:(null===m||void 0===m||null===(d=m.current)||void 0===d?void 0:d.duration)&&"edit_av_transcribe"===e.subView&&(0,R.jsx)(W,{setSubView:e.setSubView,currentLabel:Y,id:e.id,slug:e.slug,setUpdateTranscription:re,speakers:G})}),(0,R.jsxs)("audio",{ref:m,children:[(0,R.jsx)("source",{src:"",type:"audio/mpeg"}),(0,R.jsx)("source",{src:"",type:"audio/ogg"})]}),!(null!==m&&void 0!==m&&null!==(p=m.current)&&void 0!==p&&p.duration)&&(0,R.jsx)(k.A,{style:{position:"absolute",top:20,left:20,backgroundColor:g?f.palette.grey[800]:"white"},children:(0,R.jsx)(O.A,{options:{loop:!0,autoplay:!0,animationData:q,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},height:70,width:70})})]})},Q=r(70567),J=(0,v.A)((function(e){return{bloqueReproduccion:{width:"calc(100% - 20px)",margin:"10px",display:"flex",alignItems:"center",position:"absolute",bottom:0,backgroundColor:"rgba(0, 0, 0, .5)",backdropFilter:"blur(5px) saturate(10%) brightness(40%)",transition:"all .3s !important",overflow:"visible",opacity:1,"&:hover .num_currentTime":{opacity:1},"&.hide":{opacity:0}},playPauseBtn:{width:"50px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer","& svg":{width:"50%",height:"50%","& path":{fill:"#fff"}}},progressContainer:{width:"calc(100% - 140px)",height:"5px",backgroundColor:"rgba(255,255,255,.1)",display:"flex",alignItems:"center",borderRadius:"5px",cursor:"pointer"},progress:{width:"0%",height:"100%",backgroundColor:"#fff",borderRadius:"5px",position:"relative",transition:"all .3s"},currentTime:{position:"absolute",top:"0px",right:"-56px",fontSize:"12px",transform:"translateY(-170%)",fontWeight:"bold",color:"#fff",opacity:0,transition:"all .3s",textShadow:"0 0 5px rgba(0,0,0,0.6)"},duration:{width:"150px",height:"30px",display:"flex",justifyContent:"center",alignItems:"center",cursor:"pointer",color:"rgba(255,255,255,1)",fontSize:"12px",fontWeight:"bold"},hide:{visibility:"hidden"}}})),K=function(e){var t,r,n,i,s,l,d=J(),p=(0,o.useRef)(null),f=(0,o.useState)(!1),g=(0,a.A)(f,2),h=g[0],m=g[1],x=(0,o.useState)(0),v=(0,a.A)(x,2),A=v[0],M=v[1],E=(0,o.useState)(1),L=(0,a.A)(E,2),V=L[0],N=L[1],F=(0,o.useState)(!1),D=(0,a.A)(F,2),I=D[0],U=D[1],z=(0,o.useState)(null),B=(0,a.A)(z,2),G=B[0],K=B[1],Y=(0,o.useState)(!1),X=(0,a.A)(Y,2),Z=X[0],ee=X[1],te=(0,o.useState)(null),re=(0,a.A)(te,2),ne=re[0],ie=re[1],ae=(0,o.useState)(!1),oe=(0,a.A)(ae,2),se=oe[0],ce=oe[1],le=null,de=(0,b.d4)((function(e){return e.app.isDarkMode})),ue=(0,Q.A)(),pe=function(e){var t=Math.floor(e/3600),r=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return"".concat(t.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0"),":").concat(n.toString().padStart(2,"0"))},fe=function(){m(!1)},ge=function(){j().fire({title:"Error",text:"No se pudo cargar el archivo",icon:"error",confirmButtonText:"Ok"})},he=function(){var e=p.current,t=p.current.duration;M(pe(t)),e.videoHeight>e.videoWidth?U(!0):U(!1)},me=function(){if(p.current){e.setPlayTime(p.current.currentTime);var t=p.current.currentTime/p.current.duration*100,r=document.querySelector(".".concat(d.progress)),n=document.querySelector(".".concat(d.currentTime));r.style.width="".concat(t,"%"),n.innerHTML=pe(p.current.currentTime)}},xe=function(){clearTimeout(le);var e=document.querySelector(".".concat(d.bloqueReproduccion));e.classList.remove("hide"),le=setTimeout((function(){e.classList.add("hide")}),4e3)},be=function(){ee(!0)},ve=function(){p.current.paused?(p.current.play(),m(!0)):(p.current.pause(),m(!1))};(0,o.useEffect)((function(){return c.xU(e.id).then((function(e){var t=URL.createObjectURL(e);p.current.src=t,p.current.addEventListener("ended",fe),p.current.addEventListener("error",ge),p.current.addEventListener("loadedmetadata",he),p.current.addEventListener("canplay",be),p.current.addEventListener("timeupdate",me),p.current.addEventListener("mousemove",xe),p.current.addEventListener("click",ve)})).catch((function(e){console.log(e),j().fire({title:"Error",text:"No se pudo cargar el archivo",icon:"error",confirmButtonText:"Ok"})})),function(){p.current&&(p.current.removeEventListener("ended",fe),p.current.removeEventListener("error",ge),p.current.removeEventListener("loadedmetadata",he),p.current.removeEventListener("timeupdate",me),p.current.removeEventListener("mousemove",xe),p.current.removeEventListener("click",ve))}}),[]);var ye=function(e){p.current&&(p.current.currentTime=e)},ke=I?{width:"auto",height:550,maxHeight:"100%",marginBottom:-7,cursor:"move"}:{width:550,height:"auto",maxWidth:"100%",marginBottom:-7,cursor:"move"};return(0,R.jsxs)(T.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")},children:[(0,R.jsx)(_.V,{id:"videoPlayer",style:{display:"flex",flexWrap:"wrap",justifyContent:"center",position:"absolute",zIndex:1,backgroundColor:"#000",visibility:Z?"visible":"hidden"},initialPosition:{x:0,y:0},children:(0,R.jsxs)("div",{children:[(0,R.jsx)("video",{style:ke,ref:p}),(0,R.jsxs)(y.A,{className:d.bloqueReproduccion,style:{backgroundColor:"rgba(255, 255, 255, .25)"},sx:{overflow:"visible"},onMouseMove:function(){clearTimeout(le)},children:[(0,R.jsx)(u.A,{onClick:ve,className:d.playPauseBtn,children:h?(0,R.jsx)(S.A,{}):(0,R.jsx)(w.A,{})}),(0,R.jsx)(u.A,{className:d.progressContainer,onClick:function(e){var t=document.querySelector(".".concat(d.progressContainer)),r=e.nativeEvent.offsetX/t.offsetWidth*100;p.current.currentTime=p.current.duration*r/100},children:(0,R.jsx)(u.A,{className:d.progress,children:(0,R.jsx)(u.A,{className:"".concat(d.currentTime," num_currentTime")})})}),(0,R.jsx)(u.A,{className:d.duration,children:A})]})]})}),o.Children.map(e.children,(function(e){return o.isValidElement(e)?o.cloneElement(e,{setVideoTime:ye,totalTime:p.current.duration,setSpeakers:K,setCurrentLabel:ie,updateTranscription:se,setUpdateTranscription:ce}):e})),(0,R.jsx)(_.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:e.metadata?"block":"none"},children:(0,R.jsx)(C.A,{resource:e.metadata,setMetadata:e.setMetadata,history:e.history})}),(0,R.jsx)(_.V,{id:"speakers",initialPosition:{x:0,y:0},style:{display:null!==p&&void 0!==p&&null!==(t=p.current)&&void 0!==t&&t.duration&&G?"block":"none"},children:(null===p||void 0===p||null===(r=p.current)||void 0===r?void 0:r.duration)&&G&&"speakers_av_transcribe"===e.subView&&(0,R.jsx)(P,{speakers:G,totalTime:p.current.duration,setVideoTime:ye})}),(0,R.jsx)(_.V,{id:"user_record_tasks",initialPosition:{x:0,y:0},style:{display:null!==p&&void 0!==p&&null!==(n=p.current)&&void 0!==n&&n.duration&&"user_record_tasks"===e.subView?"block":"none"},children:(0,R.jsx)($.A,{id:e.id,record:!0})}),(0,R.jsx)(_.V,{id:"player_settings",initialPosition:{x:0,y:0},style:{display:null!==p&&void 0!==p&&null!==(i=p.current)&&void 0!==i&&i.duration&&"player_settings"===e.subView?"block":"none"},children:(0,R.jsx)(H,{speed:V,setSpeed:function(e){p.current&&(p.current.playbackRate=e,N(e))},handleForward:function(e){p.current&&(p.current.currentTime+=e)}})}),(0,R.jsx)(_.V,{id:"edit_av_transcribe",initialPosition:{x:0,y:0},style:{display:null!==p&&void 0!==p&&null!==(s=p.current)&&void 0!==s&&s.duration&&"edit_av_transcribe"===e.subView?"block":"none"},children:(null===p||void 0===p||null===(l=p.current)||void 0===l?void 0:l.duration)&&"edit_av_transcribe"===e.subView&&(0,R.jsx)(W,{setSubView:e.setSubView,currentLabel:ne,id:e.id,slug:e.slug,setUpdateTranscription:ce,speakers:G})}),!Z&&(0,R.jsx)(k.A,{style:{position:"absolute",top:20,left:20,backgroundColor:de?ue.palette.grey[800]:"white"},children:(0,R.jsx)(O.A,{options:{loop:!0,autoplay:!0,animationData:q,rendererSettings:{preserveAspectRatio:"xMidYMid slice"}},height:70,width:70})})]})},Y=r(63573),X=r(92392),Z=r(94495),ee=r(36795),te=r(31269),re=r(92530),ne=r(93012),ie=r(88455),ae=r(73216),oe=r(50264),se=r(58140),ce=r(11238),le=r(18751),de=r(53536),ue=r.n(de),pe=(0,z.A)((function(e){return{toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}}}})),fe=function(e){var t=(0,o.useState)("viz"),r=(0,a.A)(t,2),v=r[0],y=r[1],k=(0,o.useState)(null),A=(0,a.A)(k,2),j=A[0],w=A[1],S=(0,o.useState)(null),_=(0,a.A)(S,2),T=_[0],C=_[1],M=(0,o.useState)(0),P=(0,a.A)(M,2),N=P[0],F=P[1],I=(0,o.useState)(0),U=(0,a.A)(I,2),z=U[0],B=U[1],W=(0,o.useState)(null),O=(0,a.A)(W,2),q=O[0],H=O[1],$=(0,o.useState)(!1),Q=(0,a.A)($,2),J=Q[0],de=Q[1],fe=(0,o.useState)([]),ge=(0,a.A)(fe,2),he=ge[0],me=ge[1],xe=(0,b.d4)((function(e){return e.user})),be=(0,ae.g)().id,ve=(0,E.A)(),ye=pe(),ke=(0,se.M)().showAlert,Ae=(0,b.wA)(),je=(0,ae.Zp)(),we=(0,b.d4)((function(e){return e.app.isDarkMode})),Se=(0,L.A)();(0,o.useEffect)((function(){_e()}),[e.match]),(0,o.useEffect)((function(){xe.favorites&&(xe.favorites.find((function(e){return e.id===be}))?de(!0):de(!1))}),[xe.favorites,e.match]),(0,o.useEffect)((function(){if(T){for(var e=Object.keys(T.processing),t=e[0];"fileProcessing"===t&&e.length>1;)e.shift(),t=e[0];l.ko("detail_record").then((function(e){var t=T.processing.fileProcessing.type;e.actions.length>0&&me(e.actions.filter((function(e){return e.record_type.includes(t)})))})).catch((function(e){console.error(e)}))}}),[T]);var _e=function(){be&&(y("viz"),C(null),c.Hc(be).then((function(e){C(e)})).catch((function(e){ke("error","No se pudo obtener el archivo").then((function(){je("/")}))})))},Te=function(e){B(e)};return(0,R.jsx)(s.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:T&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsxs)(s.EL,{style:(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({width:"calc(100% - 40px)",marginBottom:0,height:"calc(100% - 20px)",padding:0},"width","400px"),"maxWidth","400px"),"border","none"),"display","block"),"placeContent","flex-start"),"overflow","auto"),"minWidth","300px"),"flexGrow",.5),"margin",10),children:[(0,R.jsxs)(p.A,{style:{background:ve.palette.primary.light},className:ye.toolbar,children:[xe.access_token&&"null"!==xe.access_token&&(0,R.jsx)(f.A,{sx:{marginLeft:"12px",color:ve.palette.primary.main},size:"large",onClick:function(){var e={type:"records",id:be};J?g.C5(e).then((function(e){ke("success",Se.formatMessage({id:"removed_from_favorites"})),Ae((0,ie.me)(xe.access_token))})).catch((function(e){ke("error",Se.formatMessage({id:"could_not_remove_from_favorites"}))})):g.Gm(e).then((function(e){ke("success",Se.formatMessage({id:"added_to_favorites"})),Ae((0,ie.me)(xe.access_token))})).catch((function(e){ke("error",Se.formatMessage({id:"could_not_add_to_favorites"}))}))},children:J?(0,R.jsx)(ne.A,{}):(0,R.jsx)(re.A,{})}),(0,R.jsx)(d.A,{variant:"h6",style:{flexGrow:1,marginLeft:0,color:ve.palette.primary.main},children:T.displayName?T.displayName:T.name})]}),(0,R.jsxs)(u.A,{children:[(0,R.jsx)(ce.nA,{startIcon:(0,R.jsx)(le.A,{}),style:{borderRadius:5,backgroundColor:we?ve.palette.grey[800]:ve.palette.grey[200],color:ve.palette.grey[500],margin:10,width:"calc(100% - 20px)"},label:"Descargar archivo",onClick:function(){ke("askUserDownloadType","Escoge el tipo de descarga").then((function(e){"original"===e?(ke("loading","Descargando archivo..."),c.U3({id:T._id.$oid,type:"original"},(function(e){ke("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){ke("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),ke("error","Error al descargar el archivo")}))):"small"===e&&(ke("loading","Descargando archivo..."),c.U3({id:T._id.$oid,type:"small"},(function(e){ke("loading","Descargando archivo... ".concat(Math.round(e),"%"))})).then((function(){ke("success","Archivo descargado correctamente")})).catch((function(e){console.error(e),ke("error","Error al descargar el archivo")})))}))}}),(0,R.jsx)(h.M2,{record:T,setMetadata:H}),(he.length>0||"audio"===T.processing.fileProcessing.type||"video"===T.processing.fileProcessing.type||ue().intersection(xe.roles,["editor","admin"]).length>0)&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(oe.Separator,{title:"Acciones"}),(0,R.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",padding:10},children:[ue().intersection(xe.roles,["editor","admin"]).length>0&&(0,R.jsx)(D.A,{children:"TaskAlt",title:"Tareas de catalogaci\xf3n",onClick:function(){w("user_record_tasks"===j?null:"user_record_tasks")},selected:"user_record_tasks"===j}),("audio"===T.processing.fileProcessing.type||"video"===T.processing.fileProcessing.type)&&(0,R.jsx)(D.A,{children:"PlayArrow,Settings",title:"Opciones de reproducci\xf3n",onClick:function(){w("player_settings"===j?null:"player_settings")},selected:"player_settings"===j}),"av_transcribe"===(null===v||void 0===v?void 0:v.view)&&(0,R.jsx)(D.A,{children:"InterpreterMode",title:"Ver oradores",onClick:function(){w("speakers_av_transcribe"===j?null:"speakers_av_transcribe")},selected:"speakers_av_transcribe"===j}),"av_transcribe"===(null===v||void 0===v?void 0:v.view)&&(0,R.jsx)(D.A,{children:"Edit,Transcribe",title:"Editar transcripci\xf3n",onClick:function(){w("edit_av_transcribe"===j?null:"edit_av_transcribe")},selected:"edit_av_transcribe"===j}),he.map((function(e,t){return(0,R.jsx)(R.Fragment,{children:ue().intersection(xe.roles,e.roles).length>0&&(0,R.jsx)(D.A,{index:t,children:e.icon,title:e.label,onClick:function(){e.extraOpts.length>0&&ke("askUserAction",JSON.stringify(e.extraOpts)).then((function(t){if(t){var r=(0,n.A)((0,n.A)({},t),{},{records:[T._id.$oid]});l.Gj(e.plugin,JSON.stringify(r),e.endpoint).then((function(e){ke("success",e.msg)})).catch((function(e){console.error(e)}))}}))}},t)})}))]})]}),Object.keys(T.processing).length>1&&(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(oe.Separator,{icon:(0,R.jsx)(m.A,{}),title:"Procesamientos"}),Object.keys(T.processing).map((function(e,t){var r=T.processing[e].type,n=Z.vJ.find((function(e){return e.value===r})),i=r;if("audio"!==r&&"video"!==r&&n)return(0,R.jsx)(oe.ItemMenu,{icon:(0,R.jsx)(x.A,{}),name:n.label,onClick:function(){y({view:i,slug:e}),w(null)},className:(null===v||void 0===v?void 0:v.view)===i?"selected":""},t)}))]})]})]}),(0,R.jsxs)(s.EL,{style:{width:"calc(100% - 400px)",height:"calc(100% - 20px)",position:"relative",margin:10,marginLeft:0,padding:0,overflow:"hidden",backgroundColor:"image"===T.processing.fileProcessing.type||"document"===T.processing.fileProcessing.type||we?ve.palette.grey[900]:"white"},children:["audio"===T.processing.fileProcessing.type&&(0,R.jsx)(ee.Q,{backend:te.t2,children:(0,R.jsx)(G,{id:T._id.$oid,setPlayTime:F,time:z,metadata:q,setMetadata:H,history:e.history,subView:j,slug:v.slug,children:"av_transcribe"===(null===v||void 0===v?void 0:v.view)&&(0,R.jsx)(V,{id:T._id.$oid,slug:v.slug,subView:j,time:N,setTime:function(e){Te(e)}})})}),"video"===T.processing.fileProcessing.type&&(0,R.jsx)(ee.Q,{backend:te.t2,children:(0,R.jsx)(K,{id:T._id.$oid,setPlayTime:F,time:z,metadata:q,setMetadata:H,history:e.history,subView:j,slug:v.slug,children:"av_transcribe"===(null===v||void 0===v?void 0:v.view)&&(0,R.jsx)(V,{id:T._id.$oid,slug:v.slug,subView:j,time:N,setTime:function(e){Te(e)}})})}),"document"===T.processing.fileProcessing.type&&(0,R.jsx)(ee.Q,{backend:te.t2,children:(0,R.jsx)(Y.A,{id:T._id.$oid,subView:j,setSubView:w,view:v,metadata:q,setMetadata:H,history:e.history})}),"image"===T.processing.fileProcessing.type&&(0,R.jsx)(ee.Q,{backend:te.t2,children:(0,R.jsx)(X.A,{id:T._id.$oid,setMetadata:H,metadata:q})})]})]})})},ge=fe},29704:function(e,t,r){var n=r(24994);t.A=void 0;var i=n(r(40039)),a=r(70579);t.A=(0,i.default)((0,a.jsx)("path",{d:"M6 19h4V5H6zm8-14v14h4V5z"}),"Pause")},54469:function(e,t,r){var n=r(24994);t.A=void 0;var i=n(r(40039)),a=r(70579);t.A=(0,i.default)((0,a.jsx)("path",{d:"M8 5v14l11-7z"}),"PlayArrow")},5374:function(e,t,r){var n=r(24994);t.A=void 0;var i=n(r(40039)),a=r(70579);t.A=(0,i.default)((0,a.jsx)("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PrecisionManufacturing")}}]);
//# sourceMappingURL=9017.381587b5.chunk.js.map