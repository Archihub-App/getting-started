"use strict";(self.webpackChunkarchihub=self.webpackChunkarchihub||[]).push([[159],{20159:function(e,t,n){n.r(t),n.d(t,{default:function(){return ee}});var i=n(64467),a=n(5544),o=n(65043),r=n(78717),s=n(9920),l=n(5670),c=n(48210),d=n(42588),u=n(26240),h=n(43845),f=n(15316),g=n(17392),p=n(99070),x=n(55263),m=n(85865),v=n(92530),y=n(93012),A=n(36795),j=n(31269),b=n(6512),w=n(4319),k=n(76370),C=n(90151),L=n(10765),S=n(68641),z=n(42497),R=n(79175),M=n(74802),_=n(94329),H=n(5374),E=n(88120),V=n(95501),B=n(83003),D=n(88455),N=n(73216),I=n(81551),P=n(72378),F=n(50264),T=n(85211),$=n(30279),O=n(30492),G=n(54536),W=n(64621),Z=n(64846),q=n(70579),J=function(e){var t=(0,B.wA)(),n=(0,B.d4)((function(e){return e.app.adjustements})),i=(0,o.useState)(!1),r=(0,a.A)(i,2),s=r[0],l=r[1],c=(0,o.useState)(n.contrast),d=(0,a.A)(c,2),h=d[0],f=d[1],m=(0,o.useState)(n.brightness),v=(0,a.A)(m,2),y=v[0],A=v[1],j=(0,u.A)();return(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(x.A,{style:{minHeight:"auto",padding:0,justifyContent:"space-between",alignContent:"center"},children:[e.children?e.children:(0,q.jsx)("div",{}),(0,q.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:10},children:[(0,q.jsx)(O.A,{style:{color:"white",opacity:s?1:.5,fontSize:20,transition:"opacity 0.3s"}}),(0,q.jsx)(g.A,{onClick:function(){return l(!s)},children:(0,q.jsx)(G.A,{style:{color:"white",opacity:.5,fontSize:20,transform:s?"rotate(180deg)":"rotate(0deg)",transition:"transform 0.3s"}})})]})]}),(0,q.jsxs)($.A,{in:s,children:[(0,q.jsxs)(x.A,{style:{minHeight:"auto",padding:0,justifyContent:"center",alignContent:"center",backgroundColor:j.palette.grey[900],borderTopLeftRadius:10,borderTopRightRadius:10,color:"white"},children:[(0,q.jsx)(p.Ay,{size:"small",min:0,max:3,step:.1,value:h,onChange:function(e,n){f(n),t((0,T.n_)({contrast:n,brightness:y}))},style:{width:"calc(100% - 20px)",margin:"10px"},valueLabelDisplay:"auto"}),(0,q.jsx)(Z.A,{style:{color:"white",opacity:.5,fontSize:20,marginRight:10}})]}),(0,q.jsxs)(x.A,{style:{minHeight:"auto",padding:0,justifyContent:"center",alignContent:"center",backgroundColor:j.palette.grey[900],borderBottomLeftRadius:10,borderBottomRightRadius:10,color:"white"},children:[(0,q.jsx)(p.Ay,{size:"small",min:0,max:2,step:.1,value:y,onChange:function(e,n){A(n),t((0,T.n_)({contrast:h,brightness:n}))},style:{width:"calc(100% - 20px)",margin:"10px"},valueLabelDisplay:"auto"}),(0,q.jsx)(W.A,{style:{color:"white",opacity:.5,fontSize:20,marginRight:10}})]})]})]})},K=n(58140),Q=(0,I.A)((function(e){return{close:{width:24,height:24,"& .MuiChip-label":{display:"none"},"& svg":{margin:"0 !important"},"& path":{fill:"white"}}}})),U=function(e){var t=Q(),n=(0,u.A)(),i=(0,K.M)().showAlert;return(0,q.jsx)("div",{style:{background:n.palette.grey[700],borderRadius:5,marginTop:5},children:(0,q.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",padding:"5px"},children:[(0,q.jsx)("div",{children:(0,q.jsx)(h.A,{label:"Guardar",size:"small",onClick:function(){c.vt({type:"image",record_id:e.record,data:{bbox:e.block.bbox}}).then((function(t){e.setSelectedBlock(null),i("success","Recorte creado correctamente")}))},icon:(0,q.jsx)(_.A,{}),style:{margin:3,border:"none"},variant:"outlined",className:t.close})}),(0,q.jsx)(h.A,{label:"Cerrar",size:"small",onClick:function(){e.setSelectedBlock(null)},variant:"outlined",icon:(0,q.jsx)(M.A,{}),style:{margin:3,width:24,height:24,border:"none"},className:t.close})]})})},X=(0,I.A)((function(e){return{toolbar:{minHeight:"auto",padding:5,paddingLeft:"10px !important",color:"#fff",borderTopLeftRadius:10,borderTopRightRadius:10,overflow:"hidden",alignItems:"center",width:"calc(100% - 34px)","& h6":{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",fontSize:16,margin:0}}}})),Y=function(e){var t=(0,o.useState)(null),n=(0,a.A)(t,2),i=n[0],r=n[1];return(0,o.useEffect)((function(){s.vv(e.record,e.slug).then((function(e){r(e)})).catch((function(e){r(null)}))}),[]),(0,q.jsx)(b.V,{id:"extra",initialPosition:{x:0,y:0},style:{display:i?"block":"none"},children:i&&(0,q.jsx)("div",{style:{padding:"10px",background:"white",maxWidth:350},children:i.caption.value})})},ee=function(e){var t=(0,o.useState)(!1),n=(0,a.A)(t,2),c=n[0],M=n[1],_=(0,o.useState)(null),I=(0,a.A)(_,2),$=I[0],O=I[1],G=(0,o.useState)(null),W=(0,a.A)(G,2),Z=W[0],Q=W[1],ee=(0,o.useState)(!1),te=(0,a.A)(ee,2),ne=te[0],ie=te[1],ae=(0,o.useState)([]),oe=(0,a.A)(ae,2),re=oe[0],se=oe[1],le=(0,o.useState)("carrousel"),ce=(0,a.A)(le,2),de=ce[0],ue=(ce[1],(0,o.useState)(null)),he=(0,a.A)(ue,2),fe=he[0],ge=he[1],pe=(0,o.useRef)(null),xe=(0,o.useRef)(null),me=(0,o.useState)(0),ve=(0,a.A)(me,2),ye=ve[0],Ae=ve[1],je=(0,o.useState)(1),be=(0,a.A)(je,2),we=be[0],ke=be[1],Ce=(0,o.useState)(null),Le=(0,a.A)(Ce,2),Se=Le[0],ze=Le[1],Re=(0,B.d4)((function(e){return e.user})),Me=(0,B.d4)((function(e){return e.app.adjustements})),_e=(0,N.g)().id,He=(0,u.A)(),Ee=X(),Ve=(0,B.wA)(),Be=(0,K.M)().showAlert,De=function(e){return(0,q.jsxs)(f.A,{style:{display:"flex",width:"calc(100% - 20px)",minWidth:"250px",alignItems:"center",justifyContent:"space-between",backgroundColor:"dark"===e.variant?He.palette.grey[900]:"white",borderRadius:"50px"},children:[(0,q.jsx)(g.A,{color:"primary",onClick:function(){Ne(we-1)},children:(0,q.jsx)(S.A,{})}),(0,q.jsx)(L.Z6,{name:null,value:we,handleChange:function(e){Ne(parseInt(e.target.value),!1)},min:1,max:ye,style:{width:"100px",padding:"0px",backgroundColor:"dark"===e.variant?He.palette.grey[700]:"white",marginRight:"10px",borderBottom:"none"}}),(0,q.jsx)(p.Ay,{ref:xe,defaultValue:0,"aria-label":"Default",valueLabelDisplay:"auto",size:"small",value:we,step:1,marks:!0,min:1,max:ye,style:{width:"80%"},onChangeCommitted:function(e,t){Ne(t,!1)}}),(0,q.jsx)(g.A,{color:"primary",onClick:function(){Ne(we+1)},children:(0,q.jsx)(z.A,{})})]})};(0,o.useEffect)((function(){return r.$R(_e).then((function(e){Ae(e.pages)})).catch((function(e){e.json().then((function(e){Be("error",e.msg)}))})),Ve((0,T.n_)({contrast:1,brightness:1})),function(){(0,C.vs)()}}),[]),(0,o.useEffect)((function(){ye>0&&((0,C.Ts)(ye,pe.current,1,_e,1,!1),(0,C.Zv)(ke),(0,C.i0)())}),[ye]),(0,o.useEffect)((function(){Se&&"img_analyze"===Se.view&&s.FZ(_e,we-1,Se.slug,"blocks").then((function(e){(0,C.P4)(e,we,1,(function(){}))})).catch((function(e){console.log(e)})),Me&&(Me.brightness&&(0,C.Ot)(Me.brightness),Me.contrast&&(0,C.zB)(Me.contrast))}),[Se,we]),(0,o.useEffect)((function(){s.de({id:_e,index:we-1}).then((function(e){O(e)})).catch((function(e){console.log(e)}))}),[we]),(0,o.useEffect)((function(){Me&&(Me.brightness&&(0,C.Ot)(Me.brightness),Me.contrast&&(0,C.zB)(Me.contrast))}),[Me]);var Ne=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e>ye&&(e=ye),e<1&&(e=1),(0,C.qV)(e,1,_e,t),ke(e)};(0,o.useEffect)((function(){Re.favorites&&$&&(Re.favorites.find((function(e){return e.id===$._id.$oid}))?M(!0):M(!1))}),[Re.favorites,$]),(0,o.useEffect)((function(){null===Z?("carrousel"===de&&(0,C.D8)(null),ne&&"carrousel"===de&&(0,C.a7)(we),Ie(we)):(ne&&"carrousel"===de&&(0,C.a7)(we),"carrousel"===de&&(0,C.D8)(Z),"carrousel"===de&&(0,C.P4)(re,we,1,Q))}),[Z]);var Ie=function(e){se([]),ne&&"carrousel"===de&&(0,C.a7)(e)};return(0,q.jsx)(P.Ay,{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"flex-start"},children:ye>0&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(P.EL,{style:(0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)((0,i.A)({width:"calc(100% - 40px)",marginBottom:0,height:"calc(100% - 20px)",padding:0},"width","400px"),"maxWidth","400px"),"border","none"),"display","block"),"placeContent","flex-start"),"overflow","auto"),"minWidth","300px"),"flexGrow",.5),"margin",10),children:$&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsxs)(x.A,{style:{background:He.palette.primary.light},className:Ee.toolbar,children:[Re.access_token&&"null"!==Re.access_token&&(0,q.jsx)(g.A,{sx:{marginLeft:"12px",color:He.palette.primary.main},size:"large",onClick:function(){var e={type:"records",id:$._id.$oid};c?l.C5(e).then((function(e){Ve((0,D.me)(Re.access_token)),Be("success","Eliminado de favoritos")})).catch((function(e){Be("error","No se pudo eliminar de favoritos")})):l.Gm(e).then((function(e){Ve((0,D.me)(Re.access_token)),Be("success","Agregado a favoritos")})).catch((function(e){Be("error","No se pudo agregar a favoritos")}))},children:c?(0,q.jsx)(y.A,{}):(0,q.jsx)(v.A,{})}),(0,q.jsx)(m.A,{variant:"h6",style:{flexGrow:1,marginLeft:0,color:He.palette.primary.main},children:$.displayName?$.displayName:$.name})]}),(0,q.jsxs)(f.A,{children:[(0,q.jsx)(d.M2,{record:$,setMetadata:ge,metadata:fe}),Object.keys($.processing).length>1&&(0,q.jsxs)(q.Fragment,{children:[(0,q.jsx)(F.Separator,{icon:(0,q.jsx)(H.A,{}),title:"Procesamientos"}),Object.keys($.processing).map((function(e,t){var n=$.processing[e].type,i=E.vJ.find((function(e){return e.value===n})),a=n;if("audio"!==n&&"video"!==n&&i)return(0,q.jsx)(F.ItemMenu,{icon:(0,q.jsx)(V.A,{}),name:i.label,onClick:function(){(null===Se||void 0===Se?void 0:Se.view)===a?ze(null):ze({view:a,slug:e}),(0,C.oS)(null)},className:(null===Se||void 0===Se?void 0:Se.view)===a?"selected":""},t)}))]})]})]})}),(0,q.jsx)(P.EL,{style:{width:"calc(100% - 400px)",height:"calc(100% - 25px)",position:"relative",margin:10,marginLeft:0,backgroundColor:He.palette.grey[900],padding:0},children:(0,q.jsx)(A.Q,{backend:j.t2,children:(0,q.jsxs)(w.M,{onDrop:function(e,t){return console.log(e,t)},onDragStart:function(){console.log("start")},children:[(0,q.jsx)(f.A,{ref:pe,style:{position:"absolute",width:"100%",height:"calc(100%)",overflow:"hidden",cursor:"move"}}),(0,q.jsx)(b.V,{id:"metadata",initialPosition:{x:0,y:0},style:{display:fe?"block":"none"},children:(0,q.jsx)(k.A,{resource:fe,setMetadata:ge,history:e.history})}),(0,q.jsxs)(b.V,{id:"processing",initialPosition:{x:0,y:0},style:{padding:0,borderRadius:5,boxShadow:"0 0 5px 0 rgba(0,0,0,0.6)"},children:[(0,q.jsxs)("div",{style:{padding:5,background:He.palette.grey[700],borderRadius:5},children:[(0,q.jsx)(De,{variant:"dark"}),(0,q.jsx)(J,{children:Re.roles.includes("user")&&(0,q.jsx)(h.A,{label:"Agregar un recorte",size:"small",onClick:function(){Q({index:re.length,bbox:{x:.1,y:.1,width:.1,height:.1},text:"",type:"default",new:!0}),ie(!0)},style:{border:"none",color:"white",backgroundColor:He.palette.grey[600],paddingLeft:"10px",paddingRight:"10px"},icon:(0,q.jsx)(f.A,{sx:{color:"white !important",display:"flex",alignItems:"center"},children:(0,q.jsx)(R.A,{})}),variant:"outlined"})})]}),Z&&(0,q.jsx)(U,{block:Z,labels:["default"],setSelectedBlock:Q,record:$._id.$oid})]}),"img_analyze"===(null===Se||void 0===Se?void 0:Se.view)&&(0,q.jsx)(Y,{record:$._id.$oid,slug:Se.slug},$._id.$oid)]})})})]})})}},30492:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M7.5 5.6 10 7 8.6 4.5 10 2 7.5 3.4 5 2l1.4 2.5L5 7zm12 9.8L17 14l1.4 2.5L17 19l2.5-1.4L22 19l-1.4-2.5L22 14zM22 2l-2.5 1.4L17 2l1.4 2.5L17 7l2.5-1.4L22 7l-1.4-2.5zm-7.63 5.29a.9959.9959 0 0 0-1.41 0L1.29 18.96c-.39.39-.39 1.02 0 1.41l2.34 2.34c.39.39 1.02.39 1.41 0L16.7 11.05c.39-.39.39-1.02 0-1.41zm-1.03 5.49-2.12-2.12 2.44-2.44 2.12 2.12z"}),"AutoFixHigh")},64621:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M20 15.31 23.31 12 20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20zM12 18V6c3.31 0 6 2.69 6 6s-2.69 6-6 6"}),"Brightness6")},64846:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M12 22c5.52 0 10-4.48 10-10S17.52 2 12 2 2 6.48 2 12s4.48 10 10 10m1-17.93c3.94.49 7 3.85 7 7.93s-3.05 7.44-7 7.93z"}),"Contrast")},54536:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M7.41 8.59 12 13.17l4.59-4.58L18 10l-6 6-6-6z"}),"KeyboardArrowDown")},5374:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"m19.93 8.21-3.6 1.68L14 7.7V6.3l2.33-2.19 3.6 1.68c.38.18.82.01 1-.36.18-.38.01-.82-.36-1L16.65 2.6c-.38-.18-.83-.1-1.13.2l-1.74 1.6c-.18-.24-.46-.4-.78-.4-.55 0-1 .45-1 1v1H8.82C8.34 4.65 6.98 3.73 5.4 4.07c-1.16.25-2.15 1.25-2.36 2.43-.22 1.32.46 2.47 1.48 3.08L7.08 18H4v3h13v-3h-3.62L8.41 8.77c.17-.24.31-.49.41-.77H12v1c0 .55.45 1 1 1 .32 0 .6-.16.78-.4l1.74 1.6c.3.3.75.38 1.13.2l3.92-1.83c.38-.18.54-.62.36-1-.18-.37-.62-.54-1-.36M6 8c-.55 0-1-.45-1-1s.45-1 1-1 1 .45 1 1-.45 1-1 1"}),"PrecisionManufacturing")},94329:function(e,t,n){var i=n(24994);t.A=void 0;var a=i(n(40039)),o=n(70579);t.A=(0,a.default)((0,o.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")}}]);
//# sourceMappingURL=159.b805a017.chunk.js.map